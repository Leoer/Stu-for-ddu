var ot=Object.defineProperty,lt=Object.defineProperties;var ut=Object.getOwnPropertyDescriptors;var Ve=Object.getOwnPropertySymbols;var ft=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var He=(he,ve,O)=>ve in he?ot(he,ve,{enumerable:!0,configurable:!0,writable:!0,value:O}):he[ve]=O,me=(he,ve)=>{for(var O in ve||(ve={}))ft.call(ve,O)&&He(he,O,ve[O]);if(Ve)for(var O of Ve(ve))dt.call(ve,O)&&He(he,O,ve[O]);return he},Ee=(he,ve)=>lt(he,ut(ve));var Ae=(he,ve,O)=>new Promise((C,_)=>{var S=M=>{try{y(O.next(M))}catch(T){_(T)}},c=M=>{try{y(O.throw(M))}catch(T){_(T)}},y=M=>M.done?C(M.value):Promise.resolve(M.value).then(S,c);y((O=O.apply(he,ve)).next())});import{d as ct,u as ht,a as vt,m as pt,n as gt}from"./useFileUpload.916a07a1.js";import{bO as Ye,O as Ke,K as We,a as ke,f as Be,p as ye,L as mt,M as yt,r as Et,o as xt,u as Ce,h as be,e as xe,k as _t,n as Ze,U as Tt,V as St,J as Re}from"./index.9f622a37.js";import{b as Ne}from"./request.b205aa07.js";import{r as Lt}from"./base.130d3d79.js";import"./tooltip.f118fcb0.js";import{E as At}from"./popper.5fa9a149.js";/* empty css               */import{_ as Dt}from"./plugin-vue_export-helper.21dcd24c.js";import"./common.3a5e4a7b.js";import"./index.109b76e3.js";import"./index.36cab1dc.js";import"./event.776e7e11.js";import"./index.612f1529.js";import"./scroll.4c4cec4f.js";import"./event.3ec63147.js";import"./focus-trap.fe9e3ce7.js";import"./validator.3c5d84ac.js";import"./index.0cd3ee2d.js";import"./index.3fabbc49.js";import"./directive.0cfb6a3e.js";var Mt="/assets/video-download.3a226681.png",It="/assets/video-thunder.5e7f4cec.png",bt="/assets/video-motrix.95ef7e61.png",Rt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAOeUlEQVR4Xu3dy5EjuRWF4TMGyA550ibIgPZirJjFODIeaDVOaDMvSREKRdRKGy0UVF1mZTV5yGS+ACSA/G/EV1F1p7unu4pA4nEB6nK5fIeG/UN/vvyuL5df9fXyi75///zHq9/00+UP/fye+9vVr3q7cZnw7deMvy/+jPiz4s+MPz/+PyH+v//Wnx7+PmiKPIEKRUMbG/nYuIdG7Q34GPF3GTuJ4e/4hc6hDfIEDjY29njaRqN6/cSu29gxDCMTOoUKyRMoLIbS8dSs7ameS/wbx5FC/Nv9+4Gi5AlkNj7hhzl1/w1+ztghMEI4hDyBDOJJF8PgWFDzBoB745SB0UER8gQSGRs9T/nthl0MOoOM5AnswJM+n7EzYJqQlDyBDWL+OqzYP75wkd6w5fjl4eeA1eQJLDQU4MRqdrvbdK0bipWYIuwgT2AGT/s6xc+EjmA1eQITYt+auX394mfE9GAxeQI3YsGJlfw2DT+zrywaviZP4MNw8IX5fevoCF6SJ04tXiTDqTqe+L0ZOwL/mZ+cPHFaNPxzGEqPWSP4IE+cTrwYWNw7H3YNruSJ0/i2j//44sB5xGvgxOsD8sQpsMCHe/FaOOX6gDzRNYb7eCVeGyebFsgTXRrO4DPcxzIxQvTXUKfkie4M12uxuo91TrJbIE90g6c+Uuh8NCBPdGE4l89TH2l0vDYgTzRvuLf+8YcI7NfdToE80awY8nNMF7nFa6yjugF5okkM+VFSvNY6mRLIE81hyI9jdFE8JE80g1V+1CBeg/7abIg80YRo/FT0oRYNrwvIE9Vjvo8aNbouIE9UbXiHXA7xoFZvrXUC8kS1WOxDG95aKiGWJ6pE40d7mtghkCeqM5zd928uUL8GzhHIE1Vhmw+tq7wTkCeqQeNHLyruBOSJKtD40ZtKC4bkicPR+NGrCkcC8sShaPzoXWWdgDxxGFb7cRYVdQLyxCHY58f5VFEnIE8UN5T3+jcH6F8FFYPyRFHU9uPcDi8blieKiUMTNH7g0ANE8kQRcXaaI73AINrCQfcJyBNFcJkHcC8uFfF2UoA8kR17/cBzB2wPyhNZsd0HvFZ4UVCeyIZFP2CJoouC8kQWLPoByxVcFJQnsuAde4B1Ci0KyhPJMe8HtspeLixPJDXM+/0fBWCZ7OsB8kQyzPuB/aJmxttWQvJEMuz3A2lkrA+QJ5LghB+QVqapgDyRBEN/IK1oU97OEpAnduNmHyCPDFMBeWIXVv2BvBJPBeSJXTjlB+SVeFdAntiMgh+glGQFQvLEJrHnz0EfoJS3VGcF5IlN2PMHykr0TkPyxGos/AHHSLAgKE+sxsIfcIwEC4LyxCpU/AHH2nmDkDyxChV/wLF2VgjKE4ux7QfUYvO2oDyxGE9/oA47rhCTJxbh6b/Pv969/WXw9yf/HVhv0yhAnpjFRR/7/Pevl4f4zw90BNhn4yhAnpjF03+7eOJPxf/+Ofx3/z3AcqtHAfLELJ7+2z17+nvEr2E0gC027AjIEy+x77/Pmohpgf9+YN6qUYA88RJVf/usjZgWxIKh/znAlJXVgfLEJJ7++20NpgVYY0V1oDwxiXf32W9vsEiIJVa8q5A88RQn/tJIEUwLsMTCk4LyxFNc9JlGyqB2AK8svEBUnniK237SSB3UDmDa28Xb8RPyxAMW/9LJFbFIyLQAbsFioDzxgMW/dHIHtQO4tWAxUJ64M1z2+fgHY5sSwbQAt2bOB8gTd1j8S6tkUDuAMLMYKE/cofIvrSOC0cC5zVQGyhOf2PtP76igduDcXtQEyBOfGP6nd3RQO3BOL6YB8sQnhv/p1RJMC87lxTRAnrhi+J9HTUHtwLlMTAPkiSuG/3nUGNQOnMPENECeuKL4J49ag9qB/k0UBckTFP9kVHtQO9C3J0VB8gS1/xm1EkwL+vTkbIA8wVt9Z9RSUDvQnydvKS5PcOtvRi0G04J+PLk1WHcJtv/yajVYJOyHbQfq9osLb/qRV+tB7UAP7q4N1+0XzP8z6yUoKW6XrQPo9gvKfzPrKZgWtMnKgvX5Bfv/+fUYLBK256YeQOMn7P8X0HNQO9COm3oAjZ9Q/19A70HtQBtuzgVo/IT6/wLOEkwL6nZzLkDjJxQAFXC2YJGwTjcFQbp+wgJgGWcMpgV1+lgIVHygArCQMwe1A3X5WAhUfLhQAVjG2YPagZpcKwIVH6gALIQYgkXC431UBCo+sANQCHEf1A4c52MnQPGBEuBCiMdgkfAYHzsBig8X3v67DGI6mBaUd+0A2AIsh5gPFgnLeW/7YguwIGJZMC0o43d9EYeACiLWBbUDeV07AGoAyiHWB7UD+fyi78UpwIKI7cEiYXrXDoAioHKI/UHtQDrvbZ8OoCQiTbBImMZv+klUARZEpA2mBfv8oZ9FFWBBRJ5gkXCbawfARSDlEPmCacF6722fDqAkIn9QO7DGW9QBcA6gFKJMUDuw1LUD8CRyIcoGb2U2iw6gJOKYoHZgEh1AScRxEaMB/3mADqAo4thgXeABHUBJxLERi4P+Mzk5OoCSiOPDfyYnRwdQEnFssA7wgA6gJOLYYEvwAYVAJRHHBQuAz1AJWBRRPjgx+MobZwFKIsoF5cDzroeBOA5cDlEmOBC0zLUD4EKQcoi8Qe3/Otf7AOgAyiHyBMP9ba5XgnEnYDlE+mC4v931UlCuBS+HSBfcALTftQPgjUHKIdIEw/00Pt4XgLcGK4XYF+zpp/aVNwctidgWDPfzuL43IG8PXg6xPhju5/P+8H//ePnuQjlwGcTyYLif33vbj4/fUQ5cCDEfDPfLiDb/2QFQDFQG8Tq4vLOcaPOfHQDFQGUQz4PhfnnR5j87AGoByiDugxLeI3293IwAqAUogfgWDPePFW3+swNgK7AMguF+LaLNf3YA7ASUceZguF+Tt8tHu9f4CTsBBZw1OLFXl48dgKDxE04FFnC24IKOOkVbf+gAWAjM7yzBcL9uHwuAQeMnLAQWcIZguF+/jwXAoPGTKxYC8+o5GO634aMEeKTbL6gIzKzHYLjflo8KwJFuv7hQEZhXb8Fwv0XXCsCRbr/gcpDMeglO7LUr2vhkBxBYB8inh2C43y6b/wd5gnWAjFoOSnjbZ/P/IE9QD5BRi8Fwvx83+/8jeYJ6gIxaC4b7fbnZ/x/JE1e8YWgerQTD/f5Em/Z2PtkBcC4gj9qD4X6/bur/b8kTV2wH5lFzcEFH32z7byRPfGI7ML0ag+F+/55s/43kiU9MA9KrKSjhPY+J4X+QJz4xDUivlmC4fy4Tw/8gT9xhGpDW0cFw/3xeDP+DPHGHaUBaRwXD/fN6MfwP8sQdpgFpHRGc2Du3F8P/IE884LLQdEoGF3Tg5vLPKfLEA84GpFMiGO5j9KT238kTD4azAbx9eAq5g+E+vvm8+/8VeeIpjginkSsY7sM9Ofr7jDzxFIuBaaQOhvuYMrP4N5InJrEYuF/KYLiPKQsW/0byxCQWA/dLEZzYw5wFi38jeeIl7gnYZ28w3Mecmco/J0+8xLXh+2wNSnix3N2133PkiZdiS5DzAdutDYb7WCPa5pNrv16RJ2ZxPmC7NcFwH2vN1P0/I0/MojBouxjKzwXDfWzztvbpH+SJRRgFbBNP9alguI89Njz9gzyxCKOA7WL/3oPhPvbZ9PQP8sRi7AhsF0P8aPQ88ZHGqpX/W/LEYuwIAMfbsPJ/S55YhVEAcLTNT/8gT6xGdSBwjIl3+1lDnliNMwLAMVbU/E+RJzbhpCBQ1ooTf6/IE5sM9wWwLQiU8bb0vP8ceWIzioOAMjYW/TwjT2zGtiCQ38rjvnPkiV1YEATySrDwd0ue2I0LRIE8Fl70uYY8sRtTASC9nRV/U+SJJJgKAGklHvqP5IlkmAoAaWQY+o/kiWSYCgD7ZRr6j+SJpJgKAPskKviZIk8kR4EQsE3Cgp8p8kQWnBgE1klU6z9HnsiC9QBguczz/lvyRDasBwBLJDvos4Q8kRU3CAFzdt3ws5Y8kR31AcBzGff7p8gT2cXchkVB4F6C6722kCeKYFEQ+Kbgop+TJ4qIfyy3CAGh6KKfkyeKYmcA5/aW65DPUvJEcewM4KwObvxBnjgE5cI4n6LbfVPkicOwPYizKFDjv5Q8cSg6AfTugL3+V+SJw9EJoFeVNf4gT1SBdxpCbyps/EGeqAYjAfSi0sYf5Imq0AmgdRU3/iBPVIdOAK2qaLV/ijxRJeoE0J4q9vnnyBPVomIQbTi8vHcNeaJqw9kBDhChVoce7NlCnqhefIM5SozaxGuyscYf5IkmcKkIahJ1Kwed599LnmhGfMPZIcDRKt/mmyNPNIfFQRyjqcW+KfJEk1gXQEmNzvefkSeaFVMCzhAgt4bn+8/IE82jaAh5xPZzE8U9a8gTXWBKgJRix6mTIb+TJ7rBLgFSaKCefw95ojuxUstoAGvFa6aDVf458kSXGA1gjXjqd7TQ94o80TXWBvBKx3P9KfLEKQw7BRwqwqjLFf4l5InTYFqAEK+Bkwz3n5EnTmP8oceQj4NF5xMFPScb7j8jT5xWDAFZH+jfSVb3l5InTi1GBcPhItYHejN07qec578iT+AydAQsFPaBhv+SPAETHQFTg/bQ8BeRJzCBNYI2xIIuc/zF5AnMiBcXx47rw6r+JvIEFhqqClknOFKMyE5UtpuDPIENGBWU9Hb9XjPMT0KewA7jqIDCovSG7+lXnvZpyRNIZOwMWDjcLhp9fA+Z22cjTyADRgZLDcP7eNLT6IuQJ5DZcAjpy/UQCqODsTT3x+v3hOF9cfIECosnXTzxztIhDPv0NPhKyBM42DhCiClDDIdb7hTi7z78G76nwddJnkCFouHcjhSiUQ3rCTXUILxd/y5jQx/n7zT2JsgTaMzYOQxvnR7lyvG0jSH2t45iKJiJkUR0GKPHhjwaf/3YsIfpSexoDA08/l808i78HzPcPJXn8KhQAAAAAElFTkSuQmCC",Ot="/assets/video-iina.1db26170.png",Ct="/assets/video-vlc.54e63a7e.png",Pt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAK2UlEQVR4Xu2dC3BUZxXHD4g4VlukLRTEIKhYochjeBRaCoggpQaqBSrQWFuCwLbFDpRhQIs4Y8YRO1Lr4JSWJkCJVihgy0PerxapUhqaQrCFIkUghM1rs7sJVCYcz3d3v+Tuud+9e/dFdpPvP/OfwAzs3j0//v9zv2x2ANDS0tLS0tLS0tLS0tLS0tLS0tJqEHrhi1gJM+jrOqyAf2A5vEFeSr8exP+sVopFg59C9pJR6UrYRu7F/55WCkQJWGABoPY1Ss9K+tqZP4ZWkkQwRtGAryuG7+QAgfmFqDj+eFoJiob7nmLgbl1KNTYdEVrzx9WKQ1gFvRVDjt2VcIx8P398rRhFdfWoZbiJ2AvbCcxd/Hm0XIqAeCxDTdz19Lj5qBd/7EoREOkApWWJXvwxKMVADFdXQmkRLX7Qiz+6UgHkagXgyWrAzTWAvw0APh1s8Im5Qb34HZUMINfJ5yoBd/sAl/sB5zYCUHpOELaT+/Jr0YL4gVwmAIcpBQUEYKFi6C5cPy8I+TNr9eKPkFsgAQLwPgFYTzX0K+tw43ctBH4WgLwlevGHZAfkGu2BjwjAVgLwXOQeSJrnRLqU4OSORGjDr7FFSQIRe+A8pWAfQXiRaugZxQCTaQajwU8FoeSJlrz4j1SBZw2lYJFiaKk0BxGGYZiA4Owg7JpdC/359TZ7zQuAhw8rleYQzCBMMKTr6ff5U2rhy/y6m61uJBAnEAoYODPsWQGom9FSFv+NAhIPDAKBPyXnkh8nT/dD6fQAzG7Wiz/VQDgIFQwzCDMMAULCkP4xOccPJVOb6+JPJRAOgsPgqZAwZCrMMH4ShvEIeSr5R+TJftg3obkt/lQA4RDcwFBVlDkVAoSwAYI8iW7Nf0B3hxNqoH68Dwqyq6Arf20ZqWQC4QDcgrCDoUrFw/5GGNnkB8hjyCN8UDe8BvImZ/riTxYQDoGDsNsV5oqyS4WAIVPxkN9IhQFiLHmUgEG+hzzEBwjVUAYXBzwB+5dk5uJPFAiHoAJhB0O1uM2pUFWUTIWAIUAMEhAudUU4PQeheBfCOz6Ew36EQ/4SeNufzV9v2iteIByCHQwVCGEOQqbCXFEShLBIhYAhQEA5+VwOQsk6hCNlCP8MEogAgRAmGG+HfZD8ln8/HKzOnMWfTCBOu8IpFbyieCp6VxKAiw8ifLQC4djHCO8SgH+F3QDD3whDgBDeXxPy3pp62Fv9KuyuS//FHw8QDiIWGHxfqCpqXLWoodEI/1mKcPwownvBEAThIyYYAoSEYU7FwTCIfQYMhN1UY7vIO6vrYIcvD/5eeQufQ9ooViDxgHBa3MJTKAntL/emGlqEcHIvpYCGVxQMgVDBcKqoAyYYe3xmGAjbydsMl8OW6sf5LNJCsQCxA+EEwy4VA6taIVzw0DLeRMvYSxDqCIJwbSOIoyYQFhh+sbitFSVTIWBIEDsEDF8Ixpaw36xCeKPqZUBsxWfSpHIDxCkV0hyEeV8ICA+Ku6GL06iGChBOnCEINPz360IgGmC4SIWqosyp2OuLhCFSIZMhQGw2QCBsqgz5b1WL+EyaVNGAcBgcCE+GhDGNauhm71iET36P8CHtgeJgCIJ0BIjaRhgyFSoY5oqyLm5TRclUmEA0pCIMYiN5A/n1iquwtjZ93te3A8IhcBAcxgzy3RX9qIZ+iXCK9sBxGswHtZEQLKkQIEwVxUEYMEypiKgotridKmpzdSgVEoYBgrxOuBzhLxUL+FyaTBwIh6ACISsqu0rcDT1FNbSRaqgsBECagzDD4KlQwVClQsKQqZAVpV7c1lREwKhA+KuAIVy5jc+lySSBcAgqGI/QmaBVGR3IzuVTDZ0mCDTYD65EglDBsOwKxeK2gxHv4hapUFXUegajkPzn8nf5XJpMAgiHIEGIu6O+5fcjnF9GNUR74EQwBEH4eIww3KTC6WzBFzdPRcTiDleUJRXhinpNwqC7u7XkV737+FyaTHNMQASEMVV0HihdjHBmD0KJrxGA2W5ACMebCleL2xe5uLc6VJQqFRLGGgPI83wuTaaJPvAYe+CTDQj/LrUO3+xYU6GCwUHEe7YwUuGwuEVFOaVCwlgtvl4eyufSdDp51WMZvMoGiBhg8IqKNRXRKsq8uI2zBUuFZXFHVFQIhHDBpfRZ6IbcAHEDIu6K8lthSBDy2x92i5tXVMPZIkpFGSDIq8pOQUGgAx9J08oJiNuKkiAaYIRBqCrK6cTNzxY8FU6L21xRAgSvKJEKM4z8SzvgT95OfBxNLzsgqoriIOJOhaKilItbpsIEgqfCrqJUqRBeVVYKr5RN42NIH6mAcBDxwrA7catguF3cvKKUi7vcurgLvNdglfcP8MfT6futd0MSiKgntxVlt7hVFSXPFqoTd6oXt4SRX3YI8i9nyAeEJJBYQDilQllRNqmwragYFrdTKlZ7vbQrHku7b7E7SgBJFAYHwSvKdnErUqFa3KqKclrcKz6sh8cWvzhs2LD2/OWmv4oFEAcQsVaUanFLGDIVzu/mWVMRraJWX0CY9xL2HTsa87vdcQQBBvKXmTkqDjQCsQOhSkXK381jqTC+/WFKRd4W7PDQw/jz/t3xU6BSAqC/BLPIGf7RawGEg7CkQjjOVERb3KqKsqSC/NIxhNz5mDNiIJ6F1gKA9HVyAfl2/tIyU8W1ViDRUhENhtPibkiFCYQqFYXnEBa+gNnjx+CBrDvMAMwmSnAPf0mZLQ7EDgYHwRe307t5blKxkXbB0k1497SpuGbAN/nguenB4GlyZv64qKMkEA4iGRUVbXGvPIRZT87F34wZhFegLR+6yqKeCsnp8x540iWAcBiuKoqnIlxRTot73SmEZ5ehZ9I4PNPtK3zY0VxCHskvv/lJAnGbiljOFlvLEJa9hlOnP4pvDfk2H7Bb0xPCAnJbfunNU0UExHUqoi1uSsLqA/jdZ+bj+ux7ETu348ON1a+Ts/glN28JIBxGxOKWMGwqatNx7J23DJfnjMcrfboj3vYZxC+0QmxtGW4sPk3+Hr/UlqEiOofYpULcRfHFvfMCtl1eiM8+mYtnRw5A7EYp6HIzpeEmxHZtENtahhuLqTthMflz/DJbjo4SEBUMWVEH6ZZ07U6ctXghvjNxNGKfLog9b0P8xi2IXQlEFwLRke6Q2iWcis3k7vzyWp4EEH62eLMIf/jc87hlxkTE+76F2K8zgaDDWc+OiHfeHoIhU5F4RZ0lj+eX1XIlgOw5i/e9XIj582fhlQcGIw7thjj4q4iDskIwenUKpeLO9o0VJVMRf0V9Sv41+fP8klq0/pszzoPf6YE4/OuI9xKIIWEQ/ama+lEqeplSISsq8VTsJPfg16JFwlFf8+Dw7qFUSBgRFRVOhYDRWaRCLO64YZwnT+bXoGUSjiAgsqKMVIQrykjFreFUJFxR/yP/jpzZnyG/EcIhWZ5QRYVTwSsq8cV9gKz/iwu3olR4lBWV+NmilJxDzqD3s9NA2Kejx5IKubjjO1tcI79A/hJ/Li0Xwrs6TYpc3OFUxFdRh8n9+HNoxSDs2aFHEs4W5eRc1PWUHGGnmw7HubjrySvIt/LH1EpA2AaGUirEyZkP3MlHyYP5Y2klSTTcmRj6F88Hz11N9mDG/7hNBoiG/H3yxwoIwuJw9wo5zT5P0cyFMOCzNPQJGLp13UBeSZ5HTsPPUmhpaWlpaWlpaWlpaWlpaWlpaWlpaWklqv8Da8GBU4g36CAAAAAASUVORK5CYII=",wt="/assets/video-mxplayer.5dfa69aa.png",Ft="/assets/video-mxplayer-pro.10406916.png",Xe={exports:{}};/*!
 * artplayer.js v4.5.2
 * Github: https://github.com/zhw2590582/ArtPlayer
 * (c) 2017-2022 Harvey Zack
 * Released under the MIT License.
 */(function(he,ve){(function(O,C,_,S,c){var y=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof Ke!="undefined"?Ke:{},M=typeof y.parcelRequire4dc0=="function"&&y.parcelRequire4dc0,T=M.cache||{},p=typeof Ye=="function"&&Ye.bind(he);function u(l,h){if(!T[l]){if(!O[l]){var v=typeof y.parcelRequire4dc0=="function"&&y.parcelRequire4dc0;if(!h&&v)return v(l,!0);if(M)return M(l,!0);if(p&&typeof l=="string")return p(l);var d=new Error("Cannot find module '"+l+"'");throw d.code="MODULE_NOT_FOUND",d}t.resolve=function(i){var e=O[l][1][i];return e!=null?e:i},t.cache={};var r=T[l]=new u.Module(l);O[l][0].call(r.exports,t,r,r.exports,this)}return T[l].exports;function t(i){var e=t.resolve(i);return e===!1?{}:u(e)}}u.isParcelRequire=!0,u.Module=function(l){this.id=l,this.bundle=u,this.exports={}},u.modules=O,u.cache=T,u.parent=M,u.register=function(l,h){O[l]=[function(v,d){d.exports=h},{}]},Object.defineProperty(u,"root",{get:function(){return y.parcelRequire4dc0}}),y.parcelRequire4dc0=u;for(var n=0;n<C.length;n++)u(C[n]);var f=u(_);he.exports=f})({"6SN6P":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("bundle-text:./style/index.less"),y=S.interopDefault(c),M=O("option-validator"),T=S.interopDefault(M),p=O("./utils/emitter"),u=S.interopDefault(p),n=O("./utils"),f=O("./scheme"),l=S.interopDefault(f),h=O("./config"),v=S.interopDefault(h),d=O("./whitelist"),r=S.interopDefault(d),t=O("./template"),i=S.interopDefault(t),e=O("./i18n"),a=S.interopDefault(e),o=O("./player"),s=S.interopDefault(o),g=O("./control"),L=S.interopDefault(g),A=O("./contextmenu"),m=S.interopDefault(A),E=O("./info"),x=S.interopDefault(E),D=O("./subtitle"),I=S.interopDefault(D),b=O("./events"),R=S.interopDefault(b),P=O("./hotkey"),w=S.interopDefault(P),F=O("./layer"),k=S.interopDefault(F),B=O("./loading"),U=S.interopDefault(B),j=O("./notice"),K=S.interopDefault(j),N=O("./mask"),Z=S.interopDefault(N),$=O("./icons"),Y=S.interopDefault($),ee=O("./setting"),Q=S.interopDefault(ee),G=O("./storage"),q=S.interopDefault(G),te=O("./plugins"),ie=S.interopDefault(te),ne=O("./mobile"),le=S.interopDefault(ne);let ae=0;const oe=[];class J extends u.default{constructor(fe,de){super(),this.id=++ae;const ge=n.mergeDeep(J.option,fe);this.option=(0,T.default)(ge,l.default),this.isLock=!1,this.isReady=!1,this.isFocus=!1,this.isInput=!1,this.isDestroy=!1,this.whitelist=new r.default(this),this.template=new i.default(this),this.events=new R.default(this),this.whitelist.state?(this.storage=new q.default(this),this.icons=new Y.default(this),this.i18n=new a.default(this),this.notice=new K.default(this),this.player=new s.default(this),this.layers=new k.default(this),this.controls=new L.default(this),this.contextmenu=new m.default(this),this.subtitle=new I.default(this),this.info=new x.default(this),this.loading=new U.default(this),this.hotkey=new w.default(this),this.mask=new Z.default(this),this.setting=new Q.default(this),this.plugins=new ie.default(this)):this.mobile=new le.default(this),typeof de=="function"&&this.on("ready",()=>de.call(this)),oe.push(this)}static get instances(){return oe}static get version(){return"4.5.2"}static get env(){return"production"}static get build(){return"1655888299105"}static get config(){return v.default}static get utils(){return n}static get scheme(){return l.default}static get Emitter(){return u.default}static get validator(){return T.default}static get kindOf(){return T.default.kindOf}static get html(){return i.default.html}static get option(){return{container:"#artplayer",url:"",poster:"",title:"",type:"",theme:"#f00",volume:.7,isLive:!1,muted:!1,autoplay:!1,autoSize:!1,autoMini:!1,loop:!1,flip:!1,playbackRate:!1,aspectRatio:!1,screenshot:!1,setting:!1,hotkey:!0,pip:!1,mutex:!0,backdrop:!0,fullscreen:!1,fullscreenWeb:!1,subtitleOffset:!1,miniProgressBar:!1,useSSR:!1,playsInline:!0,lock:!1,fastForward:!1,autoPlayback:!1,autoOrientation:!1,layers:[],contextmenu:[],controls:[],settings:[],quality:[],highlight:[],plugins:[],whitelist:[],thumbnails:{url:"",number:60,column:10},subtitle:{url:"",type:"",style:{},encoding:"utf-8"},moreVideoAttr:{controls:!1,preload:n.isSafari?"auto":"metadata"},icons:{},customType:{},lang:navigator.language.toLowerCase()}}get proxy(){return this.events.proxy}get query(){return this.template.query}destroy(fe=!0){this.events.destroy(),this.template.destroy(fe),oe.splice(oe.indexOf(this),1),this.isDestroy=!0,this.emit("destroy")}}if(_.default=J,J.NOTICE_TIME=2e3,J.SETTING_WIDTH=250,J.SETTING_ITEM_WIDTH=200,J.SETTING_ITEM_HEIGHT=35,J.INDICATOR_SIZE=14,J.INDICATOR_SIZE_ICON=16,J.INDICATOR_SIZE_MOBILE=18,J.INDICATOR_SIZE_MOBILE_ICON=20,J.VOLUME_PANEL_WIDTH=60,J.VOLUME_HANDLE_WIDTH=12,J.RESIZE_TIME=500,J.SCROLL_TIME=200,J.SCROLL_GAP=50,J.AUTO_PLAYBACK_MAX=10,J.AUTO_PLAYBACK_TIMEOUT=3e3,J.RECONNECT_TIME_MAX=5,J.RECONNECT_SLEEP_TIME=1e3,J.CONTROL_HIDE_TIME=3e3,J.DB_CLICE_TIME=300,J.MOBILE_AUTO_PLAYBACKRATE=3,J.MOBILE_AUTO_PLAYBACKRATE_TIME=1e3,J.MOBILE_AUTO_ORIENTATION_TIME=200,J.INFO_LOOP_TIME=1e3,J.FAST_FORWARD_VALUE=3,J.FAST_FORWARD_TIME=1e3,typeof document!="undefined"&&!document.getElementById("artplayer-style")){const se=document.createElement("style");se.id="artplayer-style",se.textContent=y.default,document.head.appendChild(se)}typeof window!="undefined"&&(window.Artplayer=J),console.log(`%c ArtPlayer %c ${J.version} %c https://artplayer.org`,"color: #fff; background: #5f5f5f","color: #fff; background: #4bc729","")},{"bundle-text:./style/index.less":"9EPUe","option-validator":"2A2W5","./utils/emitter":"7pHuB","./utils":"geSvU","./scheme":"3vPoh","./config":"eksZR","./whitelist":"fCKwj","./template":"bqHdK","./i18n":"4O9ZY","./player":"fzROd","./control":"kJ9J9","./contextmenu":"7rh9q","./info":"c896w","./subtitle":"2hqso","./events":"j2hlX","./hotkey":"aTHWZ","./layer":"f2kxw","./loading":"bOs9w","./notice":"ic4th","./mask":"iLfmB","./icons":"5lAmI","./setting":"d5XKP","./storage":"5M8nN","./plugins":"jWfEd","./mobile":"fkUkB","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9EPUe":[function(O,C,_){C.exports='.art-video-player{z-index:20;width:100%;height:100%;zoom:1;color:#eee;text-align:left;direction:ltr;user-select:none;-webkit-tap-highlight-color:#0000;touch-action:manipulation;-ms-high-contrast-adjust:none;background-color:#000;outline:0;margin:0 auto;font-family:Roboto,Arial,Helvetica,sans-serif;font-size:14px;line-height:1.3;display:flex;position:relative}.art-video-player *,.art-video-player :before,.art-video-player :after{box-sizing:border-box;margin:0;padding:0}.art-video-player ::-webkit-scrollbar{width:5px;height:5px}.art-video-player ::-webkit-scrollbar-thumb{background-color:#666}.art-video-player ::-webkit-scrollbar-thumb:hover{background-color:#ccc}.art-video-player .art-icon{justify-content:center;align-items:center;line-height:1.5;display:inline-flex}.art-video-player .art-icon svg{fill:#fff}.art-video-player img{max-width:100%;vertical-align:top}@supports ((-webkit-backdrop-filter: initial) or (backdrop-filter: initial)){.art-video-player .art-backdrop-filter{-webkit-backdrop-filter:saturate(180%)blur(20px);backdrop-filter:saturate(180%)blur(20px);background-color:#000000b3!important}}.art-video-player .art-video{z-index:10;width:100%;height:100%;cursor:pointer;background-color:#000;position:absolute;inset:0}.art-video-player .art-poster{z-index:11;width:100%;height:100%;user-select:none;pointer-events:none;background-position:50%;background-repeat:no-repeat;background-size:cover;position:absolute;inset:0}.art-video-player .art-subtitle{z-index:20;width:100%;text-align:center;color:#fff;pointer-events:none;text-shadow:1px 0 1px #000,0 1px 1px #000,-1px 0 1px #000,0 -1px 1px #000,1px 1px 1px #000,-1px -1px 1px #000,1px -1px 1px #000,-1px 1px 1px #000;padding:0 20px;font-size:20px;display:none;position:absolute;bottom:10px}.art-video-player .art-subtitle p{word-break:break-all;height:fit-content;margin:5px 0 0;line-height:1.2}.art-video-player.art-subtitle-show .art-subtitle{display:block}.art-video-player.art-control-show .art-subtitle{bottom:50px}.art-video-player .art-danmuku{z-index:30;width:100%;height:100%;pointer-events:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers{z-index:40;width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-layers .art-layer{pointer-events:auto}.art-video-player.art-layer-show .art-layers{display:block}.art-video-player .art-mask{z-index:50;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0;overflow:hidden}.art-video-player .art-mask .art-state{width:60px;height:60px;opacity:.85;cursor:pointer;pointer-events:all;justify-content:center;align-items:center;display:flex;position:absolute;bottom:65px;right:30px}.art-video-player.art-mask-show .art-mask{display:flex}.art-video-player.art-mobile .art-state{position:static}.art-video-player .art-loading{z-index:70;width:100%;height:100%;pointer-events:none;justify-content:center;align-items:center;display:none;position:absolute;inset:0}.art-video-player.art-loading-show .art-loading{display:flex}.art-video-player .art-bottom{z-index:60;height:100px;opacity:0;visibility:hidden;pointer-events:none;background-image:linear-gradient(#0000,#0006,#000);background-position:bottom;background-repeat:repeat-x;flex-direction:column;justify-content:space-between;padding:50px 10px 0;transition:all .2s ease-in-out;display:flex;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-bottom .art-progress{z-index:0;pointer-events:auto;flex:1;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress{height:4px;cursor:pointer;flex-direction:row;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner{height:50%;width:100%;background:#fff3;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-loaded{z-index:10;height:100%;width:0;background:#fff6;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-played{z-index:20;height:100%;width:0;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight{z-index:30;height:100%;pointer-events:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-highlight span{width:7px;height:100%;pointer-events:auto;background:#fff;display:inline-block;position:absolute;top:0;left:0}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:hidden;z-index:40;border-radius:50%;justify-content:center;align-items:center;transition:transform .1s ease-in-out;position:absolute;transform:scale(.1)}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator .art-icon{width:100%;height:100%;pointer-events:none;user-select:none}.art-video-player .art-bottom .art-progress .art-control-progress .art-control-progress-inner .art-progress-tip{z-index:50;height:20px;color:#fff;text-align:center;white-space:nowrap;background:#000000b3;border-radius:3px;padding:0 5px;font-size:12px;font-weight:700;line-height:20px;display:none;position:absolute;top:-25px;left:0}.art-video-player .art-bottom .art-progress .art-control-thumbnails{pointer-events:none;background-color:#000000b3;display:none;position:absolute;bottom:8px;left:0}.art-video-player .art-bottom .art-progress .art-control-loop{width:100%;height:100%;pointer-events:none;display:none;position:absolute;inset:0}.art-video-player .art-bottom .art-progress .art-control-loop .art-loop-point{width:2px;height:8px;background:#ffffffbf;position:absolute;top:-2px;left:0}.art-video-player .art-bottom .art-controls{z-index:1;pointer-events:auto;height:45px;justify-content:space-between;align-items:center;display:flex;position:relative}.art-video-player .art-bottom .art-controls .art-controls-left,.art-video-player .art-bottom .art-controls .art-controls-right{display:flex}.art-video-player .art-bottom .art-controls .art-controls-center{height:100%;flex:1;justify-content:center;align-items:center;padding:0 10px;display:flex}.art-video-player .art-bottom .art-controls .art-controls-right{justify-content:flex-end}.art-video-player .art-bottom .art-controls .art-control{opacity:.9;min-height:36px;min-width:36px;text-align:center;cursor:pointer;white-space:nowrap;justify-content:center;align-items:center;font-size:12px;line-height:1;display:flex}.art-video-player .art-bottom .art-controls .art-control .art-icon{float:left;height:36px;width:36px;justify-content:center;align-items:center;display:flex}.art-video-player .art-bottom .art-controls .art-control:hover{opacity:1}.art-video-player .art-bottom .art-controls .art-control-onlyText{padding:0 10px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel{float:left;width:0;height:100%;transition:margin .2s cubic-bezier(.4,0,1,1),width .2s cubic-bezier(.4,0,1,1);position:relative;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle{width:12px;height:12px;background:#fff;border-radius:12px;margin-top:-6px;position:absolute;top:50%;left:0}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before{background:#fff;left:-54px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{background:#fff3;left:6px}.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:before,.art-video-player .art-bottom .art-controls .art-control-volume .art-volume-panel .art-volume-slider-handle:after{content:"";height:3px;width:60px;margin-top:-2px;display:block;position:absolute;top:50%}.art-video-player .art-bottom .art-controls .art-control-volume:hover .art-volume-panel{width:60px}.art-video-player .art-bottom .art-controls .art-control-quality{z-index:30;position:relative}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys{width:100px;text-align:center;color:#fff;background:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;line-height:30px;overflow:hidden}.art-video-player .art-bottom .art-controls .art-control-quality .art-qualitys .art-quality-item:hover{background-color:#ffffff1a}.art-video-player .art-bottom .art-controls .art-control-quality:hover .art-qualitys{display:block}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner{height:100%}.art-video-player .art-bottom:hover .art-progress .art-control-progress .art-control-progress-inner .art-progress-indicator{visibility:visible;transform:scale(1)}.art-video-player.art-control-show .art-bottom,.art-video-player.art-hover .art-bottom{opacity:1;visibility:visible}.art-video-player.art-error .art-progress-indicator,.art-video-player.art-destroy .art-progress-indicator,.art-video-player.art-error .art-progress-tip,.art-video-player.art-destroy .art-progress-tip{display:none!important}.art-video-player.art-mobile .art-bottom{padding:50px 7px 0}.art-video-player.art-mobile .art-bottom .art-controls{height:40px}.art-video-player.art-mobile .art-bottom .art-progress-indicator{visibility:visible!important;transform:scale(1)!important}.art-video-player .art-notice{z-index:80;width:100%;pointer-events:none;padding:10px;font-size:14px;display:none;position:absolute;top:0;left:0}.art-video-player .art-notice .art-notice-inner{color:#fff;background-color:#0009;border-radius:3px;padding:5px 10px;display:inline-block}.art-video-player.art-notice-show .art-notice{display:flex}.art-video-player .art-contextmenus{z-index:120;min-width:200px;background-color:#000000e6;border-radius:3px;flex-direction:column;padding:5px 0;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-contextmenus .art-contextmenu{cursor:pointer;color:#fff;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;border-bottom:1px solid #ffffff1a;padding:10px 15px;font-size:12px;display:block;overflow:hidden}.art-video-player .art-contextmenus .art-contextmenu a{color:#fff;text-decoration:none}.art-video-player .art-contextmenus .art-contextmenu span{padding:0 7px;display:inline-block}.art-video-player .art-contextmenus .art-contextmenu span:hover,.art-video-player .art-contextmenus .art-contextmenu span.art-current{color:#00c9ff}.art-video-player .art-contextmenus .art-contextmenu:hover{background-color:#ffffff1a}.art-video-player .art-contextmenus .art-contextmenu:last-child{border-bottom:none}.art-video-player.art-contextmenu-show .art-contextmenus{display:flex}.art-video-player .art-settings{z-index:90;height:auto;max-height:300px;background-color:#000000e6;border-radius:3px;font-size:13px;transition:all .2s;display:none;position:absolute;bottom:50px;right:10px;overflow:auto}.art-video-player .art-settings .art-setting-panel{display:none}.art-video-player .art-settings .art-setting-panel.art-current{display:block}.art-video-player .art-settings .art-setting-panel .art-setting-item{height:35px;cursor:pointer;color:#fffc;justify-content:space-between;align-items:center;padding:0 5px;line-height:1;display:flex;overflow:hidden}.art-video-player .art-settings .art-setting-panel .art-setting-item:hover,.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current{color:#fff;background-color:#ffffff1a}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon{width:30px;height:30px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-icon-check{visibility:hidden;height:15px}.art-video-player .art-settings .art-setting-panel .art-setting-item.art-current .art-icon-check{visibility:visible}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left{white-space:nowrap;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-left .art-setting-item-left-icon{height:24px;width:24px;justify-content:center;align-items:center;margin-right:10px;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right{align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-tooltip{white-space:nowrap;color:#ffffff80;margin-right:5px;font-size:12px}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-item-right-icon{height:24px;justify-content:center;align-items:center;display:flex}.art-video-player .art-settings .art-setting-panel .art-setting-item .art-setting-item-right .art-setting-range{height:3px;width:80px;appearance:none;background-color:#fff3;outline:none}.art-video-player .art-settings .art-setting-panel .art-setting-item-back{border-bottom:1px solid #ffffff1a}.art-video-player.art-setting-show .art-settings{display:block}.art-video-player.art-mobile .art-settings{max-height:200px}.art-video-player .art-info{z-index:100;width:350px;color:#fff;-webkit-font-smoothing:antialiased;background-color:#000000e6;flex-direction:column;padding:10px;font-family:Noto Sans CJK SC DemiLight,Roboto,Segoe UI,Tahoma,Arial,Helvetica,sans-serif;font-size:12px;display:none;position:absolute;top:10px;left:10px}.art-video-player .art-info .art-info-item{margin-bottom:5px;display:flex}.art-video-player .art-info .art-info-item .art-info-title{width:100px;text-align:right}.art-video-player .art-info .art-info-item .art-info-content{text-overflow:ellipsis;white-space:nowrap;flex:1;padding-left:5px;overflow:hidden}.art-video-player .art-info .art-info-item:last-child{margin-bottom:0}.art-video-player .art-info .art-info-close{cursor:pointer;position:absolute;top:5px;right:5px}.art-video-player.art-info-show .art-info{display:flex}.art-video-player.art-hide-cursor *{cursor:none!important}.art-video-player[data-aspect-ratio] video{box-sizing:content-box;object-fit:fill}.art-video-player.art-fullscreen-web{z-index:9999;width:100%;height:100%;position:fixed;inset:0}.art-video-player .art-mini-header{z-index:110;height:35px;color:#fff;opacity:0;visibility:hidden;background-color:#00000080;justify-content:space-between;align-items:center;line-height:35px;transition:all .2s ease-in-out;display:none;position:absolute;top:0;left:0;right:0}.art-video-player .art-mini-header .art-mini-title{text-overflow:ellipsis;white-space:nowrap;cursor:move;flex:1;padding:0 10px;overflow:hidden}.art-video-player .art-mini-header .art-mini-close{width:35px;text-align:center;cursor:pointer;font-size:22px}.art-video-player.art-is-dragging{opacity:.7}.art-video-player.art-mini{z-index:9999;width:400px;height:225px;position:fixed;box-shadow:0 2px 5px #00000029,0 3px 6px #0003}.art-video-player.art-mini .art-mini-header{user-select:none;display:flex}.art-video-player.art-mini.art-hover .art-mini-header{opacity:1;visibility:visible}.art-video-player.art-mini .art-mask .art-state{position:static}.art-video-player.art-mini .art-contextmenu,.art-video-player.art-mini .art-bottom,.art-video-player.art-mini .art-danmu,.art-video-player.art-mini .art-info,.art-video-player.art-mini .art-layers,.art-video-player.art-mini .art-notice,.art-video-player.art-mini .art-settings,.art-video-player.art-mini .art-subtitle{display:none!important}.art-auto-size{justify-content:center;align-items:center;display:flex}.art-auto-size .art-video-player{transition:all .2s}.art-video-player[data-flip=horizontal] .art-video{transform:scaleX(-1)}.art-video-player[data-flip=vertical] .art-video{transform:scaleY(-1)}.art-video-player .art-layer-miniProgressBar{height:2px;background-color:var(--theme);display:block;position:absolute;bottom:0;left:0;right:0}.art-video-player .art-layer-lock{height:34px;width:34px;color:#fff;background-color:#00000080;border-radius:50%;justify-content:center;align-items:center;display:none;position:absolute;top:calc(50% - 17px);left:15px}.art-video-player .art-layer-autoPlayback{background-color:#000c;border-radius:3px;align-items:center;padding:10px;line-height:1;display:none;position:absolute;bottom:60px;left:20px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close{cursor:pointer;align-items:center;margin-right:10px;display:flex}.art-video-player .art-layer-autoPlayback .art-autoPlayback-close svg{width:15px;height:15px;fill:#00c9ff}.art-video-player .art-layer-autoPlayback .art-autoPlayback-last{margin-right:10px}.art-video-player .art-layer-autoPlayback .art-autoPlayback-jump{color:#00c9ff;cursor:pointer}.art-video-player.art-lock .art-bottom{display:none!important}.art-video-player.art-lock .art-subtitle{bottom:10px!important}.art-video-player.art-lock .art-layer-miniProgressBar{display:block!important}.art-video-player.art-control-show .art-layer-miniProgressBar{display:none}.art-video-player.art-control-show .art-layer-lock{display:flex}.art-video-player .art-control-selector{position:relative}.art-video-player .art-control-selector .art-selector-list{min-width:100px;max-width:200px;max-height:200px;text-align:center;color:#fff;background-color:#000c;border-radius:3px;padding:5px 0;display:none;position:absolute;bottom:35px;overflow:auto}.art-video-player .art-control-selector .art-selector-list .art-selector-item{height:30px;text-overflow:ellipsis;white-space:nowrap;text-shadow:0 0 2px #00000080;padding:0 5px;line-height:30px;overflow:hidden}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover{background-color:#ffffff1a}.art-video-player .art-control-selector .art-selector-list .art-selector-item:hover,.art-video-player .art-control-selector .art-selector-list .art-selector-item.art-current{color:#00c9ff}.art-video-player .art-control-selector:hover .art-selector-list{display:block}[class*=hint--]{font-style:normal;display:inline-block;position:relative}[class*=hint--]:before,[class*=hint--]:after{visibility:hidden;opacity:0;z-index:1000000;pointer-events:none;transition:all .3s;position:absolute;transform:translate(0,0)}[class*=hint--]:hover:before,[class*=hint--]:hover:after{visibility:visible;opacity:1;transition-delay:.1s}[class*=hint--]:before{content:"";z-index:1000001;background:0 0;border:6px solid #0000;position:absolute}[class*=hint--]:after{color:#fff;white-space:nowrap;background:#000;padding:8px 10px;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;font-size:12px;line-height:12px}[class*=hint--][aria-label]:after{content:attr(aria-label)}[class*=hint--][data-hint]:after{content:attr(data-hint)}[aria-label=""]:before,[aria-label=""]:after,[data-hint=""]:before,[data-hint=""]:after{display:none!important}.hint--top-left:before,.hint--top-right:before,.hint--top:before{border-top-color:#000}.hint--bottom-left:before,.hint--bottom-right:before,.hint--bottom:before{border-bottom-color:#000}.hint--left:before{border-left-color:#000}.hint--right:before{border-right-color:#000}.hint--top:before{margin-bottom:-11px}.hint--top:before,.hint--top:after{bottom:100%;left:50%}.hint--top:before{left:calc(50% - 6px)}.hint--top:after{transform:translate(-50%)}.hint--top:hover:before{transform:translateY(-8px)}.hint--top:hover:after{transform:translate(-50%)translateY(-8px)}.hint--bottom:before{margin-top:-11px}.hint--bottom:before,.hint--bottom:after{top:100%;left:50%}.hint--bottom:before{left:calc(50% - 6px)}.hint--bottom:after{transform:translate(-50%)}.hint--bottom:hover:before{transform:translateY(8px)}.hint--bottom:hover:after{transform:translate(-50%)translateY(8px)}.hint--right:before{margin-bottom:-6px;margin-left:-11px}.hint--right:after{margin-bottom:-14px}.hint--right:before,.hint--right:after{bottom:50%;left:100%}.hint--right:hover:before,.hint--right:hover:after{transform:translate(8px)}.hint--left:before{margin-bottom:-6px;margin-right:-11px}.hint--left:after{margin-bottom:-14px}.hint--left:before,.hint--left:after{bottom:50%;right:100%}.hint--left:hover:before,.hint--left:hover:after{transform:translate(-8px)}.hint--top-left:before{margin-bottom:-11px}.hint--top-left:before,.hint--top-left:after{bottom:100%;left:50%}.hint--top-left:before{left:calc(50% - 6px)}.hint--top-left:after{margin-left:12px;transform:translate(-100%)}.hint--top-left:hover:before{transform:translateY(-8px)}.hint--top-left:hover:after{transform:translate(-100%)translateY(-8px)}.hint--top-right:before{margin-bottom:-11px}.hint--top-right:before,.hint--top-right:after{bottom:100%;left:50%}.hint--top-right:before{left:calc(50% - 6px)}.hint--top-right:after{margin-left:-12px;transform:translate(0)}.hint--top-right:hover:before,.hint--top-right:hover:after{transform:translateY(-8px)}.hint--bottom-left:before{margin-top:-11px}.hint--bottom-left:before,.hint--bottom-left:after{top:100%;left:50%}.hint--bottom-left:before{left:calc(50% - 6px)}.hint--bottom-left:after{margin-left:12px;transform:translate(-100%)}.hint--bottom-left:hover:before{transform:translateY(8px)}.hint--bottom-left:hover:after{transform:translate(-100%)translateY(8px)}.hint--bottom-right:before{margin-top:-11px}.hint--bottom-right:before,.hint--bottom-right:after{top:100%;left:50%}.hint--bottom-right:before{left:calc(50% - 6px)}.hint--bottom-right:after{margin-left:-12px;transform:translate(0)}.hint--bottom-right:hover:before,.hint--bottom-right:hover:after{transform:translateY(8px)}.hint--small:after,.hint--medium:after,.hint--large:after{white-space:normal;word-wrap:break-word;line-height:1.4em}.hint--small:after{width:80px}.hint--medium:after{width:150px}.hint--large:after{width:300px}[class*=hint--]:after{text-shadow:0 -1px #000;box-shadow:4px 4px 8px #0000004d}.hint--error:after{text-shadow:0 -1px #592726;background-color:#b34e4d}.hint--error.hint--top-left:before,.hint--error.hint--top-right:before,.hint--error.hint--top:before{border-top-color:#b34e4d}.hint--error.hint--bottom-left:before,.hint--error.hint--bottom-right:before,.hint--error.hint--bottom:before{border-bottom-color:#b34e4d}.hint--error.hint--left:before{border-left-color:#b34e4d}.hint--error.hint--right:before{border-right-color:#b34e4d}.hint--warning:after{text-shadow:0 -1px #6c5328;background-color:#c09854}.hint--warning.hint--top-left:before,.hint--warning.hint--top-right:before,.hint--warning.hint--top:before{border-top-color:#c09854}.hint--warning.hint--bottom-left:before,.hint--warning.hint--bottom-right:before,.hint--warning.hint--bottom:before{border-bottom-color:#c09854}.hint--warning.hint--left:before{border-left-color:#c09854}.hint--warning.hint--right:before{border-right-color:#c09854}.hint--info:after{text-shadow:0 -1px #1a3c4d;background-color:#3986ac}.hint--info.hint--top-left:before,.hint--info.hint--top-right:before,.hint--info.hint--top:before{border-top-color:#3986ac}.hint--info.hint--bottom-left:before,.hint--info.hint--bottom-right:before,.hint--info.hint--bottom:before{border-bottom-color:#3986ac}.hint--info.hint--left:before{border-left-color:#3986ac}.hint--info.hint--right:before{border-right-color:#3986ac}.hint--success:after{text-shadow:0 -1px #1a321a;background-color:#458746}.hint--success.hint--top-left:before,.hint--success.hint--top-right:before,.hint--success.hint--top:before{border-top-color:#458746}.hint--success.hint--bottom-left:before,.hint--success.hint--bottom-right:before,.hint--success.hint--bottom:before{border-bottom-color:#458746}.hint--success.hint--left:before{border-left-color:#458746}.hint--success.hint--right:before{border-right-color:#458746}.hint--always:after,.hint--always:before{opacity:1;visibility:visible}.hint--always.hint--top:before{transform:translateY(-8px)}.hint--always.hint--top:after{transform:translate(-50%)translateY(-8px)}.hint--always.hint--top-left:before{transform:translateY(-8px)}.hint--always.hint--top-left:after{transform:translate(-100%)translateY(-8px)}.hint--always.hint--top-right:before,.hint--always.hint--top-right:after{transform:translateY(-8px)}.hint--always.hint--bottom:before{transform:translateY(8px)}.hint--always.hint--bottom:after{transform:translate(-50%)translateY(8px)}.hint--always.hint--bottom-left:before{transform:translateY(8px)}.hint--always.hint--bottom-left:after{transform:translate(-100%)translateY(8px)}.hint--always.hint--bottom-right:before,.hint--always.hint--bottom-right:after{transform:translateY(8px)}.hint--always.hint--left:before,.hint--always.hint--left:after{transform:translate(-8px)}.hint--always.hint--right:before,.hint--always.hint--right:after{transform:translate(8px)}.hint--rounded:after{border-radius:4px}.hint--no-animate:before,.hint--no-animate:after{transition-duration:0s}.hint--bounce:before,.hint--bounce:after{-webkit-transition:opacity .3s,visibility .3s,-webkit-transform .3s cubic-bezier(.71,1.7,.77,1.24);-moz-transition:opacity .3s,visibility .3s,-moz-transform .3s cubic-bezier(.71,1.7,.77,1.24);transition:opacity .3s,visibility .3s,transform .3s cubic-bezier(.71,1.7,.77,1.24)}.hint--no-shadow:before,.hint--no-shadow:after{text-shadow:initial;box-shadow:initial}.hint--no-arrow:before{display:none}'},{}],"2A2W5":[function(O,C,_){C.exports=function(){function S(n){return(S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f})(n)}var c=Object.prototype.toString,y=function(n){if(n===void 0)return"undefined";if(n===null)return"null";var f=S(n);if(f==="boolean")return"boolean";if(f==="string")return"string";if(f==="number")return"number";if(f==="symbol")return"symbol";if(f==="function")return function(l){return M(l)==="GeneratorFunction"}(n)?"generatorfunction":"function";if(function(l){return Array.isArray?Array.isArray(l):l instanceof Array}(n))return"array";if(function(l){return!(!l.constructor||typeof l.constructor.isBuffer!="function")&&l.constructor.isBuffer(l)}(n))return"buffer";if(function(l){try{if(typeof l.length=="number"&&typeof l.callee=="function")return!0}catch(h){if(h.message.indexOf("callee")!==-1)return!0}return!1}(n))return"arguments";if(function(l){return l instanceof Date||typeof l.toDateString=="function"&&typeof l.getDate=="function"&&typeof l.setDate=="function"}(n))return"date";if(function(l){return l instanceof Error||typeof l.message=="string"&&l.constructor&&typeof l.constructor.stackTraceLimit=="number"}(n))return"error";if(function(l){return l instanceof RegExp||typeof l.flags=="string"&&typeof l.ignoreCase=="boolean"&&typeof l.multiline=="boolean"&&typeof l.global=="boolean"}(n))return"regexp";switch(M(n)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(l){return typeof l.throw=="function"&&typeof l.return=="function"&&typeof l.next=="function"}(n))return"generator";switch(f=c.call(n)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return f.slice(8,-1).toLowerCase().replace(/\s/g,"")};function M(n){return n.constructor?n.constructor.name:null}function T(n,f){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:["option"];return p(n,f,l),u(n,f,l),function(h,v,d){var r=y(v),t=y(h);if(r==="object"){if(t!=="object")throw new Error("[Type Error]: '".concat(d.join("."),"' require 'object' type, but got '").concat(t,"'"));Object.keys(v).forEach(function(i){var e=h[i],a=v[i],o=d.slice();o.push(i),p(e,a,o),u(e,a,o),T(e,a,o)})}if(r==="array"){if(t!=="array")throw new Error("[Type Error]: '".concat(d.join("."),"' require 'array' type, but got '").concat(t,"'"));h.forEach(function(i,e){var a=h[e],o=v[e]||v[0],s=d.slice();s.push(e),p(a,o,s),u(a,o,s),T(a,o,s)})}}(n,f,l),n}function p(n,f,l){if(y(f)==="string"){var h=y(n);if(f[0]==="?"&&(f=f.slice(1)+"|undefined"),!(-1<f.indexOf("|")?f.split("|").map(function(v){return v.toLowerCase().trim()}).filter(Boolean).some(function(v){return h===v}):f.toLowerCase().trim()===h))throw new Error("[Type Error]: '".concat(l.join("."),"' require '").concat(f,"' type, but got '").concat(h,"'"))}}function u(n,f,l){if(y(f)==="function"){var h=f(n,y(n),l);if(h!==!0){var v=y(h);throw v==="string"?new Error(h):v==="error"?h:new Error("[Validator Error]: The scheme for '".concat(l.join("."),"' validator require return true, but got '").concat(h,"'"))}}}return T.kindOf=y,T}()},{}],"7pHuB":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=class{on(S,c,y){const M=this.e||(this.e={});return(M[S]||(M[S]=[])).push({fn:c,ctx:y}),this}once(S,c,y){const M=this;function T(...p){M.off(S,T),c.apply(y,p)}return T._=c,this.on(S,T,y)}emit(S,...c){const y=((this.e||(this.e={}))[S]||[]).slice();for(let M=0;M<y.length;M+=1)y[M].fn.apply(y[M].ctx,c);return this}off(S,c){const y=this.e||(this.e={}),M=y[S],T=[];if(M&&c)for(let p=0,u=M.length;p<u;p+=1)M[p].fn!==c&&M[p].fn._!==c&&T.push(M[p]);return T.length?y[S]=T:delete y[S],this}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fRZO2:[function(O,C,_){_.interopDefault=function(S){return S&&S.__esModule?S:{default:S}},_.defineInteropFlag=function(S){Object.defineProperty(S,"__esModule",{value:!0})},_.exportAll=function(S,c){return Object.keys(S).forEach(function(y){y==="default"||y==="__esModule"||c.hasOwnProperty(y)||Object.defineProperty(c,y,{enumerable:!0,get:function(){return S[y]}})}),c},_.export=function(S,c,y){Object.defineProperty(S,c,{enumerable:!0,get:y})}},{}],geSvU:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./dom");S.exportAll(c,_);var y=O("./error");S.exportAll(y,_);var M=O("./subtitle");S.exportAll(M,_);var T=O("./file");S.exportAll(T,_);var p=O("./property");S.exportAll(p,_);var u=O("./time");S.exportAll(u,_);var n=O("./format");S.exportAll(n,_);var f=O("./compatibility");S.exportAll(f,_)},{"./dom":"ff6Hs","./error":"lDQPM","./subtitle":"1dyFb","./file":"96gQe","./property":"lMM6V","./time":"41yFW","./format":"MRJhs","./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ff6Hs:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_),S.export(_,"query",()=>y),S.export(_,"queryAll",()=>M),S.export(_,"addClass",()=>T),S.export(_,"removeClass",()=>p),S.export(_,"hasClass",()=>u),S.export(_,"append",()=>n),S.export(_,"remove",()=>f),S.export(_,"setStyle",()=>l),S.export(_,"setStyles",()=>h),S.export(_,"getStyle",()=>v),S.export(_,"sublings",()=>d),S.export(_,"inverseClass",()=>r),S.export(_,"tooltip",()=>t),S.export(_,"isInViewport",()=>i),S.export(_,"includeFromEvent",()=>e),S.export(_,"replaceElement",()=>a);var c=O("./compatibility");function y(o,s=document){return s.querySelector(o)}function M(o,s=document){return Array.from(s.querySelectorAll(o))}function T(o,s){return o.classList.add(s)}function p(o,s){return o.classList.remove(s)}function u(o,s){return o.classList.contains(s)}function n(o,s){return s instanceof Element?o.appendChild(s):o.insertAdjacentHTML("beforeend",String(s)),o.lastElementChild||o.lastChild}function f(o){return o.parentNode.removeChild(o)}function l(o,s,g){return o.style[s]=g,o}function h(o,s){return Object.keys(s).forEach(g=>{l(o,g,s[g])}),o}function v(o,s,g=!0){const L=window.getComputedStyle(o,null).getPropertyValue(s);return g?parseFloat(L):L}function d(o){return Array.from(o.parentElement.children).filter(s=>s!==o)}function r(o,s){d(o).forEach(g=>p(g,s)),T(o,s)}function t(o,s,g="top"){c.isMobile||(o.setAttribute("aria-label",s),T(o,"hint--rounded"),T(o,`hint--${g}`))}function i(o,s=0){const g=o.getBoundingClientRect(),L=window.innerHeight||document.documentElement.clientHeight,A=window.innerWidth||document.documentElement.clientWidth,m=g.top-s<=L&&g.top+g.height+s>=0,E=g.left-s<=A+s&&g.left+g.width+s>=0;return m&&E}function e(o,s){return o.composedPath&&o.composedPath().indexOf(s)>-1}function a(o,s){return s.parentNode.replaceChild(o,s),o}},{"./compatibility":"ki3pQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ki3pQ:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_),S.export(_,"userAgent",()=>c),S.export(_,"isMobile",()=>y),S.export(_,"isSafari",()=>M),S.export(_,"isWechat",()=>T),S.export(_,"isIE",()=>p),S.export(_,"isAndroid",()=>u),S.export(_,"isIOS",()=>n);const c=typeof window!="undefined"?window.navigator.userAgent:"",y=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(c),M=/^((?!chrome|android).)*safari/i.test(c),T=/MicroMessenger/i.test(c),p=/MSIE|Trident/i.test(c),u=/android/i.test(c),n=/iPad|iPhone|iPod/i.test(c)&&!window.MSStream},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lDQPM:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_),S.export(_,"ArtPlayerError",()=>c),S.export(_,"errorHandle",()=>y);class c extends Error{constructor(T,p){super(T),typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,p||this.constructor),this.name="ArtPlayerError"}}function y(M,T){if(!M)throw new c(T);return M}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1dyFb":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function c(T){return`WEBVTT \r
\r
`.concat((p=T,p.replace(/(\d\d:\d\d:\d\d)[,.](\d+)/g,(u,n,f)=>{let l=f.slice(0,3);return f.length===1&&(l=f+"00"),f.length===2&&(l=f+"0"),`${n},${l}`})).replace(/\{\\([ibu])\}/g,"</$1>").replace(/\{\\([ibu])1\}/g,"<$1>").replace(/\{([ibu])\}/g,"<$1>").replace(/\{\/([ibu])\}/g,"</$1>").replace(/(\d\d:\d\d:\d\d),(\d\d\d)/g,"$1.$2").replace(/{[\s\S]*?}/g,"").concat(`\r
\r
`));var p}function y(T){return URL.createObjectURL(new Blob([T],{type:"text/vtt"}))}function M(T){const p=new RegExp("Dialogue:\\s\\d,(\\d+:\\d\\d:\\d\\d.\\d\\d),(\\d+:\\d\\d:\\d\\d.\\d\\d),([^,]*),([^,]*),(?:[^,]*,){4}([\\s\\S]*)$","i");function u(n=""){return n.split(/[:.]/).map((f,l,h)=>{if(l===h.length-1){if(f.length===1)return`.${f}00`;if(f.length===2)return`.${f}0`}else if(f.length===1)return(l===0?"0":":0")+f;return l===0?f:l===h.length-1?`.${f}`:`:${f}`}).join("")}return`WEBVTT

${T.split(/\r?\n/).map(n=>{const f=n.match(p);return f?{start:u(f[1].trim()),end:u(f[2].trim()),text:f[5].replace(/{[\s\S]*?}/g,"").replace(/(\\N)/g,`
`).trim().split(/\r?\n/).map(l=>l.trim()).join(`
`)}:null}).filter(n=>n).map((n,f)=>n?`${f+1}
${n.start} --> ${n.end}
${n.text}`:"").filter(n=>n.trim()).join(`

`)}`}S.defineInteropFlag(_),S.export(_,"srtToVtt",()=>c),S.export(_,"vttToBlob",()=>y),S.export(_,"assToVtt",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"96gQe":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function c(M){return M.includes("?")?c(M.split("?")[0]):M.includes("#")?c(M.split("#")[0]):M.trim().toLowerCase().split(".").pop()}function y(M,T){const p=document.createElement("a");p.style.display="none",p.href=M,p.download=T,document.body.appendChild(p),p.click(),document.body.removeChild(p)}S.defineInteropFlag(_),S.export(_,"getExt",()=>c),S.export(_,"download",()=>y)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lMM6V:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_),S.export(_,"def",()=>c),S.export(_,"has",()=>M),S.export(_,"get",()=>T),S.export(_,"mergeDeep",()=>p);const c=Object.defineProperty,{hasOwnProperty:y}=Object.prototype;function M(u,n){return y.call(u,n)}function T(u,n){return Object.getOwnPropertyDescriptor(u,n)}function p(...u){const n=f=>f&&typeof f=="object"&&!Array.isArray(f);return u.reduce((f,l)=>(Object.keys(l).forEach(h=>{const v=f[h],d=l[h];Array.isArray(v)&&Array.isArray(d)?f[h]=v.concat(...d):!n(v)||!n(d)||d instanceof Element?f[h]=d:f[h]=p(v,d)}),f),{})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"41yFW":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function c(T=0){return new Promise(p=>setTimeout(p,T))}function y(T,p,u){let n;function f(...l){clearTimeout(n),n=setTimeout(function(){n=null,T.apply(u,l)},p)}return f.clearTimeout=function(){clearTimeout(n)},f}function M(T,p){let u,n,f=!1;return function l(...h){if(f)return u=h,void(n=this);f=!0,T.apply(this,h),setTimeout(()=>{f=!1,u&&(l.apply(n,u),u=null,n=null)},p)}}S.defineInteropFlag(_),S.export(_,"sleep",()=>c),S.export(_,"debounce",()=>y),S.export(_,"throttle",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],MRJhs:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");function c(T,p,u){return Math.max(Math.min(T,Math.max(p,u)),Math.min(p,u))}function y(T){const p=Math.floor(T/3600),u=Math.floor((T-3600*p)/60),n=Math.floor(T-3600*p-60*u);return(p>0?[p,u,n]:[u,n]).map(f=>f<10?`0${f}`:String(f)).join(":")}function M(T){return T.replace(/[&<>'"]/g,p=>({"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"})[p]||p)}S.defineInteropFlag(_),S.export(_,"clamp",()=>c),S.export(_,"secondToTime",()=>y),S.export(_,"escape",()=>M)},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3vPoh":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_),S.export(_,"ComponentOption",()=>l);var c=O("../utils");const y="array",M="boolean",T="string",p="number",u="object",n="function";function f(h,v,d){return(0,c.errorHandle)(v===T||v===p||h instanceof Element,`${d.join(".")} require '${T}' or 'Element' type`)}const l={html:f,disable:`?${M}`,name:`?${T}`,index:`?${p}`,style:`?${u}`,click:`?${n}`,mounted:`?${n}`,tooltip:`?${T}|${p}`,width:`?${p}`,selector:`?${y}`,onSelect:`?${n}`,switch:`?${M}`,onSwitch:`?${n}`,range:`?${y}`,onRange:`?${n}`};_.default={container:f,url:T,poster:T,title:T,type:T,theme:T,lang:T,volume:p,isLive:M,muted:M,autoplay:M,autoSize:M,autoMini:M,loop:M,flip:M,playbackRate:M,aspectRatio:M,screenshot:M,setting:M,hotkey:M,pip:M,mutex:M,backdrop:M,fullscreen:M,fullscreenWeb:M,subtitleOffset:M,miniProgressBar:M,useSSR:M,playsInline:M,lock:M,fastForward:M,autoPlayback:M,autoOrientation:M,plugins:[n],whitelist:[`${T}|${n}|regexp`],layers:[l],contextmenu:[l],settings:[l],controls:[Ee(me({},l),{position:(h,v,d)=>{const r=["top","left","right"];return(0,c.errorHandle)(r.includes(h),`${d.join(".")} only accept ${r.toString()} as parameters`)}})],quality:[{default:`?${M}`,html:T,url:T}],highlight:[{time:p,text:T}],thumbnails:{url:T,number:p,column:p},subtitle:{url:T,type:T,style:u,encoding:T},moreVideoAttr:u,icons:u,customType:u}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eksZR:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default={propertys:["audioTracks","autoplay","buffered","controller","controls","crossOrigin","currentSrc","currentTime","defaultMuted","defaultPlaybackRate","duration","ended","error","loop","mediaGroup","muted","networkState","paused","playbackRate","played","preload","readyState","seekable","seeking","src","startDate","textTracks","videoTracks","volume"],methods:["addTextTrack","canPlayType","load","play","pause"],events:["abort","canplay","canplaythrough","durationchange","emptied","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],prototypes:["width","height","videoWidth","videoHeight","poster","webkitDecodedFrameCount","webkitDroppedFrameCount","playsInline","webkitSupportsFullscreen","webkitDisplayingFullscreen","onenterpictureinpicture","onleavepictureinpicture","disablePictureInPicture","cancelVideoFrameCallback","requestVideoFrameCallback","getVideoPlaybackQuality","requestPictureInPicture","webkitEnterFullScreen","webkitEnterFullscreen","webkitExitFullScreen","webkitExitFullscreen"]}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fCKwj:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("./utils");_.default=class{constructor(c){this.art=c}get state(){const{option:c,constructor:{kindOf:y}}=this.art;return!S.isMobile||c.whitelist.some(M=>{switch(y(M)){case"string":return M==="*"||S.userAgent.indexOf(M)>-1;case"function":return M(S.userAgent);case"regexp":return M.test(S.userAgent);default:return!1}})}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bqHdK:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("./utils");class c{constructor(M){this.art=M;const{option:T,constructor:p,whitelist:u}=M;T.container instanceof Element?this.$container=T.container:(this.$container=(0,S.query)(T.container),(0,S.errorHandle)(this.$container,`No container element found by ${T.container}`));const n=this.$container.tagName.toLowerCase();(0,S.errorHandle)(n==="div",`Unsupported container element type, only support 'div' but got '${n}'`),(0,S.errorHandle)(p.instances.every(f=>f.template.$container!==this.$container),"Cannot mount multiple instances on the same dom element"),this.query=this.query.bind(this),this.$container.dataset.artId=M.id,this.$original=this.$container.cloneNode(!0),u.state?this.desktop():this.mobile()}static get html(){return'<div class="art-video-player art-subtitle-show art-layer-show art-control-show art-mask-show"><video class="art-video"></video><div class="art-poster"></div><div class="art-subtitle"></div><div class="art-danmuku"></div><div class="art-layers"></div><div class="art-mask"><div class="art-state"></div></div><div class="art-bottom"><div class="art-progress"></div><div class="art-controls"><div class="art-controls-left"></div><div class="art-controls-center"></div><div class="art-controls-right"></div></div></div><div class="art-loading"></div><div class="art-notice"><div class="art-notice-inner"></div></div><div class="art-settings"></div><div class="art-info"><div class="art-info-panel"><div class="art-info-item"><div class="art-info-title">Player version:</div><div class="art-info-content">4.5.2</div></div><div class="art-info-item"><div class="art-info-title">Video url:</div><div class="art-info-content" data-video="src"></div></div><div class="art-info-item"><div class="art-info-title">Video volume:</div><div class="art-info-content" data-video="volume"></div></div><div class="art-info-item"><div class="art-info-title">Video time:</div><div class="art-info-content" data-video="currentTime"></div></div><div class="art-info-item"><div class="art-info-title">Video duration:</div><div class="art-info-content" data-video="duration"></div></div><div class="art-info-item"><div class="art-info-title">Video resolution:</div><div class="art-info-content"><span data-video="videoWidth"></span> x <span data-video="videoHeight"></span></div></div></div><div class="art-info-close">[x]</div></div><div class="art-mini-header"><div class="art-mini-title"></div><div class="art-mini-close">\xD7</div></div><div class="art-contextmenus"></div></div>'}query(M){return(0,S.query)(M,this.$container)}desktop(){const{option:M}=this.art;M.useSSR||(this.$container.innerHTML=c.html),this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video"),this.$poster=this.query(".art-poster"),this.$subtitle=this.query(".art-subtitle"),this.$danmuku=this.query(".art-danmuku"),this.$bottom=this.query(".art-bottom"),this.$progress=this.query(".art-progress"),this.$controls=this.query(".art-controls"),this.$controlsLeft=this.query(".art-controls-left"),this.$controlsCenter=this.query(".art-controls-center"),this.$controlsRight=this.query(".art-controls-right"),this.$layer=this.query(".art-layers"),this.$loading=this.query(".art-loading"),this.$notice=this.query(".art-notice"),this.$noticeInner=this.query(".art-notice-inner"),this.$mask=this.query(".art-mask"),this.$state=this.query(".art-state"),this.$setting=this.query(".art-settings"),this.$info=this.query(".art-info"),this.$infoPanel=this.query(".art-info-panel"),this.$infoClose=this.query(".art-info-close"),this.$miniHeader=this.query(".art-mini-header"),this.$miniTitle=this.query(".art-mini-title"),this.$miniClose=this.query(".art-mini-close"),this.$contextmenu=this.query(".art-contextmenus"),M.backdrop&&((0,S.addClass)(this.$setting,"art-backdrop-filter"),(0,S.addClass)(this.$contextmenu,"art-backdrop-filter"),(0,S.addClass)(this.$info,"art-backdrop-filter")),S.isMobile&&(0,S.addClass)(this.$player,"art-mobile")}mobile(){this.$container.innerHTML='<div class="art-video-player"><video class="art-video"></video></div>',this.$player=this.query(".art-video-player"),this.$video=this.query(".art-video")}destroy(M){M?(0,S.replaceElement)(this.$original,this.$container):(0,S.addClass)(this.$player,"art-destroy")}}_.default=c},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4O9ZY":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("../utils"),y=O("./zh-cn.json"),M=S.interopDefault(y),T=O("./zh-tw.json"),p=S.interopDefault(T),u=O("./pl.json"),n=S.interopDefault(u),f=O("./cs.json"),l=S.interopDefault(f);_.default=class{constructor(h){this.art=h,this.languages={"zh-cn":M.default,"zh-tw":p.default,pl:n.default,cs:l.default},this.init()}init(){const h=this.art.option.lang.toLowerCase();this.language=this.languages[h]||{}}get(h){return this.language[h]||h}update(h){this.languages=(0,c.mergeDeep)(this.languages,h),this.init()}}},{"../utils":"geSvU","./zh-cn.json":"e7BQ4","./zh-tw.json":"5kFyN","./pl.json":"3cd1e","./cs.json":"an7cR","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e7BQ4:[function(O,C,_){C.exports=JSON.parse('{"Video Info":"\u7EDF\u8BA1\u4FE1\u606F","Close":"\u5173\u95ED","Video Load Failed":"\u52A0\u8F7D\u5931\u8D25","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u6682\u505C","Rate":"\u901F\u5EA6","Mute":"\u9759\u97F3","Video Flip":"\u753B\u9762\u7FFB\u8F6C","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u8FDE\u63A5","Show Setting":"\u663E\u793A\u8BBE\u7F6E","Hide Setting":"\u9690\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u56FE","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u753B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8BA4","Normal":"\u6B63\u5E38","Open":"\u6253\u5F00","Switch Video":"\u5207\u6362","Switch Subtitle":"\u5207\u6362\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7F51\u9875\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7F51\u9875\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u5F00\u542F\u753B\u4E2D\u753B","Exit PIP Mode":"\u9000\u51FA\u753B\u4E2D\u753B","PIP Not Supported":"\u4E0D\u652F\u6301\u753B\u4E2D\u753B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F6C\u64AD\u653E"}')},{}],"5kFyN":[function(O,C,_){C.exports=JSON.parse('{"Video Info":"\u7D71\u8A08\u8A0A\u606F","Close":"\u95DC\u9589","Video Load Failed":"\u8F09\u5165\u5931\u6557","Volume":"\u97F3\u91CF","Play":"\u64AD\u653E","Pause":"\u66AB\u505C","Rate":"\u901F\u5EA6","Mute":"\u975C\u97F3","Video Flip":"\u756B\u9762\u7FFB\u8F49","Horizontal":"\u6C34\u5E73","Vertical":"\u5782\u76F4","Reconnect":"\u91CD\u65B0\u9023\u63A5","Show Setting":"\u986F\u793A\u8BBE\u7F6E","Hide Setting":"\u96B1\u85CF\u8BBE\u7F6E","Screenshot":"\u622A\u5716","Play Speed":"\u64AD\u653E\u901F\u5EA6","Aspect Ratio":"\u756B\u9762\u6BD4\u4F8B","Default":"\u9ED8\u8A8D","Normal":"\u6B63\u5E38","Open":"\u6253\u958B","Switch Video":"\u5207\u63DB","Switch Subtitle":"\u5207\u63DB\u5B57\u5E55","Fullscreen":"\u5168\u5C4F","Exit Fullscreen":"\u9000\u51FA\u5168\u5C4F","Web Fullscreen":"\u7DB2\u9801\u5168\u5C4F","Exit Web Fullscreen":"\u9000\u51FA\u7DB2\u9801\u5168\u5C4F","Mini Player":"\u8FF7\u4F60\u64AD\u653E\u5668","PIP Mode":"\u958B\u555F\u756B\u4E2D\u756B","Exit PIP Mode":"\u9000\u51FA\u756B\u4E2D\u756B","PIP Not Supported":"\u4E0D\u652F\u6301\u756B\u4E2D\u756B","Fullscreen Not Supported":"\u4E0D\u652F\u6301\u5168\u5C4F","Subtitle Offset":"\u5B57\u5E55\u504F\u79FB","Last Seen":"\u4E0A\u6B21\u770B\u5230","Jump Play":"\u8DF3\u8F49\u64AD\u653E"}')},{}],"3cd1e":[function(O,C,_){C.exports=JSON.parse('{"Video Info":"Informacje o wideo","Close":"Zamknij","Video Load Failed":"B\u0142\u0105d \u0142adowania wideo","Volume":"G\u0142o\u015Bno\u015B\u0107","Play":"Odtw\xF3rz","Pause":"Wstrzymaj","Rate":"Oce\u0144","Mute":"Wycisz","Video Flip":"Rotacja wideo","Horizontal":"Pozioma","Vertical":"Pionowa","Reconnect":"Po\u0142\u0105cz ponownie","Show Setting":"Poka\u017C ustawienia","Hide Setting":"Ukryj ustawienia","Screenshot":"Zrzut ekranu","Play Speed":"Pr\u0119dko\u015B\u0107 odtwarzania","Aspect Ratio":"Wsp\xF3\u0142czynnik proporcji","Default":"Domy\u015Blny","Normal":"Normalny","Open":"Otw\xF3rz","Switch Video":"Prze\u0142\u0105cz wideo","Switch Subtitle":"Prze\u0142\u0105cz napisy","Fullscreen":"Pe\u0142ny ekran","Exit Fullscreen":"Zamknij pe\u0142ny ekran","Web Fullscreen":"Tryb pe\u0142nej strony","Exit Web Fullscreen":"Zamknij tryb pe\u0142nej strony","Mini Player":"Miniodtwarzacz","PIP Mode":"Tryb PiP","Exit PIP Mode":"Zamknij tryb PiP","PIP Not Supported":"Tryb PiP nieobs\u0142ugiwany","Fullscreen Not Supported":"Pe\u0142ny ekran nieobs\u0142ugiwany","Subtitle Offset":"Przesuni\u0119cie napis\xF3w","Last Seen":"Ostatnio widziany","Jump Play":"Skocz do gry"}')},{}],an7cR:[function(O,C,_){C.exports=JSON.parse('{"Video Info":"Info o videu","Close":"Zav\u0159\xEDt","Video Load Failed":"Nahr\xE1n\xED videa selhalo","Volume":"Hlasitost","Play":"P\u0159ehr\xE1t","Pause":"Pozastavit","Rate":"Hodnocen\xED","Mute":"Ztlumit","Video Flip":"Oto\u010Dit video","Horizontal":"Horizont\xE1ln\u011B","Vertical":"Vertik\xE1ln\u011B","Reconnect":"Op\u011Btovn\xE9 p\u0159ipojen\xED","Show Setting":"Zobrazit nastaven\xED","Hide Setting":"Skr\xFDt nastaven\xED","Screenshot":"Sn\xEDmek obrazovky","Play Speed":"Rychlost p\u0159ehr\xE1v\xE1n\xED","Aspect Ratio":"Pom\u011Br stran","Default":"V\xFDchoz\xED","Normal":"Norm\xE1ln\xED","Open":"Otev\u0159\xEDt","Switch Video":"P\u0159epnout video","Switch Subtitle":"P\u0159epnout titulky","Fullscreen":"Cel\xE1 obrazovka","Exit Fullscreen":"Opustit re\u017Eim cel\xE9 obrazovky","Web Fullscreen":"Cel\xE1 str\xE1nka","Exit Web Fullscreen":"Zav\u0159\xEDt re\u017Eim cel\xE9 str\xE1nky","Mini Player":"Mini p\u0159ehr\xE1va\u010D","PIP Mode":"Re\u017Eim PIP","Exit PIP Mode":"Opustit re\u017Eim PIP","PIP Not Supported":"Re\u017Eim PIP nen\xED podporov\xE1n","Fullscreen Not Supported":"Re\u017Eim cel\xE9 obrazovky nen\xED podporov\xE1n","Subtitle Offset":"Posun titulk\u016F","Last Seen":"Naposledy vid\u011Bn","Jump Play":"Hra na skok"}')},{}],fzROd:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./urlMix"),y=S.interopDefault(c),M=O("./attrMix"),T=S.interopDefault(M),p=O("./playMix"),u=S.interopDefault(p),n=O("./pauseMix"),f=S.interopDefault(n),l=O("./toggleMix"),h=S.interopDefault(l),v=O("./seekMix"),d=S.interopDefault(v),r=O("./volumeMix"),t=S.interopDefault(r),i=O("./currentTimeMix"),e=S.interopDefault(i),a=O("./durationMix"),o=S.interopDefault(a),s=O("./switchMix"),g=S.interopDefault(s),L=O("./playbackRateMix"),A=S.interopDefault(L),m=O("./aspectRatioMix"),E=S.interopDefault(m),x=O("./screenshotMix"),D=S.interopDefault(x),I=O("./fullscreenMix"),b=S.interopDefault(I),R=O("./fullscreenWebMix"),P=S.interopDefault(R),w=O("./pipMix"),F=S.interopDefault(w),k=O("./loadedMix"),B=S.interopDefault(k),U=O("./playedMix"),j=S.interopDefault(U),K=O("./playingMix"),N=S.interopDefault(K),Z=O("./autoSizeMix"),$=S.interopDefault(Z),Y=O("./rectMix"),ee=S.interopDefault(Y),Q=O("./flipMix"),G=S.interopDefault(Q),q=O("./miniMix"),te=S.interopDefault(q),ie=O("./loopMix"),ne=S.interopDefault(ie),le=O("./posterMix"),ae=S.interopDefault(le),oe=O("./autoHeightMix"),J=S.interopDefault(oe),se=O("./themeMix"),fe=S.interopDefault(se),de=O("./titleMix"),ge=S.interopDefault(de),ue=O("./normalSizeMix"),De=S.interopDefault(ue),pe=O("./subtitleOffsetMix"),Te=S.interopDefault(pe),W=O("./optionInit"),z=S.interopDefault(W),V=O("./eventInit"),X=S.interopDefault(V);_.default=class{constructor(H){(0,y.default)(H),(0,T.default)(H),(0,u.default)(H),(0,f.default)(H),(0,h.default)(H),(0,d.default)(H),(0,t.default)(H),(0,e.default)(H),(0,o.default)(H),(0,g.default)(H),(0,A.default)(H),(0,E.default)(H),(0,D.default)(H),(0,b.default)(H),(0,P.default)(H),(0,F.default)(H),(0,B.default)(H),(0,j.default)(H),(0,N.default)(H),(0,$.default)(H),(0,ee.default)(H),(0,G.default)(H),(0,te.default)(H),(0,ne.default)(H),(0,ae.default)(H),(0,J.default)(H),(0,fe.default)(H),(0,ge.default)(H),(0,De.default)(H),(0,Te.default)(H),(0,X.default)(H),(0,z.default)(H)}}},{"./urlMix":"cChak","./attrMix":"e6Qkm","./playMix":"1FNSV","./pauseMix":"aPHUd","./toggleMix":"joISC","./seekMix":"4wG3e","./volumeMix":"42Xo1","./currentTimeMix":"8Z3pM","./durationMix":"hpnJy","./switchMix":"aCsa8","./playbackRateMix":"61TVa","./aspectRatioMix":"8BV9k","./screenshotMix":"bop8O","./fullscreenMix":"i63VK","./fullscreenWebMix":"bEKHA","./pipMix":"ibIuh","./loadedMix":"kwpxq","./playedMix":"e4Iws","./playingMix":"fueZP","./autoSizeMix":"l6TMg","./rectMix":"6URTt","./flipMix":"joth7","./miniMix":"durkk","./loopMix":"5EZwI","./posterMix":"22WMt","./autoHeightMix":"8pdNr","./themeMix":"eADqm","./titleMix":"8T9U6","./normalSizeMix":"iEQHG","./subtitleOffsetMix":"8CMLG","./optionInit":"aqLU7","./eventInit":"59ETf","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],cChak:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{option:y,template:{$video:M}}=c;(0,S.def)(c,"url",{get:()=>M.currentSrc,set(p){return Ae(this,null,function*(){const u=y.type||(0,S.getExt)(p),n=y.customType[u];u&&n?(yield(0,S.sleep)(),c.loading.show=!0,n.call(c,M,p,c)):(c.url&&c.url!==p&&c.once("video:canplay",()=>{c.isReady&&c.emit("restart")}),M.src=p,c.option.url=p,c.emit("url",p))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e6Qkm:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{template:{$video:y}}=c;(0,S.def)(c,"attr",{value(M,T){if(T===void 0)return y[M];y[M]=T}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1FNSV":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,notice:M,option:T,constructor:{instances:p},template:{$video:u}}=c;(0,S.def)(c,"play",{value(){const n=u.play();if(n&&n.then&&n.then().catch(f=>{throw M.show=f,f}),T.mutex)for(let f=0;f<p.length;f++){const l=p[f];l!==c&&l.pause()}return M.show=y.get("Play"),c.emit("play"),n}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPHUd:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{template:{$video:y},i18n:M,notice:T}=c;(0,S.def)(c,"pause",{value(){const p=y.pause();return T.show=M.get("Pause"),c.emit("pause"),p}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joISC:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){(0,S.def)(c,"toggle",{value:()=>c.playing?c.pause():c.play()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4wG3e":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{notice:y}=c;(0,S.def)(c,"seek",{set(M){c.currentTime=M,c.emit("seek",c.currentTime),c.duration&&(y.show=`${(0,S.secondToTime)(c.currentTime)} / ${(0,S.secondToTime)(c.duration)}`)}}),(0,S.def)(c,"forward",{set(M){c.seek=c.currentTime+M}}),(0,S.def)(c,"backward",{set(M){c.seek=c.currentTime-M}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"42Xo1":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{template:{$video:y},i18n:M,notice:T,storage:p}=c;(0,S.def)(c,"volume",{get:()=>y.volume||0,set:u=>{y.volume=(0,S.clamp)(u,0,1),T.show=`${M.get("Volume")}: ${parseInt(100*y.volume,10)}`,y.volume!==0&&p.set("volume",y.volume),c.emit("volume",y.volume)}}),(0,S.def)(c,"muted",{get:()=>y.muted,set:u=>{y.muted=u,c.emit("volume",y.volume)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8Z3pM":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{$video:y}=c.template;(0,S.def)(c,"currentTime",{get:()=>y.currentTime||0,set:M=>{M=parseFloat(M),Number.isNaN(M)||(y.currentTime=(0,S.clamp)(M,0,c.duration))}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],hpnJy:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){(0,S.def)(c,"duration",{get:()=>{const{duration:y}=c.template.$video;return y===1/0?0:y||0}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aCsa8:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,option:M,notice:T}=c;function p(u,n,f){return new Promise(l=>{if(u===c.url)return l(u);const{playing:h}=c;c.pause(),URL.revokeObjectURL(c.url),c.url=u,c.once("video:canplay",()=>{c.playbackRate=!1,c.aspectRatio=!1,c.flip="normal",c.autoSize=M.autoSize,c.currentTime=f,c.notice.show="",h&&c.play(),n&&(T.show=`${y.get("Switch Video")}: ${n}`),c.emit("switch",u),l(u)})})}(0,S.def)(c,"switchQuality",{value:(u,n)=>p(u,n,c.currentTime)}),(0,S.def)(c,"switchUrl",{value:(u,n)=>p(u,n,0)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"61TVa":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{template:{$video:y},i18n:M,notice:T}=c;(0,S.def)(c,"playbackRate",{get:()=>y.playbackRate,set(p){if(p){if(p===y.playbackRate)return;const u=[.25,.5,.75,1,1.25,1.5,1.75,2,3,4];(0,S.errorHandle)(u.includes(p),`'playbackRate' only accept ${u.toString()} as parameters`),y.playbackRate=p,T.show=`${M.get("Rate")}: ${p===1?M.get("Normal"):`${p}x`}`,c.emit("playbackRate",p)}else c.playbackRate=1,c.emit("playbackRate")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8BV9k":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{template:{$video:y,$player:M},i18n:T,notice:p}=c;(0,S.def)(c,"aspectRatio",{get:()=>M.dataset.aspectRatio||"default",set(u){u||(u="default");const n=["default","4:3","16:9"];if((0,S.errorHandle)(n.includes(u),`'aspectRatio' only accept ${n.toString()} as parameters`),u==="default")(0,S.setStyle)(y,"width",null),(0,S.setStyle)(y,"height",null),(0,S.setStyle)(y,"padding",null),delete M.dataset.aspectRatio;else{const f=u.split(":").map(Number),{videoWidth:l,videoHeight:h}=y,{clientWidth:v,clientHeight:d}=M,r=l/h,t=f[0]/f[1];if(r>t){const i=t*h/l;(0,S.setStyle)(y,"width",100*i+"%"),(0,S.setStyle)(y,"height","100%"),(0,S.setStyle)(y,"padding",`0 ${(v-v*i)/2}px`)}else{const i=l/t/h;(0,S.setStyle)(y,"width","100%"),(0,S.setStyle)(y,"height",100*i+"%"),(0,S.setStyle)(y,"padding",(d-d*i)/2+"px 0")}M.dataset.aspectRatio=u}p.show=`${T.get("Aspect Ratio")}: ${u==="default"?T.get("Default"):u}`,c.emit("aspectRatio",u)}}),(0,S.def)(c,"aspectRatioReset",{set(u){if(u){const{aspectRatio:n}=c;c.aspectRatio=n}}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bop8O:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{option:y,notice:M,template:{$video:T}}=c,p=document.createElement("canvas");(0,S.def)(c,"getDataURL",{value:()=>new Promise((u,n)=>{try{p.width=T.videoWidth,p.height=T.videoHeight,p.getContext("2d").drawImage(T,0,0),u(p.toDataURL("image/png"))}catch(f){M.show=f,n(f)}})}),(0,S.def)(c,"getBlobUrl",{value:()=>new Promise((u,n)=>{try{p.width=T.videoWidth,p.height=T.videoHeight,p.getContext("2d").drawImage(T,0,0),p.toBlob(f=>{u(URL.createObjectURL(f))})}catch(f){M.show=f,n(f)}})}),(0,S.def)(c,"screenshot",{value:()=>Ae(this,null,function*(){const u=yield c.getDataURL();return(0,S.download)(u,`${y.title||"artplayer"}_${(0,S.secondToTime)(T.currentTime)}.png`),c.emit("screenshot",u),u})})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i63VK:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("../libs/screenfull"),y=S.interopDefault(c),M=O("../utils");_.default=function(T){const{i18n:p,notice:u,template:{$video:n,$player:f}}=T,l=(0,y.default)();T.once("video:loadedmetadata",()=>{var h;l.isEnabled?(h=T,l.on("change",()=>h.emit("fullscreen",l.isFullscreen)),(0,M.def)(h,"fullscreen",{get:()=>l.isFullscreen,set(d){return Ae(this,null,function*(){d?(h.normalSize="fullscreen",h.aspectRatioReset=!0,h.autoSize=!1,yield l.request(f),(0,M.addClass)(f,"art-fullscreen"),h.emit("resize"),h.emit("fullscreen",!0),u.show=""):(h.aspectRatioReset=!0,h.autoSize=h.option.autoSize,yield l.exit(),(0,M.removeClass)(f,"art-fullscreen"),h.emit("resize"),h.emit("fullscreen"),u.show="")})}})):document.fullscreenEnabled||n.webkitSupportsFullscreen?(d=>{(0,M.def)(d,"fullscreen",{get:()=>n.webkitDisplayingFullscreen,set(r){r?(d.normalSize="fullscreen",n.webkitEnterFullscreen(),d.emit("fullscreen",!0),u.show=""):(n.webkitExitFullscreen(),d.emit("fullscreen"),u.show="")}})})(T):(0,M.def)(T,"fullscreen",{get:()=>!1,set(){u.show=p.get("Fullscreen Not Supported")}}),(0,M.def)(T,"fullscreen",(0,M.get)(T,"fullscreen"))})}},{"../libs/screenfull":"aPwar","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPwar:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=function(){const S=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],c=(()=>{const T=S[0],p={};for(const u of S)if(u[1]in document){for(const[n,f]of u.entries())p[T[n]]=f;return p}return!1})(),y={change:c.fullscreenchange,error:c.fullscreenerror};let M={request:(T=document.documentElement,p)=>new Promise((u,n)=>{const f=()=>{M.off("change",f),u()};M.on("change",f);const l=T[c.requestFullscreen](p);l instanceof Promise&&l.then(f).catch(n)}),exit:()=>new Promise((T,p)=>{if(!M.isFullscreen)return void T();const u=()=>{M.off("change",u),T()};M.on("change",u);const n=document[c.exitFullscreen]();n instanceof Promise&&n.then(u).catch(p)}),toggle:(T,p)=>M.isFullscreen?M.exit():M.request(T,p),onchange(T){M.on("change",T)},onerror(T){M.on("error",T)},on(T,p){const u=y[T];u&&document.addEventListener(u,p,!1)},off(T,p){const u=y[T];u&&document.removeEventListener(u,p,!1)},raw:c};return Object.defineProperties(M,{isFullscreen:{get:()=>Boolean(document[c.fullscreenElement])},element:{enumerable:!0,get:()=>document[c.fullscreenElement]},isEnabled:{enumerable:!0,get:()=>Boolean(document[c.fullscreenEnabled])}}),c||(M={isEnabled:!1}),M}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bEKHA:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{notice:y,template:{$player:M}}=c;(0,S.def)(c,"fullscreenWeb",{get:()=>(0,S.hasClass)(M,"art-fullscreen-web"),set(T){T?(c.normalSize="fullscreenWeb",(0,S.addClass)(M,"art-fullscreen-web"),c.aspectRatioReset=!0,c.autoSize=!1,c.emit("resize"),c.emit("fullscreenWeb",!0),y.show=""):((0,S.removeClass)(M,"art-fullscreen-web"),c.aspectRatioReset=!0,c.autoSize=c.option.autoSize,c.emit("resize"),c.emit("fullscreenWeb"),y.show="")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ibIuh:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,notice:M,template:{$video:T}}=c;document.pictureInPictureEnabled?function(p){const{template:{$video:u},events:{proxy:n},notice:f}=p;u.disablePictureInPicture=!1,(0,S.def)(p,"pip",{get:()=>document.pictureInPictureElement,set(l){l?(p.normalSize="pip",u.requestPictureInPicture().catch(h=>{throw f.show=h,h})):document.exitPictureInPicture().catch(h=>{throw f.show=h,h})}}),n(u,"enterpictureinpicture",()=>{p.emit("pip",!0)}),n(u,"leavepictureinpicture",()=>{p.emit("pip")})}(c):T.webkitSupportsPresentationMode?function(p){const{$video:u}=p.template;u.webkitSetPresentationMode("inline"),(0,S.def)(p,"pip",{get:()=>u.webkitPresentationMode==="picture-in-picture",set(n){n?(p.normalSize="pip",u.webkitSetPresentationMode("picture-in-picture"),p.emit("pip",!0)):(u.webkitSetPresentationMode("inline"),p.emit("pip"))}})}(c):(0,S.def)(c,"pip",{get:()=>!1,set(){M.show=y.get("PIP Not Supported")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kwpxq:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{$video:y}=c.template;(0,S.def)(c,"loaded",{get:()=>c.loadedTime/y.duration}),(0,S.def)(c,"loadedTime",{get:()=>y.buffered.length?y.buffered.end(y.buffered.length-1):0})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],e4Iws:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){(0,S.def)(c,"played",{get:()=>c.currentTime/c.duration})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fueZP:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{$video:y}=c.template;(0,S.def)(c,"playing",{get:()=>y.currentTime>0&&!y.paused&&!y.ended&&y.readyState>2})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],l6TMg:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{$container:y,$player:M,$video:T}=c.template;(0,S.def)(c,"autoSize",{get:()=>(0,S.hasClass)(y,"art-auto-size"),set(p){if(p){const{videoWidth:u,videoHeight:n}=T,{width:f,height:l}=y.getBoundingClientRect(),h=u/n,v=f/l;if((0,S.addClass)(y,"art-auto-size"),v>h){const d=l*h/f*100;(0,S.setStyle)(M,"width",`${d}%`),(0,S.setStyle)(M,"height","100%")}else{const d=f/h/l*100;(0,S.setStyle)(M,"width","100%"),(0,S.setStyle)(M,"height",`${d}%`)}c.emit("autoSize",{width:c.width,height:c.height})}else(0,S.removeClass)(y,"art-auto-size"),(0,S.setStyle)(M,"width",null),(0,S.setStyle)(M,"height",null),c.emit("autoSize")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"6URTt":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){(0,S.def)(c,"rect",{get:()=>c.template.$player.getBoundingClientRect()});const y=["bottom","height","left","right","top","width"];for(let M=0;M<y.length;M++){const T=y[M];(0,S.def)(c,T,{get:()=>c.rect[T]})}(0,S.def)(c,"x",{get:()=>c.left+window.pageXOffset}),(0,S.def)(c,"y",{get:()=>c.top+window.pageYOffset})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],joth7:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{template:{$player:y},i18n:M,notice:T}=c;(0,S.def)(c,"flip",{get:()=>y.dataset.flip||"normal",set(p){p||(p="normal");const u=["normal","horizontal","vertical"];(0,S.errorHandle)(u.includes(p),`'flip' only accept ${u.toString()} as parameters`),p==="normal"?delete y.dataset.flip:y.dataset.flip=p;const n=p.replace(p[0],p[0].toUpperCase());T.show=`${M.get("Video Flip")}: ${M.get(n)}`,c.emit("flip",p)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],durkk:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,option:M,storage:T,events:{proxy:p},template:{$player:u,$miniClose:n,$miniTitle:f,$miniHeader:l}}=c;let h=!1,v=0,d=0,r=0,t=0;p(l,"mousedown",i=>{h=!0,v=i.pageX,d=i.pageY,r=c.left,t=c.top}),p(document,"mousemove",i=>{if(h){(0,S.addClass)(u,"art-is-dragging");const e=t+i.pageY-d,a=r+i.pageX-v;(0,S.setStyle)(u,"top",`${e}px`),(0,S.setStyle)(u,"left",`${a}px`),T.set("top",e),T.set("left",a)}}),p(document,"mouseup",()=>{h=!1,(0,S.removeClass)(u,"art-is-dragging")}),p(n,"click",()=>{c.mini=!1,h=!1,(0,S.removeClass)(u,"art-is-dragging")}),(0,S.append)(f,M.title||y.get("Mini Player")),(0,S.def)(c,"mini",{get:()=>(0,S.hasClass)(u,"art-mini"),set(i){if(i){c.normalSize="mini",c.autoSize=!1,(0,S.addClass)(u,"art-mini");const e=T.get("top"),a=T.get("left");if(e&&a)(0,S.setStyle)(u,"top",`${e}px`),(0,S.setStyle)(u,"left",`${a}px`),(0,S.isInViewport)(l)||(T.del("top"),T.del("left"),c.mini=!0);else{const o=window.innerHeight-c.height-50,s=window.innerWidth-c.width-50;T.set("top",o),T.set("left",s),(0,S.setStyle)(u,"top",`${o}px`),(0,S.setStyle)(u,"left",`${s}px`)}c.aspectRatio=!1,c.playbackRate=!1,c.notice.show="",c.emit("mini",!0)}else(0,S.removeClass)(u,"art-mini"),(0,S.setStyle)(u,"top",null),(0,S.setStyle)(u,"left",null),c.aspectRatio=!1,c.playbackRate=!1,c.autoSize=M.autoSize,c.notice.show="",c.emit("mini")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5EZwI":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){let y=[];(0,S.def)(c,"loop",{get:()=>y,set:M=>{if(Array.isArray(M)&&typeof M[0]=="number"&&typeof M[1]=="number"){const T=(0,S.clamp)(M[0],0,Math.min(M[1],c.duration)),p=(0,S.clamp)(M[1],T,c.duration);p-T>=1?(y=[T,p],c.emit("loop",y)):(y=[],c.emit("loop"))}else y=[],c.emit("loop")}}),c.on("video:timeupdate",()=>{y.length&&(c.currentTime<y[0]||c.currentTime>y[1])&&(c.seek=y[0])})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"22WMt":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{option:y,template:{$poster:M}}=c;(0,S.def)(c,"poster",{get:()=>y.poster,set(T){y.poster=T,(0,S.setStyle)(M,"backgroundImage",`url(${T})`)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8pdNr":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{option:y,template:{$container:M,$video:T}}=c,p=M.style.height;(0,S.def)(c,"autoHeight",{get:()=>(0,S.hasClass)(M,"art-auto-height"),set(u){if(u){const{clientWidth:n}=M,{videoHeight:f,videoWidth:l}=T,h=f*(n/l);(0,S.setStyle)(M,"height",h+"px"),(0,S.addClass)(M,"art-auto-height"),c.autoSize=y.autoSize,c.emit("autoHeight",h)}else(0,S.setStyle)(M,"height",p),(0,S.removeClass)(M,"art-auto-height"),c.autoSize=y.autoSize,c.emit("autoHeight")}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],eADqm:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{option:y,template:{$player:M}}=c;(0,S.def)(c,"theme",{get:()=>getComputedStyle(M).getPropertyValue("--theme"),set(T){y.theme=T,M.style.setProperty("--theme",T)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8T9U6":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){(0,S.def)(c,"title",{get:()=>c.option.title,set(y){c.option.title=y}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iEQHG:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const y=["mini","pip","fullscreen","fullscreenWeb"];(0,S.def)(c,"normalSize",{get:()=>y.every(M=>!c[M]),set(M){y.filter(T=>T!==M).forEach(T=>{c[T]&&(c[T]=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8CMLG":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{clamp:y}=c.constructor.utils,{notice:M,template:T,i18n:p}=c;let u=0,n=[];c.on("subtitle:switch",()=>{n=[]}),(0,S.def)(c,"subtitleOffset",{get:()=>u,set(f){if(T.$track&&T.$track.track){const l=Array.from(T.$track.track.cues);u=y(f,-5,5);for(let h=0;h<l.length;h++){const v=l[h];n[h]||(n[h]={startTime:v.startTime,endTime:v.endTime}),v.startTime=y(n[h].startTime+u,0,c.duration),v.endTime=y(n[h].endTime+u,0,c.duration)}c.subtitle.update(),M.show=`${p.get("Subtitle Offset")}: ${f}s`,c.emit("subtitleOffset",f)}else c.emit("subtitleOffset",0)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aqLU7:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{option:y,storage:M,template:{$video:T,$poster:p}}=c;Object.keys(y.moreVideoAttr).forEach(n=>{c.attr(n,y.moreVideoAttr[n])}),y.muted&&(c.muted=y.muted),y.volume&&(T.volume=(0,S.clamp)(y.volume,0,1));const u=M.get("volume");typeof u=="number"&&(T.volume=(0,S.clamp)(u,0,1)),y.poster&&(0,S.setStyle)(p,"backgroundImage",`url(${y.poster})`),y.autoplay&&(T.autoplay=y.autoplay),y.playsInline&&(T.playsInline=!0,T["webkit-playsinline"]=!0),y.theme&&(c.theme=y.theme),c.url=y.url}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"59ETf":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("../config"),y=S.interopDefault(c),M=O("../utils");_.default=function(T){const{i18n:p,notice:u,option:n,constructor:f,events:{proxy:l},template:{$player:h,$video:v,$poster:d}}=T;let r=0;for(let t=0;t<y.default.events.length;t++)l(v,y.default.events[t],i=>{T.emit(`video:${i.type}`,i)});T.on("video:canplay",()=>{r=0,T.loading.show=!1}),T.once("video:canplay",()=>{T.loading.show=!1,T.controls.show=!0,T.mask.show=!0,T.isReady=!0,T.emit("ready")}),T.on("video:ended",()=>{n.loop?(T.seek=0,T.play(),T.controls.show=!1,T.mask.show=!1):(T.controls.show=!0,T.mask.show=!0)}),T.on("video:error",()=>Ae(this,null,function*(){r<f.RECONNECT_TIME_MAX?(yield(0,M.sleep)(f.RECONNECT_SLEEP_TIME),r+=1,T.url=n.url,u.show=`${p.get("Reconnect")}: ${r}`,T.emit("error",r)):(T.mask.show=!0,T.loading.show=!1,T.controls.show=!0,(0,M.addClass)(h,"art-error"),yield(0,M.sleep)(f.RECONNECT_SLEEP_TIME),u.show=p.get("Video Load Failed"),T.destroy(!1))})),T.on("video:loadedmetadata",()=>{T.autoSize=n.autoSize,M.isMobile&&(T.loading.show=!1,T.controls.show=!0,T.mask.show=!0)}),T.on("video:loadstart",()=>{T.loading.show=!0,T.mask.show=!1,T.controls.show=!0}),T.on("video:pause",()=>{T.controls.show=!0,T.mask.show=!0}),T.on("video:play",()=>{T.mask.show=!1,(0,M.setStyle)(d,"display","none")}),T.on("video:playing",()=>{T.mask.show=!1}),T.on("video:seeked",()=>{T.loading.show=!1}),T.on("video:seeking",()=>{T.loading.show=!0,T.mask.show=!1}),T.on("video:timeupdate",()=>{T.mask.show=!1}),T.on("video:waiting",()=>{T.loading.show=!0,T.mask.show=!1})}},{"../config":"eksZR","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kJ9J9:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("../utils"),y=O("../utils/component"),M=S.interopDefault(y),T=O("./fullscreen"),p=S.interopDefault(T),u=O("./fullscreenWeb"),n=S.interopDefault(u),f=O("./pip"),l=S.interopDefault(f),h=O("./playAndPause"),v=S.interopDefault(h),d=O("./progress"),r=S.interopDefault(d),t=O("./time"),i=S.interopDefault(t),e=O("./volume"),a=S.interopDefault(e),o=O("./setting"),s=S.interopDefault(o),g=O("./thumbnails"),L=S.interopDefault(g),A=O("./screenshot"),m=S.interopDefault(A),E=O("./quality"),x=S.interopDefault(E),D=O("./loop"),I=S.interopDefault(D);class b extends M.default{constructor(P){super(P),this.name="control";const{constructor:w,events:{proxy:F},template:{$player:k}}=P;let B=Date.now();F(k,["click","mousemove","touchstart","touchmove"],()=>{this.show=!0,(0,c.removeClass)(k,"art-hide-cursor"),(0,c.addClass)(k,"art-hover"),B=Date.now()}),P.on("video:timeupdate",()=>{!P.isInput&&P.playing&&this.show&&Date.now()-B>=w.CONTROL_HIDE_TIME&&(this.show=!1,(0,c.addClass)(k,"art-hide-cursor"),(0,c.removeClass)(k,"art-hover"))}),this.init()}init(){const{option:P}=this.art;this.add((0,r.default)({name:"progress",disable:P.isLive,position:"top",index:10})),this.add((0,L.default)({name:"thumbnails",disable:!P.thumbnails.url||P.isLive||c.isMobile,position:"top",index:20})),this.add((0,I.default)({name:"loop",disable:!1,position:"top",index:30})),this.add((0,v.default)({name:"playAndPause",disable:!1,position:"left",index:10})),this.add((0,a.default)({name:"volume",disable:!1,position:"left",index:20})),this.add((0,i.default)({name:"time",disable:P.isLive,position:"left",index:30})),this.add((0,x.default)({name:"quality",disable:P.quality.length===0,position:"right",index:10})),this.add((0,m.default)({name:"screenshot",disable:!P.screenshot||c.isMobile,position:"right",index:20})),this.add((0,s.default)({name:"setting",disable:!P.setting,position:"right",index:30})),this.add((0,l.default)({name:"pip",disable:!P.pip,position:"right",index:40})),this.add((0,n.default)({name:"fullscreenWeb",disable:!P.fullscreenWeb,position:"right",index:50})),this.add((0,p.default)({name:"fullscreen",disable:!P.fullscreen,position:"right",index:60}));for(let w=0;w<P.controls.length;w++)this.add(P.controls[w])}add(P){const w=typeof P=="function"?P(this.art):P,{$progress:F,$controlsLeft:k,$controlsRight:B}=this.art.template;switch(w.position){case"top":this.$parent=F;break;case"left":this.$parent=k;break;case"right":this.$parent=B;break;default:(0,c.errorHandle)(!1,"Control option.position must one of 'top', 'left', 'right'")}super.add(w)}}_.default=b},{"../utils":"geSvU","../utils/component":"kPHYl","./fullscreen":"awkUw","./fullscreenWeb":"3qoPe","./pip":"lFHYL","./playAndPause":"b8vU1","./progress":"dRwzT","./time":"ltYI1","./volume":"8O7mM","./setting":"lX5UX","./thumbnails":"lUoGG","./screenshot":"jvdQ0","./quality":"k9pKK","./loop":"aE690","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],kPHYl:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./dom"),y=O("option-validator"),M=S.interopDefault(y),T=O("../scheme"),p=O("./property"),u=O("./error");_.default=class{constructor(n){this.id=0,this.art=n,this.add=this.add.bind(this)}get show(){return(0,c.hasClass)(this.art.template.$player,`art-${this.name}-show`)}set show(n){const{$player:f}=this.art.template,l=`art-${this.name}-show`;n?(0,c.addClass)(f,l):(0,c.removeClass)(f,l),this.art.emit(this.name,n)}set toggle(n){n&&(this.show=!this.show)}add(n){const f=typeof n=="function"?n(this.art):n;if(f.html=f.html||"",(0,M.default)(f,T.ComponentOption),!this.$parent||!this.name||f.disable)return;const l=f.name||`${this.name}${this.id}`;(0,u.errorHandle)(!(0,p.has)(this,l),`Cannot add an existing name [${l}] to the [${this.name}]`),this.id+=1;const h=document.createElement("div");(0,c.addClass)(h,`art-${this.name}`),(0,c.addClass)(h,`art-${this.name}-${l}`);const v=Array.from(this.$parent.children);h.dataset.index=f.index||this.id;const d=v.find(r=>Number(r.dataset.index)>=Number(h.dataset.index));return d?d.insertAdjacentElement("beforebegin",h):(0,c.append)(this.$parent,h),f.html&&(0,c.append)(h,f.html),f.style&&(0,c.setStyles)(h,f.style),f.tooltip&&(0,c.tooltip)(h,f.tooltip),f.click&&this.art.events.proxy(h,"click",r=>{r.preventDefault(),f.click.call(this.art,this,r)}),f.selector&&["left","right"].includes(f.position)&&this.selector(f,h),f.mounted&&f.mounted.call(this.art,h),h.childNodes.length===1&&h.childNodes[0].nodeType===3&&(0,c.addClass)(h,"art-control-onlyText"),(0,p.def)(this,l,{value:h}),h}selector(n,f){const{hover:l,proxy:h}=this.art.events;(0,c.addClass)(f,"art-control-selector");const v=document.createElement("div");(0,c.addClass)(v,"art-selector-value"),(0,c.append)(v,n.html),f.innerText="",(0,c.append)(f,v);const d=n.selector.map((i,e)=>`<div class="art-selector-item ${i.default?"art-current":""}" data-index="${e}">${i.html}</div>`).join(""),r=document.createElement("div");(0,c.addClass)(r,"art-selector-list"),(0,c.append)(r,d),(0,c.append)(f,r);const t=()=>{const i=(0,c.getStyle)(f,"width")/2-(0,c.getStyle)(r,"width")/2;r.style.left=`${i}px`};l(f,t),h(r,"click",i=>Ae(this,null,function*(){const e=(i.composedPath()||[]).find(s=>(0,c.hasClass)(s,"art-selector-item"));if(!e)return;(0,c.inverseClass)(e,"art-current");const a=Number(e.dataset.index),o=n.selector[a]||{};if(v.innerText=e.innerText,n.onSelect){const s=yield n.onSelect.call(this.art,o,e,i);typeof s!="string"&&typeof s!="number"||(v.innerHTML=s)}t(),this.art.emit("selector",o,e)}))}}},{"./dom":"ff6Hs","option-validator":"2A2W5","../scheme":"3vPoh","./property":"lMM6V","./error":"lDQPM","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],awkUw:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{tooltip:y.i18n.get("Fullscreen"),mounted:M=>{const{events:{proxy:T},icons:p,i18n:u}=y,n=(0,S.append)(M,p.fullscreenOn),f=(0,S.append)(M,p.fullscreenOff);(0,S.setStyle)(f,"display","none"),T(M,"click",()=>{y.fullscreen=!y.fullscreen}),y.on("fullscreen",l=>{l?((0,S.tooltip)(M,u.get("Exit Fullscreen")),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(f,"display","inline-flex")):((0,S.tooltip)(M,u.get("Fullscreen")),(0,S.setStyle)(n,"display","inline-flex"),(0,S.setStyle)(f,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3qoPe":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{tooltip:y.i18n.get("Web Fullscreen"),mounted:M=>{const{events:{proxy:T},icons:p,i18n:u}=y,n=(0,S.append)(M,p.fullscreenWebOn),f=(0,S.append)(M,p.fullscreenWebOff);(0,S.setStyle)(f,"display","none"),T(M,"click",()=>{y.fullscreenWeb=!y.fullscreenWeb}),y.on("fullscreenWeb",l=>{l?((0,S.tooltip)(M,u.get("Exit Web Fullscreen")),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(f,"display","inline-flex")):((0,S.tooltip)(M,u.get("Web Fullscreen")),(0,S.setStyle)(n,"display","inline-flex"),(0,S.setStyle)(f,"display","none"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lFHYL:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{tooltip:y.i18n.get("PIP Mode"),mounted:M=>{const{events:{proxy:T},icons:p,i18n:u}=y;(0,S.append)(M,p.pip),T(M,"click",()=>{y.pip=!y.pip}),y.on("pip",n=>{(0,S.tooltip)(M,u.get(n?"Exit PIP Mode":"PIP Mode"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],b8vU1:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{mounted:M=>{const{events:{proxy:T},icons:p,i18n:u}=y,n=(0,S.append)(M,p.play),f=(0,S.append)(M,p.pause);function l(){(0,S.setStyle)(n,"display","flex"),(0,S.setStyle)(f,"display","none")}function h(){(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(f,"display","flex")}(0,S.tooltip)(n,u.get("Play")),(0,S.tooltip)(f,u.get("Pause")),T(n,"click",()=>{y.play()}),T(f,"click",()=>{y.pause()}),y.playing?h():l(),y.on("video:playing",()=>{h()}),y.on("video:pause",()=>{l()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],dRwzT:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_),S.export(_,"getPosFromEvent",()=>y);var c=O("../utils");function y(M,T){const{$progress:p}=M.template,{left:u}=p.getBoundingClientRect(),n=T.pageX,f=(0,c.clamp)(n-u,0,p.clientWidth),l=f/p.clientWidth*M.duration;return{second:l,time:(0,c.secondToTime)(l),width:f,percentage:(0,c.clamp)(f/p.clientWidth,0,1)}}_.default=function(M){return T=>{const{icons:p,option:u,events:{proxy:n}}=T;return Ee(me({},M),{html:'<div class="art-control-progress-inner"><div class="art-progress-loaded"></div><div class="art-progress-played"></div><div class="art-progress-highlight"></div><div class="art-progress-indicator"></div><div class="art-progress-tip"></div></div>',mounted:f=>{let l=!1;const h=(0,c.query)(".art-progress-loaded",f),v=(0,c.query)(".art-progress-played",f),d=(0,c.query)(".art-progress-highlight",f),r=(0,c.query)(".art-progress-indicator",f),t=(0,c.query)(".art-progress-tip",f);(0,c.setStyle)(v,"backgroundColor","var(--theme)");let i=T.constructor.INDICATOR_SIZE;function e(a,o){a==="loaded"&&(0,c.setStyle)(h,"width",100*o+"%"),a==="played"&&((0,c.setStyle)(v,"width",100*o+"%"),(0,c.setStyle)(r,"left",`calc(${100*o}% - ${i/2}px)`))}p.indicator?(i=T.constructor.INDICATOR_SIZE_ICON,(0,c.append)(r,p.indicator)):(0,c.setStyles)(r,{backgroundColor:"var(--theme)"}),c.isMobile&&(i=T.constructor.INDICATOR_SIZE_MOBILE,p.indicator&&(i=T.constructor.INDICATOR_SIZE_MOBILE_ICON)),(0,c.setStyles)(r,{left:`-${i/2}px`,width:`${i}px`,height:`${i}px`}),T.on("video:loadedmetadata",()=>{for(let a=0;a<u.highlight.length;a++){const o=u.highlight[a],s=(0,c.clamp)(o.time,0,T.duration)/T.duration*100;(0,c.append)(d,`<span data-text="${o.text}" data-time="${o.time}" style="left: ${s}%"></span>`)}}),e("loaded",T.loaded),T.on("setBar",(a,o)=>{e(a,o)}),T.on("video:progress",()=>{e("loaded",T.loaded)}),T.on("video:timeupdate",()=>{e("played",T.played)}),T.on("video:ended",()=>{e("played",1)}),c.isMobile||(n(f,"click",a=>{if(a.target!==r){const{second:o,percentage:s}=y(T,a);e("played",s),T.seek=o}}),n(f,"mousemove",a=>{(0,c.setStyle)(t,"display","block"),(0,c.includeFromEvent)(a,d)?function(o){const{width:s}=y(T,o),{text:g}=o.target.dataset;t.innerHTML=g;const L=t.clientWidth;s<=L/2?(0,c.setStyle)(t,"left",0):s>f.clientWidth-L/2?(0,c.setStyle)(t,"left",f.clientWidth-L+"px"):(0,c.setStyle)(t,"left",s-L/2+"px")}(a):function(o){const{width:s,time:g}=y(T,o);t.innerHTML=g;const L=t.clientWidth;s<=L/2?(0,c.setStyle)(t,"left",0):s>f.clientWidth-L/2?(0,c.setStyle)(t,"left",f.clientWidth-L+"px"):(0,c.setStyle)(t,"left",s-L/2+"px")}(a)}),n(f,"mouseout",()=>{(0,c.setStyle)(t,"display","none")}),n(r,"mousedown",()=>{l=!0}),n(document,"mousemove",a=>{if(l){const{second:o,percentage:s}=y(T,a);e("played",s),T.seek=o}}),n(document,"mouseup",()=>{l&&(l=!1)}))}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ltYI1:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{style:{cursor:"auto"},mounted:M=>{function T(){const u=`${(0,S.secondToTime)(y.currentTime)} / ${(0,S.secondToTime)(y.duration)}`;u!==M.innerText&&(M.innerText=u)}T();const p=["video:loadedmetadata","video:timeupdate","video:progress"];for(let u=0;u<p.length;u++)y.on(p[u],T)}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"8O7mM":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{mounted:M=>{const{events:{proxy:T},icons:p,i18n:u}=y;let n=!1;const f=y.constructor.VOLUME_PANEL_WIDTH,l=y.constructor.VOLUME_HANDLE_WIDTH,h=(0,S.append)(M,p.volume),v=(0,S.append)(M,p.volumeClose),d=(0,S.append)(M,'<div class="art-volume-panel"></div>'),r=(0,S.append)(d,'<div class="art-volume-slider-handle"></div>');function t(e){const{left:a}=d.getBoundingClientRect();return(0,S.clamp)(e.pageX-a-l/2,0,f-l/2)/(f-l)}function i(e=.7){if(y.muted||e===0)(0,S.setStyle)(h,"display","none"),(0,S.setStyle)(v,"display","flex"),(0,S.setStyle)(r,"left","0");else{const a=(f-l)*e;(0,S.setStyle)(h,"display","flex"),(0,S.setStyle)(v,"display","none"),(0,S.setStyle)(r,"left",`${a}px`)}}(0,S.tooltip)(h,u.get("Mute")),(0,S.setStyle)(v,"display","none"),S.isMobile&&(0,S.setStyle)(d,"display","none"),i(y.volume),y.on("video:volumechange",()=>{i(y.volume)}),T(h,"click",()=>{y.muted=!0}),T(v,"click",()=>{y.muted=!1}),T(d,"click",e=>{y.muted=!1,y.volume=t(e)}),T(r,"mousedown",()=>{n=!0}),T(M,"mousemove",e=>{n&&(y.muted=!1,y.volume=t(e))}),T(document,"mouseup",()=>{n&&(n=!1)})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lX5UX:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{tooltip:y.i18n.get("Show Setting"),mounted:M=>{const{events:{proxy:T},icons:p,i18n:u}=y;(0,S.append)(M,p.setting),T(M,"click",()=>{y.setting.toggle=!0}),y.on("setting",n=>{(0,S.tooltip)(M,u.get(n?"Hide Setting":"Show Setting"))})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],lUoGG:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils"),c=O("./progress");_.default=function(y){return M=>Ee(me({},y),{mounted:T=>{const{option:p,template:{$progress:u,$video:n},events:{proxy:f,loadImg:l}}=M;let h=null,v=!1,d=!1;f(u,"mousemove",r=>Ae(this,null,function*(){v||(v=!0,h=yield l(p.thumbnails.url),d=!0),d&&((0,S.setStyle)(T,"display","block"),function(t){const{width:i}=(0,c.getPosFromEvent)(M,t),{url:e,number:a,column:o}=p.thumbnails,s=h.naturalWidth/o,g=s/(n.videoWidth/n.videoHeight),L=u.clientWidth/a,A=Math.floor(i/L),m=Math.ceil(A/o)-1,E=A%o||o-1;(0,S.setStyle)(T,"backgroundImage",`url(${e})`),(0,S.setStyle)(T,"height",`${g}px`),(0,S.setStyle)(T,"width",`${s}px`),(0,S.setStyle)(T,"backgroundPosition",`-${E*s}px -${m*g}px`),i<=s/2?(0,S.setStyle)(T,"left",0):i>u.clientWidth-s/2?(0,S.setStyle)(T,"left",u.clientWidth-s+"px"):(0,S.setStyle)(T,"left",i-s/2+"px")}(r))})),f(u,"mouseout",()=>{(0,S.setStyle)(T,"display","none")})}})}},{"../utils":"geSvU","./progress":"dRwzT","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jvdQ0:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{tooltip:y.i18n.get("Screenshot"),mounted:M=>{const{events:{proxy:T},icons:p}=y;(0,S.append)(M,p.screenshot),T(M,"click",()=>{y.screenshot()})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k9pKK:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=function(S){return c=>{const y=c.option.quality,M=y.find(T=>T.default)||y[0];return Ee(me({},S),{html:M?M.html:"",selector:y,onSelect(T){c.switchQuality(T.url,T.html)}})}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aE690:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>Ee(me({},c),{mounted:M=>{const T=(0,S.append)(M,'<span class="art-loop-point"></span>'),p=(0,S.append)(M,'<span class="art-loop-point"></span>');y.on("loop",u=>{u?((0,S.setStyle)(M,"display","block"),(0,S.setStyle)(T,"left",`calc(${u[0]/y.duration*100}% - ${T.clientWidth}px)`),(0,S.setStyle)(p,"left",u[1]/y.duration*100+"%")):(0,S.setStyle)(M,"display","none")})}})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7rh9q":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("../utils"),y=O("../utils/component"),M=S.interopDefault(y),T=O("./playbackRate"),p=S.interopDefault(T),u=O("./aspectRatio"),n=S.interopDefault(u),f=O("./flip"),l=S.interopDefault(f),h=O("./info"),v=S.interopDefault(h),d=O("./version"),r=S.interopDefault(d),t=O("./close"),i=S.interopDefault(t);class e extends M.default{constructor(o){super(o),this.name="contextmenu",this.$parent=o.template.$contextmenu,c.isMobile||this.init()}init(){const{option:o,template:{$player:s,$contextmenu:g},events:{proxy:L}}=this.art;this.add((0,p.default)({disable:!o.playbackRate,name:"playbackRate",index:10})),this.add((0,n.default)({disable:!o.aspectRatio,name:"aspectRatio",index:20})),this.add((0,l.default)({disable:!o.flip,name:"flip",index:30})),this.add((0,v.default)({disable:!1,name:"info",index:40})),this.add((0,r.default)({disable:!1,name:"version",index:50})),this.add((0,i.default)({disable:!1,name:"close",index:60}));for(let A=0;A<o.contextmenu.length;A++)this.add(o.contextmenu[A]);L(s,"contextmenu",A=>{A.preventDefault(),this.show=!0;const m=A.clientX,E=A.clientY,{height:x,width:D,left:I,top:b}=s.getBoundingClientRect(),{height:R,width:P}=g.getBoundingClientRect();let w=m-I,F=E-b;m+P>I+D&&(w=D-P),E+R>b+x&&(F=x-R),(0,c.setStyles)(g,{top:`${F}px`,left:`${w}px`})}),L(s,"click",A=>{(0,c.includeFromEvent)(A,g)||(this.show=!1)}),this.art.on("blur",()=>{this.show=!1})}}_.default=e},{"../utils":"geSvU","../utils/component":"kPHYl","./playbackRate":"9P3rd","./aspectRatio":"3OqVf","./flip":"iMg4Y","./info":"9FFXO","./version":"duhqU","./close":"k3lJQ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9P3rd":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>{const{i18n:M}=y;return Ee(me({},c),{html:`${M.get("Play Speed")}:<span data-value="0.5">0.5</span><span data-value="0.75">0.75</span><span data-value="1.0" class="art-current">${M.get("Normal")}</span><span data-value="1.25">1.25</span><span data-value="1.5">1.5</span><span data-value="2.0">2.0</span>`,click:(T,p)=>{const{value:u}=p.target.dataset;u&&(y.playbackRate=Number(u),T.show=!1)},mounted:T=>{y.on("playbackRate",p=>{const u=(0,S.queryAll)("span",T).find(n=>Number(n.dataset.value)===p);u&&(0,S.inverseClass)(u,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"3OqVf":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>{const{i18n:M}=y;return Ee(me({},c),{html:`${M.get("Aspect Ratio")}:<span data-value="default" class="art-current">${M.get("Default")}</span><span data-value="4:3">4:3</span><span data-value="16:9">16:9</span>`,click:(T,p)=>{const{value:u}=p.target.dataset;u&&(y.aspectRatio=u,T.show=!1)},mounted:T=>{y.on("aspectRatio",p=>{const u=(0,S.queryAll)("span",T).find(n=>n.dataset.value===p);u&&(0,S.inverseClass)(u,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iMg4Y:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){return y=>{const{i18n:M}=y;return Ee(me({},c),{html:`${M.get("Video Flip")}:<span data-value="normal" class="art-current">${M.get("Normal")}</span><span data-value="horizontal">${M.get("Horizontal")}</span><span data-value="vertical">${M.get("Vertical")}</span>`,click:(T,p)=>{const{value:u}=p.target.dataset;u&&(y.flip=u,T.show=!1)},mounted:T=>{y.on("flip",p=>{const u=(0,S.queryAll)("span",T).find(n=>n.dataset.value===p);u&&(0,S.inverseClass)(u,"art-current")})}})}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"9FFXO":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=function(S){return c=>Ee(me({},S),{html:c.i18n.get("Video Info"),click:y=>{c.info.show=!0,y.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],duhqU:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=function(S){return Ee(me({},S),{html:'<a href="https://artplayer.org" target="_blank">ArtPlayer 4.5.2</a>'})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],k3lJQ:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=function(S){return c=>Ee(me({},S),{html:c.i18n.get("Close"),click:y=>{y.show=!1}})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],c896w:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./utils"),y=O("./utils/component"),M=S.interopDefault(y);class T extends M.default{constructor(u){super(u),this.name="info",c.isMobile||this.init()}init(){const{constructor:u,events:{proxy:n},template:{$infoPanel:f,$infoClose:l,$video:h}}=this.art;n(l,"click",()=>{this.show=!1});let v=null;const d=(0,c.queryAll)("[data-video]",f)||[];this.art.on("destroy",()=>{clearTimeout(v)}),function r(){for(let t=0;t<d.length;t++){const i=d[t],e=h[i.dataset.video],a=typeof e=="number"?e.toFixed(2):e;i.innerText!==a&&(i.innerText=a)}v=setTimeout(r,u.INFO_LOOP_TIME)}()}}_.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"2hqso":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./utils"),y=O("./utils/component"),M=S.interopDefault(y),T=O("option-validator"),p=S.interopDefault(T),u=O("./scheme"),n=S.interopDefault(u);class f extends M.default{constructor(h){super(h),this.name="subtitle",this.init(h.option.subtitle)}get url(){return this.art.template.$track.src}set url(h){this.switch(h)}get textTrack(){return this.art.template.$video.textTracks[0]}get activeCue(){return this.textTrack.activeCues[0]}style(h,v){const{$subtitle:d}=this.art.template;return typeof h=="object"?(0,c.setStyles)(d,h):(0,c.setStyle)(d,h,v)}update(){const{$subtitle:h}=this.art.template;h.innerHTML="",this.activeCue&&(h.innerHTML=this.activeCue.text.split(/\r?\n/).map(v=>`<p>${(0,c.escape)(v)}</p>`).join(""),this.art.emit("subtitleUpdate",this.activeCue.text))}switch(d){return Ae(this,arguments,function*(h,v={}){const{i18n:r,notice:t,option:i}=this.art,e=Ee(me(me({},i.subtitle),v),{url:h}),a=yield this.init(e);return v.name&&(t.show=`${r.get("Switch Subtitle")}: ${v.name}`),a})}init(h){if((0,p.default)(h,n.default.subtitle),!h.url)return;const{notice:v,events:{proxy:d},template:{$subtitle:r,$video:t,$track:i}}=this.art;if(!i){const e=document.createElement("track");e.default=!0,e.kind="metadata",t.appendChild(e),this.art.template.$track=e,d(this.textTrack,"cuechange",this.update.bind(this))}return this.style(h.style),(0,c.errorHandle)(window.fetch,"fetch not support"),fetch(h.url).then(e=>e.arrayBuffer()).then(e=>{(0,c.errorHandle)(window.TextDecoder,"TextDecoder not support");const a=new TextDecoder(h.encoding).decode(e);switch(this.art.emit("subtitleLoad",h.url),h.type||(0,c.getExt)(h.url)){case"srt":return(0,c.vttToBlob)((0,c.srtToVtt)(a));case"ass":return(0,c.vttToBlob)((0,c.assToVtt)(a));case"vtt":return(0,c.vttToBlob)(a);default:return h.url}}).then(e=>(r.innerHTML="",this.url===e||(URL.revokeObjectURL(this.url),this.art.template.$track.src=e,this.art.emit("subtitleSwitch",e)),e)).catch(e=>{throw v.show=e,e})}}_.default=f},{"./utils":"geSvU","./utils/component":"kPHYl","option-validator":"2A2W5","./scheme":"3vPoh","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j2hlX:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("../utils/error"),y=O("./clickInit"),M=S.interopDefault(y),T=O("./hoverInit"),p=S.interopDefault(T),u=O("./mousemoveInit"),n=S.interopDefault(u),f=O("./resizeInit"),l=S.interopDefault(f),h=O("./gestureInit"),v=S.interopDefault(h),d=O("./viewInit"),r=S.interopDefault(d);_.default=class{constructor(t){this.destroyEvents=[],this.proxy=this.proxy.bind(this),this.hover=this.hover.bind(this),this.loadImg=this.loadImg.bind(this),t.whitelist.state&&((0,M.default)(t,this),(0,p.default)(t,this),(0,n.default)(t,this),(0,l.default)(t,this),(0,v.default)(t,this),(0,r.default)(t,this))}proxy(t,i,e,a={}){if(Array.isArray(i))return i.map(s=>this.proxy(t,s,e,a));t.addEventListener(i,e,a);const o=()=>t.removeEventListener(i,e,a);return this.destroyEvents.push(o),o}hover(t,i,e){i&&this.proxy(t,"mouseenter",i),e&&this.proxy(t,"mouseleave",e)}loadImg(t){return new Promise((i,e)=>{let a;if(t instanceof HTMLImageElement)a=t;else{if(typeof t!="string")return e(new c.ArtPlayerError("Unable to get Image"));a=new Image,a.src=t}if(a.complete)return i(a);this.proxy(a,"load",()=>i(a)),this.proxy(a,"error",()=>e(new c.ArtPlayerError(`Failed to load Image: ${a.src}`)))})}destroy(){for(let t=0;t<this.destroyEvents.length;t++)this.destroyEvents[t]()}}},{"../utils/error":"lDQPM","./clickInit":"iP4Z9","./hoverInit":"aoIIW","./mousemoveInit":"4WC5c","./resizeInit":"7fpan","./gestureInit":"ixtiG","./viewInit":"5WvmH","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iP4Z9:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c,y){const{constructor:M,template:{$player:T,$video:p}}=c;y.proxy(document,["click","contextmenu"],n=>{(0,S.includeFromEvent)(n,T)?(c.isInput=n.target.tagName==="INPUT",c.isFocus=!0,c.emit("focus")):(c.isInput=!1,c.isFocus=!1,c.emit("blur"))});let u=0;y.proxy(p,"click",()=>{const n=Date.now();n-u<=M.DB_CLICE_TIME?(c.emit("dblclick"),S.isMobile?c.isLock||c.toggle():c.fullscreen=!c.fullscreen):(c.emit("click"),S.isMobile||c.toggle()),u=n})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aoIIW:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c,y){const{$player:M}=c.template;y.hover(M,()=>{(0,S.addClass)(M,"art-hover"),c.emit("hover",!0)},()=>{(0,S.removeClass)(M,"art-hover"),c.emit("hover")})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"4WC5c":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=function(S,c){const{$player:y}=S.template;c.proxy(y,"mousemove",M=>{S.emit("mousemove",M)})}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7fpan":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c,y){const{option:M}=c,T=(0,S.throttle)(()=>{c.normalSize&&(c.autoSize=M.autoSize),c.aspectRatioReset=!0,c.notice.show="",c.emit("resize")},c.constructor.RESIZE_TIME);y.proxy(window,["orientationchange","resize"],()=>{T()}),screen&&screen.orientation&&screen.orientation.onchange&&y.proxy(screen.orientation,"change",()=>{T()})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ixtiG:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c,y){if(S.isMobile&&!c.option.isLive){const{$video:M,$bottom:T,$controls:p}=c.template;let u=!1,n=0,f=0,l=0;const h=r=>{if(r.touches.length===1&&!c.isLock){u=!0;const{clientX:t,clientY:i}=r.touches[0];n=t,f=i,l=c.currentTime}},v=r=>{if(r.touches.length===1&&u&&c.duration){const t=c.plugins.autoOrientation&&c.plugins.autoOrientation.state,{clientX:i,clientY:e}=r.touches[0],a=(0,S.clamp)((i-n)/c.width,-1,1),o=(0,S.clamp)((e-f)/c.height,-1,1),s=t?o:a,g=(0,S.clamp)(l+c.duration*s/2,0,c.duration);c.seek=g,c.emit("setBar","played",(0,S.clamp)(g/c.duration,0,1)),c.notice.show=`${(0,S.secondToTime)(g)} / ${(0,S.secondToTime)(c.duration)}`}},d=()=>{u&&(n=0,f=0,l=0,u=!1)};y.proxy(T,"touchstart",r=>{(0,S.includeFromEvent)(r,p)||h(r)}),y.proxy(T,"touchmove",v),y.proxy(M,"touchstart",h),y.proxy(M,"touchmove",v),y.proxy(document,"touchend",d)}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5WvmH":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c,y){const{option:M,constructor:T,template:{$container:p}}=c,u=(0,S.throttle)(()=>{c.emit("view",(0,S.isInViewport)(p,T.SCROLL_GAP))},T.SCROLL_TIME);y.proxy(window,"scroll",()=>{u()}),c.on("view",n=>{M.autoMini&&(c.mini=!n)})}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aTHWZ:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("./utils");_.default=class{constructor(c){this.art=c,this.keys={},c.option.hotkey&&!S.isMobile&&this.init()}init(){const{proxy:c}=this.art.events;this.add(27,()=>{this.art.fullscreenWeb&&(this.art.fullscreenWeb=!1)}),this.add(32,()=>{this.art.toggle()}),this.add(37,()=>{this.art.backward=5}),this.add(38,()=>{this.art.volume+=.1}),this.add(39,()=>{this.art.forward=5}),this.add(40,()=>{this.art.volume-=.1}),c(window,"keydown",y=>{if(this.art.isFocus){const M=document.activeElement.tagName.toUpperCase(),T=document.activeElement.getAttribute("contenteditable");if(M!=="INPUT"&&M!=="TEXTAREA"&&T!==""&&T!=="true"){const p=this.keys[y.keyCode];if(p){y.preventDefault();for(let u=0;u<p.length;u++)p[u].call(this.art,y);this.art.emit("hotkey",y)}}}})}add(c,y){return this.keys[c]?this.keys[c].push(y):this.keys[c]=[y],this}remove(c,y){if(this.keys[c]){const M=this.keys[c].indexOf(y);M!==-1&&this.keys[c].splice(M,1)}return this}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],f2kxw:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./utils/component"),y=S.interopDefault(c);class M extends y.default{constructor(p){super(p);const{option:u,template:{$layer:n}}=p;this.name="layer",this.$parent=n;for(let f=0;f<u.layers.length;f++)this.add(u.layers[f])}}_.default=M},{"./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],bOs9w:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./utils"),y=O("./utils/component"),M=S.interopDefault(y);class T extends M.default{constructor(u){super(u),this.name="loading",(0,c.append)(u.template.$loading,u.icons.loading)}}_.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ic4th:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("./utils");_.default=class{constructor(c){this.art=c,this.timer=null}set show(c){const{constructor:y,template:{$player:M,$noticeInner:T}}=this.art;c?(T.innerText=c instanceof Error?c.message.trim():c,(0,S.addClass)(M,"art-notice-show"),clearTimeout(this.timer),this.timer=setTimeout(()=>{T.innerText="",(0,S.removeClass)(M,"art-notice-show")},y.NOTICE_TIME)):(0,S.removeClass)(M,"art-notice-show")}}},{"./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],iLfmB:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./utils"),y=O("./utils/component"),M=S.interopDefault(y);class T extends M.default{constructor(u){super(u),this.name="mask";const{template:n,icons:f,events:l}=u,h=(0,c.append)(n.$state,f.state),v=(0,c.append)(n.$state,f.error);(0,c.setStyle)(v,"display","none"),u.on("destroy",()=>{(0,c.setStyle)(h,"display","none"),(0,c.setStyle)(v,"display",null)}),l.proxy(n.$state,"click",()=>u.play())}}_.default=T},{"./utils":"geSvU","./utils/component":"kPHYl","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5lAmI":[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("../utils"),y=O("bundle-text:./loading.svg"),M=S.interopDefault(y),T=O("bundle-text:./state.svg"),p=S.interopDefault(T),u=O("bundle-text:./check.svg"),n=S.interopDefault(u),f=O("bundle-text:./play.svg"),l=S.interopDefault(f),h=O("bundle-text:./pause.svg"),v=S.interopDefault(h),d=O("bundle-text:./volume.svg"),r=S.interopDefault(d),t=O("bundle-text:./volume-close.svg"),i=S.interopDefault(t),e=O("bundle-text:./screenshot.svg"),a=S.interopDefault(e),o=O("bundle-text:./setting.svg"),s=S.interopDefault(o),g=O("bundle-text:./arrow-left.svg"),L=S.interopDefault(g),A=O("bundle-text:./arrow-right.svg"),m=S.interopDefault(A),E=O("bundle-text:./playback-rate.svg"),x=S.interopDefault(E),D=O("bundle-text:./aspect-ratio.svg"),I=S.interopDefault(D),b=O("bundle-text:./config.svg"),R=S.interopDefault(b),P=O("bundle-text:./pip.svg"),w=S.interopDefault(P),F=O("bundle-text:./lock.svg"),k=S.interopDefault(F),B=O("bundle-text:./unlock.svg"),U=S.interopDefault(B),j=O("bundle-text:./fullscreen-off.svg"),K=S.interopDefault(j),N=O("bundle-text:./fullscreen-on.svg"),Z=S.interopDefault(N),$=O("bundle-text:./fullscreen-web-off.svg"),Y=S.interopDefault($),ee=O("bundle-text:./fullscreen-web-on.svg"),Q=S.interopDefault(ee),G=O("bundle-text:./switch-on.svg"),q=S.interopDefault(G),te=O("bundle-text:./switch-off.svg"),ie=S.interopDefault(te),ne=O("bundle-text:./flip.svg"),le=S.interopDefault(ne),ae=O("bundle-text:./error.svg"),oe=S.interopDefault(ae),J=O("bundle-text:./close.svg"),se=S.interopDefault(J);_.default=class{constructor(fe){const de=me({loading:M.default,state:p.default,play:l.default,pause:v.default,check:n.default,volume:r.default,volumeClose:i.default,screenshot:a.default,setting:s.default,pip:w.default,arrowLeft:L.default,arrowRight:m.default,playbackRate:x.default,aspectRatio:I.default,config:R.default,lock:k.default,flip:le.default,unlock:U.default,fullscreenOff:K.default,fullscreenOn:Z.default,fullscreenWebOff:Y.default,fullscreenWebOn:Q.default,switchOn:q.default,switchOff:ie.default,error:oe.default,close:se.default},fe.option.icons);Object.keys(de).forEach(ge=>{(0,c.def)(this,ge,{get:()=>{const ue=document.createElement("i");return(0,c.addClass)(ue,"art-icon"),(0,c.addClass)(ue,`art-icon-${ge}`),(0,c.append)(ue,de[ge]),ue}})})}}},{"../utils":"geSvU","bundle-text:./loading.svg":"hX0lQ","bundle-text:./state.svg":"01U3R","bundle-text:./check.svg":"9jaCP","bundle-text:./play.svg":"invok","bundle-text:./pause.svg":"68285","bundle-text:./volume.svg":"3zSKr","bundle-text:./volume-close.svg":"ft8Zf","bundle-text:./screenshot.svg":"dfLel","bundle-text:./setting.svg":"j8dnn","bundle-text:./arrow-left.svg":"fMoi9","bundle-text:./arrow-right.svg":"auIjA","bundle-text:./playback-rate.svg":"g3V1U","bundle-text:./aspect-ratio.svg":"3LQJt","bundle-text:./config.svg":"bcTkc","bundle-text:./pip.svg":"jDSoL","bundle-text:./lock.svg":"jqFLt","bundle-text:./unlock.svg":"5qYod","bundle-text:./fullscreen-off.svg":"25MvP","bundle-text:./fullscreen-on.svg":"6CCX4","bundle-text:./fullscreen-web-off.svg":"m9TwS","bundle-text:./fullscreen-web-on.svg":"iWJrW","bundle-text:./switch-on.svg":"8cFxH","bundle-text:./switch-off.svg":"6tBmw","bundle-text:./flip.svg":"6N8Hu","bundle-text:./error.svg":"bNBRZ","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2","bundle-text:./close.svg":"8pxPz"}],hX0lQ:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="uil-default"><path fill="none" class="bk" d="M0 0h100v100H0z"/><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="translate(0 -30)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-1s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(30 105.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.9166666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(60 75.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.8333333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(90 65 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.75s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(120 58.66 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.6666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(150 54.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5833333333333334s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(180 50 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.5s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-150 45.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.4166666666666667s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-120 41.34 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.3333333333333333s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-90 35 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.25s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-60 24.02 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.16666666666666666s" repeatCount="indefinite"/></rect><rect x="47" y="40" width="6" height="20" rx="5" ry="5" fill="#fff" transform="rotate(-30 -5.98 65)"><animate attributeName="opacity" from="1" to="0" dur="1s" begin="-0.08333333333333333s" repeatCount="indefinite"/></rect></svg>'},{}],"01U3R":[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="60" width="60" style="filter:drop-shadow(0 1px 1px #000)" viewBox="0 0 24 24"><path d="M20 2H4C1.8 2 0 3.8 0 6v12c0 2.2 1.8 4 4 4h16c2.2 0 4-1.8 4-4V6c0-2.2-1.8-4-4-4zm-4.4 10.8L10.5 16c-.6.5-1.5 0-1.5-.8V8.8c0-.8.9-1.3 1.5-.8l5.1 3.2c.7.3.7 1.3 0 1.6z"/></svg>'},{}],"9jaCP":[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="width:100%;height:100%"><path d="M9 16.2 4.8 12l-1.4 1.4L9 19 21 7l-1.4-1.4L9 16.2z" fill="#fff"/></svg>'},{}],invok:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M17.982 9.275 8.06 3.27A2.013 2.013 0 0 0 5 4.994v12.011a2.017 2.017 0 0 0 3.06 1.725l9.922-6.005a2.017 2.017 0 0 0 0-3.45z"/></svg>'},{}],68285:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M7 3a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2zm8 0a2 2 0 0 0-2 2v12a2 2 0 1 0 4 0V5a2 2 0 0 0-2-2z"/></svg>'},{}],"3zSKr":[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M10.188 4.65 6 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39V5.04a.498.498 0 0 0-.812-.39zm4.258-.872a1 1 0 0 0-.862 1.804 6.002 6.002 0 0 1-.007 10.838 1 1 0 0 0 .86 1.806A8.001 8.001 0 0 0 19 11a8.001 8.001 0 0 0-4.554-7.222z"/><path d="M15 11a3.998 3.998 0 0 0-2-3.465v6.93A3.998 3.998 0 0 0 15 11z"/></svg>'},{}],ft8Zf:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><path d="M15 11a3.998 3.998 0 0 0-2-3.465v2.636l1.865 1.865A4.02 4.02 0 0 0 15 11z"/><path d="M13.583 5.583A5.998 5.998 0 0 1 17 11a6 6 0 0 1-.585 2.587l1.477 1.477a8.001 8.001 0 0 0-3.446-11.286 1 1 0 0 0-.863 1.805zm5.195 13.195-2.121-2.121-1.414-1.414-1.415-1.415L13 13l-2-2-3.889-3.889-3.889-3.889a.999.999 0 1 0-1.414 1.414L5.172 8H5a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h1l4.188 3.35a.5.5 0 0 0 .812-.39v-3.131l2.587 2.587-.01.005a1 1 0 0 0 .86 1.806c.215-.102.424-.214.627-.333l2.3 2.3a1.001 1.001 0 0 0 1.414-1.416zM11 5.04a.5.5 0 0 0-.813-.39L8.682 5.854 11 8.172V5.04z"/></svg>'},{}],dfLel:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 50 50"><path d="M19.402 6a5 5 0 0 0-4.902 4.012L14.098 12H9a5 5 0 0 0-5 5v21a5 5 0 0 0 5 5h32a5 5 0 0 0 5-5V17a5 5 0 0 0-5-5h-5.098l-.402-1.988A5 5 0 0 0 30.598 6ZM25 17c5.52 0 10 4.48 10 10s-4.48 10-10 10-10-4.48-10-10 4.48-10 10-10Zm0 2c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8Z"/></svg>'},{}],j8dnn:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" height="22" width="22"><circle cx="11" cy="11" r="2"/><path d="M19.164 8.861 17.6 8.6a6.978 6.978 0 0 0-1.186-2.099l.574-1.533a1 1 0 0 0-.436-1.217l-1.997-1.153a1.001 1.001 0 0 0-1.272.23l-1.008 1.225a7.04 7.04 0 0 0-2.55.001L8.716 2.829a1 1 0 0 0-1.272-.23L5.447 3.751a1 1 0 0 0-.436 1.217l.574 1.533A6.997 6.997 0 0 0 4.4 8.6l-1.564.261A.999.999 0 0 0 2 9.847v2.306c0 .489.353.906.836.986l1.613.269a7 7 0 0 0 1.228 2.075l-.558 1.487a1 1 0 0 0 .436 1.217l1.997 1.153c.423.244.961.147 1.272-.23l1.04-1.263a7.089 7.089 0 0 0 2.272 0l1.04 1.263a1 1 0 0 0 1.272.23l1.997-1.153a1 1 0 0 0 .436-1.217l-.557-1.487c.521-.61.94-1.31 1.228-2.075l1.613-.269a.999.999 0 0 0 .835-.986V9.847a.999.999 0 0 0-.836-.986zM11 15a4 4 0 1 1 0-8 4 4 0 0 1 0 8z"/></svg>'},{}],fMoi9:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m19.41 20.09-4.58-4.59 4.58-4.59L18 9.5l-6 6 6 6z" fill="#fff"/></svg>'},{}],auIjA:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="m12.59 20.34 4.58-4.59-4.58-4.59L14 9.75l6 6-6 6z" fill="#fff"/></svg>'},{}],g3V1U:[function(O,C,_){C.exports='<svg height="24" width="24"><path d="M10 8v8l6-4-6-4zM6.3 5l-.6-.8C7.2 3 9 2.2 11 2l.1 1c-1.8.2-3.4.9-4.8 2zM5 6.3l-.8-.6C3 7.2 2.2 9 2 11l1 .1c.2-1.8.9-3.4 2-4.8zm0 11.4c-1.1-1.4-1.8-3.1-2-4.8L2 13c.2 2 1 3.8 2.2 5.4l.8-.7zm6.1 3.3c-1.8-.2-3.4-.9-4.8-2l-.6.8C7.2 21 9 21.8 11 22l.1-1zM22 12c0-5.2-3.9-9.4-9-10l-.1 1c4.6.5 8.1 4.3 8.1 9s-3.5 8.5-8.1 9l.1 1c5.2-.5 9-4.8 9-10z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],"3LQJt":[function(O,C,_){C.exports=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 88 88" style="width:100%;height:100%;transform:translate(0,0)"><defs><clipPath id="__lottie_element_216"><path d="M0 0h88v88H0z"/></clipPath></defs><g style="display:block" clip-path="url('#__lottie_element_216')"><path fill="#FFF" d="m12.438-12.702-2.82 2.82c-.79.79-.79 2.05 0 2.83l7.07 7.07-7.07 7.07c-.79.79-.79 2.05 0 2.83l2.82 2.83c.79.78 2.05.78 2.83 0l11.32-11.31c.78-.78.78-2.05 0-2.83l-11.32-11.31c-.78-.79-2.04-.79-2.83 0zm-24.88 0c-.74-.74-1.92-.78-2.7-.12l-.13.12-11.31 11.31a2 2 0 0 0-.12 2.7l.12.13 11.31 11.31a2 2 0 0 0 2.7.12l.13-.12 2.83-2.83c.74-.74.78-1.91.11-2.7l-.11-.13-7.07-7.07 7.07-7.07c.74-.74.78-1.91.11-2.7l-.11-.13-2.83-2.82zM28-28c4.42 0 8 3.58 8 8v40c0 4.42-3.58 8-8 8h-56c-4.42 0-8-3.58-8-8v-40c0-4.42 3.58-8 8-8h56z" style="--darkreader-inline-fill:#a8a6a4" transform="translate(44 44)"/></g></svg>`},{}],bcTkc:[function(O,C,_){C.exports='<svg height="24" width="24"><path d="M15 17h6v1h-6v-1zm-4 0H3v1h8v2h1v-5h-1v2zm3-9h1V3h-1v2H3v1h11v2zm4-3v1h3V5h-3zM6 14h1V9H6v2H3v1h3v2zm4-2h11v-1H10v1z" fill="#fff" style="--darkreader-inline-fill:#a8a6a4"/></svg>'},{}],jDSoL:[function(O,C,_){C.exports='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 36 36" height="32" width="32"><path d="M25 17h-8v6h8v-6Zm4 8V10.98C29 9.88 28.1 9 27 9H9c-1.1 0-2 .88-2 1.98V25c0 1.1.9 2 2 2h18c1.1 0 2-.9 2-2Zm-2 .02H9V10.97h18v14.05Z"/></svg>'},{}],jqFLt:[function(O,C,_){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="M298.667 426.667v-85.334a213.333 213.333 0 1 1 426.666 0v85.334H768A85.333 85.333 0 0 1 853.333 512v256A85.333 85.333 0 0 1 768 853.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667zM512 213.333a128 128 0 0 0-128 128v85.334h256v-85.334a128 128 0 0 0-128-128z" fill="#fff"/></svg>'},{}],"5qYod":[function(O,C,_){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="20" height="20"><path d="m666.752 194.517-49.365 74.112A128 128 0 0 0 384 341.333l.043 85.334h384A85.333 85.333 0 0 1 853.376 512v256a85.333 85.333 0 0 1-85.333 85.333H256A85.333 85.333 0 0 1 170.667 768V512A85.333 85.333 0 0 1 256 426.667h42.667v-85.334a213.333 213.333 0 0 1 368.085-146.816z" fill="#fff"/></svg>'},{}],"25MvP":[function(O,C,_){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M768 298.667h170.667V384h-256V128H768v170.667zM341.333 384h-256v-85.333H256V128h85.333v256zM768 725.333V896h-85.333V640h256v85.333H768zM341.333 640v256H256V725.333H85.333V640h256z"/></svg>'},{}],"6CCX4":[function(O,C,_){C.exports='<svg class="icon" width="22" height="22" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M625.778 256H768v142.222h113.778v-256h-256V256zM256 398.222V256h142.222V142.222h-256v256H256zm512 227.556V768H625.778v113.778h256v-256H768zM398.222 768H256V625.778H142.222v256h256V768z"/></svg>'},{}],m9TwS:[function(O,C,_){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zM896 512a64 64 0 0 1 7.488 127.552L896 640H768v128a64 64 0 0 1-56.512 63.552L704 832a64 64 0 0 1-63.552-56.512L640 768V582.592c0-34.496 25.024-66.112 61.632-70.208l8-.384H896zm-640 0a64 64 0 0 1-7.488-127.552L256 384h128V256a64 64 0 0 1 56.512-63.552L448 192a64 64 0 0 1 63.552 56.512L512 256v185.408c0 34.432-25.024 66.112-61.632 70.144l-8 .448H256z"/></svg>'},{}],iWJrW:[function(O,C,_){C.exports='<svg class="icon" width="18" height="18" viewBox="0 0 1152 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M1075.2 0H76.8A76.8 76.8 0 0 0 0 76.8v870.4a76.8 76.8 0 0 0 76.8 76.8h998.4a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 1075.2 0zM1024 128v768H128V128h896zm-576 64a64 64 0 0 1 7.488 127.552L448 320H320v128a64 64 0 0 1-56.512 63.552L256 512a64 64 0 0 1-63.552-56.512L192 448V262.592c0-34.432 25.024-66.112 61.632-70.144l8-.448H448zm256 640a64 64 0 0 1-7.488-127.552L704 704h128V576a64 64 0 0 1 56.512-63.552L896 512a64 64 0 0 1 63.552 56.512L960 576v185.408c0 34.496-25.024 66.112-61.632 70.208l-8 .384H704z"/></svg>'},{}],"8cFxH":[function(O,C,_){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1664 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#648FFC" d="M1152 0H512a512 512 0 0 0 0 1024h640a512 512 0 0 0 0-1024zm0 960a448 448 0 1 1 448-448 448 448 0 0 1-448 448z"/></svg>'},{}],"6tBmw":[function(O,C,_){C.exports='<svg class="icon" width="26" height="26" viewBox="0 0 1740 1024" xmlns="http://www.w3.org/2000/svg"><path fill="#fff" d="M511.898 1024h670.515c282.419-.41 511.18-229.478 511.18-511.898 0-282.419-228.761-511.488-511.18-511.897H511.898C229.478.615.717 229.683.717 512.102c0 282.42 228.761 511.488 511.18 511.898zm-.564-975.36A464.589 464.589 0 1 1 48.026 513.024 463.872 463.872 0 0 1 511.334 48.435v.205z"/></svg>'},{}],"6N8Hu":[function(O,C,_){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="24" height="24"><path d="M554.667 810.667V896h-85.334v-85.333h85.334zm-384-632.662a42.667 42.667 0 0 1 34.986 18.219l203.904 291.328a42.667 42.667 0 0 1 0 48.896L205.611 827.776A42.667 42.667 0 0 1 128 803.328V220.672a42.667 42.667 0 0 1 42.667-42.667zm682.666 0a42.667 42.667 0 0 1 42.368 37.718l.299 4.949v582.656a42.667 42.667 0 0 1-74.24 28.63l-3.413-4.182-203.904-291.328a42.667 42.667 0 0 1-3.03-43.861l3.03-5.035 203.946-291.328a42.667 42.667 0 0 1 34.944-18.219zM554.667 640v85.333h-85.334V640h85.334zm-358.4-320.896V716.8L335.957 512 196.31 319.104zm358.4 150.23v85.333h-85.334v-85.334h85.334zm0-170.667V384h-85.334v-85.333h85.334zm0-170.667v85.333h-85.334V128h85.334z" fill="#fff"/></svg>'},{}],bNBRZ:[function(O,C,_){C.exports='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="50" height="50"><path d="M593.818 168.55 949.82 763.76c26.153 43.746 10.732 99.738-34.447 125.052-14.397 8.069-30.72 12.308-47.37 12.308H155.976c-52.224 0-94.536-40.96-94.536-91.505 0-16.097 4.383-31.928 12.718-45.875l356.004-595.19c26.173-43.724 84.009-58.654 129.208-33.341a93.082 93.082 0 0 1 34.448 33.341zM512 819.2a61.44 61.44 0 1 0 0-122.88 61.44 61.44 0 0 0 0 122.88zm0-512a72.315 72.315 0 0 0-71.762 81.306l25.723 205.721a46.408 46.408 0 0 0 92.078 0l25.723-205.742A72.315 72.315 0 0 0 512 307.2z"/></svg>'},{}],"8pxPz":[function(O,C,_){C.exports='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="22" height="22"><path d="m571.733 512 268.8-268.8c17.067-17.067 17.067-42.667 0-59.733-17.066-17.067-42.666-17.067-59.733 0L512 452.267l-268.8-268.8c-17.067-17.067-42.667-17.067-59.733 0-17.067 17.066-17.067 42.666 0 59.733l268.8 268.8-268.8 268.8c-17.067 17.067-17.067 42.667 0 59.733 8.533 8.534 19.2 12.8 29.866 12.8s21.334-4.266 29.867-12.8l268.8-268.8 268.8 268.8c8.533 8.534 19.2 12.8 29.867 12.8s21.333-4.266 29.866-12.8c17.067-17.066 17.067-42.666 0-59.733L571.733 512z"/></svg>'},{}],d5XKP:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./flip"),y=S.interopDefault(c),M=O("./aspectRatio"),T=S.interopDefault(M),p=O("./playbackRate"),u=S.interopDefault(p),n=O("./subtitleOffset"),f=S.interopDefault(n),l=O("../utils/component"),h=S.interopDefault(l),v=O("../utils");function d(i,e,a){for(let o=0;o<i.length;o++){const s=i[o];s.$parentItem=e,s.$parentList=a,s.selector&&d(s.selector,s,i)}return i}function r(i){return["string","number"].includes(typeof i)}class t extends h.default{constructor(e){super(e);const{option:a,events:{proxy:o},template:{$setting:s,$player:g}}=e;if(this.name="setting",this.$parent=s,this.option=[],this.events=[],this.cache=new Map,a.setting){a.playbackRate&&this.option.push((0,u.default)(e)),a.aspectRatio&&this.option.push((0,T.default)(e)),a.flip&&this.option.push((0,y.default)(e)),a.subtitleOffset&&this.option.push((0,f.default)(e));for(let L=0;L<a.settings.length;L++)this.option.push(a.settings[L]);this.option=d(this.option),this.init(this.option),e.on("blur",()=>{this.show&&(this.show=!1,this.init(this.option))}),o(g,"click",L=>{!this.show||(0,v.includeFromEvent)(L,e.controls.setting)||(0,v.includeFromEvent)(L,this.$parent)||(this.show=!1,this.init(this.option))})}}add(e){typeof e=="function"?this.option.push(e(this.art)):this.option.push(e),this.cache=new Map,this.events.forEach(a=>a()),this.events=[],this.$parent.innerHTML="",this.option=d(this.option),this.init(this.option)}creatHeader(e){const{icons:a,events:{proxy:o}}=this.art,s=document.createElement("div");(0,v.addClass)(s,"art-setting-item"),(0,v.addClass)(s,"art-setting-item-back");const g=(0,v.append)(s,'<div class="art-setting-item-left"></div>'),L=document.createElement("div");(0,v.addClass)(L,"art-setting-item-left-icon"),(0,v.append)(L,a.arrowLeft),(0,v.append)(g,L),(0,v.append)(g,e.$parentItem.html);const A=o(s,"click",()=>{this.init(e.$parentList)});return this.events.push(A),s}creatItem(e,a){const{icons:o,events:{proxy:s}}=this.art,g=document.createElement("div");(0,v.addClass)(g,"art-setting-item"),r(a.name)&&(g.dataset.name=a.name),r(a.value)&&(g.dataset.value=a.value);const L=(0,v.append)(g,'<div class="art-setting-item-left"></div>'),A=(0,v.append)(g,'<div class="art-setting-item-right"></div>'),m=document.createElement("div");switch((0,v.addClass)(m,"art-setting-item-left-icon"),e){case"switch":case"range":(0,v.append)(m,r(a.icon)||a.icon instanceof Element?a.icon:o.config);break;case"selector":a.selector&&a.selector.length?(0,v.append)(m,r(a.icon)||a.icon instanceof Element?a.icon:o.config):(0,v.append)(m,o.check)}(0,v.append)(L,m),a.$icon=m,(0,v.def)(a,"icon",{configurable:!0,get:()=>m.innerHTML,set(D){r(D)&&(m.innerHTML=D)}});const E=document.createElement("div");(0,v.addClass)(E,"art-setting-item-left-text"),(0,v.append)(E,a.html||""),(0,v.append)(L,E),a.$html=E,(0,v.def)(a,"html",{configurable:!0,get:()=>E.innerHTML,set(D){r(D)&&(E.innerHTML=D)}});const x=document.createElement("div");switch((0,v.addClass)(x,"art-setting-item-right-tooltip"),(0,v.append)(x,a.tooltip||""),(0,v.append)(A,x),a.$tooltip=x,(0,v.def)(a,"tooltip",{configurable:!0,get:()=>x.innerHTML,set(D){r(D)&&(x.innerHTML=D)}}),e){case"switch":{const D=document.createElement("div");(0,v.addClass)(D,"art-setting-item-right-icon");const I=(0,v.append)(D,o.switchOn),b=(0,v.append)(D,o.switchOff);(0,v.setStyle)(a.switch?b:I,"display","none"),(0,v.append)(A,D),a.$switch=a.switch,(0,v.def)(a,"switch",{configurable:!0,get:()=>a.$switch,set(R){a.$switch=R,R?((0,v.setStyle)(b,"display","none"),(0,v.setStyle)(I,"display",null)):((0,v.setStyle)(b,"display",null),(0,v.setStyle)(I,"display","none"))}});break}case"range":{const D=document.createElement("div");(0,v.addClass)(D,"art-setting-item-right-icon");const I=(0,v.append)(D,'<input type="range">');I.value=a.range[0]||0,I.min=a.range[1]||0,I.max=a.range[2]||10,I.step=a.range[3]||1,(0,v.addClass)(I,"art-setting-range"),(0,v.append)(A,D),a.$range=I,(0,v.def)(a,"range",{configurable:!0,get:()=>I.valueAsNumber,set(b){I.value=Number(b)}})}break;case"selector":if(a.selector&&a.selector.length){const D=document.createElement("div");(0,v.addClass)(D,"art-setting-item-right-icon"),(0,v.append)(D,o.arrowRight),(0,v.append)(A,D)}}switch(e){case"switch":if(a.onSwitch){const D=s(g,"click",I=>Ae(this,null,function*(){a.switch=yield a.onSwitch.call(this.art,a,g,I)}));this.events.push(D)}break;case"range":if(a.onRange&&a.$range){const D=s(a.$range,"change",I=>Ae(this,null,function*(){a.tooltip=yield a.onRange.call(this.art,a,g,I)}));this.events.push(D)}break;case"selector":{const D=s(g,"click",I=>Ae(this,null,function*(){if(a.selector&&a.selector.length)this.init(a.selector,a.width);else if((0,v.inverseClass)(g,"art-current"),a.$parentList&&this.init(a.$parentList),a.$parentItem&&a.$parentItem.onSelect){const b=yield a.$parentItem.onSelect.call(this.art,a,g,I);a.$parentItem.$tooltip&&r(b)&&(a.$parentItem.$tooltip.innerHTML=b)}}));this.events.push(D),a.default&&(0,v.addClass)(g,"art-current")}}return g}init(e,a){const{constructor:o}=this.art;if(this.cache.has(e)){const s=this.cache.get(e);(0,v.inverseClass)(s,"art-current"),(0,v.setStyle)(this.$parent,"width",`${s.dataset.width}px`),(0,v.setStyle)(this.$parent,"height",`${s.dataset.height}px`)}else{const s=document.createElement("div");(0,v.addClass)(s,"art-setting-panel"),s.dataset.width=a||o.SETTING_WIDTH,s.dataset.height=e.length*o.SETTING_ITEM_HEIGHT,e[0]&&e[0].$parentItem&&((0,v.append)(s,this.creatHeader(e[0])),s.dataset.height=Number(s.dataset.height)+o.SETTING_ITEM_HEIGHT);for(let g=0;g<e.length;g++){const L=e[g];(0,v.has)(L,"switch")?(0,v.append)(s,this.creatItem("switch",L)):(0,v.has)(L,"range")?(0,v.append)(s,this.creatItem("range",L)):(0,v.append)(s,this.creatItem("selector",L))}(0,v.append)(this.$parent,s),this.cache.set(e,s),(0,v.inverseClass)(s,"art-current"),(0,v.setStyle)(this.$parent,"width",`${s.dataset.width}px`),(0,v.setStyle)(this.$parent,"height",`${s.dataset.height}px`),e[0]&&e[0].$parentItem&&e[0].$parentItem.mounted&&e[0].$parentItem.mounted.call(this.art,s,e[0].$parentItem)}}}_.default=t},{"./flip":"ah3Qs","./aspectRatio":"1gs5B","./playbackRate":"j50mh","./subtitleOffset":"i17b6","../utils/component":"kPHYl","../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],ah3Qs:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,icons:M,constructor:T}=c,p={normal:"Normal",horizontal:"Horizontal",vertical:"Vertical"};function u(n,f,l){f&&(f.innerText=y.get(p[l]));const h=(0,S.queryAll)(".art-setting-item",n).find(v=>v.dataset.value===l);h&&(0,S.inverseClass)(h,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:y.get("Video Flip"),tooltip:y.get(p[c.flip]),icon:M.flip,selector:Object.keys(p).map(n=>({value:n,default:n===c.flip,html:y.get(p[n])})),onSelect(n){c.flip=n.value},mounted:(n,f)=>{u(n,f.$tooltip,c.flip),c.on("flip",()=>{u(n,f.$tooltip,c.flip)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1gs5B":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,icons:M,constructor:T}=c;function p(n){return n==="default"?y.get("Default"):n}function u(n,f,l){f&&(f.innerText=p(l));const h=(0,S.queryAll)(".art-setting-item",n).find(v=>v.dataset.value===l);h&&(0,S.inverseClass)(h,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:y.get("Aspect Ratio"),icon:M.aspectRatio,tooltip:p(c.aspectRatio),selector:["default","4:3","16:9"].map(n=>({value:n,default:n===c.aspectRatio,html:p(n)})),onSelect(n){c.aspectRatio=n.value},mounted:(n,f)=>{u(n,f.$tooltip,c.aspectRatio),c.on("aspectRatio",()=>{u(n,f.$tooltip,c.aspectRatio)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j50mh:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,icons:M,constructor:T}=c;function p(n){return n===1?y.get("Normal"):n}function u(n,f,l){f&&(f.innerText=p(l));const h=(0,S.queryAll)(".art-setting-item",n).find(v=>Number(v.dataset.value)===l);h&&(0,S.inverseClass)(h,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:y.get("Play Speed"),tooltip:p(c.playbackRate),icon:M.playbackRate,selector:[.5,.75,1,1.25,1.5,2].map(n=>({value:n,default:n===c.playbackRate,html:p(n)})),onSelect(n){c.playbackRate=n.value},mounted:(n,f)=>{u(n,f.$tooltip,c.playbackRate),c.on("playbackRate",()=>{u(n,f.$tooltip,c.playbackRate)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],i17b6:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,icons:M,constructor:T}=c;function p(n){return n===0?y.get("Normal"):n}function u(n,f,l){f&&(f.innerText=p(l));const h=(0,S.queryAll)(".art-setting-item",n).find(v=>Number(v.dataset.value)===l);h&&(0,S.inverseClass)(h,"art-current")}return{width:T.SETTING_ITEM_WIDTH,html:y.get("Subtitle Offset"),tooltip:p(c.subtitleOffset),icon:M.subtitle,selector:[-5,-4,-3,-2,-1,0,1,2,3,4,5].map(n=>({value:n,default:n===c.subtitleOffset,html:p(n)})),onSelect(n){c.subtitleOffset=n.value},mounted:(n,f)=>{u(n,f.$tooltip,c.subtitleOffset),c.on("subtitleOffset",()=>{u(n,f.$tooltip,c.subtitleOffset)})}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"5M8nN":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=class{constructor(){this.name="artplayer_settings",this.settings={}}get(S){try{const c=JSON.parse(window.localStorage.getItem(this.name))||{};return S?c[S]:c}catch(c){return S?this.settings[S]:this.settings}}set(S,c){try{const y=Object.assign({},this.get(),{[S]:c});window.localStorage.setItem(this.name,JSON.stringify(y))}catch(y){this.settings[S]=c}}del(S){try{const c=this.get();delete c[S],window.localStorage.setItem(this.name,JSON.stringify(c))}catch(c){delete this.settings[S]}}clear(){try{window.localStorage.removeItem(this.name)}catch(S){this.settings={}}}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],jWfEd:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("../utils"),y=O("./miniProgressBar"),M=S.interopDefault(y),T=O("./autoOrientation"),p=S.interopDefault(T),u=O("./autoPlayback"),n=S.interopDefault(u),f=O("./fastForward"),l=S.interopDefault(f),h=O("./lock"),v=S.interopDefault(h);_.default=class{constructor(d){this.art=d,this.id=0;const{option:r}=d;r.miniProgressBar&&!r.isLive&&this.add(M.default),r.lock&&c.isMobile&&this.add(v.default),r.autoPlayback&&this.add(n.default),r.autoOrientation&&c.isMobile&&this.add(p.default),r.fastForward&&c.isMobile&&!r.isLive&&this.add(l.default);for(let t=0;t<r.plugins.length;t++)this.add(r.plugins[t])}add(d){this.id+=1;const r=d.call(this,this.art),t=r&&r.name||d.name||`plugin${this.id}`;return(0,c.errorHandle)(!(0,c.has)(this,t),`Cannot add a plugin that already has the same name: ${t}`),(0,c.def)(this,t,{value:r}),this}}},{"../utils":"geSvU","./miniProgressBar":"7KBj0","./autoOrientation":"aPIVP","./autoPlayback":"j87OI","./fastForward":"1VTki","./lock":"7BtoE","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7KBj0":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_),_.default=function(S){return S.on("ready",()=>{S.layers.add({name:"miniProgressBar",mounted(c){S.on("destroy",()=>{c.style.display="none"}),S.on("video:timeupdate",()=>{c.style.width=100*S.played+"%"}),S.on("setBar",(y,M)=>{y==="played"&&(c.style.width=100*M+"%")})}})}),{name:"miniProgressBar"}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],aPIVP:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{option:y,constructor:M,template:{$player:T,$video:p}}=c;return c.on("fullscreenWeb",u=>{if(u){const{videoWidth:n,videoHeight:f}=p,{clientWidth:l,clientHeight:h}=document.documentElement;(n>f&&l<h||n<f&&l>h)&&setTimeout(()=>{(0,S.setStyle)(T,"width",`${h}px`),(0,S.setStyle)(T,"height",`${l}px`),(0,S.setStyle)(T,"transform-origin","0 0"),(0,S.setStyle)(T,"transform",`rotate(90deg) translate(0, -${l}px)`),(0,S.addClass)(T,"art-auto-orientation"),c.emit("resize")},M.MOBILE_AUTO_ORIENTATION_TIME)}else(0,S.hasClass)(T,"art-auto-orientation")&&((0,S.setStyle)(T,"width",null),(0,S.setStyle)(T,"height",null),(0,S.setStyle)(T,"transform",null),(0,S.setStyle)(T,"transform-origin",null),(0,S.removeClass)(T,"art-auto-orientation"),c.aspectRatioReset=!0,c.autoSize=y.autoSize,c.notice.show="",c.emit("resize"))}),c.on("fullscreen",u=>Ae(this,null,function*(){const n=screen.orientation.type;if(u){const{videoWidth:f,videoHeight:l}=p,{clientWidth:h,clientHeight:v}=document.documentElement;if(f>l&&h<v||f<l&&h>v){const d=n.startsWith("portrait")?"landscape":"portrait";yield screen.orientation.lock(d),(0,S.addClass)(T,"art-auto-orientation-fullscreen")}}else(0,S.hasClass)(T,"art-auto-orientation-fullscreen")&&(yield screen.orientation.lock(n),(0,S.removeClass)(T,"art-auto-orientation-fullscreen"))})),{name:"autoOrientation",get state(){return(0,S.hasClass)(T,"art-auto-orientation")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],j87OI:[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{i18n:y,icons:M,storage:T,constructor:p,events:{proxy:u},template:{$poster:n}}=c,f=c.layers.add({name:"autoPlayback",html:'<div class="art-autoPlayback-close"></div><div class="art-autoPlayback-last"></div><div class="art-autoPlayback-jump"></div>'}),l=(0,S.query)(".art-autoPlayback-last",f),h=(0,S.query)(".art-autoPlayback-jump",f),v=(0,S.query)(".art-autoPlayback-close",f);return c.on("video:timeupdate",()=>{const d=T.get("times")||{},r=Object.keys(d);r.length>p.AUTO_PLAYBACK_MAX&&delete d[r[0]],d[c.option.url]=c.currentTime,T.set("times",d)}),c.on("ready",()=>{const d=(T.get("times")||{})[c.option.url];d&&((0,S.append)(v,M.close),(0,S.setStyle)(f,"display","flex"),l.innerText=`${y.get("Last Seen")} ${(0,S.secondToTime)(d)}`,h.innerText=y.get("Jump Play"),u(v,"click",()=>{(0,S.setStyle)(f,"display","none")}),u(h,"click",()=>{c.seek=d,c.play(),(0,S.setStyle)(n,"display","none"),(0,S.setStyle)(f,"display","none")}),c.once("video:timeupdate",()=>{setTimeout(()=>{(0,S.setStyle)(f,"display","none")},p.AUTO_PLAYBACK_TIMEOUT)}))}),{name:"autoPlayback",get times(){return T.get("times")||{}},clear:()=>T.del("times")}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"1VTki":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{constructor:y,events:{proxy:M},template:{$player:T,$video:p}}=c;let u=null,n=!1;const f=()=>{clearTimeout(u),n&&(n=!1,c.playbackRate=1,(0,S.removeClass)(T,"art-fast-forward"))};return M(p,"touchstart",l=>{l.touches.length===1&&c.playing&&!c.isLock&&(u=setTimeout(()=>{n=!0,c.playbackRate=y.FAST_FORWARD_VALUE,(0,S.addClass)(T,"art-fast-forward")},y.FAST_FORWARD_TIME))}),M(document,"touchmove",f),M(document,"touchend",f),{name:"fastForward",get state(){return(0,S.hasClass)(T,"art-fast-forward")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],"7BtoE":[function(O,C,_){O("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(_);var S=O("../utils");_.default=function(c){const{layers:y,icons:M,template:{$player:T}}=c;return y.add({name:"lock",mounted(p){const u=(0,S.append)(p,M.lock),n=(0,S.append)(p,M.unlock);(0,S.setStyle)(u,"display","none"),c.on("lock",f=>{f?((0,S.setStyle)(u,"display","inline-flex"),(0,S.setStyle)(n,"display","none")):((0,S.setStyle)(u,"display","none"),(0,S.setStyle)(n,"display","inline-flex"))})},click(){(0,S.hasClass)(T,"art-lock")?((0,S.removeClass)(T,"art-lock"),this.isLock=!1,c.emit("lock",!1)):((0,S.addClass)(T,"art-lock"),this.isLock=!0,c.emit("lock",!0))}}),{name:"lock",get state(){return(0,S.hasClass)(T,"art-lock")}}}},{"../utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}],fkUkB:[function(O,C,_){var S=O("@parcel/transformer-js/src/esmodule-helpers.js");S.defineInteropFlag(_);var c=O("./config"),y=S.interopDefault(c),M=O("./utils");_.default=class{constructor(T){const{option:p,events:{proxy:u},template:{$video:n}}=T;for(let h=0;h<y.default.events.length;h++)u(n,y.default.events[h],v=>{T.emit(`video:${v.type}`,v)});Object.keys(p.moreVideoAttr).forEach(h=>{n[h]=p.moreVideoAttr[h]}),p.muted&&(n.muted=p.muted),p.volume&&(n.volume=(0,M.clamp)(p.volume,0,1)),p.poster&&(n.poster=p.poster),p.autoplay&&(n.autoplay=p.autoplay),p.playsInline&&(n.playsInline=!0,n["webkit-playsinline"]=!0);const f=p.type||(0,M.getExt)(p.url),l=p.customType[f];f&&l?(l(n,p.url,T),T.emit("customType",f)):(n.src=p.url,T.emit("url",n.src))}}},{"./config":"eksZR","./utils":"geSvU","@parcel/transformer-js/src/esmodule-helpers.js":"fRZO2"}]},["6SN6P"],"6SN6P")})(Xe);var kt=We(Xe.exports);const Bt={style:{transform:"scale(-1,1)"},height:"25",width:"25",viewBox:"0 0 22 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Ut=ye("path",{d:"M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"},null,-1),jt=[Ut];function Nt(he,ve){return ke(),Be("svg",Bt,jt)}var Kt={name:"custom-prev",render:Nt};const Wt={height:"25",width:"25",viewBox:"0 0 22 22",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Gt=ye("path",{d:"M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"},null,-1),zt=[Gt];function Vt(he,ve){return ke(),Be("svg",Wt,zt)}var Ht={name:"custom-next",render:Vt},Je={exports:{}};(function(he,ve){(function(C,_){he.exports=_()})(self,function(){return function(){var O={"./node_modules/es6-promise/dist/es6-promise.js":function(c,y,M){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(T,p){c.exports=p()})(this,function(){function T(W){var z=typeof W;return W!==null&&(z==="object"||z==="function")}function p(W){return typeof W=="function"}var u=void 0;Array.isArray?u=Array.isArray:u=function(W){return Object.prototype.toString.call(W)==="[object Array]"};var n=u,f=0,l=void 0,h=void 0,v=function(z,V){E[f]=z,E[f+1]=V,f+=2,f===2&&(h?h(x):I())};function d(W){h=W}function r(W){v=W}var t=typeof window!="undefined"?window:void 0,i=t||{},e=i.MutationObserver||i.WebKitMutationObserver,a=typeof self=="undefined"&&typeof process!="undefined"&&{}.toString.call(process)==="[object process]",o=typeof Uint8ClampedArray!="undefined"&&typeof importScripts!="undefined"&&typeof MessageChannel!="undefined";function s(){return function(){return process.nextTick(x)}}function g(){return typeof l!="undefined"?function(){l(x)}:m()}function L(){var W=0,z=new e(x),V=document.createTextNode("");return z.observe(V,{characterData:!0}),function(){V.data=W=++W%2}}function A(){var W=new MessageChannel;return W.port1.onmessage=x,function(){return W.port2.postMessage(0)}}function m(){var W=setTimeout;return function(){return W(x,1)}}var E=new Array(1e3);function x(){for(var W=0;W<f;W+=2){var z=E[W],V=E[W+1];z(V),E[W]=void 0,E[W+1]=void 0}f=0}function D(){try{var W=Function("return this")().require("vertx");return l=W.runOnLoop||W.runOnContext,g()}catch(z){return m()}}var I=void 0;a?I=s():e?I=L():o?I=A():t===void 0?I=D():I=m();function b(W,z){var V=this,X=new this.constructor(w);X[P]===void 0&&oe(X);var H=V._state;if(H){var re=arguments[H-1];v(function(){return ie(H,X,re,V._result)})}else q(V,X,W,z);return X}function R(W){var z=this;if(W&&typeof W=="object"&&W.constructor===z)return W;var V=new z(w);return Y(V,W),V}var P=Math.random().toString(36).substring(2);function w(){}var F=void 0,k=1,B=2;function U(){return new TypeError("You cannot resolve a promise with itself")}function j(){return new TypeError("A promises callback cannot return that same promise.")}function K(W,z,V,X){try{W.call(z,V,X)}catch(H){return H}}function N(W,z,V){v(function(X){var H=!1,re=K(V,z,function(ce){H||(H=!0,z!==ce?Y(X,ce):Q(X,ce))},function(ce){H||(H=!0,G(X,ce))},"Settle: "+(X._label||" unknown promise"));!H&&re&&(H=!0,G(X,re))},W)}function Z(W,z){z._state===k?Q(W,z._result):z._state===B?G(W,z._result):q(z,void 0,function(V){return Y(W,V)},function(V){return G(W,V)})}function $(W,z,V){z.constructor===W.constructor&&V===b&&z.constructor.resolve===R?Z(W,z):V===void 0?Q(W,z):p(V)?N(W,z,V):Q(W,z)}function Y(W,z){if(W===z)G(W,U());else if(T(z)){var V=void 0;try{V=z.then}catch(X){G(W,X);return}$(W,z,V)}else Q(W,z)}function ee(W){W._onerror&&W._onerror(W._result),te(W)}function Q(W,z){W._state===F&&(W._result=z,W._state=k,W._subscribers.length!==0&&v(te,W))}function G(W,z){W._state===F&&(W._state=B,W._result=z,v(ee,W))}function q(W,z,V,X){var H=W._subscribers,re=H.length;W._onerror=null,H[re]=z,H[re+k]=V,H[re+B]=X,re===0&&W._state&&v(te,W)}function te(W){var z=W._subscribers,V=W._state;if(z.length!==0){for(var X=void 0,H=void 0,re=W._result,ce=0;ce<z.length;ce+=3)X=z[ce],H=z[ce+V],X?ie(V,X,H,re):H(re);W._subscribers.length=0}}function ie(W,z,V,X){var H=p(V),re=void 0,ce=void 0,_e=!0;if(H){try{re=V(X)}catch(Se){_e=!1,ce=Se}if(z===re){G(z,j());return}}else re=X;z._state!==F||(H&&_e?Y(z,re):_e===!1?G(z,ce):W===k?Q(z,re):W===B&&G(z,re))}function ne(W,z){try{z(function(X){Y(W,X)},function(X){G(W,X)})}catch(V){G(W,V)}}var le=0;function ae(){return le++}function oe(W){W[P]=le++,W._state=void 0,W._result=void 0,W._subscribers=[]}function J(){return new Error("Array Methods must be provided an Array")}var se=function(){function W(z,V){this._instanceConstructor=z,this.promise=new z(w),this.promise[P]||oe(this.promise),n(V)?(this.length=V.length,this._remaining=V.length,this._result=new Array(this.length),this.length===0?Q(this.promise,this._result):(this.length=this.length||0,this._enumerate(V),this._remaining===0&&Q(this.promise,this._result))):G(this.promise,J())}return W.prototype._enumerate=function(V){for(var X=0;this._state===F&&X<V.length;X++)this._eachEntry(V[X],X)},W.prototype._eachEntry=function(V,X){var H=this._instanceConstructor,re=H.resolve;if(re===R){var ce=void 0,_e=void 0,Se=!1;try{ce=V.then}catch(Le){Se=!0,_e=Le}if(ce===b&&V._state!==F)this._settledAt(V._state,X,V._result);else if(typeof ce!="function")this._remaining--,this._result[X]=V;else if(H===pe){var Me=new H(w);Se?G(Me,_e):$(Me,V,ce),this._willSettleAt(Me,X)}else this._willSettleAt(new H(function(Le){return Le(V)}),X)}else this._willSettleAt(re(V),X)},W.prototype._settledAt=function(V,X,H){var re=this.promise;re._state===F&&(this._remaining--,V===B?G(re,H):this._result[X]=H),this._remaining===0&&Q(re,this._result)},W.prototype._willSettleAt=function(V,X){var H=this;q(V,void 0,function(re){return H._settledAt(k,X,re)},function(re){return H._settledAt(B,X,re)})},W}();function fe(W){return new se(this,W).promise}function de(W){var z=this;return n(W)?new z(function(V,X){for(var H=W.length,re=0;re<H;re++)z.resolve(W[re]).then(V,X)}):new z(function(V,X){return X(new TypeError("You must pass an array to race."))})}function ge(W){var z=this,V=new z(w);return G(V,W),V}function ue(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function De(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var pe=function(){function W(z){this[P]=ae(),this._result=this._state=void 0,this._subscribers=[],w!==z&&(typeof z!="function"&&ue(),this instanceof W?ne(this,z):De())}return W.prototype.catch=function(V){return this.then(null,V)},W.prototype.finally=function(V){var X=this,H=X.constructor;return p(V)?X.then(function(re){return H.resolve(V()).then(function(){return re})},function(re){return H.resolve(V()).then(function(){throw re})}):X.then(V,V)},W}();pe.prototype.then=b,pe.all=fe,pe.race=de,pe.resolve=R,pe.reject=ge,pe._setScheduler=d,pe._setAsap=r,pe._asap=v;function Te(){var W=void 0;if(typeof M.g!="undefined")W=M.g;else if(typeof self!="undefined")W=self;else try{W=Function("return this")()}catch(X){throw new Error("polyfill failed because global object is unavailable in this environment")}var z=W.Promise;if(z){var V=null;try{V=Object.prototype.toString.call(z.resolve())}catch(X){}if(V==="[object Promise]"&&!z.cast)return}W.Promise=pe}return pe.polyfill=Te,pe.Promise=pe,pe})},"./node_modules/events/events.js":function(c){var y=typeof Reflect=="object"?Reflect:null,M=y&&typeof y.apply=="function"?y.apply:function(m,E,x){return Function.prototype.apply.call(m,E,x)},T;y&&typeof y.ownKeys=="function"?T=y.ownKeys:Object.getOwnPropertySymbols?T=function(m){return Object.getOwnPropertyNames(m).concat(Object.getOwnPropertySymbols(m))}:T=function(m){return Object.getOwnPropertyNames(m)};function p(A){console&&console.warn&&console.warn(A)}var u=Number.isNaN||function(m){return m!==m};function n(){n.init.call(this)}c.exports=n,c.exports.once=s,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var f=10;function l(A){if(typeof A!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof A)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(A){if(typeof A!="number"||A<0||u(A))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+A+".");f=A}}),n.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(m){if(typeof m!="number"||m<0||u(m))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+m+".");return this._maxListeners=m,this};function h(A){return A._maxListeners===void 0?n.defaultMaxListeners:A._maxListeners}n.prototype.getMaxListeners=function(){return h(this)},n.prototype.emit=function(m){for(var E=[],x=1;x<arguments.length;x++)E.push(arguments[x]);var D=m==="error",I=this._events;if(I!==void 0)D=D&&I.error===void 0;else if(!D)return!1;if(D){var b;if(E.length>0&&(b=E[0]),b instanceof Error)throw b;var R=new Error("Unhandled error."+(b?" ("+b.message+")":""));throw R.context=b,R}var P=I[m];if(P===void 0)return!1;if(typeof P=="function")M(P,this,E);else for(var w=P.length,F=e(P,w),x=0;x<w;++x)M(F[x],this,E);return!0};function v(A,m,E,x){var D,I,b;if(l(E),I=A._events,I===void 0?(I=A._events=Object.create(null),A._eventsCount=0):(I.newListener!==void 0&&(A.emit("newListener",m,E.listener?E.listener:E),I=A._events),b=I[m]),b===void 0)b=I[m]=E,++A._eventsCount;else if(typeof b=="function"?b=I[m]=x?[E,b]:[b,E]:x?b.unshift(E):b.push(E),D=h(A),D>0&&b.length>D&&!b.warned){b.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+b.length+" "+String(m)+" listeners added. Use emitter.setMaxListeners() to increase limit");R.name="MaxListenersExceededWarning",R.emitter=A,R.type=m,R.count=b.length,p(R)}return A}n.prototype.addListener=function(m,E){return v(this,m,E,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(m,E){return v(this,m,E,!0)};function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(A,m,E){var x={fired:!1,wrapFn:void 0,target:A,type:m,listener:E},D=d.bind(x);return D.listener=E,x.wrapFn=D,D}n.prototype.once=function(m,E){return l(E),this.on(m,r(this,m,E)),this},n.prototype.prependOnceListener=function(m,E){return l(E),this.prependListener(m,r(this,m,E)),this},n.prototype.removeListener=function(m,E){var x,D,I,b,R;if(l(E),D=this._events,D===void 0)return this;if(x=D[m],x===void 0)return this;if(x===E||x.listener===E)--this._eventsCount===0?this._events=Object.create(null):(delete D[m],D.removeListener&&this.emit("removeListener",m,x.listener||E));else if(typeof x!="function"){for(I=-1,b=x.length-1;b>=0;b--)if(x[b]===E||x[b].listener===E){R=x[b].listener,I=b;break}if(I<0)return this;I===0?x.shift():a(x,I),x.length===1&&(D[m]=x[0]),D.removeListener!==void 0&&this.emit("removeListener",m,R||E)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(m){var E,x,D;if(x=this._events,x===void 0)return this;if(x.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):x[m]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete x[m]),this;if(arguments.length===0){var I=Object.keys(x),b;for(D=0;D<I.length;++D)b=I[D],b!=="removeListener"&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(E=x[m],typeof E=="function")this.removeListener(m,E);else if(E!==void 0)for(D=E.length-1;D>=0;D--)this.removeListener(m,E[D]);return this};function t(A,m,E){var x=A._events;if(x===void 0)return[];var D=x[m];return D===void 0?[]:typeof D=="function"?E?[D.listener||D]:[D]:E?o(D):e(D,D.length)}n.prototype.listeners=function(m){return t(this,m,!0)},n.prototype.rawListeners=function(m){return t(this,m,!1)},n.listenerCount=function(A,m){return typeof A.listenerCount=="function"?A.listenerCount(m):i.call(A,m)},n.prototype.listenerCount=i;function i(A){var m=this._events;if(m!==void 0){var E=m[A];if(typeof E=="function")return 1;if(E!==void 0)return E.length}return 0}n.prototype.eventNames=function(){return this._eventsCount>0?T(this._events):[]};function e(A,m){for(var E=new Array(m),x=0;x<m;++x)E[x]=A[x];return E}function a(A,m){for(;m+1<A.length;m++)A[m]=A[m+1];A.pop()}function o(A){for(var m=new Array(A.length),E=0;E<m.length;++E)m[E]=A[E].listener||A[E];return m}function s(A,m){return new Promise(function(E,x){function D(b){A.removeListener(m,I),x(b)}function I(){typeof A.removeListener=="function"&&A.removeListener("error",D),E([].slice.call(arguments))}L(A,m,I,{once:!0}),m!=="error"&&g(A,D,{once:!0})})}function g(A,m,E){typeof A.on=="function"&&L(A,"error",m,E)}function L(A,m,E,x){if(typeof A.on=="function")x.once?A.once(m,E):A.on(m,E);else if(typeof A.addEventListener=="function")A.addEventListener(m,function D(I){x.once&&A.removeEventListener(m,D),E(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof A)}},"./node_modules/webworkify-webpack/index.js":function(c,y,M){function T(d){var r={};function t(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return d[e].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=d,t.c=r,t.i=function(e){return e},t.d=function(e,a,o){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:o})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)},t.p="/",t.oe=function(e){throw console.error(e),e};var i=t(t.s=ENTRY_MODULE);return i.default||i}var p="[\\.|\\-|\\+|\\w|/|@]+",u="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+p+").*?\\)";function n(d){return(d+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function f(d){return!isNaN(1*d)}function l(d,r,t){var i={};i[t]=[];var e=r.toString(),a=e.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!a)return i;for(var o=a[1],s=new RegExp("(\\\\n|\\W)"+n(o)+u,"g"),g;g=s.exec(e);)g[3]!=="dll-reference"&&i[t].push(g[3]);for(s=new RegExp("\\("+n(o)+'\\("(dll-reference\\s('+p+'))"\\)\\)'+u,"g");g=s.exec(e);)d[g[2]]||(i[t].push(g[1]),d[g[2]]=M(g[1]).m),i[g[2]]=i[g[2]]||[],i[g[2]].push(g[4]);for(var L=Object.keys(i),A=0;A<L.length;A++)for(var m=0;m<i[L[A]].length;m++)f(i[L[A]][m])&&(i[L[A]][m]=1*i[L[A]][m]);return i}function h(d){var r=Object.keys(d);return r.reduce(function(t,i){return t||d[i].length>0},!1)}function v(d,r){for(var t={main:[r]},i={main:[]},e={main:{}};h(t);)for(var a=Object.keys(t),o=0;o<a.length;o++){var s=a[o],g=t[s],L=g.pop();if(e[s]=e[s]||{},!(e[s][L]||!d[s][L])){e[s][L]=!0,i[s]=i[s]||[],i[s].push(L);for(var A=l(d,d[s][L],s),m=Object.keys(A),E=0;E<m.length;E++)t[m[E]]=t[m[E]]||[],t[m[E]]=t[m[E]].concat(A[m[E]])}}return i}c.exports=function(d,r){r=r||{};var t={main:M.m},i=r.all?{main:Object.keys(t.main)}:v(t,d),e="";Object.keys(i).filter(function(L){return L!=="main"}).forEach(function(L){for(var A=0;i[L][A];)A++;i[L].push(A),t[L][A]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",e=e+"var "+L+" = ("+T.toString().replace("ENTRY_MODULE",JSON.stringify(A))+")({"+i[L].map(function(m){return""+JSON.stringify(m)+": "+t[L][m].toString()}).join(",")+`});
`}),e=e+"new (("+T.toString().replace("ENTRY_MODULE",JSON.stringify(d))+")({"+i.main.map(function(L){return""+JSON.stringify(L)+": "+t.main[L].toString()}).join(",")+"}))(self);";var a=new window.Blob([e],{type:"text/javascript"});if(r.bare)return a;var o=window.URL||window.webkitURL||window.mozURL||window.msURL,s=o.createObjectURL(a),g=new window.Worker(s);return g.objectURL=s,g}},"./src/config.js":function(c,y,M){M.r(y),M.d(y,{defaultConfig:function(){return T},createDefaultConfig:function(){return p}});var T={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,lazyLoad:!0,lazyLoadMaxDuration:3*60,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:3*60,autoCleanupMinBackwardDuration:2*60,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function p(){return Object.assign({},T)}},"./src/core/features.js":function(c,y,M){M.r(y);var T=M("./src/io/io-controller.js"),p=M("./src/config.js"),u=function(){function n(){}return n.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},n.supportNetworkStreamIO=function(){var f=new T.default({},(0,p.createDefaultConfig)()),l=f.loaderType;return f.destroy(),l=="fetch-stream-loader"||l=="xhr-moz-chunked-loader"},n.getNetworkLoaderTypeName=function(){var f=new T.default({},(0,p.createDefaultConfig)()),l=f.loaderType;return f.destroy(),l},n.supportNativeMediaPlayback=function(f){n.videoElement==null&&(n.videoElement=window.document.createElement("video"));var l=n.videoElement.canPlayType(f);return l==="probably"||l=="maybe"},n.getFeatureList=function(){var f={mseFlvPlayback:!1,mseLiveFlvPlayback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return f.mseFlvPlayback=n.supportMSEH264Playback(),f.networkStreamIO=n.supportNetworkStreamIO(),f.networkLoaderName=n.getNetworkLoaderTypeName(),f.mseLiveFlvPlayback=f.mseFlvPlayback&&f.networkStreamIO,f.nativeMP4H264Playback=n.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),f.nativeWebmVP8Playback=n.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),f.nativeWebmVP9Playback=n.supportNativeMediaPlayback('video/webm; codecs="vp9"'),f},n}();y.default=u},"./src/core/media-info.js":function(c,y,M){M.r(y);var T=function(){function p(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return p.prototype.isComplete=function(){var u=this.hasAudio===!1||this.hasAudio===!0&&this.audioCodec!=null&&this.audioSampleRate!=null&&this.audioChannelCount!=null,n=this.hasVideo===!1||this.hasVideo===!0&&this.videoCodec!=null&&this.width!=null&&this.height!=null&&this.fps!=null&&this.profile!=null&&this.level!=null&&this.refFrames!=null&&this.chromaFormat!=null&&this.sarNum!=null&&this.sarDen!=null;return this.mimeType!=null&&this.duration!=null&&this.metadata!=null&&this.hasKeyframesIndex!=null&&u&&n},p.prototype.isSeekable=function(){return this.hasKeyframesIndex===!0},p.prototype.getNearestKeyframe=function(u){if(this.keyframesIndex==null)return null;var n=this.keyframesIndex,f=this._search(n.times,u);return{index:f,milliseconds:n.times[f],fileposition:n.filepositions[f]}},p.prototype._search=function(u,n){var f=0,l=u.length-1,h=0,v=0,d=l;for(n<u[0]&&(f=0,v=d+1);v<=d;)if(h=v+Math.floor((d-v)/2),h===l||n>=u[h]&&n<u[h+1]){f=h;break}else u[h]<n?v=h+1:d=h-1;return f},p}();y.default=T},"./src/core/media-segment-info.js":function(c,y,M){M.r(y),M.d(y,{SampleInfo:function(){return T},MediaSegmentInfo:function(){return p},IDRSampleList:function(){return u},MediaSegmentInfoList:function(){return n}});var T=function(){function f(l,h,v,d,r){this.dts=l,this.pts=h,this.duration=v,this.originalDts=d,this.isSyncPoint=r,this.fileposition=null}return f}(),p=function(){function f(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return f.prototype.appendSyncPoint=function(l){l.isSyncPoint=!0,this.syncPoints.push(l)},f}(),u=function(){function f(){this._list=[]}return f.prototype.clear=function(){this._list=[]},f.prototype.appendArray=function(l){var h=this._list;l.length!==0&&(h.length>0&&l[0].originalDts<h[h.length-1].originalDts&&this.clear(),Array.prototype.push.apply(h,l))},f.prototype.getLastSyncPointBeforeDts=function(l){if(this._list.length==0)return null;var h=this._list,v=0,d=h.length-1,r=0,t=0,i=d;for(l<h[0].dts&&(v=0,t=i+1);t<=i;)if(r=t+Math.floor((i-t)/2),r===d||l>=h[r].dts&&l<h[r+1].dts){v=r;break}else h[r].dts<l?t=r+1:i=r-1;return this._list[v]},f}(),n=function(){function f(l){this._type=l,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(f.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),f.prototype.isEmpty=function(){return this._list.length===0},f.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},f.prototype._searchNearestSegmentBefore=function(l){var h=this._list;if(h.length===0)return-2;var v=h.length-1,d=0,r=0,t=v,i=0;if(l<h[0].originalBeginDts)return i=-1,i;for(;r<=t;)if(d=r+Math.floor((t-r)/2),d===v||l>h[d].lastSample.originalDts&&l<h[d+1].originalBeginDts){i=d;break}else h[d].originalBeginDts<l?r=d+1:t=d-1;return i},f.prototype._searchNearestSegmentAfter=function(l){return this._searchNearestSegmentBefore(l)+1},f.prototype.append=function(l){var h=this._list,v=l,d=this._lastAppendLocation,r=0;d!==-1&&d<h.length&&v.originalBeginDts>=h[d].lastSample.originalDts&&(d===h.length-1||d<h.length-1&&v.originalBeginDts<h[d+1].originalBeginDts)?r=d+1:h.length>0&&(r=this._searchNearestSegmentBefore(v.originalBeginDts)+1),this._lastAppendLocation=r,this._list.splice(r,0,v)},f.prototype.getLastSegmentBefore=function(l){var h=this._searchNearestSegmentBefore(l);return h>=0?this._list[h]:null},f.prototype.getLastSampleBefore=function(l){var h=this.getLastSegmentBefore(l);return h!=null?h.lastSample:null},f.prototype.getLastSyncPointBefore=function(l){for(var h=this._searchNearestSegmentBefore(l),v=this._list[h].syncPoints;v.length===0&&h>0;)h--,v=this._list[h].syncPoints;return v.length>0?v[v.length-1]:null},f}()},"./src/core/mse-controller.js":function(c,y,M){M.r(y);var T=M("./node_modules/events/events.js"),p=M.n(T),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),f=M("./src/core/mse-events.js"),l=M("./src/core/media-segment-info.js"),h=M("./src/utils/exception.js"),v=function(){function d(r){this.TAG="MSEController",this._config=r,this._emitter=new(p()),this._config.isLive&&this._config.autoCleanupSourceBuffer==null&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new l.IDRSampleList}return d.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},d.prototype.on=function(r,t){this._emitter.addListener(r,t)},d.prototype.off=function(r,t){this._emitter.removeListener(r,t)},d.prototype.attachMediaElement=function(r){if(this._mediaSource)throw new h.IllegalStateException("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=r,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),r.src=this._mediaSourceObjectURL},d.prototype.detachMediaElement=function(){if(this._mediaSource){var r=this._mediaSource;for(var t in this._sourceBuffers){var i=this._pendingSegments[t];i.splice(0,i.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var e=this._sourceBuffers[t];if(e){if(r.readyState!=="closed"){try{r.removeSourceBuffer(e)}catch(a){u.default.e(this.TAG,a.message)}e.removeEventListener("error",this.e.onSourceBufferError),e.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if(r.readyState==="open")try{r.endOfStream()}catch(a){u.default.e(this.TAG,a.message)}r.removeEventListener("sourceopen",this.e.onSourceOpen),r.removeEventListener("sourceended",this.e.onSourceEnded),r.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},d.prototype.appendInitSegment=function(r,t){if(!this._mediaSource||this._mediaSource.readyState!=="open"){this._pendingSourceBufferInit.push(r),this._pendingSegments[r.type].push(r);return}var i=r,e=""+i.container;i.codec&&i.codec.length>0&&(e+=";codecs="+i.codec);var a=!1;if(u.default.v(this.TAG,"Received Initialization Segment, mimeType: "+e),this._lastInitSegments[i.type]=i,e!==this._mimeTypes[i.type]){if(this._mimeTypes[i.type])u.default.v(this.TAG,"Notice: "+i.type+" mimeType changed, origin: "+this._mimeTypes[i.type]+", target: "+e);else{a=!0;try{var o=this._sourceBuffers[i.type]=this._mediaSource.addSourceBuffer(e);o.addEventListener("error",this.e.onSourceBufferError),o.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(s){u.default.e(this.TAG,s.message),this._emitter.emit(f.default.ERROR,{code:s.code,msg:s.message});return}}this._mimeTypes[i.type]=e}t||this._pendingSegments[i.type].push(i),a||this._sourceBuffers[i.type]&&!this._sourceBuffers[i.type].updating&&this._doAppendSegments(),n.default.safari&&i.container==="audio/mpeg"&&i.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=i.mediaDuration/1e3,this._updateMediaSourceDuration())},d.prototype.appendMediaSegment=function(r){var t=r;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var i=this._sourceBuffers[t.type];i&&!i.updating&&!this._hasPendingRemoveRanges()&&this._doAppendSegments()},d.prototype.seek=function(r){for(var t in this._sourceBuffers)if(!!this._sourceBuffers[t]){var i=this._sourceBuffers[t];if(this._mediaSource.readyState==="open")try{i.abort()}catch(L){u.default.e(this.TAG,L.message)}this._idrList.clear();var e=this._pendingSegments[t];if(e.splice(0,e.length),this._mediaSource.readyState!=="closed"){for(var a=0;a<i.buffered.length;a++){var o=i.buffered.start(a),s=i.buffered.end(a);this._pendingRemoveRanges[t].push({start:o,end:s})}if(i.updating||this._doRemoveRanges(),n.default.safari){var g=this._lastInitSegments[t];g&&(this._pendingSegments[t].push(g),i.updating||this._doAppendSegments())}}}},d.prototype.endOfStream=function(){var r=this._mediaSource,t=this._sourceBuffers;if(!r||r.readyState!=="open"){r&&r.readyState==="closed"&&this._hasPendingSegments()&&(this._hasPendingEos=!0);return}t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,r.endOfStream())},d.prototype.getNearestKeyframe=function(r){return this._idrList.getLastSyncPointBeforeDts(r)},d.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var r=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var i=this._sourceBuffers[t];if(i){var e=i.buffered;if(e.length>=1&&r-e.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},d.prototype._doCleanupSourceBuffer=function(){var r=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var i=this._sourceBuffers[t];if(i){for(var e=i.buffered,a=!1,o=0;o<e.length;o++){var s=e.start(o),g=e.end(o);if(s<=r&&r<g+3){if(r-s>=this._config.autoCleanupMaxBackwardDuration){a=!0;var L=r-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:s,end:L})}}else g<r&&(a=!0,this._pendingRemoveRanges[t].push({start:s,end:g}))}a&&!i.updating&&this._doRemoveRanges()}}},d.prototype._updateMediaSourceDuration=function(){var r=this._sourceBuffers;if(!(this._mediaElement.readyState===0||this._mediaSource.readyState!=="open")&&!(r.video&&r.video.updating||r.audio&&r.audio.updating)){var t=this._mediaSource.duration,i=this._pendingMediaDuration;i>0&&(isNaN(t)||i>t)&&(u.default.v(this.TAG,"Update MediaSource duration from "+t+" to "+i),this._mediaSource.duration=i),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},d.prototype._doRemoveRanges=function(){for(var r in this._pendingRemoveRanges)if(!(!this._sourceBuffers[r]||this._sourceBuffers[r].updating))for(var t=this._sourceBuffers[r],i=this._pendingRemoveRanges[r];i.length&&!t.updating;){var e=i.shift();t.remove(e.start,e.end)}},d.prototype._doAppendSegments=function(){var r=this._pendingSegments;for(var t in r)if(!(!this._sourceBuffers[t]||this._sourceBuffers[t].updating)&&r[t].length>0){var i=r[t].shift();if(i.timestampOffset){var e=this._sourceBuffers[t].timestampOffset,a=i.timestampOffset/1e3,o=Math.abs(e-a);o>.1&&(u.default.v(this.TAG,"Update MPEG audio timestampOffset from "+e+" to "+a),this._sourceBuffers[t].timestampOffset=a),delete i.timestampOffset}if(!i.data||i.data.byteLength===0)continue;try{this._sourceBuffers[t].appendBuffer(i.data),this._isBufferFull=!1,t==="video"&&i.hasOwnProperty("info")&&this._idrList.appendArray(i.info.syncPoints)}catch(s){this._pendingSegments[t].unshift(i),s.code===22?(this._isBufferFull||this._emitter.emit(f.default.BUFFER_FULL),this._isBufferFull=!0):(u.default.e(this.TAG,s.message),this._emitter.emit(f.default.ERROR,{code:s.code,msg:s.message}))}}},d.prototype._onSourceOpen=function(){if(u.default.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var r=this._pendingSourceBufferInit;r.length;){var t=r.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(f.default.SOURCE_OPEN)},d.prototype._onSourceEnded=function(){u.default.v(this.TAG,"MediaSource onSourceEnded")},d.prototype._onSourceClose=function(){u.default.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&this.e!=null&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},d.prototype._hasPendingSegments=function(){var r=this._pendingSegments;return r.video.length>0||r.audio.length>0},d.prototype._hasPendingRemoveRanges=function(){var r=this._pendingRemoveRanges;return r.video.length>0||r.audio.length>0},d.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(f.default.UPDATE_END)},d.prototype._onSourceBufferError=function(r){u.default.e(this.TAG,"SourceBuffer Error: "+r)},d}();y.default=v},"./src/core/mse-events.js":function(c,y,M){M.r(y);var T={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"};y.default=T},"./src/core/transmuxer.js":function(c,y,M){M.r(y);var T=M("./node_modules/events/events.js"),p=M.n(T),u=M("./node_modules/webworkify-webpack/index.js"),n=M.n(u),f=M("./src/utils/logger.js"),l=M("./src/utils/logging-control.js"),h=M("./src/core/transmuxing-controller.js"),v=M("./src/core/transmuxing-events.js"),d=M("./src/core/media-info.js"),r=function(){function t(i,e){if(this.TAG="Transmuxer",this._emitter=new(p()),e.enableWorker&&typeof Worker!="undefined")try{this._worker=n()("./src/core/transmuxing-worker.js"),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[i,e]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},l.default.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:l.default.getConfig()})}catch(o){f.default.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new h.default(i,e)}else this._controller=new h.default(i,e);if(this._controller){var a=this._controller;a.on(v.default.IO_ERROR,this._onIOError.bind(this)),a.on(v.default.DEMUX_ERROR,this._onDemuxError.bind(this)),a.on(v.default.INIT_SEGMENT,this._onInitSegment.bind(this)),a.on(v.default.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),a.on(v.default.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),a.on(v.default.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),a.on(v.default.MEDIA_INFO,this._onMediaInfo.bind(this)),a.on(v.default.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),a.on(v.default.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),a.on(v.default.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),a.on(v.default.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return t.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),l.default.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},t.prototype.on=function(i,e){this._emitter.addListener(i,e)},t.prototype.off=function(i,e){this._emitter.removeListener(i,e)},t.prototype.hasWorker=function(){return this._worker!=null},t.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},t.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},t.prototype.seek=function(i){this._worker?this._worker.postMessage({cmd:"seek",param:i}):this._controller.seek(i)},t.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},t.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},t.prototype._onInitSegment=function(i,e){var a=this;Promise.resolve().then(function(){a._emitter.emit(v.default.INIT_SEGMENT,i,e)})},t.prototype._onMediaSegment=function(i,e){var a=this;Promise.resolve().then(function(){a._emitter.emit(v.default.MEDIA_SEGMENT,i,e)})},t.prototype._onLoadingComplete=function(){var i=this;Promise.resolve().then(function(){i._emitter.emit(v.default.LOADING_COMPLETE)})},t.prototype._onRecoveredEarlyEof=function(){var i=this;Promise.resolve().then(function(){i._emitter.emit(v.default.RECOVERED_EARLY_EOF)})},t.prototype._onMediaInfo=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.MEDIA_INFO,i)})},t.prototype._onMetaDataArrived=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.METADATA_ARRIVED,i)})},t.prototype._onScriptDataArrived=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.SCRIPTDATA_ARRIVED,i)})},t.prototype._onStatisticsInfo=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.STATISTICS_INFO,i)})},t.prototype._onIOError=function(i,e){var a=this;Promise.resolve().then(function(){a._emitter.emit(v.default.IO_ERROR,i,e)})},t.prototype._onDemuxError=function(i,e){var a=this;Promise.resolve().then(function(){a._emitter.emit(v.default.DEMUX_ERROR,i,e)})},t.prototype._onRecommendSeekpoint=function(i){var e=this;Promise.resolve().then(function(){e._emitter.emit(v.default.RECOMMEND_SEEKPOINT,i)})},t.prototype._onLoggingConfigChanged=function(i){this._worker&&this._worker.postMessage({cmd:"logging_config",param:i})},t.prototype._onWorkerMessage=function(i){var e=i.data,a=e.data;if(e.msg==="destroyed"||this._workerDestroying){this._workerDestroying=!1,this._worker.terminate(),this._worker=null;return}switch(e.msg){case v.default.INIT_SEGMENT:case v.default.MEDIA_SEGMENT:this._emitter.emit(e.msg,a.type,a.data);break;case v.default.LOADING_COMPLETE:case v.default.RECOVERED_EARLY_EOF:this._emitter.emit(e.msg);break;case v.default.MEDIA_INFO:Object.setPrototypeOf(a,d.default.prototype),this._emitter.emit(e.msg,a);break;case v.default.METADATA_ARRIVED:case v.default.SCRIPTDATA_ARRIVED:case v.default.STATISTICS_INFO:this._emitter.emit(e.msg,a);break;case v.default.IO_ERROR:case v.default.DEMUX_ERROR:this._emitter.emit(e.msg,a.type,a.info);break;case v.default.RECOMMEND_SEEKPOINT:this._emitter.emit(e.msg,a);break;case"logcat_callback":f.default.emitter.emit("log",a.type,a.logcat);break}},t}();y.default=r},"./src/core/transmuxing-controller.js":function(c,y,M){M.r(y);var T=M("./node_modules/events/events.js"),p=M.n(T),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),f=M("./src/core/media-info.js"),l=M("./src/demux/flv-demuxer.js"),h=M("./src/remux/mp4-remuxer.js"),v=M("./src/demux/demux-errors.js"),d=M("./src/io/io-controller.js"),r=M("./src/core/transmuxing-events.js"),t=function(){function i(e,a){this.TAG="TransmuxingController",this._emitter=new(p()),this._config=a,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),typeof e.cors!="boolean"&&(e.cors=!0),typeof e.withCredentials!="boolean"&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var o=0;this._mediaDataSource.segments.forEach(function(s){s.timestampBase=o,o+=s.duration,s.cors=e.cors,s.withCredentials=e.withCredentials,a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy)}),!isNaN(o)&&this._mediaDataSource.duration!==o&&(this._mediaDataSource.duration=o),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return i.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},i.prototype.on=function(e,a){this._emitter.addListener(e,a)},i.prototype.off=function(e,a){this._emitter.removeListener(e,a)},i.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},i.prototype._loadSegment=function(e,a){this._currentSegmentIndex=e;var o=this._mediaDataSource.segments[e],s=this._ioctl=new d.default(o,this._config,e);s.onError=this._onIOException.bind(this),s.onSeeked=this._onIOSeeked.bind(this),s.onComplete=this._onIOComplete.bind(this),s.onRedirect=this._onIORedirect.bind(this),s.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),a?this._demuxer.bindDataSource(this._ioctl):s.onDataArrival=this._onInitChunkArrival.bind(this),s.open(a)},i.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},i.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},i.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},i.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},i.prototype.seek=function(e){if(!(this._mediaInfo==null||!this._mediaInfo.isSeekable())){var a=this._searchSegmentIndexContains(e);if(a===this._currentSegmentIndex){var o=this._mediaInfo.segments[a];if(o==null)this._pendingSeekTime=e;else{var s=o.getNearestKeyframe(e);this._remuxer.seek(s.milliseconds),this._ioctl.seek(s.fileposition),this._pendingResolveSeekPoint=s.milliseconds}}else{var g=this._mediaInfo.segments[a];if(g==null)this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(a);else{var s=g.getNearestKeyframe(e);this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[a].timestampBase,this._loadSegment(a,s.fileposition),this._pendingResolveSeekPoint=s.milliseconds,this._reportSegmentMediaInfo(a)}}this._enableStatisticsReporter()}},i.prototype._searchSegmentIndexContains=function(e){for(var a=this._mediaDataSource.segments,o=a.length-1,s=0;s<a.length;s++)if(e<a[s].timestampBase){o=s-1;break}return o},i.prototype._onInitChunkArrival=function(e,a){var o=this,s=null,g=0;if(a>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,g=this._demuxer.parseChunks(e,a);else if((s=l.default.probe(e)).match){this._demuxer=new l.default(s,this._config),this._remuxer||(this._remuxer=new h.default(this._config));var L=this._mediaDataSource;L.duration!=null&&!isNaN(L.duration)&&(this._demuxer.overridedDuration=L.duration),typeof L.hasAudio=="boolean"&&(this._demuxer.overridedHasAudio=L.hasAudio),typeof L.hasVideo=="boolean"&&(this._demuxer.overridedHasVideo=L.hasVideo),this._demuxer.timestampBase=L.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this),g=this._demuxer.parseChunks(e,a)}else s=null,u.default.e(this.TAG,"Non-FLV, Unsupported media type!"),Promise.resolve().then(function(){o._internalAbort()}),this._emitter.emit(r.default.DEMUX_ERROR,v.default.FORMAT_UNSUPPORTED,"Non-FLV, Unsupported media type"),g=0;return g},i.prototype._onMediaInfo=function(e){var a=this;this._mediaInfo==null&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,f.default.prototype));var o=Object.assign({},e);Object.setPrototypeOf(o,f.default.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=o,this._reportSegmentMediaInfo(this._currentSegmentIndex),this._pendingSeekTime!=null&&Promise.resolve().then(function(){var s=a._pendingSeekTime;a._pendingSeekTime=null,a.seek(s)})},i.prototype._onMetaDataArrived=function(e){this._emitter.emit(r.default.METADATA_ARRIVED,e)},i.prototype._onScriptDataArrived=function(e){this._emitter.emit(r.default.SCRIPTDATA_ARRIVED,e)},i.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},i.prototype._onIOComplete=function(e){var a=e,o=a+1;o<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer.flushStashedSamples(),this._loadSegment(o)):(this._remuxer.flushStashedSamples(),this._emitter.emit(r.default.LOADING_COMPLETE),this._disableStatisticsReporter())},i.prototype._onIORedirect=function(e){var a=this._ioctl.extraData;this._mediaDataSource.segments[a].redirectedURL=e},i.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(r.default.RECOVERED_EARLY_EOF)},i.prototype._onIOException=function(e,a){u.default.e(this.TAG,"IOException: type = "+e+", code = "+a.code+", msg = "+a.msg),this._emitter.emit(r.default.IO_ERROR,e,a),this._disableStatisticsReporter()},i.prototype._onDemuxException=function(e,a){u.default.e(this.TAG,"DemuxException: type = "+e+", info = "+a),this._emitter.emit(r.default.DEMUX_ERROR,e,a)},i.prototype._onRemuxerInitSegmentArrival=function(e,a){this._emitter.emit(r.default.INIT_SEGMENT,e,a)},i.prototype._onRemuxerMediaSegmentArrival=function(e,a){if(this._pendingSeekTime==null&&(this._emitter.emit(r.default.MEDIA_SEGMENT,e,a),this._pendingResolveSeekPoint!=null&&e==="video")){var o=a.info.syncPoints,s=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,n.default.safari&&o.length>0&&o[0].originalDts===s&&(s=o[0].pts),this._emitter.emit(r.default.RECOMMEND_SEEKPOINT,s)}},i.prototype._enableStatisticsReporter=function(){this._statisticsReporter==null&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},i.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},i.prototype._reportSegmentMediaInfo=function(e){var a=this._mediaInfo.segments[e],o=Object.assign({},a);o.duration=this._mediaInfo.duration,o.segmentCount=this._mediaInfo.segmentCount,delete o.segments,delete o.keyframesIndex,this._emitter.emit(r.default.MEDIA_INFO,o)},i.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(r.default.STATISTICS_INFO,e)},i}();y.default=t},"./src/core/transmuxing-events.js":function(c,y,M){M.r(y);var T={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"};y.default=T},"./src/core/transmuxing-worker.js":function(c,y,M){M.r(y);var T=M("./src/utils/logging-control.js"),p=M("./src/utils/polyfill.js"),u=M("./src/core/transmuxing-controller.js"),n=M("./src/core/transmuxing-events.js"),f=function(l){var h=null,v=m.bind(this);p.default.install(),l.addEventListener("message",function(E){switch(E.data.cmd){case"init":h=new u.default(E.data.param[0],E.data.param[1]),h.on(n.default.IO_ERROR,g.bind(this)),h.on(n.default.DEMUX_ERROR,L.bind(this)),h.on(n.default.INIT_SEGMENT,d.bind(this)),h.on(n.default.MEDIA_SEGMENT,r.bind(this)),h.on(n.default.LOADING_COMPLETE,t.bind(this)),h.on(n.default.RECOVERED_EARLY_EOF,i.bind(this)),h.on(n.default.MEDIA_INFO,e.bind(this)),h.on(n.default.METADATA_ARRIVED,a.bind(this)),h.on(n.default.SCRIPTDATA_ARRIVED,o.bind(this)),h.on(n.default.STATISTICS_INFO,s.bind(this)),h.on(n.default.RECOMMEND_SEEKPOINT,A.bind(this));break;case"destroy":h&&(h.destroy(),h=null),l.postMessage({msg:"destroyed"});break;case"start":h.start();break;case"stop":h.stop();break;case"seek":h.seek(E.data.param);break;case"pause":h.pause();break;case"resume":h.resume();break;case"logging_config":{var x=E.data.param;T.default.applyConfig(x),x.enableCallback===!0?T.default.addLogListener(v):T.default.removeLogListener(v);break}}});function d(E,x){var D={msg:n.default.INIT_SEGMENT,data:{type:E,data:x}};l.postMessage(D,[x.data])}function r(E,x){var D={msg:n.default.MEDIA_SEGMENT,data:{type:E,data:x}};l.postMessage(D,[x.data])}function t(){var E={msg:n.default.LOADING_COMPLETE};l.postMessage(E)}function i(){var E={msg:n.default.RECOVERED_EARLY_EOF};l.postMessage(E)}function e(E){var x={msg:n.default.MEDIA_INFO,data:E};l.postMessage(x)}function a(E){var x={msg:n.default.METADATA_ARRIVED,data:E};l.postMessage(x)}function o(E){var x={msg:n.default.SCRIPTDATA_ARRIVED,data:E};l.postMessage(x)}function s(E){var x={msg:n.default.STATISTICS_INFO,data:E};l.postMessage(x)}function g(E,x){l.postMessage({msg:n.default.IO_ERROR,data:{type:E,info:x}})}function L(E,x){l.postMessage({msg:n.default.DEMUX_ERROR,data:{type:E,info:x}})}function A(E){l.postMessage({msg:n.default.RECOMMEND_SEEKPOINT,data:E})}function m(E,x){l.postMessage({msg:"logcat_callback",data:{type:E,logcat:x}})}};y.default=f},"./src/demux/amf-parser.js":function(c,y,M){M.r(y);var T=M("./src/utils/logger.js"),p=M("./src/utils/utf8-conv.js"),u=M("./src/utils/exception.js"),n=function(){var l=new ArrayBuffer(2);return new DataView(l).setInt16(0,256,!0),new Int16Array(l)[0]===256}(),f=function(){function l(){}return l.parseScriptData=function(h,v,d){var r={};try{var t=l.parseValue(h,v,d),i=l.parseValue(h,v+t.size,d-t.size);r[t.data]=i.data}catch(e){T.default.e("AMF",e.toString())}return r},l.parseObject=function(h,v,d){if(d<3)throw new u.IllegalStateException("Data not enough when parse ScriptDataObject");var r=l.parseString(h,v,d),t=l.parseValue(h,v+r.size,d-r.size),i=t.objectEnd;return{data:{name:r.data,value:t.data},size:r.size+t.size,objectEnd:i}},l.parseVariable=function(h,v,d){return l.parseObject(h,v,d)},l.parseString=function(h,v,d){if(d<2)throw new u.IllegalStateException("Data not enough when parse String");var r=new DataView(h,v,d),t=r.getUint16(0,!n),i;return t>0?i=(0,p.default)(new Uint8Array(h,v+2,t)):i="",{data:i,size:2+t}},l.parseLongString=function(h,v,d){if(d<4)throw new u.IllegalStateException("Data not enough when parse LongString");var r=new DataView(h,v,d),t=r.getUint32(0,!n),i;return t>0?i=(0,p.default)(new Uint8Array(h,v+4,t)):i="",{data:i,size:4+t}},l.parseDate=function(h,v,d){if(d<10)throw new u.IllegalStateException("Data size invalid when parse Date");var r=new DataView(h,v,d),t=r.getFloat64(0,!n),i=r.getInt16(8,!n);return t+=i*60*1e3,{data:new Date(t),size:8+2}},l.parseValue=function(h,v,d){if(d<1)throw new u.IllegalStateException("Data not enough when parse Value");var r=new DataView(h,v,d),t=1,i=r.getUint8(0),e,a=!1;try{switch(i){case 0:e=r.getFloat64(1,!n),t+=8;break;case 1:{var o=r.getUint8(1);e=!!o,t+=1;break}case 2:{var s=l.parseString(h,v+1,d-1);e=s.data,t+=s.size;break}case 3:{e={};var g=0;for((r.getUint32(d-4,!n)&16777215)===9&&(g=3);t<d-4;){var L=l.parseObject(h,v+t,d-t-g);if(L.objectEnd)break;e[L.data.name]=L.data.value,t+=L.size}if(t<=d-3){var A=r.getUint32(t-1,!n)&16777215;A===9&&(t+=3)}break}case 8:{e={},t+=4;var g=0;for((r.getUint32(d-4,!n)&16777215)===9&&(g=3);t<d-8;){var m=l.parseVariable(h,v+t,d-t-g);if(m.objectEnd)break;e[m.data.name]=m.data.value,t+=m.size}if(t<=d-3){var A=r.getUint32(t-1,!n)&16777215;A===9&&(t+=3)}break}case 9:e=void 0,t=1,a=!0;break;case 10:{e=[];var E=r.getUint32(1,!n);t+=4;for(var x=0;x<E;x++){var D=l.parseValue(h,v+t,d-t);e.push(D.data),t+=D.size}break}case 11:{var I=l.parseDate(h,v+1,d-1);e=I.data,t+=I.size;break}case 12:{var b=l.parseString(h,v+1,d-1);e=b.data,t+=b.size;break}default:t=d,T.default.w("AMF","Unsupported AMF value type "+i)}}catch(R){T.default.e("AMF",R.toString())}return{data:e,size:t,objectEnd:a}},l}();y.default=f},"./src/demux/demux-errors.js":function(c,y,M){M.r(y);var T={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"};y.default=T},"./src/demux/exp-golomb.js":function(c,y,M){M.r(y);var T=M("./src/utils/exception.js"),p=function(){function u(n){this.TAG="ExpGolomb",this._buffer=n,this._buffer_index=0,this._total_bytes=n.byteLength,this._total_bits=n.byteLength*8,this._current_word=0,this._current_word_bits_left=0}return u.prototype.destroy=function(){this._buffer=null},u.prototype._fillCurrentWord=function(){var n=this._total_bytes-this._buffer_index;if(n<=0)throw new T.IllegalStateException("ExpGolomb: _fillCurrentWord() but no bytes available");var f=Math.min(4,n),l=new Uint8Array(4);l.set(this._buffer.subarray(this._buffer_index,this._buffer_index+f)),this._current_word=new DataView(l.buffer).getUint32(0,!1),this._buffer_index+=f,this._current_word_bits_left=f*8},u.prototype.readBits=function(n){if(n>32)throw new T.InvalidArgumentException("ExpGolomb: readBits() bits exceeded max 32bits!");if(n<=this._current_word_bits_left){var f=this._current_word>>>32-n;return this._current_word<<=n,this._current_word_bits_left-=n,f}var l=this._current_word_bits_left?this._current_word:0;l=l>>>32-this._current_word_bits_left;var h=n-this._current_word_bits_left;this._fillCurrentWord();var v=Math.min(h,this._current_word_bits_left),d=this._current_word>>>32-v;return this._current_word<<=v,this._current_word_bits_left-=v,l=l<<v|d,l},u.prototype.readBool=function(){return this.readBits(1)===1},u.prototype.readByte=function(){return this.readBits(8)},u.prototype._skipLeadingZero=function(){var n;for(n=0;n<this._current_word_bits_left;n++)if((this._current_word&2147483648>>>n)!==0)return this._current_word<<=n,this._current_word_bits_left-=n,n;return this._fillCurrentWord(),n+this._skipLeadingZero()},u.prototype.readUEG=function(){var n=this._skipLeadingZero();return this.readBits(n+1)-1},u.prototype.readSEG=function(){var n=this.readUEG();return n&1?n+1>>>1:-1*(n>>>1)},u}();y.default=p},"./src/demux/flv-demuxer.js":function(c,y,M){M.r(y);var T=M("./src/utils/logger.js"),p=M("./src/demux/amf-parser.js"),u=M("./src/demux/sps-parser.js"),n=M("./src/demux/demux-errors.js"),f=M("./src/core/media-info.js"),l=M("./src/utils/exception.js");function h(d,r){return d[r]<<24|d[r+1]<<16|d[r+2]<<8|d[r+3]}var v=function(){function d(r,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=r.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=r.hasAudioTrack,this._hasVideo=r.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new f.default,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var i=new ArrayBuffer(2);return new DataView(i).setInt16(0,256,!0),new Int16Array(i)[0]===256}()}return d.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},d.probe=function(r){var t=new Uint8Array(r),i={match:!1};if(t[0]!==70||t[1]!==76||t[2]!==86||t[3]!==1)return i;var e=(t[4]&4)>>>2!==0,a=(t[4]&1)!==0,o=h(t,5);return o<9?i:{match:!0,consumed:o,dataOffset:o,hasAudioTrack:e,hasVideoTrack:a}},d.prototype.bindDataSource=function(r){return r.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(d.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(r){this._onTrackMetadata=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(r){this._onMediaInfo=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(r){this._onMetaDataArrived=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(r){this._onScriptDataArrived=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onError",{get:function(){return this._onError},set:function(r){this._onError=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(r){this._onDataAvailable=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(r){this._timestampBase=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"overridedDuration",{get:function(){return this._duration},set:function(r){this._durationOverrided=!0,this._duration=r,this._mediaInfo.duration=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"overridedHasAudio",{set:function(r){this._hasAudioFlagOverrided=!0,this._hasAudio=r,this._mediaInfo.hasAudio=r},enumerable:!1,configurable:!0}),Object.defineProperty(d.prototype,"overridedHasVideo",{set:function(r){this._hasVideoFlagOverrided=!0,this._hasVideo=r,this._mediaInfo.hasVideo=r},enumerable:!1,configurable:!0}),d.prototype.resetMediaInfo=function(){this._mediaInfo=new f.default},d.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!this._hasAudio&&this._hasVideo?this._videoInitialMetadataDispatched:!1},d.prototype.parseChunks=function(r,t){if(!this._onError||!this._onMediaInfo||!this._onTrackMetadata||!this._onDataAvailable)throw new l.IllegalStateException("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var i=0,e=this._littleEndian;if(t===0)if(r.byteLength>13){var a=d.probe(r);i=a.dataOffset}else return 0;if(this._firstParse){this._firstParse=!1,t+i!==this._dataOffset&&T.default.w(this.TAG,"First time parsing but chunk byteStart invalid!");var o=new DataView(r,i),s=o.getUint32(0,!e);s!==0&&T.default.w(this.TAG,"PrevTagSize0 !== 0 !!!"),i+=4}for(;i<r.byteLength;){this._dispatch=!0;var o=new DataView(r,i);if(i+11+4>r.byteLength)break;var g=o.getUint8(0),L=o.getUint32(0,!e)&16777215;if(i+11+L+4>r.byteLength)break;if(g!==8&&g!==9&&g!==18){T.default.w(this.TAG,"Unsupported tag type "+g+", skipped"),i+=11+L+4;continue}var A=o.getUint8(4),m=o.getUint8(5),E=o.getUint8(6),x=o.getUint8(7),D=E|m<<8|A<<16|x<<24,I=o.getUint32(7,!e)&16777215;I!==0&&T.default.w(this.TAG,"Meet tag which has StreamID != 0!");var b=i+11;switch(g){case 8:this._parseAudioData(r,b,L,D);break;case 9:this._parseVideoData(r,b,L,D,t+i);break;case 18:this._parseScriptData(r,b,L);break}var R=o.getUint32(11+L,!e);R!==11+L&&T.default.w(this.TAG,"Invalid PrevTagSize "+R),i+=11+L+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),i},d.prototype._parseScriptData=function(r,t,i){var e=p.default.parseScriptData(r,t,i);if(e.hasOwnProperty("onMetaData")){if(e.onMetaData==null||typeof e.onMetaData!="object"){T.default.w(this.TAG,"Invalid onMetaData structure!");return}this._metadata&&T.default.w(this.TAG,"Found another onMetaData tag!"),this._metadata=e;var a=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},a)),typeof a.hasAudio=="boolean"&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=a.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),typeof a.hasVideo=="boolean"&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=a.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),typeof a.audiodatarate=="number"&&(this._mediaInfo.audioDataRate=a.audiodatarate),typeof a.videodatarate=="number"&&(this._mediaInfo.videoDataRate=a.videodatarate),typeof a.width=="number"&&(this._mediaInfo.width=a.width),typeof a.height=="number"&&(this._mediaInfo.height=a.height),typeof a.duration=="number"){if(!this._durationOverrided){var o=Math.floor(a.duration*this._timescale);this._duration=o,this._mediaInfo.duration=o}}else this._mediaInfo.duration=0;if(typeof a.framerate=="number"){var s=Math.floor(a.framerate*1e3);if(s>0){var g=s/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=g,this._referenceFrameRate.fps_num=s,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=g}}if(typeof a.keyframes=="object"){this._mediaInfo.hasKeyframesIndex=!0;var L=a.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(L),a.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=a,T.default.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(e).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},e))},d.prototype._parseKeyframesIndex=function(r){for(var t=[],i=[],e=1;e<r.times.length;e++){var a=this._timestampBase+Math.floor(r.times[e]*1e3);t.push(a),i.push(r.filepositions[e])}return{times:t,filepositions:i}},d.prototype._parseAudioData=function(r,t,i,e){if(i<=1){T.default.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");return}if(!(this._hasAudioFlagOverrided===!0&&this._hasAudio===!1)){this._littleEndian;var a=new DataView(r,t,i),o=a.getUint8(0),s=o>>>4;if(s!==2&&s!==10){this._onError(n.default.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+s);return}var g=0,L=(o&12)>>>2;if(L>=0&&L<=4)g=this._flvSoundRateTable[L];else{this._onError(n.default.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+L);return}var A=o&1,m=this._audioMetadata,E=this._audioTrack;if(m||(this._hasAudio===!1&&this._hasAudioFlagOverrided===!1&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),m=this._audioMetadata={},m.type="audio",m.id=E.id,m.timescale=this._timescale,m.duration=this._duration,m.audioSampleRate=g,m.channelCount=A===0?1:2),s===10){var x=this._parseAACAudioData(r,t+1,i-1);if(x==null)return;if(x.packetType===0){m.config&&T.default.w(this.TAG,"Found another AudioSpecificConfig!");var D=x.data;m.audioSampleRate=D.samplingRate,m.channelCount=D.channelCount,m.codec=D.codec,m.originalCodec=D.originalCodec,m.config=D.config,m.refSampleDuration=1024/m.audioSampleRate*m.timescale,T.default.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",m);var I=this._mediaInfo;I.audioCodec=m.originalCodec,I.audioSampleRate=m.audioSampleRate,I.audioChannelCount=m.channelCount,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}else if(x.packetType===1){var b=this._timestampBase+e,R={unit:x.data,length:x.data.byteLength,dts:b,pts:b};E.samples.push(R),E.length+=x.data.length}else T.default.e(this.TAG,"Flv: Unsupported AAC data type "+x.packetType)}else if(s===2){if(!m.codec){var D=this._parseMP3AudioData(r,t+1,i-1,!0);if(D==null)return;m.audioSampleRate=D.samplingRate,m.channelCount=D.channelCount,m.codec=D.codec,m.originalCodec=D.originalCodec,m.refSampleDuration=1152/m.audioSampleRate*m.timescale,T.default.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",m);var I=this._mediaInfo;I.audioCodec=m.codec,I.audioSampleRate=m.audioSampleRate,I.audioChannelCount=m.channelCount,I.audioDataRate=D.bitRate,I.hasVideo?I.videoCodec!=null&&(I.mimeType='video/x-flv; codecs="'+I.videoCodec+","+I.audioCodec+'"'):I.mimeType='video/x-flv; codecs="'+I.audioCodec+'"',I.isComplete()&&this._onMediaInfo(I)}var P=this._parseMP3AudioData(r,t+1,i-1,!1);if(P==null)return;var b=this._timestampBase+e,w={unit:P,length:P.byteLength,dts:b,pts:b};E.samples.push(w),E.length+=P.length}}},d.prototype._parseAACAudioData=function(r,t,i){if(i<=1){T.default.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!");return}var e={},a=new Uint8Array(r,t,i);return e.packetType=a[0],a[0]===0?e.data=this._parseAACAudioSpecificConfig(r,t+1,i-1):e.data=a.subarray(1),e},d.prototype._parseAACAudioSpecificConfig=function(r,t,i){var e=new Uint8Array(r,t,i),a=null,o=0,s=0,g=0,L=null;if(o=s=e[0]>>>3,g=(e[0]&7)<<1|e[1]>>>7,g<0||g>=this._mpegSamplingRates.length){this._onError(n.default.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");return}var A=this._mpegSamplingRates[g],m=(e[1]&120)>>>3;if(m<0||m>=8){this._onError(n.default.FORMAT_ERROR,"Flv: AAC invalid channel configuration");return}o===5&&(L=(e[1]&7)<<1|e[2]>>>7,(e[2]&124)>>>2);var E=self.navigator.userAgent.toLowerCase();return E.indexOf("firefox")!==-1?g>=6?(o=5,a=new Array(4),L=g-3):(o=2,a=new Array(2),L=g):E.indexOf("android")!==-1?(o=2,a=new Array(2),L=g):(o=5,L=g,a=new Array(4),g>=6?L=g-3:m===1&&(o=2,a=new Array(2),L=g)),a[0]=o<<3,a[0]|=(g&15)>>>1,a[1]=(g&15)<<7,a[1]|=(m&15)<<3,o===5&&(a[1]|=(L&15)>>>1,a[2]=(L&1)<<7,a[2]|=2<<2,a[3]=0),{config:a,samplingRate:A,channelCount:m,codec:"mp4a.40."+o,originalCodec:"mp4a.40."+s}},d.prototype._parseMP3AudioData=function(r,t,i,e){if(i<4){T.default.w(this.TAG,"Flv: Invalid MP3 packet, header missing!");return}this._littleEndian;var a=new Uint8Array(r,t,i),o=null;if(e){if(a[0]!==255)return;var s=a[1]>>>3&3,g=(a[1]&6)>>1,L=(a[2]&240)>>>4,A=(a[2]&12)>>>2,m=a[3]>>>6&3,E=m!==3?2:1,x=0,D=0,I="mp3";switch(s){case 0:x=this._mpegAudioV25SampleRateTable[A];break;case 2:x=this._mpegAudioV20SampleRateTable[A];break;case 3:x=this._mpegAudioV10SampleRateTable[A];break}switch(g){case 1:L<this._mpegAudioL3BitRateTable.length&&(D=this._mpegAudioL3BitRateTable[L]);break;case 2:L<this._mpegAudioL2BitRateTable.length&&(D=this._mpegAudioL2BitRateTable[L]);break;case 3:L<this._mpegAudioL1BitRateTable.length&&(D=this._mpegAudioL1BitRateTable[L]);break}o={bitRate:D,samplingRate:x,channelCount:E,codec:I,originalCodec:I}}else o=a;return o},d.prototype._parseVideoData=function(r,t,i,e,a){if(i<=1){T.default.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");return}if(!(this._hasVideoFlagOverrided===!0&&this._hasVideo===!1)){var o=new Uint8Array(r,t,i)[0],s=(o&240)>>>4,g=o&15;if(g!==7){this._onError(n.default.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+g);return}this._parseAVCVideoPacket(r,t+1,i-1,e,a,s)}},d.prototype._parseAVCVideoPacket=function(r,t,i,e,a,o){if(i<4){T.default.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");return}var s=this._littleEndian,g=new DataView(r,t,i),L=g.getUint8(0),A=g.getUint32(0,!s)&16777215,m=A<<8>>8;if(L===0)this._parseAVCDecoderConfigurationRecord(r,t+4,i-4);else if(L===1)this._parseAVCVideoData(r,t+4,i-4,e,a,o,m);else if(L!==2){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid video packet type "+L);return}},d.prototype._parseAVCDecoderConfigurationRecord=function(r,t,i){if(i<7){T.default.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");return}var e=this._videoMetadata,a=this._videoTrack,o=this._littleEndian,s=new DataView(r,t,i);e?typeof e.avcc!="undefined"&&T.default.w(this.TAG,"Found another AVCDecoderConfigurationRecord!"):(this._hasVideo===!1&&this._hasVideoFlagOverrided===!1&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),e=this._videoMetadata={},e.type="video",e.id=a.id,e.timescale=this._timescale,e.duration=this._duration);var g=s.getUint8(0),L=s.getUint8(1);if(s.getUint8(2),s.getUint8(3),g!==1||L===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord");return}if(this._naluLengthSize=(s.getUint8(4)&3)+1,this._naluLengthSize!==3&&this._naluLengthSize!==4){this._onError(n.default.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));return}var A=s.getUint8(5)&31;if(A===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS");return}else A>1&&T.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+A);for(var m=6,E=0;E<A;E++){var x=s.getUint16(m,!o);if(m+=2,x!==0){var D=new Uint8Array(r,t+m,x);m+=x;var I=u.default.parseSPS(D);if(E===0){e.codecWidth=I.codec_size.width,e.codecHeight=I.codec_size.height,e.presentWidth=I.present_size.width,e.presentHeight=I.present_size.height,e.profile=I.profile_string,e.level=I.level_string,e.bitDepth=I.bit_depth,e.chromaFormat=I.chroma_format,e.sarRatio=I.sar_ratio,e.frameRate=I.frame_rate,(I.frame_rate.fixed===!1||I.frame_rate.fps_num===0||I.frame_rate.fps_den===0)&&(e.frameRate=this._referenceFrameRate);var b=e.frameRate.fps_den,R=e.frameRate.fps_num;e.refSampleDuration=e.timescale*(b/R);for(var P=D.subarray(1,4),w="avc1.",F=0;F<3;F++){var k=P[F].toString(16);k.length<2&&(k="0"+k),w+=k}e.codec=w;var B=this._mediaInfo;B.width=e.codecWidth,B.height=e.codecHeight,B.fps=e.frameRate.fps,B.profile=e.profile,B.level=e.level,B.refFrames=I.ref_frames,B.chromaFormat=I.chroma_format_string,B.sarNum=e.sarRatio.width,B.sarDen=e.sarRatio.height,B.videoCodec=w,B.hasAudio?B.audioCodec!=null&&(B.mimeType='video/x-flv; codecs="'+B.videoCodec+","+B.audioCodec+'"'):B.mimeType='video/x-flv; codecs="'+B.videoCodec+'"',B.isComplete()&&this._onMediaInfo(B)}}}var U=s.getUint8(m);if(U===0){this._onError(n.default.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS");return}else U>1&&T.default.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+U);m++;for(var E=0;E<U;E++){var x=s.getUint16(m,!o);m+=2,x!==0&&(m+=x)}e.avcc=new Uint8Array(i),e.avcc.set(new Uint8Array(r,t,i),0),T.default.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",e)},d.prototype._parseAVCVideoData=function(r,t,i,e,a,o,s){for(var g=this._littleEndian,L=new DataView(r,t,i),A=[],m=0,E=0,x=this._naluLengthSize,D=this._timestampBase+e,I=o===1;E<i;){if(E+4>=i){T.default.w(this.TAG,"Malformed Nalu near timestamp "+D+", offset = "+E+", dataSize = "+i);break}var b=L.getUint32(E,!g);if(x===3&&(b>>>=8),b>i-x){T.default.w(this.TAG,"Malformed Nalus near timestamp "+D+", NaluSize > DataSize!");return}var R=L.getUint8(E+x)&31;R===5&&(I=!0);var P=new Uint8Array(r,t+E,x+b),w={type:R,data:P};A.push(w),m+=P.byteLength,E+=x+b}if(A.length){var F=this._videoTrack,k={units:A,length:m,isKeyframe:I,dts:D,cts:s,pts:D+s};I&&(k.fileposition=a),F.samples.push(k),F.length+=m}},d}();y.default=v},"./src/demux/sps-parser.js":function(c,y,M){M.r(y);var T=M("./src/demux/exp-golomb.js"),p=function(){function u(){}return u._ebsp2rbsp=function(n){for(var f=n,l=f.byteLength,h=new Uint8Array(l),v=0,d=0;d<l;d++)d>=2&&f[d]===3&&f[d-1]===0&&f[d-2]===0||(h[v]=f[d],v++);return new Uint8Array(h.buffer,0,v)},u.parseSPS=function(n){var f=u._ebsp2rbsp(n),l=new T.default(f);l.readByte();var h=l.readByte();l.readByte();var v=l.readByte();l.readUEG();var d=u.getProfileString(h),r=u.getLevelString(v),t=1,i=420,e=[0,420,422,444],a=8;if((h===100||h===110||h===122||h===244||h===44||h===83||h===86||h===118||h===128||h===138||h===144)&&(t=l.readUEG(),t===3&&l.readBits(1),t<=3&&(i=e[t]),a=l.readUEG()+8,l.readUEG(),l.readBits(1),l.readBool()))for(var o=t!==3?8:12,s=0;s<o;s++)l.readBool()&&(s<6?u._skipScalingList(l,16):u._skipScalingList(l,64));l.readUEG();var g=l.readUEG();if(g===0)l.readUEG();else if(g===1){l.readBits(1),l.readSEG(),l.readSEG();for(var L=l.readUEG(),s=0;s<L;s++)l.readSEG()}var A=l.readUEG();l.readBits(1);var m=l.readUEG(),E=l.readUEG(),x=l.readBits(1);x===0&&l.readBits(1),l.readBits(1);var D=0,I=0,b=0,R=0,P=l.readBool();P&&(D=l.readUEG(),I=l.readUEG(),b=l.readUEG(),R=l.readUEG());var w=1,F=1,k=0,B=!0,U=0,j=0,K=l.readBool();if(K){if(l.readBool()){var N=l.readByte(),Z=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],$=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];N>0&&N<16?(w=Z[N-1],F=$[N-1]):N===255&&(w=l.readByte()<<8|l.readByte(),F=l.readByte()<<8|l.readByte())}if(l.readBool()&&l.readBool(),l.readBool()&&(l.readBits(4),l.readBool()&&l.readBits(24)),l.readBool()&&(l.readUEG(),l.readUEG()),l.readBool()){var Y=l.readBits(32),ee=l.readBits(32);B=l.readBool(),U=ee,j=Y*2,k=U/j}}var Q=1;(w!==1||F!==1)&&(Q=w/F);var G=0,q=0;if(t===0)G=1,q=2-x;else{var te=t===3?1:2,ie=t===1?2:1;G=te,q=ie*(2-x)}var ne=(m+1)*16,le=(2-x)*((E+1)*16);ne-=(D+I)*G,le-=(b+R)*q;var ae=Math.ceil(ne*Q);return l.destroy(),l=null,{profile_string:d,level_string:r,bit_depth:a,ref_frames:A,chroma_format:i,chroma_format_string:u.getChromaFormatString(i),frame_rate:{fixed:B,fps:k,fps_den:j,fps_num:U},sar_ratio:{width:w,height:F},codec_size:{width:ne,height:le},present_size:{width:ae,height:le}}},u._skipScalingList=function(n,f){for(var l=8,h=8,v=0,d=0;d<f;d++)h!==0&&(v=n.readSEG(),h=(l+v+256)%256),l=h===0?l:h},u.getProfileString=function(n){switch(n){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},u.getLevelString=function(n){return(n/10).toFixed(1)},u.getChromaFormatString=function(n){switch(n){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},u}();y.default=p},"./src/flv.js":function(c,y,M){M.r(y);var T=M("./src/utils/polyfill.js"),p=M("./src/core/features.js"),u=M("./src/io/loader.js"),n=M("./src/player/flv-player.js"),f=M("./src/player/native-player.js"),l=M("./src/player/player-events.js"),h=M("./src/player/player-errors.js"),v=M("./src/utils/logging-control.js"),d=M("./src/utils/exception.js");T.default.install();function r(a,o){var s=a;if(s==null||typeof s!="object")throw new d.InvalidArgumentException("MediaDataSource must be an javascript object!");if(!s.hasOwnProperty("type"))throw new d.InvalidArgumentException("MediaDataSource must has type field to indicate video file type!");switch(s.type){case"flv":return new n.default(s,o);default:return new f.default(s,o)}}function t(){return p.default.supportMSEH264Playback()}function i(){return p.default.getFeatureList()}var e={};e.createPlayer=r,e.isSupported=t,e.getFeatureList=i,e.BaseLoader=u.BaseLoader,e.LoaderStatus=u.LoaderStatus,e.LoaderErrors=u.LoaderErrors,e.Events=l.default,e.ErrorTypes=h.ErrorTypes,e.ErrorDetails=h.ErrorDetails,e.FlvPlayer=n.default,e.NativePlayer=f.default,e.LoggingControl=v.default,Object.defineProperty(e,"version",{enumerable:!0,get:function(){return"1.6.2"}}),y.default=e},"./src/index.js":function(c,y,M){c.exports=M("./src/flv.js").default},"./src/io/fetch-stream-loader.js":function(c,y,M){M.r(y);var T=M("./src/utils/browser.js"),p=M("./src/io/loader.js"),u=M("./src/utils/exception.js"),n=function(){var l=function(h,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,r){d.__proto__=r}||function(d,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(d[t]=r[t])},l(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(h,v);function d(){this.constructor=h}h.prototype=v===null?Object.create(v):(d.prototype=v.prototype,new d)}}(),f=function(l){n(h,l);function h(v,d){var r=l.call(this,"fetch-stream-loader")||this;return r.TAG="FetchStreamLoader",r._seekHandler=v,r._config=d,r._needStash=!0,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}return h.isSupported=function(){try{var v=T.default.msedge&&T.default.version.minor>=15048,d=T.default.msedge?v:!0;return self.fetch&&self.ReadableStream&&d}catch(r){return!1}},h.prototype.destroy=function(){this.isWorking()&&this.abort(),l.prototype.destroy.call(this)},h.prototype.open=function(v,d){var r=this;this._dataSource=v,this._range=d;var t=v.url;this._config.reuseRedirectedURL&&v.redirectedURL!=null&&(t=v.redirectedURL);var i=this._seekHandler.getConfig(t,d),e=new self.Headers;if(typeof i.headers=="object"){var a=i.headers;for(var o in a)a.hasOwnProperty(o)&&e.append(o,a[o])}var s={method:"GET",headers:e,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if(typeof this._config.headers=="object")for(var o in this._config.headers)e.append(o,this._config.headers[o]);v.cors===!1&&(s.mode="same-origin"),v.withCredentials&&(s.credentials="include"),v.referrerPolicy&&(s.referrerPolicy=v.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,s.signal=this._abortController.signal),this._status=p.LoaderStatus.kConnecting,self.fetch(i.url,s).then(function(g){if(r._requestAbort){r._status=p.LoaderStatus.kIdle,g.body.cancel();return}if(g.ok&&g.status>=200&&g.status<=299){if(g.url!==i.url&&r._onURLRedirect){var L=r._seekHandler.removeURLParameters(g.url);r._onURLRedirect(L)}var A=g.headers.get("Content-Length");return A!=null&&(r._contentLength=parseInt(A),r._contentLength!==0&&r._onContentLengthKnown&&r._onContentLengthKnown(r._contentLength)),r._pump.call(r,g.body.getReader())}else if(r._status=p.LoaderStatus.kError,r._onError)r._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:g.status,msg:g.statusText});else throw new u.RuntimeException("FetchStreamLoader: Http code invalid, "+g.status+" "+g.statusText)}).catch(function(g){if(!(r._abortController&&r._abortController.signal.aborted))if(r._status=p.LoaderStatus.kError,r._onError)r._onError(p.LoaderErrors.EXCEPTION,{code:-1,msg:g.message});else throw g})},h.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==p.LoaderStatus.kBuffering||!T.default.chrome)&&this._abortController)try{this._abortController.abort()}catch(v){}},h.prototype._pump=function(v){var d=this;return v.read().then(function(r){if(r.done)if(d._contentLength!==null&&d._receivedLength<d._contentLength){d._status=p.LoaderStatus.kError;var t=p.LoaderErrors.EARLY_EOF,i={code:-1,msg:"Fetch stream meet Early-EOF"};if(d._onError)d._onError(t,i);else throw new u.RuntimeException(i.msg)}else d._status=p.LoaderStatus.kComplete,d._onComplete&&d._onComplete(d._range.from,d._range.from+d._receivedLength-1);else{if(d._abortController&&d._abortController.signal.aborted){d._status=p.LoaderStatus.kComplete;return}else if(d._requestAbort===!0)return d._status=p.LoaderStatus.kComplete,v.cancel();d._status=p.LoaderStatus.kBuffering;var e=r.value.buffer,a=d._range.from+d._receivedLength;d._receivedLength+=e.byteLength,d._onDataArrival&&d._onDataArrival(e,a,d._receivedLength),d._pump(v)}}).catch(function(r){if(d._abortController&&d._abortController.signal.aborted){d._status=p.LoaderStatus.kComplete;return}if(!(r.code===11&&T.default.msedge)){d._status=p.LoaderStatus.kError;var t=0,i=null;if((r.code===19||r.message==="network error")&&(d._contentLength===null||d._contentLength!==null&&d._receivedLength<d._contentLength)?(t=p.LoaderErrors.EARLY_EOF,i={code:r.code,msg:"Fetch stream meet Early-EOF"}):(t=p.LoaderErrors.EXCEPTION,i={code:r.code,msg:r.message}),d._onError)d._onError(t,i);else throw new u.RuntimeException(i.msg)}})},h}(p.BaseLoader);y.default=f},"./src/io/io-controller.js":function(c,y,M){M.r(y);var T=M("./src/utils/logger.js"),p=M("./src/io/speed-sampler.js"),u=M("./src/io/loader.js"),n=M("./src/io/fetch-stream-loader.js"),f=M("./src/io/xhr-moz-chunked-loader.js"),l=M("./src/io/xhr-range-loader.js"),h=M("./src/io/websocket-loader.js"),v=M("./src/io/range-seek-handler.js"),d=M("./src/io/param-seek-handler.js"),r=M("./src/utils/exception.js"),t=function(){function i(e,a,o){this.TAG="IOController",this._config=a,this._extraData=o,this._stashInitialSize=1024*384,a.stashInitialSize!=null&&a.stashInitialSize>0&&(this._stashInitialSize=a.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=1024*1024*3,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,a.enableStashBuffer===!1&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new p.default,this._speedNormalizeList=[64,128,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return i.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},i.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},i.prototype.isPaused=function(){return this._paused},Object.defineProperty(i.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"hasRedirect",{get:function(){return this._redirectedURL!=null||this._dataSource.redirectedURL!=null},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentSpeed",{get:function(){return this._loaderClass===l.default?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),i.prototype._selectSeekHandler=function(){var e=this._config;if(e.seekType==="range")this._seekHandler=new v.default(this._config.rangeLoadZeroStart);else if(e.seekType==="param"){var a=e.seekParamStart||"bstart",o=e.seekParamEnd||"bend";this._seekHandler=new d.default(a,o)}else if(e.seekType==="custom"){if(typeof e.customSeekHandler!="function")throw new r.InvalidArgumentException("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}else throw new r.InvalidArgumentException("Invalid seekType in config: "+e.seekType)},i.prototype._selectLoader=function(){if(this._config.customLoader!=null)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=h.default;else if(n.default.isSupported())this._loaderClass=n.default;else if(f.default.isSupported())this._loaderClass=f.default;else if(l.default.isSupported())this._loaderClass=l.default;else throw new r.RuntimeException("Your browser doesn't support xhr with arraybuffer responseType!")},i.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),this._loader.needStashBuffer===!1&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},i.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},i.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},i.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),this._stashUsed!==0?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},i.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},i.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},i.prototype._internalSeek=function(e,a){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(a),this._loader.destroy(),this._loader=null;var o={from:e,to:-1};this._currentRange={from:o.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,o),this._onSeeked&&this._onSeeked()},i.prototype.updateUrl=function(e){if(!e||typeof e!="string"||e.length===0)throw new r.InvalidArgumentException("Url must be a non-empty string!");this._dataSource.url=e},i.prototype._expandBuffer=function(e){for(var a=this._stashSize;a+1024*1024*1<e;)a*=2;if(a+=1024*1024*1,a!==this._bufferSize){var o=new ArrayBuffer(a);if(this._stashUsed>0){var s=new Uint8Array(this._stashBuffer,0,this._stashUsed),g=new Uint8Array(o,0,a);g.set(s,0)}this._stashBuffer=o,this._bufferSize=a}},i.prototype._normalizeSpeed=function(e){var a=this._speedNormalizeList,o=a.length-1,s=0,g=0,L=o;if(e<a[0])return a[0];for(;g<=L;){if(s=g+Math.floor((L-g)/2),s===o||e>=a[s]&&e<a[s+1])return a[s];a[s]<e?g=s+1:L=s-1}},i.prototype._adjustStashSize=function(e){var a=0;this._config.isLive||e<512?a=e:e>=512&&e<=1024?a=Math.floor(e*1.5):a=e*2,a>8192&&(a=8192);var o=a*1024+1024*1024*1;this._bufferSize<o&&this._expandBuffer(o),this._stashSize=a*1024},i.prototype._dispatchChunks=function(e,a){return this._currentRange.to=a+e.byteLength-1,this._onDataArrival(e,a)},i.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},i.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},i.prototype._onLoaderChunkArrival=function(e,a,o){if(!this._onDataArrival)throw new r.IllegalStateException("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var s=this._speedSampler.lastSecondKBps;if(s!==0){var g=this._normalizeSpeed(s);this._speedNormalized!==g&&(this._speedNormalized=g,this._adjustStashSize(g))}if(this._enableStash)if(this._stashUsed===0&&this._stashByteStart===0&&(this._stashByteStart=a),this._stashUsed+e.byteLength<=this._stashSize){var m=new Uint8Array(this._stashBuffer,0,this._stashSize);m.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var m=new Uint8Array(this._stashBuffer,0,this._bufferSize);if(this._stashUsed>0){var x=this._stashBuffer.slice(0,this._stashUsed),L=this._dispatchChunks(x,this._stashByteStart);if(L<x.byteLength){if(L>0){var E=new Uint8Array(x,L);m.set(E,0),this._stashUsed=E.byteLength,this._stashByteStart+=L}}else this._stashUsed=0,this._stashByteStart+=L;this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),m=new Uint8Array(this._stashBuffer,0,this._bufferSize)),m.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else{var L=this._dispatchChunks(e,a);if(L<e.byteLength){var A=e.byteLength-L;A>this._bufferSize&&(this._expandBuffer(A),m=new Uint8Array(this._stashBuffer,0,this._bufferSize)),m.set(new Uint8Array(e,L),0),this._stashUsed+=A,this._stashByteStart=a+L}}}else if(this._stashUsed===0){var L=this._dispatchChunks(e,a);if(L<e.byteLength){var A=e.byteLength-L;A>this._bufferSize&&this._expandBuffer(A);var m=new Uint8Array(this._stashBuffer,0,this._bufferSize);m.set(new Uint8Array(e,L),0),this._stashUsed+=A,this._stashByteStart=a+L}}else{this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength);var m=new Uint8Array(this._stashBuffer,0,this._bufferSize);m.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;var L=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart);if(L<this._stashUsed&&L>0){var E=new Uint8Array(this._stashBuffer,L);m.set(E,0)}this._stashUsed-=L,this._stashByteStart+=L}}},i.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var a=this._stashBuffer.slice(0,this._stashUsed),o=this._dispatchChunks(a,this._stashByteStart),s=a.byteLength-o;if(o<a.byteLength)if(e)T.default.w(this.TAG,s+" bytes unconsumed data remain when flush buffer, dropped");else{if(o>0){var g=new Uint8Array(this._stashBuffer,0,this._bufferSize),L=new Uint8Array(a,o);g.set(L,0),this._stashUsed=L.byteLength,this._stashByteStart+=o}return 0}return this._stashUsed=0,this._stashByteStart=0,s}return 0},i.prototype._onLoaderComplete=function(e,a){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},i.prototype._onLoaderError=function(e,a){switch(T.default.e(this.TAG,"Loader error, code = "+a.code+", msg = "+a.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=u.LoaderErrors.UNRECOVERABLE_EARLY_EOF),e){case u.LoaderErrors.EARLY_EOF:{if(!this._config.isLive&&this._totalLength){var o=this._currentRange.to+1;o<this._totalLength&&(T.default.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(o,!1));return}e=u.LoaderErrors.UNRECOVERABLE_EARLY_EOF;break}case u.LoaderErrors.UNRECOVERABLE_EARLY_EOF:case u.LoaderErrors.CONNECTING_TIMEOUT:case u.LoaderErrors.HTTP_STATUS_CODE_INVALID:case u.LoaderErrors.EXCEPTION:break}if(this._onError)this._onError(e,a);else throw new r.RuntimeException("IOException: "+a.msg)},i}();y.default=t},"./src/io/loader.js":function(c,y,M){M.r(y),M.d(y,{LoaderStatus:function(){return p},LoaderErrors:function(){return u},BaseLoader:function(){return n}});var T=M("./src/utils/exception.js"),p={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},u={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},n=function(){function f(l){this._type=l||"undefined",this._status=p.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return f.prototype.destroy=function(){this._status=p.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},f.prototype.isWorking=function(){return this._status===p.kConnecting||this._status===p.kBuffering},Object.defineProperty(f.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(l){this._onContentLengthKnown=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(l){this._onURLRedirect=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(l){this._onDataArrival=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onError",{get:function(){return this._onError},set:function(l){this._onError=l},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"onComplete",{get:function(){return this._onComplete},set:function(l){this._onComplete=l},enumerable:!1,configurable:!0}),f.prototype.open=function(l,h){throw new T.NotImplementedException("Unimplemented abstract function!")},f.prototype.abort=function(){throw new T.NotImplementedException("Unimplemented abstract function!")},f}()},"./src/io/param-seek-handler.js":function(c,y,M){M.r(y);var T=function(){function p(u,n){this._startName=u,this._endName=n}return p.prototype.getConfig=function(u,n){var f=u;if(n.from!==0||n.to!==-1){var l=!0;f.indexOf("?")===-1&&(f+="?",l=!1),l&&(f+="&"),f+=this._startName+"="+n.from.toString(),n.to!==-1&&(f+="&"+this._endName+"="+n.to.toString())}return{url:f,headers:{}}},p.prototype.removeURLParameters=function(u){var n=u.split("?")[0],f=void 0,l=u.indexOf("?");l!==-1&&(f=u.substring(l+1));var h="";if(f!=null&&f.length>0)for(var v=f.split("&"),d=0;d<v.length;d++){var r=v[d].split("="),t=d>0;r[0]!==this._startName&&r[0]!==this._endName&&(t&&(h+="&"),h+=v[d])}return h.length===0?n:n+"?"+h},p}();y.default=T},"./src/io/range-seek-handler.js":function(c,y,M){M.r(y);var T=function(){function p(u){this._zeroStart=u||!1}return p.prototype.getConfig=function(u,n){var f={};if(n.from!==0||n.to!==-1){var l=void 0;n.to!==-1?l="bytes="+n.from.toString()+"-"+n.to.toString():l="bytes="+n.from.toString()+"-",f.Range=l}else this._zeroStart&&(f.Range="bytes=0-");return{url:u,headers:f}},p.prototype.removeURLParameters=function(u){return u},p}();y.default=T},"./src/io/speed-sampler.js":function(c,y,M){M.r(y);var T=function(){function p(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return p.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},p.prototype.addBytes=function(u){this._firstCheckpoint===0?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=u,this._totalBytes+=u):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=u,this._totalBytes+=u):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=u,this._totalBytes+=u,this._lastCheckpoint=this._now())},Object.defineProperty(p.prototype,"currentKBps",{get:function(){this.addBytes(0);var u=(this._now()-this._lastCheckpoint)/1e3;return u==0&&(u=1),this._intervalBytes/u/1024},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),this._lastSecondBytes!==0?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"averageKBps",{get:function(){var u=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/u/1024},enumerable:!1,configurable:!0}),p}();y.default=T},"./src/io/websocket-loader.js":function(c,y,M){M.r(y);var T=M("./src/io/loader.js"),p=M("./src/utils/exception.js"),u=function(){var f=function(l,h){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,d){v.__proto__=d}||function(v,d){for(var r in d)Object.prototype.hasOwnProperty.call(d,r)&&(v[r]=d[r])},f(l,h)};return function(l,h){if(typeof h!="function"&&h!==null)throw new TypeError("Class extends value "+String(h)+" is not a constructor or null");f(l,h);function v(){this.constructor=l}l.prototype=h===null?Object.create(h):(v.prototype=h.prototype,new v)}}(),n=function(f){u(l,f);function l(){var h=f.call(this,"websocket-loader")||this;return h.TAG="WebSocketLoader",h._needStash=!0,h._ws=null,h._requestAbort=!1,h._receivedLength=0,h}return l.isSupported=function(){try{return typeof self.WebSocket!="undefined"}catch(h){return!1}},l.prototype.destroy=function(){this._ws&&this.abort(),f.prototype.destroy.call(this)},l.prototype.open=function(h){try{var v=this._ws=new self.WebSocket(h.url);v.binaryType="arraybuffer",v.onopen=this._onWebSocketOpen.bind(this),v.onclose=this._onWebSocketClose.bind(this),v.onmessage=this._onWebSocketMessage.bind(this),v.onerror=this._onWebSocketError.bind(this),this._status=T.LoaderStatus.kConnecting}catch(r){this._status=T.LoaderStatus.kError;var d={code:r.code,msg:r.message};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,d);else throw new p.RuntimeException(d.msg)}},l.prototype.abort=function(){var h=this._ws;h&&(h.readyState===0||h.readyState===1)&&(this._requestAbort=!0,h.close()),this._ws=null,this._status=T.LoaderStatus.kComplete},l.prototype._onWebSocketOpen=function(h){this._status=T.LoaderStatus.kBuffering},l.prototype._onWebSocketClose=function(h){if(this._requestAbort===!0){this._requestAbort=!1;return}this._status=T.LoaderStatus.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)},l.prototype._onWebSocketMessage=function(h){var v=this;if(h.data instanceof ArrayBuffer)this._dispatchArrayBuffer(h.data);else if(h.data instanceof Blob){var d=new FileReader;d.onload=function(){v._dispatchArrayBuffer(d.result)},d.readAsArrayBuffer(h.data)}else{this._status=T.LoaderStatus.kError;var r={code:-1,msg:"Unsupported WebSocket message type: "+h.data.constructor.name};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,r);else throw new p.RuntimeException(r.msg)}},l.prototype._dispatchArrayBuffer=function(h){var v=h,d=this._receivedLength;this._receivedLength+=v.byteLength,this._onDataArrival&&this._onDataArrival(v,d,this._receivedLength)},l.prototype._onWebSocketError=function(h){this._status=T.LoaderStatus.kError;var v={code:h.code,msg:h.message};if(this._onError)this._onError(T.LoaderErrors.EXCEPTION,v);else throw new p.RuntimeException(v.msg)},l}(T.BaseLoader);y.default=n},"./src/io/xhr-moz-chunked-loader.js":function(c,y,M){M.r(y);var T=M("./src/utils/logger.js"),p=M("./src/io/loader.js"),u=M("./src/utils/exception.js"),n=function(){var l=function(h,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,r){d.__proto__=r}||function(d,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(d[t]=r[t])},l(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(h,v);function d(){this.constructor=h}h.prototype=v===null?Object.create(v):(d.prototype=v.prototype,new d)}}(),f=function(l){n(h,l);function h(v,d){var r=l.call(this,"xhr-moz-chunked-loader")||this;return r.TAG="MozChunkedLoader",r._seekHandler=v,r._config=d,r._needStash=!0,r._xhr=null,r._requestAbort=!1,r._contentLength=null,r._receivedLength=0,r}return h.isSupported=function(){try{var v=new XMLHttpRequest;return v.open("GET","https://example.com",!0),v.responseType="moz-chunked-arraybuffer",v.responseType==="moz-chunked-arraybuffer"}catch(d){return T.default.w("MozChunkedLoader",d.message),!1}},h.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),l.prototype.destroy.call(this)},h.prototype.open=function(v,d){this._dataSource=v,this._range=d;var r=v.url;this._config.reuseRedirectedURL&&v.redirectedURL!=null&&(r=v.redirectedURL);var t=this._seekHandler.getConfig(r,d);this._requestURL=t.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",t.url,!0),i.responseType="moz-chunked-arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onloadend=this._onLoadEnd.bind(this),i.onerror=this._onXhrError.bind(this),v.withCredentials&&(i.withCredentials=!0),typeof t.headers=="object"){var e=t.headers;for(var a in e)e.hasOwnProperty(a)&&i.setRequestHeader(a,e[a])}if(typeof this._config.headers=="object"){var e=this._config.headers;for(var a in e)e.hasOwnProperty(a)&&i.setRequestHeader(a,e[a])}this._status=p.LoaderStatus.kConnecting,i.send()},h.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=p.LoaderStatus.kComplete},h.prototype._onReadyStateChange=function(v){var d=v.target;if(d.readyState===2){if(d.responseURL!=null&&d.responseURL!==this._requestURL&&this._onURLRedirect){var r=this._seekHandler.removeURLParameters(d.responseURL);this._onURLRedirect(r)}if(d.status!==0&&(d.status<200||d.status>299))if(this._status=p.LoaderStatus.kError,this._onError)this._onError(p.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:d.status,msg:d.statusText});else throw new u.RuntimeException("MozChunkedLoader: Http code invalid, "+d.status+" "+d.statusText);else this._status=p.LoaderStatus.kBuffering}},h.prototype._onProgress=function(v){if(this._status!==p.LoaderStatus.kError){this._contentLength===null&&v.total!==null&&v.total!==0&&(this._contentLength=v.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var d=v.target.response,r=this._range.from+this._receivedLength;this._receivedLength+=d.byteLength,this._onDataArrival&&this._onDataArrival(d,r,this._receivedLength)}},h.prototype._onLoadEnd=function(v){if(this._requestAbort===!0){this._requestAbort=!1;return}else if(this._status===p.LoaderStatus.kError)return;this._status=p.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)},h.prototype._onXhrError=function(v){this._status=p.LoaderStatus.kError;var d=0,r=null;if(this._contentLength&&v.loaded<this._contentLength?(d=p.LoaderErrors.EARLY_EOF,r={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(d=p.LoaderErrors.EXCEPTION,r={code:-1,msg:v.constructor.name+" "+v.type}),this._onError)this._onError(d,r);else throw new u.RuntimeException(r.msg)},h}(p.BaseLoader);y.default=f},"./src/io/xhr-range-loader.js":function(c,y,M){M.r(y);var T=M("./src/utils/logger.js"),p=M("./src/io/speed-sampler.js"),u=M("./src/io/loader.js"),n=M("./src/utils/exception.js"),f=function(){var h=function(v,d){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])},h(v,d)};return function(v,d){if(typeof d!="function"&&d!==null)throw new TypeError("Class extends value "+String(d)+" is not a constructor or null");h(v,d);function r(){this.constructor=v}v.prototype=d===null?Object.create(d):(r.prototype=d.prototype,new r)}}(),l=function(h){f(v,h);function v(d,r){var t=h.call(this,"xhr-range-loader")||this;return t.TAG="RangeLoader",t._seekHandler=d,t._config=r,t._needStash=!1,t._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],t._currentChunkSizeKB=384,t._currentSpeedNormalized=0,t._zeroSpeedChunkCount=0,t._xhr=null,t._speedSampler=new p.default,t._requestAbort=!1,t._waitForTotalLength=!1,t._totalLengthReceived=!1,t._currentRequestURL=null,t._currentRedirectedURL=null,t._currentRequestRange=null,t._totalLength=null,t._contentLength=null,t._receivedLength=0,t._lastTimeLoaded=0,t}return v.isSupported=function(){try{var d=new XMLHttpRequest;return d.open("GET","https://example.com",!0),d.responseType="arraybuffer",d.responseType==="arraybuffer"}catch(r){return T.default.w("RangeLoader",r.message),!1}},v.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),h.prototype.destroy.call(this)},Object.defineProperty(v.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),v.prototype.open=function(d,r){this._dataSource=d,this._range=r,this._status=u.LoaderStatus.kConnecting;var t=!1;this._dataSource.filesize!=null&&this._dataSource.filesize!==0&&(t=!0,this._totalLength=this._dataSource.filesize),!this._totalLengthReceived&&!t?(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1})):this._openSubRange()},v.prototype._openSubRange=function(){var d=this._currentChunkSizeKB*1024,r=this._range.from+this._receivedLength,t=r+d;this._contentLength!=null&&t-this._range.from>=this._contentLength&&(t=this._range.from+this._contentLength-1),this._currentRequestRange={from:r,to:t},this._internalOpen(this._dataSource,this._currentRequestRange)},v.prototype._internalOpen=function(d,r){this._lastTimeLoaded=0;var t=d.url;this._config.reuseRedirectedURL&&(this._currentRedirectedURL!=null?t=this._currentRedirectedURL:d.redirectedURL!=null&&(t=d.redirectedURL));var i=this._seekHandler.getConfig(t,r);this._currentRequestURL=i.url;var e=this._xhr=new XMLHttpRequest;if(e.open("GET",i.url,!0),e.responseType="arraybuffer",e.onreadystatechange=this._onReadyStateChange.bind(this),e.onprogress=this._onProgress.bind(this),e.onload=this._onLoad.bind(this),e.onerror=this._onXhrError.bind(this),d.withCredentials&&(e.withCredentials=!0),typeof i.headers=="object"){var a=i.headers;for(var o in a)a.hasOwnProperty(o)&&e.setRequestHeader(o,a[o])}if(typeof this._config.headers=="object"){var a=this._config.headers;for(var o in a)a.hasOwnProperty(o)&&e.setRequestHeader(o,a[o])}e.send()},v.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=u.LoaderStatus.kComplete},v.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},v.prototype._onReadyStateChange=function(d){var r=d.target;if(r.readyState===2){if(r.responseURL!=null){var t=this._seekHandler.removeURLParameters(r.responseURL);r.responseURL!==this._currentRequestURL&&t!==this._currentRedirectedURL&&(this._currentRedirectedURL=t,this._onURLRedirect&&this._onURLRedirect(t))}if(r.status>=200&&r.status<=299){if(this._waitForTotalLength)return;this._status=u.LoaderStatus.kBuffering}else if(this._status=u.LoaderStatus.kError,this._onError)this._onError(u.LoaderErrors.HTTP_STATUS_CODE_INVALID,{code:r.status,msg:r.statusText});else throw new n.RuntimeException("RangeLoader: Http code invalid, "+r.status+" "+r.statusText)}},v.prototype._onProgress=function(d){if(this._status!==u.LoaderStatus.kError){if(this._contentLength===null){var r=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,r=!0;var t=d.total;this._internalAbort(),t!=null&t!==0&&(this._totalLength=t)}if(this._range.to===-1?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,r){this._openSubRange();return}this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var i=d.loaded-this._lastTimeLoaded;this._lastTimeLoaded=d.loaded,this._speedSampler.addBytes(i)}},v.prototype._normalizeSpeed=function(d){var r=this._chunkSizeKBList,t=r.length-1,i=0,e=0,a=t;if(d<r[0])return r[0];for(;e<=a;){if(i=e+Math.floor((a-e)/2),i===t||d>=r[i]&&d<r[i+1])return r[i];r[i]<d?e=i+1:a=i-1}},v.prototype._onLoad=function(d){if(this._status!==u.LoaderStatus.kError){if(this._waitForTotalLength){this._waitForTotalLength=!1;return}this._lastTimeLoaded=0;var r=this._speedSampler.lastSecondKBps;if(r===0&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(r=this._speedSampler.currentKBps)),r!==0){var t=this._normalizeSpeed(r);this._currentSpeedNormalized!==t&&(this._currentSpeedNormalized=t,this._currentChunkSizeKB=t)}var i=d.target.response,e=this._range.from+this._receivedLength;this._receivedLength+=i.byteLength;var a=!1;this._contentLength!=null&&this._receivedLength<this._contentLength?this._openSubRange():a=!0,this._onDataArrival&&this._onDataArrival(i,e,this._receivedLength),a&&(this._status=u.LoaderStatus.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},v.prototype._onXhrError=function(d){this._status=u.LoaderStatus.kError;var r=0,t=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(r=u.LoaderErrors.EARLY_EOF,t={code:-1,msg:"RangeLoader meet Early-Eof"}):(r=u.LoaderErrors.EXCEPTION,t={code:-1,msg:d.constructor.name+" "+d.type}),this._onError)this._onError(r,t);else throw new n.RuntimeException(t.msg)},v}(u.BaseLoader);y.default=l},"./src/player/flv-player.js":function(c,y,M){M.r(y);var T=M("./node_modules/events/events.js"),p=M.n(T),u=M("./src/utils/logger.js"),n=M("./src/utils/browser.js"),f=M("./src/player/player-events.js"),l=M("./src/core/transmuxer.js"),h=M("./src/core/transmuxing-events.js"),v=M("./src/core/mse-controller.js"),d=M("./src/core/mse-events.js"),r=M("./src/player/player-errors.js"),t=M("./src/config.js"),i=M("./src/utils/exception.js"),e=function(){function a(o,s){if(this.TAG="FlvPlayer",this._type="FlvPlayer",this._emitter=new(p()),this._config=(0,t.createDefaultConfig)(),typeof s=="object"&&Object.assign(this._config,s),o.type.toLowerCase()!=="flv")throw new i.InvalidArgumentException("FlvPlayer requires an flv MediaDataSource input!");o.isLive===!0&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=o,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var g=n.default.chrome&&(n.default.version.major<50||n.default.version.major===50&&n.default.version.build<2661);this._alwaysSeekKeyframe=!!(g||n.default.msedge||n.default.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return a.prototype.destroy=function(){this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},a.prototype.on=function(o,s){var g=this;o===f.default.MEDIA_INFO?this._mediaInfo!=null&&Promise.resolve().then(function(){g._emitter.emit(f.default.MEDIA_INFO,g.mediaInfo)}):o===f.default.STATISTICS_INFO&&this._statisticsInfo!=null&&Promise.resolve().then(function(){g._emitter.emit(f.default.STATISTICS_INFO,g.statisticsInfo)}),this._emitter.addListener(o,s)},a.prototype.off=function(o,s){this._emitter.removeListener(o,s)},a.prototype.attachMediaElement=function(o){var s=this;if(this._mediaElement=o,o.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),o.addEventListener("seeking",this.e.onvSeeking),o.addEventListener("canplay",this.e.onvCanPlay),o.addEventListener("stalled",this.e.onvStalled),o.addEventListener("progress",this.e.onvProgress),this._msectl=new v.default(this._config),this._msectl.on(d.default.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(d.default.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(d.default.SOURCE_OPEN,function(){s._mseSourceOpened=!0,s._hasPendingLoad&&(s._hasPendingLoad=!1,s.load())}),this._msectl.on(d.default.ERROR,function(g){s._emitter.emit(f.default.ERROR,r.ErrorTypes.MEDIA_ERROR,r.ErrorDetails.MEDIA_MSE_ERROR,g)}),this._msectl.attachMediaElement(o),this._pendingSeekTime!=null)try{o.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(g){}},a.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},a.prototype.load=function(){var o=this;if(!this._mediaElement)throw new i.IllegalStateException("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new i.IllegalStateException("FlvPlayer.load() has been called, please call unload() first!");if(!this._hasPendingLoad){if(this._config.deferLoadAfterSourceOpen&&this._mseSourceOpened===!1){this._hasPendingLoad=!0;return}this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new l.default(this._mediaDataSource,this._config),this._transmuxer.on(h.default.INIT_SEGMENT,function(s,g){o._msectl.appendInitSegment(g)}),this._transmuxer.on(h.default.MEDIA_SEGMENT,function(s,g){if(o._msectl.appendMediaSegment(g),o._config.lazyLoad&&!o._config.isLive){var L=o._mediaElement.currentTime;g.info.endDts>=(L+o._config.lazyLoadMaxDuration)*1e3&&o._progressChecker==null&&(u.default.v(o.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),o._suspendTransmuxer())}}),this._transmuxer.on(h.default.LOADING_COMPLETE,function(){o._msectl.endOfStream(),o._emitter.emit(f.default.LOADING_COMPLETE)}),this._transmuxer.on(h.default.RECOVERED_EARLY_EOF,function(){o._emitter.emit(f.default.RECOVERED_EARLY_EOF)}),this._transmuxer.on(h.default.IO_ERROR,function(s,g){o._emitter.emit(f.default.ERROR,r.ErrorTypes.NETWORK_ERROR,s,g)}),this._transmuxer.on(h.default.DEMUX_ERROR,function(s,g){o._emitter.emit(f.default.ERROR,r.ErrorTypes.MEDIA_ERROR,s,{code:-1,msg:g})}),this._transmuxer.on(h.default.MEDIA_INFO,function(s){o._mediaInfo=s,o._emitter.emit(f.default.MEDIA_INFO,Object.assign({},s))}),this._transmuxer.on(h.default.METADATA_ARRIVED,function(s){o._emitter.emit(f.default.METADATA_ARRIVED,s)}),this._transmuxer.on(h.default.SCRIPTDATA_ARRIVED,function(s){o._emitter.emit(f.default.SCRIPTDATA_ARRIVED,s)}),this._transmuxer.on(h.default.STATISTICS_INFO,function(s){o._statisticsInfo=o._fillStatisticsInfo(s),o._emitter.emit(f.default.STATISTICS_INFO,Object.assign({},o._statisticsInfo))}),this._transmuxer.on(h.default.RECOMMEND_SEEKPOINT,function(s){o._mediaElement&&!o._config.accurateSeek&&(o._requestSetTime=!0,o._mediaElement.currentTime=s/1e3)}),this._transmuxer.open()}},a.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},a.prototype.play=function(){return this._mediaElement.play()},a.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(a.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(o){this._mediaElement.volume=o},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(o){this._mediaElement.muted=o},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(o){this._mediaElement?this._internalSeek(o):this._pendingSeekTime=o},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"statisticsInfo",{get:function(){return this._statisticsInfo==null&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),a.prototype._fillStatisticsInfo=function(o){if(o.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return o;var s=!0,g=0,L=0;if(this._mediaElement.getVideoPlaybackQuality){var A=this._mediaElement.getVideoPlaybackQuality();g=A.totalVideoFrames,L=A.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(g=this._mediaElement.webkitDecodedFrameCount,L=this._mediaElement.webkitDroppedFrameCount):s=!1;return s&&(o.decodedFrames=g,o.droppedFrames=L),o},a.prototype._onmseUpdateEnd=function(){if(!(!this._config.lazyLoad||this._config.isLive)){for(var o=this._mediaElement.buffered,s=this._mediaElement.currentTime,g=0,L=0;L<o.length;L++){var A=o.start(L),m=o.end(L);if(A<=s&&s<m){g=m;break}}g>=s+this._config.lazyLoadMaxDuration&&this._progressChecker==null&&(u.default.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},a.prototype._onmseBufferFull=function(){u.default.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),this._progressChecker==null&&this._suspendTransmuxer()},a.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),this._progressChecker==null&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},a.prototype._checkProgressAndResume=function(){for(var o=this._mediaElement.currentTime,s=this._mediaElement.buffered,g=!1,L=0;L<s.length;L++){var A=s.start(L),m=s.end(L);if(o>=A&&o<m){o>=m-this._config.lazyLoadRecoverDuration&&(g=!0);break}}g&&(window.clearInterval(this._progressChecker),this._progressChecker=null,g&&(u.default.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},a.prototype._isTimepointBuffered=function(o){for(var s=this._mediaElement.buffered,g=0;g<s.length;g++){var L=s.start(g),A=s.end(g);if(o>=L&&o<A)return!0}return!1},a.prototype._internalSeek=function(o){var s=this._isTimepointBuffered(o),g=!1,L=0;if(o<1&&this._mediaElement.buffered.length>0){var A=this._mediaElement.buffered.start(0);(A<1&&o<A||n.default.safari)&&(g=!0,L=n.default.safari?.1:A)}if(g)this._requestSetTime=!0,this._mediaElement.currentTime=L;else if(s){if(!this._alwaysSeekKeyframe)this._requestSetTime=!0,this._mediaElement.currentTime=o;else{var m=this._msectl.getNearestKeyframe(Math.floor(o*1e3));this._requestSetTime=!0,m!=null?this._mediaElement.currentTime=m.dts/1e3:this._mediaElement.currentTime=o}this._progressChecker!=null&&this._checkProgressAndResume()}else this._progressChecker!=null&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(o),this._transmuxer.seek(Math.floor(o*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=o)},a.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var o=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(o)||(this._progressChecker!=null&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(o),this._transmuxer.seek(Math.floor(o*1e3)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=o))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},a.prototype._checkAndResumeStuckPlayback=function(o){var s=this._mediaElement;if(o||!this._receivedCanPlay||s.readyState<2){var g=s.buffered;g.length>0&&s.currentTime<g.start(0)&&(u.default.w(this.TAG,"Playback seems stuck at "+s.currentTime+", seek to "+g.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=g.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},a.prototype._onvLoadedMetadata=function(o){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},a.prototype._onvSeeking=function(o){var s=this._mediaElement.currentTime,g=this._mediaElement.buffered;if(this._requestSetTime){this._requestSetTime=!1;return}if(s<1&&g.length>0){var L=g.start(0);if(L<1&&s<L||n.default.safari){this._requestSetTime=!0,this._mediaElement.currentTime=n.default.safari?.1:L;return}}if(this._isTimepointBuffered(s)){if(this._alwaysSeekKeyframe){var A=this._msectl.getNearestKeyframe(Math.floor(s*1e3));A!=null&&(this._requestSetTime=!0,this._mediaElement.currentTime=A.dts/1e3)}this._progressChecker!=null&&this._checkProgressAndResume();return}this._seekpointRecord={seekPoint:s,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},a.prototype._onvCanPlay=function(o){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},a.prototype._onvStalled=function(o){this._checkAndResumeStuckPlayback(!0)},a.prototype._onvProgress=function(o){this._checkAndResumeStuckPlayback()},a}();y.default=e},"./src/player/native-player.js":function(c,y,M){M.r(y);var T=M("./node_modules/events/events.js"),p=M.n(T),u=M("./src/player/player-events.js"),n=M("./src/config.js"),f=M("./src/utils/exception.js"),l=function(){function h(v,d){if(this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new(p()),this._config=(0,n.createDefaultConfig)(),typeof d=="object"&&Object.assign(this._config,d),v.type.toLowerCase()==="flv")throw new f.InvalidArgumentException("NativePlayer does't support flv MediaDataSource input!");if(v.hasOwnProperty("segments"))throw new f.InvalidArgumentException("NativePlayer("+v.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=v,this._mediaElement=null}return h.prototype.destroy=function(){this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},h.prototype.on=function(v,d){var r=this;v===u.default.MEDIA_INFO?this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){r._emitter.emit(u.default.MEDIA_INFO,r.mediaInfo)}):v===u.default.STATISTICS_INFO&&this._mediaElement!=null&&this._mediaElement.readyState!==0&&Promise.resolve().then(function(){r._emitter.emit(u.default.STATISTICS_INFO,r.statisticsInfo)}),this._emitter.addListener(v,d)},h.prototype.off=function(v,d){this._emitter.removeListener(v,d)},h.prototype.attachMediaElement=function(v){if(this._mediaElement=v,v.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._pendingSeekTime!=null)try{v.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(d){}},h.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},h.prototype.load=function(){if(!this._mediaElement)throw new f.IllegalStateException("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},h.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),this._statisticsReporter!=null&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},h.prototype.play=function(){return this._mediaElement.play()},h.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(h.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(v){this._mediaElement.volume=v},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(v){this._mediaElement.muted=v},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(v){this._mediaElement?this._mediaElement.currentTime=v:this._pendingSeekTime=v},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"mediaInfo",{get:function(){var v=this._mediaElement instanceof HTMLAudioElement?"audio/":"video/",d={mimeType:v+this._mediaDataSource.type};return this._mediaElement&&(d.duration=Math.floor(this._mediaElement.duration*1e3),this._mediaElement instanceof HTMLVideoElement&&(d.width=this._mediaElement.videoWidth,d.height=this._mediaElement.videoHeight)),d},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"statisticsInfo",{get:function(){var v={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return v;var d=!0,r=0,t=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();r=i.totalVideoFrames,t=i.droppedVideoFrames}else this._mediaElement.webkitDecodedFrameCount!=null?(r=this._mediaElement.webkitDecodedFrameCount,t=this._mediaElement.webkitDroppedFrameCount):d=!1;return d&&(v.decodedFrames=r,v.droppedFrames=t),v},enumerable:!1,configurable:!0}),h.prototype._onvLoadedMetadata=function(v){this._pendingSeekTime!=null&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(u.default.MEDIA_INFO,this.mediaInfo)},h.prototype._reportStatisticsInfo=function(){this._emitter.emit(u.default.STATISTICS_INFO,this.statisticsInfo)},h}();y.default=l},"./src/player/player-errors.js":function(c,y,M){M.r(y),M.d(y,{ErrorTypes:function(){return u},ErrorDetails:function(){return n}});var T=M("./src/io/loader.js"),p=M("./src/demux/demux-errors.js"),u={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},n={NETWORK_EXCEPTION:T.LoaderErrors.EXCEPTION,NETWORK_STATUS_CODE_INVALID:T.LoaderErrors.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:T.LoaderErrors.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:T.LoaderErrors.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:p.default.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:p.default.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:p.default.CODEC_UNSUPPORTED}},"./src/player/player-events.js":function(c,y,M){M.r(y);var T={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",STATISTICS_INFO:"statistics_info"};y.default=T},"./src/remux/aac-silent.js":function(c,y,M){M.r(y);var T=function(){function p(){}return p.getSilentFrame=function(u,n){if(u==="mp4a.40.2"){if(n===1)return new Uint8Array([0,200,0,128,35,128]);if(n===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(n===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(n===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(n===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(n===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(n===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(n===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},p}();y.default=T},"./src/remux/mp4-generator.js":function(c,y,M){M.r(y);var T=function(){function p(){}return p.init=function(){p.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[]};for(var u in p.types)p.types.hasOwnProperty(u)&&(p.types[u]=[u.charCodeAt(0),u.charCodeAt(1),u.charCodeAt(2),u.charCodeAt(3)]);var n=p.constants={};n.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),n.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),n.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSC=n.STCO=n.STTS,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),n.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},p.box=function(u){for(var n=8,f=null,l=Array.prototype.slice.call(arguments,1),h=l.length,v=0;v<h;v++)n+=l[v].byteLength;f=new Uint8Array(n),f[0]=n>>>24&255,f[1]=n>>>16&255,f[2]=n>>>8&255,f[3]=n&255,f.set(u,4);for(var d=8,v=0;v<h;v++)f.set(l[v],d),d+=l[v].byteLength;return f},p.generateInitSegment=function(u){var n=p.box(p.types.ftyp,p.constants.FTYP),f=p.moov(u),l=new Uint8Array(n.byteLength+f.byteLength);return l.set(n,0),l.set(f,n.byteLength),l},p.moov=function(u){var n=p.mvhd(u.timescale,u.duration),f=p.trak(u),l=p.mvex(u);return p.box(p.types.moov,n,f,l)},p.mvhd=function(u,n){return p.box(p.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},p.trak=function(u){return p.box(p.types.trak,p.tkhd(u),p.mdia(u))},p.tkhd=function(u){var n=u.id,f=u.duration,l=u.presentWidth,h=u.presentHeight;return p.box(p.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,l>>>8&255,l&255,0,0,h>>>8&255,h&255,0,0]))},p.mdia=function(u){return p.box(p.types.mdia,p.mdhd(u),p.hdlr(u),p.minf(u))},p.mdhd=function(u){var n=u.timescale,f=u.duration;return p.box(p.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,f>>>24&255,f>>>16&255,f>>>8&255,f&255,85,196,0,0]))},p.hdlr=function(u){var n=null;return u.type==="audio"?n=p.constants.HDLR_AUDIO:n=p.constants.HDLR_VIDEO,p.box(p.types.hdlr,n)},p.minf=function(u){var n=null;return u.type==="audio"?n=p.box(p.types.smhd,p.constants.SMHD):n=p.box(p.types.vmhd,p.constants.VMHD),p.box(p.types.minf,n,p.dinf(),p.stbl(u))},p.dinf=function(){var u=p.box(p.types.dinf,p.box(p.types.dref,p.constants.DREF));return u},p.stbl=function(u){var n=p.box(p.types.stbl,p.stsd(u),p.box(p.types.stts,p.constants.STTS),p.box(p.types.stsc,p.constants.STSC),p.box(p.types.stsz,p.constants.STSZ),p.box(p.types.stco,p.constants.STCO));return n},p.stsd=function(u){return u.type==="audio"?u.codec==="mp3"?p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp3(u)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.mp4a(u)):p.box(p.types.stsd,p.constants.STSD_PREFIX,p.avc1(u))},p.mp3=function(u){var n=u.channelCount,f=u.audioSampleRate,l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,f>>>8&255,f&255,0,0]);return p.box(p.types[".mp3"],l)},p.mp4a=function(u){var n=u.channelCount,f=u.audioSampleRate,l=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,n,0,16,0,0,0,0,f>>>8&255,f&255,0,0]);return p.box(p.types.mp4a,l,p.esds(u))},p.esds=function(u){var n=u.config||[],f=n.length,l=new Uint8Array([0,0,0,0,3,23+f,0,1,0,4,15+f,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([f]).concat(n).concat([6,1,2]));return p.box(p.types.esds,l)},p.avc1=function(u){var n=u.avcc,f=u.codecWidth,l=u.codecHeight,h=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,f>>>8&255,f&255,l>>>8&255,l&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return p.box(p.types.avc1,h,p.box(p.types.avcC,n))},p.mvex=function(u){return p.box(p.types.mvex,p.trex(u))},p.trex=function(u){var n=u.id,f=new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return p.box(p.types.trex,f)},p.moof=function(u,n){return p.box(p.types.moof,p.mfhd(u.sequenceNumber),p.traf(u,n))},p.mfhd=function(u){var n=new Uint8Array([0,0,0,0,u>>>24&255,u>>>16&255,u>>>8&255,u&255]);return p.box(p.types.mfhd,n)},p.traf=function(u,n){var f=u.id,l=p.box(p.types.tfhd,new Uint8Array([0,0,0,0,f>>>24&255,f>>>16&255,f>>>8&255,f&255])),h=p.box(p.types.tfdt,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,n&255])),v=p.sdtp(u),d=p.trun(u,v.byteLength+16+16+8+16+8+8);return p.box(p.types.traf,l,h,d,v)},p.sdtp=function(u){for(var n=u.samples||[],f=n.length,l=new Uint8Array(4+f),h=0;h<f;h++){var v=n[h].flags;l[h+4]=v.isLeading<<6|v.dependsOn<<4|v.isDependedOn<<2|v.hasRedundancy}return p.box(p.types.sdtp,l)},p.trun=function(u,n){var f=u.samples||[],l=f.length,h=12+16*l,v=new Uint8Array(h);n+=8+h,v.set([0,0,15,1,l>>>24&255,l>>>16&255,l>>>8&255,l&255,n>>>24&255,n>>>16&255,n>>>8&255,n&255],0);for(var d=0;d<l;d++){var r=f[d].duration,t=f[d].size,i=f[d].flags,e=f[d].cts;v.set([r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255,i.isLeading<<2|i.dependsOn,i.isDependedOn<<6|i.hasRedundancy<<4|i.isNonSync,0,0,e>>>24&255,e>>>16&255,e>>>8&255,e&255],12+16*d)}return p.box(p.types.trun,v)},p.mdat=function(u){return p.box(p.types.mdat,u)},p}();T.init(),y.default=T},"./src/remux/mp4-remuxer.js":function(c,y,M){M.r(y);var T=M("./src/utils/logger.js"),p=M("./src/remux/mp4-generator.js"),u=M("./src/remux/aac-silent.js"),n=M("./src/utils/browser.js"),f=M("./src/core/media-segment-info.js"),l=M("./src/utils/exception.js"),h=function(){function v(d){this.TAG="MP4Remuxer",this._config=d,this._isLive=d.isLive===!0,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new f.MediaSegmentInfoList("audio"),this._videoSegmentInfoList=new f.MediaSegmentInfoList("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!!(n.default.chrome&&(n.default.version.major<50||n.default.version.major===50&&n.default.version.build<2661)),this._fillSilentAfterSeek=n.default.msedge||n.default.msie,this._mp3UseMpegAudio=!n.default.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return v.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},v.prototype.bindDataSource=function(d){return d.onDataAvailable=this.remux.bind(this),d.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(v.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(d){this._onInitSegment=d},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(d){this._onMediaSegment=d},enumerable:!1,configurable:!0}),v.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},v.prototype.seek=function(d){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},v.prototype.remux=function(d,r){if(!this._onMediaSegment)throw new l.IllegalStateException("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(d,r),this._remuxVideo(r),this._remuxAudio(d)},v.prototype._onTrackMetadataReceived=function(d,r){var t=null,i="mp4",e=r.codec;if(d==="audio")this._audioMeta=r,r.codec==="mp3"&&this._mp3UseMpegAudio?(i="mpeg",e="",t=new Uint8Array):t=p.default.generateInitSegment(r);else if(d==="video")this._videoMeta=r,t=p.default.generateInitSegment(r);else return;if(!this._onInitSegment)throw new l.IllegalStateException("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(d,{type:d,data:t.buffer,codec:e,container:d+"/"+i,mediaDuration:r.duration})},v.prototype._calculateDtsBase=function(d,r){this._dtsBaseInited||(d.samples&&d.samples.length&&(this._audioDtsBase=d.samples[0].dts),r.samples&&r.samples.length&&(this._videoDtsBase=r.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},v.prototype.flushStashedSamples=function(){var d=this._videoStashedLastSample,r=this._audioStashedLastSample,t={type:"video",id:1,sequenceNumber:0,samples:[],length:0};d!=null&&(t.samples.push(d),t.length=d.length);var i={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};r!=null&&(i.samples.push(r),i.length=r.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(t,!0),this._remuxAudio(i,!0)},v.prototype._remuxAudio=function(d,r){if(this._audioMeta!=null){var t=d,i=t.samples,e=void 0,a=-1,o=-1,s=this._audioMeta.refSampleDuration,g=this._audioMeta.codec==="mp3"&&this._mp3UseMpegAudio,L=this._dtsBaseInited&&this._audioNextDts===void 0,A=!1;if(!(!i||i.length===0)&&!(i.length===1&&!r)){var m=0,E=null,x=0;g?(m=0,x=t.length):(m=8,x=8+t.length);var D=null;if(i.length>1&&(D=i.pop(),x-=D.length),this._audioStashedLastSample!=null){var I=this._audioStashedLastSample;this._audioStashedLastSample=null,i.unshift(I),x+=I.length}D!=null&&(this._audioStashedLastSample=D);var b=i[0].dts-this._dtsBase;if(this._audioNextDts)e=b-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())e=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&this._audioMeta.originalCodec!=="mp3"&&(A=!0);else{var R=this._audioSegmentInfoList.getLastSampleBefore(b);if(R!=null){var P=b-(R.originalDts+R.duration);P<=3&&(P=0);var w=R.dts+R.duration+P;e=b-w}else e=0}if(A){var F=b-e,k=this._videoSegmentInfoList.getLastSegmentBefore(b);if(k!=null&&k.beginDts<F){var B=u.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);if(B){var U=k.beginDts,j=F-k.beginDts;T.default.v(this.TAG,"InsertPrefixSilentAudio: dts: "+U+", duration: "+j),i.unshift({unit:B,dts:U,pts:U}),x+=B.byteLength}}else A=!1}for(var K=[],N=0;N<i.length;N++){var I=i[N],Z=I.unit,$=I.dts-this._dtsBase,U=$,Y=!1,ee=null,Q=0;if(!($<-.001)){if(this._audioMeta.codec!=="mp3"){var G=$,q=3;if(this._audioNextDts&&(G=this._audioNextDts),e=$-G,e<=-q*s){T.default.w(this.TAG,"Dropping 1 audio frame (originalDts: "+$+" ms ,curRefDts: "+G+" ms)  due to dtsCorrection: "+e+" ms overlap.");continue}else if(e>=q*s&&this._fillAudioTimestampGap&&!n.default.safari){Y=!0;var te=Math.floor(e/s);T.default.w(this.TAG,`Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.
`+("originalDts: "+$+" ms, curRefDts: "+G+" ms, ")+("dtsCorrection: "+Math.round(e)+" ms, generate: "+te+" frames")),U=Math.floor(G),Q=Math.floor(G+s)-U;var B=u.default.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount);B==null&&(T.default.w(this.TAG,"Unable to generate silent frame for "+(this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame")),B=Z),ee=[];for(var ie=0;ie<te;ie++){G=G+s;var ne=Math.floor(G),le=Math.floor(G+s)-ne,ae={dts:ne,pts:ne,cts:0,unit:B,size:B.byteLength,duration:le,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};ee.push(ae),x+=ae.size}this._audioNextDts=G+s}else U=Math.floor(G),Q=Math.floor(G+s)-U,this._audioNextDts=G+s}else{if(U=$-e,N!==i.length-1){var oe=i[N+1].dts-this._dtsBase-e;Q=oe-U}else if(D!=null){var oe=D.dts-this._dtsBase-e;Q=oe-U}else K.length>=1?Q=K[K.length-1].duration:Q=Math.floor(s);this._audioNextDts=U+Q}a===-1&&(a=U),K.push({dts:U,pts:U,cts:0,unit:I.unit,size:I.unit.byteLength,duration:Q,originalDts:$,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),Y&&K.push.apply(K,ee)}}if(K.length===0){t.samples=[],t.length=0;return}g?E=new Uint8Array(x):(E=new Uint8Array(x),E[0]=x>>>24&255,E[1]=x>>>16&255,E[2]=x>>>8&255,E[3]=x&255,E.set(p.default.types.mdat,4));for(var N=0;N<K.length;N++){var Z=K[N].unit;E.set(Z,m),m+=Z.byteLength}var J=K[K.length-1];o=J.dts+J.duration;var se=new f.MediaSegmentInfo;se.beginDts=a,se.endDts=o,se.beginPts=a,se.endPts=o,se.originalBeginDts=K[0].originalDts,se.originalEndDts=J.originalDts+J.duration,se.firstSample=new f.SampleInfo(K[0].dts,K[0].pts,K[0].duration,K[0].originalDts,!1),se.lastSample=new f.SampleInfo(J.dts,J.pts,J.duration,J.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(se),t.samples=K,t.sequenceNumber++;var fe=null;g?fe=new Uint8Array:fe=p.default.moof(t,a),t.samples=[],t.length=0;var de={type:"audio",data:this._mergeBoxes(fe,E).buffer,sampleCount:K.length,info:se};g&&L&&(de.timestampOffset=a),this._onMediaSegment("audio",de)}}},v.prototype._remuxVideo=function(d,r){if(this._videoMeta!=null){var t=d,i=t.samples,e=void 0,a=-1,o=-1,s=-1,g=-1;if(!(!i||i.length===0)&&!(i.length===1&&!r)){var L=8,A=null,m=8+d.length,E=null;if(i.length>1&&(E=i.pop(),m-=E.length),this._videoStashedLastSample!=null){var x=this._videoStashedLastSample;this._videoStashedLastSample=null,i.unshift(x),m+=x.length}E!=null&&(this._videoStashedLastSample=E);var D=i[0].dts-this._dtsBase;if(this._videoNextDts)e=D-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())e=0;else{var I=this._videoSegmentInfoList.getLastSampleBefore(D);if(I!=null){var b=D-(I.originalDts+I.duration);b<=3&&(b=0);var R=I.dts+I.duration+b;e=D-R}else e=0}for(var P=new f.MediaSegmentInfo,w=[],F=0;F<i.length;F++){var x=i[F],k=x.dts-this._dtsBase,B=x.isKeyframe,U=k-e,j=x.cts,K=U+j;a===-1&&(a=U,s=K);var N=0;if(F!==i.length-1){var Z=i[F+1].dts-this._dtsBase-e;N=Z-U}else if(E!=null){var Z=E.dts-this._dtsBase-e;N=Z-U}else w.length>=1?N=w[w.length-1].duration:N=Math.floor(this._videoMeta.refSampleDuration);if(B){var $=new f.SampleInfo(U,K,N,x.dts,!0);$.fileposition=x.fileposition,P.appendSyncPoint($)}w.push({dts:U,pts:K,cts:j,units:x.units,size:x.length,isKeyframe:B,duration:N,originalDts:k,flags:{isLeading:0,dependsOn:B?2:1,isDependedOn:B?1:0,hasRedundancy:0,isNonSync:B?0:1}})}A=new Uint8Array(m),A[0]=m>>>24&255,A[1]=m>>>16&255,A[2]=m>>>8&255,A[3]=m&255,A.set(p.default.types.mdat,4);for(var F=0;F<w.length;F++)for(var Y=w[F].units;Y.length;){var ee=Y.shift(),Q=ee.data;A.set(Q,L),L+=Q.byteLength}var G=w[w.length-1];if(o=G.dts+G.duration,g=G.pts+G.duration,this._videoNextDts=o,P.beginDts=a,P.endDts=o,P.beginPts=s,P.endPts=g,P.originalBeginDts=w[0].originalDts,P.originalEndDts=G.originalDts+G.duration,P.firstSample=new f.SampleInfo(w[0].dts,w[0].pts,w[0].duration,w[0].originalDts,w[0].isKeyframe),P.lastSample=new f.SampleInfo(G.dts,G.pts,G.duration,G.originalDts,G.isKeyframe),this._isLive||this._videoSegmentInfoList.append(P),t.samples=w,t.sequenceNumber++,this._forceFirstIDR){var q=w[0].flags;q.dependsOn=2,q.isNonSync=0}var te=p.default.moof(t,a);t.samples=[],t.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(te,A).buffer,sampleCount:w.length,info:P})}}},v.prototype._mergeBoxes=function(d,r){var t=new Uint8Array(d.byteLength+r.byteLength);return t.set(d,0),t.set(r,d.byteLength),t},v}();y.default=h},"./src/utils/browser.js":function(c,y,M){M.r(y);var T={};function p(){var u=self.navigator.userAgent.toLowerCase(),n=/(edge)\/([\w.]+)/.exec(u)||/(opr)[\/]([\w.]+)/.exec(u)||/(chrome)[ \/]([\w.]+)/.exec(u)||/(iemobile)[\/]([\w.]+)/.exec(u)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(u)||/(webkit)[ \/]([\w.]+)/.exec(u)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(u)||/(msie) ([\w.]+)/.exec(u)||u.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(u)||u.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(u)||[],f=/(ipad)/.exec(u)||/(ipod)/.exec(u)||/(windows phone)/.exec(u)||/(iphone)/.exec(u)||/(kindle)/.exec(u)||/(android)/.exec(u)||/(windows)/.exec(u)||/(mac)/.exec(u)||/(linux)/.exec(u)||/(cros)/.exec(u)||[],l={browser:n[5]||n[3]||n[1]||"",version:n[2]||n[4]||"0",majorVersion:n[4]||n[2]||"0",platform:f[0]||""},h={};if(l.browser){h[l.browser]=!0;var v=l.majorVersion.split(".");h.version={major:parseInt(l.majorVersion,10),string:l.version},v.length>1&&(h.version.minor=parseInt(v[1],10)),v.length>2&&(h.version.build=parseInt(v[2],10))}if(l.platform&&(h[l.platform]=!0),(h.chrome||h.opr||h.safari)&&(h.webkit=!0),h.rv||h.iemobile){h.rv&&delete h.rv;var d="msie";l.browser=d,h[d]=!0}if(h.edge){delete h.edge;var r="msedge";l.browser=r,h[r]=!0}if(h.opr){var t="opera";l.browser=t,h[t]=!0}if(h.safari&&h.android){var i="android";l.browser=i,h[i]=!0}h.name=l.browser,h.platform=l.platform;for(var e in T)T.hasOwnProperty(e)&&delete T[e];Object.assign(T,h)}p(),y.default=T},"./src/utils/exception.js":function(c,y,M){M.r(y),M.d(y,{RuntimeException:function(){return p},IllegalStateException:function(){return u},InvalidArgumentException:function(){return n},NotImplementedException:function(){return f}});var T=function(){var l=function(h,v){return l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,r){d.__proto__=r}||function(d,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(d[t]=r[t])},l(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");l(h,v);function d(){this.constructor=h}h.prototype=v===null?Object.create(v):(d.prototype=v.prototype,new d)}}(),p=function(){function l(h){this._message=h}return Object.defineProperty(l.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(l.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),l.prototype.toString=function(){return this.name+": "+this.message},l}(),u=function(l){T(h,l);function h(v){return l.call(this,v)||this}return Object.defineProperty(h.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),h}(p),n=function(l){T(h,l);function h(v){return l.call(this,v)||this}return Object.defineProperty(h.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),h}(p),f=function(l){T(h,l);function h(v){return l.call(this,v)||this}return Object.defineProperty(h.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),h}(p)},"./src/utils/logger.js":function(c,y,M){M.r(y);var T=M("./node_modules/events/events.js"),p=M.n(T),u=function(){function n(){}return n.e=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var h="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","error",h),n.ENABLE_ERROR&&(console.error?console.error(h):console.warn?console.warn(h):console.log(h))},n.i=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var h="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","info",h),n.ENABLE_INFO&&(console.info?console.info(h):console.log(h))},n.w=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var h="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","warn",h),n.ENABLE_WARN&&(console.warn?console.warn(h):console.log(h))},n.d=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var h="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","debug",h),n.ENABLE_DEBUG&&(console.debug?console.debug(h):console.log(h))},n.v=function(f,l){(!f||n.FORCE_GLOBAL_TAG)&&(f=n.GLOBAL_TAG);var h="["+f+"] > "+l;n.ENABLE_CALLBACK&&n.emitter.emit("log","verbose",h),n.ENABLE_VERBOSE&&console.log(h)},n}();u.GLOBAL_TAG="flv.js",u.FORCE_GLOBAL_TAG=!1,u.ENABLE_ERROR=!0,u.ENABLE_INFO=!0,u.ENABLE_WARN=!0,u.ENABLE_DEBUG=!0,u.ENABLE_VERBOSE=!0,u.ENABLE_CALLBACK=!1,u.emitter=new(p()),y.default=u},"./src/utils/logging-control.js":function(c,y,M){M.r(y);var T=M("./node_modules/events/events.js"),p=M.n(T),u=M("./src/utils/logger.js"),n=function(){function f(){}return Object.defineProperty(f,"forceGlobalTag",{get:function(){return u.default.FORCE_GLOBAL_TAG},set:function(l){u.default.FORCE_GLOBAL_TAG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"globalTag",{get:function(){return u.default.GLOBAL_TAG},set:function(l){u.default.GLOBAL_TAG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableAll",{get:function(){return u.default.ENABLE_VERBOSE&&u.default.ENABLE_DEBUG&&u.default.ENABLE_INFO&&u.default.ENABLE_WARN&&u.default.ENABLE_ERROR},set:function(l){u.default.ENABLE_VERBOSE=l,u.default.ENABLE_DEBUG=l,u.default.ENABLE_INFO=l,u.default.ENABLE_WARN=l,u.default.ENABLE_ERROR=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableDebug",{get:function(){return u.default.ENABLE_DEBUG},set:function(l){u.default.ENABLE_DEBUG=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableVerbose",{get:function(){return u.default.ENABLE_VERBOSE},set:function(l){u.default.ENABLE_VERBOSE=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableInfo",{get:function(){return u.default.ENABLE_INFO},set:function(l){u.default.ENABLE_INFO=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableWarn",{get:function(){return u.default.ENABLE_WARN},set:function(l){u.default.ENABLE_WARN=l,f._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(f,"enableError",{get:function(){return u.default.ENABLE_ERROR},set:function(l){u.default.ENABLE_ERROR=l,f._notifyChange()},enumerable:!1,configurable:!0}),f.getConfig=function(){return{globalTag:u.default.GLOBAL_TAG,forceGlobalTag:u.default.FORCE_GLOBAL_TAG,enableVerbose:u.default.ENABLE_VERBOSE,enableDebug:u.default.ENABLE_DEBUG,enableInfo:u.default.ENABLE_INFO,enableWarn:u.default.ENABLE_WARN,enableError:u.default.ENABLE_ERROR,enableCallback:u.default.ENABLE_CALLBACK}},f.applyConfig=function(l){u.default.GLOBAL_TAG=l.globalTag,u.default.FORCE_GLOBAL_TAG=l.forceGlobalTag,u.default.ENABLE_VERBOSE=l.enableVerbose,u.default.ENABLE_DEBUG=l.enableDebug,u.default.ENABLE_INFO=l.enableInfo,u.default.ENABLE_WARN=l.enableWarn,u.default.ENABLE_ERROR=l.enableError,u.default.ENABLE_CALLBACK=l.enableCallback},f._notifyChange=function(){var l=f.emitter;if(l.listenerCount("change")>0){var h=f.getConfig();l.emit("change",h)}},f.registerListener=function(l){f.emitter.addListener("change",l)},f.removeListener=function(l){f.emitter.removeListener("change",l)},f.addLogListener=function(l){u.default.emitter.addListener("log",l),u.default.emitter.listenerCount("log")>0&&(u.default.ENABLE_CALLBACK=!0,f._notifyChange())},f.removeLogListener=function(l){u.default.emitter.removeListener("log",l),u.default.emitter.listenerCount("log")===0&&(u.default.ENABLE_CALLBACK=!1,f._notifyChange())},f}();n.emitter=new(p()),y.default=n},"./src/utils/polyfill.js":function(c,y,M){M.r(y);var T=function(){function p(){}return p.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(u,n){return u.__proto__=n,u},Object.assign=Object.assign||function(u){if(u==null)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(u),f=1;f<arguments.length;f++){var l=arguments[f];if(l!=null)for(var h in l)l.hasOwnProperty(h)&&(n[h]=l[h])}return n},typeof self.Promise!="function"&&M("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},p}();T.install(),y.default=T},"./src/utils/utf8-conv.js":function(c,y,M){M.r(y);function T(u,n,f){var l=u;if(n+f<l.length){for(;f--;)if((l[++n]&192)!==128)return!1;return!0}else return!1}function p(u){for(var n=[],f=u,l=0,h=u.length;l<h;){if(f[l]<128){n.push(String.fromCharCode(f[l])),++l;continue}else if(!(f[l]<192)){if(f[l]<224){if(T(f,l,1)){var v=(f[l]&31)<<6|f[l+1]&63;if(v>=128){n.push(String.fromCharCode(v&65535)),l+=2;continue}}}else if(f[l]<240){if(T(f,l,2)){var v=(f[l]&15)<<12|(f[l+1]&63)<<6|f[l+2]&63;if(v>=2048&&(v&63488)!==55296){n.push(String.fromCharCode(v&65535)),l+=3;continue}}}else if(f[l]<248&&T(f,l,3)){var v=(f[l]&7)<<18|(f[l+1]&63)<<12|(f[l+2]&63)<<6|f[l+3]&63;if(v>65536&&v<1114112){v-=65536,n.push(String.fromCharCode(v>>>10|55296)),n.push(String.fromCharCode(v&1023|56320)),l+=4;continue}}}n.push(String.fromCharCode(65533)),++l}return n.join("")}y.default=p}},C={};function _(c){var y=C[c];if(y!==void 0)return y.exports;var M=C[c]={exports:{}};return O[c].call(M.exports,M,M.exports,_),M.exports}_.m=O,function(){_.n=function(c){var y=c&&c.__esModule?function(){return c.default}:function(){return c};return _.d(y,{a:y}),y}}(),function(){_.d=function(c,y){for(var M in y)_.o(y,M)&&!_.o(c,M)&&Object.defineProperty(c,M,{enumerable:!0,get:y[M]})}}(),function(){_.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(c){if(typeof window=="object")return window}}()}(),function(){_.o=function(c,y){return Object.prototype.hasOwnProperty.call(c,y)}}(),function(){_.r=function(c){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(c,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(c,"__esModule",{value:!0})}}();var S=_("./src/index.js");return S}()})})(Je);var Qe=We(Je.exports),qe={exports:{}};(function(he,ve){typeof window!="undefined"&&function(C,_){he.exports=_()}(Ke,function(){return function(O){var C={};function _(S){if(C[S])return C[S].exports;var c=C[S]={i:S,l:!1,exports:{}};return O[S].call(c.exports,c,c.exports,_),c.l=!0,c.exports}return _.m=O,_.c=C,_.d=function(S,c,y){_.o(S,c)||Object.defineProperty(S,c,{enumerable:!0,get:y})},_.r=function(S){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(S,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(S,"__esModule",{value:!0})},_.t=function(S,c){if(c&1&&(S=_(S)),c&8||c&4&&typeof S=="object"&&S&&S.__esModule)return S;var y=Object.create(null);if(_.r(y),Object.defineProperty(y,"default",{enumerable:!0,value:S}),c&2&&typeof S!="string")for(var M in S)_.d(y,M,function(T){return S[T]}.bind(null,M));return y},_.n=function(S){var c=S&&S.__esModule?function(){return S.default}:function(){return S};return _.d(c,"a",c),c},_.o=function(S,c){return Object.prototype.hasOwnProperty.call(S,c)},_.p="/dist/",_(_.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(O,C,_){var S=Object.prototype.hasOwnProperty,c="~";function y(){}Object.create&&(y.prototype=Object.create(null),new y().__proto__||(c=!1));function M(n,f,l){this.fn=n,this.context=f,this.once=l||!1}function T(n,f,l,h,v){if(typeof l!="function")throw new TypeError("The listener must be a function");var d=new M(l,h||n,v),r=c?c+f:f;return n._events[r]?n._events[r].fn?n._events[r]=[n._events[r],d]:n._events[r].push(d):(n._events[r]=d,n._eventsCount++),n}function p(n,f){--n._eventsCount===0?n._events=new y:delete n._events[f]}function u(){this._events=new y,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],l,h;if(this._eventsCount===0)return f;for(h in l=this._events)S.call(l,h)&&f.push(c?h.slice(1):h);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(l)):f},u.prototype.listeners=function(f){var l=c?c+f:f,h=this._events[l];if(!h)return[];if(h.fn)return[h.fn];for(var v=0,d=h.length,r=new Array(d);v<d;v++)r[v]=h[v].fn;return r},u.prototype.listenerCount=function(f){var l=c?c+f:f,h=this._events[l];return h?h.fn?1:h.length:0},u.prototype.emit=function(f,l,h,v,d,r){var t=c?c+f:f;if(!this._events[t])return!1;var i=this._events[t],e=arguments.length,a,o;if(i.fn){switch(i.once&&this.removeListener(f,i.fn,void 0,!0),e){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,l),!0;case 3:return i.fn.call(i.context,l,h),!0;case 4:return i.fn.call(i.context,l,h,v),!0;case 5:return i.fn.call(i.context,l,h,v,d),!0;case 6:return i.fn.call(i.context,l,h,v,d,r),!0}for(o=1,a=new Array(e-1);o<e;o++)a[o-1]=arguments[o];i.fn.apply(i.context,a)}else{var s=i.length,g;for(o=0;o<s;o++)switch(i[o].once&&this.removeListener(f,i[o].fn,void 0,!0),e){case 1:i[o].fn.call(i[o].context);break;case 2:i[o].fn.call(i[o].context,l);break;case 3:i[o].fn.call(i[o].context,l,h);break;case 4:i[o].fn.call(i[o].context,l,h,v);break;default:if(!a)for(g=1,a=new Array(e-1);g<e;g++)a[g-1]=arguments[g];i[o].fn.apply(i[o].context,a)}}return!0},u.prototype.on=function(f,l,h){return T(this,f,l,h,!1)},u.prototype.once=function(f,l,h){return T(this,f,l,h,!0)},u.prototype.removeListener=function(f,l,h,v){var d=c?c+f:f;if(!this._events[d])return this;if(!l)return p(this,d),this;var r=this._events[d];if(r.fn)r.fn===l&&(!v||r.once)&&(!h||r.context===h)&&p(this,d);else{for(var t=0,i=[],e=r.length;t<e;t++)(r[t].fn!==l||v&&!r[t].once||h&&r[t].context!==h)&&i.push(r[t]);i.length?this._events[d]=i.length===1?i[0]:i:p(this,d)}return this},u.prototype.removeAllListeners=function(f){var l;return f?(l=c?c+f:f,this._events[l]&&p(this,l)):(this._events=new y,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=c,u.EventEmitter=u,O.exports=u},"./node_modules/url-toolkit/src/url-toolkit.js":function(O,C,_){(function(S){var c=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,y=/^([^\/?#]*)([^]*)$/,M=/(?:\/|^)\.(?=\/)/g,T=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,p={buildAbsoluteURL:function(u,n,f){if(f=f||{},u=u.trim(),n=n.trim(),!n){if(!f.alwaysNormalize)return u;var l=p.parseURL(u);if(!l)throw new Error("Error trying to parse base URL.");return l.path=p.normalizePath(l.path),p.buildURLFromParts(l)}var h=p.parseURL(n);if(!h)throw new Error("Error trying to parse relative URL.");if(h.scheme)return f.alwaysNormalize?(h.path=p.normalizePath(h.path),p.buildURLFromParts(h)):n;var v=p.parseURL(u);if(!v)throw new Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var d=y.exec(v.path);v.netLoc=d[1],v.path=d[2]}v.netLoc&&!v.path&&(v.path="/");var r={scheme:v.scheme,netLoc:h.netLoc,path:null,params:h.params,query:h.query,fragment:h.fragment};if(!h.netLoc&&(r.netLoc=v.netLoc,h.path[0]!=="/"))if(!h.path)r.path=v.path,h.params||(r.params=v.params,h.query||(r.query=v.query));else{var t=v.path,i=t.substring(0,t.lastIndexOf("/")+1)+h.path;r.path=p.normalizePath(i)}return r.path===null&&(r.path=f.alwaysNormalize?p.normalizePath(h.path):h.path),p.buildURLFromParts(r)},parseURL:function(u){var n=c.exec(u);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(u){for(u=u.split("").reverse().join("").replace(M,"");u.length!==(u=u.replace(T,"")).length;);return u.split("").reverse().join("")},buildURLFromParts:function(u){return u.scheme+u.netLoc+u.path+u.params+u.query+u.fragment}};O.exports=p})()},"./node_modules/webworkify-webpack/index.js":function(O,C,_){function S(f){var l={};function h(d){if(l[d])return l[d].exports;var r=l[d]={i:d,l:!1,exports:{}};return f[d].call(r.exports,r,r.exports,h),r.l=!0,r.exports}h.m=f,h.c=l,h.i=function(d){return d},h.d=function(d,r,t){h.o(d,r)||Object.defineProperty(d,r,{configurable:!1,enumerable:!0,get:t})},h.r=function(d){Object.defineProperty(d,"__esModule",{value:!0})},h.n=function(d){var r=d&&d.__esModule?function(){return d.default}:function(){return d};return h.d(r,"a",r),r},h.o=function(d,r){return Object.prototype.hasOwnProperty.call(d,r)},h.p="/",h.oe=function(d){throw console.error(d),d};var v=h(h.s=ENTRY_MODULE);return v.default||v}var c="[\\.|\\-|\\+|\\w|/|@]+",y="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+c+").*?\\)";function M(f){return(f+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function T(f){return!isNaN(1*f)}function p(f,l,h){var v={};v[h]=[];var d=l.toString(),r=d.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!r)return v;for(var t=r[1],i=new RegExp("(\\\\n|\\W)"+M(t)+y,"g"),e;e=i.exec(d);)e[3]!=="dll-reference"&&v[h].push(e[3]);for(i=new RegExp("\\("+M(t)+'\\("(dll-reference\\s('+c+'))"\\)\\)'+y,"g");e=i.exec(d);)f[e[2]]||(v[h].push(e[1]),f[e[2]]=_(e[1]).m),v[e[2]]=v[e[2]]||[],v[e[2]].push(e[4]);for(var a=Object.keys(v),o=0;o<a.length;o++)for(var s=0;s<v[a[o]].length;s++)T(v[a[o]][s])&&(v[a[o]][s]=1*v[a[o]][s]);return v}function u(f){var l=Object.keys(f);return l.reduce(function(h,v){return h||f[v].length>0},!1)}function n(f,l){for(var h={main:[l]},v={main:[]},d={main:{}};u(h);)for(var r=Object.keys(h),t=0;t<r.length;t++){var i=r[t],e=h[i],a=e.pop();if(d[i]=d[i]||{},!(d[i][a]||!f[i][a])){d[i][a]=!0,v[i]=v[i]||[],v[i].push(a);for(var o=p(f,f[i][a],i),s=Object.keys(o),g=0;g<s.length;g++)h[s[g]]=h[s[g]]||[],h[s[g]]=h[s[g]].concat(o[s[g]])}}return v}O.exports=function(f,l){l=l||{};var h={main:_.m},v=l.all?{main:Object.keys(h.main)}:n(h,f),d="";Object.keys(v).filter(function(a){return a!=="main"}).forEach(function(a){for(var o=0;v[a][o];)o++;v[a].push(o),h[a][o]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",d=d+"var "+a+" = ("+S.toString().replace("ENTRY_MODULE",JSON.stringify(o))+")({"+v[a].map(function(s){return""+JSON.stringify(s)+": "+h[a][s].toString()}).join(",")+`});
`}),d=d+"new (("+S.toString().replace("ENTRY_MODULE",JSON.stringify(f))+")({"+v.main.map(function(a){return""+JSON.stringify(a)+": "+h.main[a].toString()}).join(",")+"}))(self);";var r=new window.Blob([d],{type:"text/javascript"});if(l.bare)return r;var t=window.URL||window.webkitURL||window.mozURL||window.msURL,i=t.createObjectURL(r),e=new window.Worker(i);return e.objectURL=i,e}},"./src/config.ts":function(O,C,_){_.r(C),_.d(C,"hlsDefaultConfig",function(){return g}),_.d(C,"mergeConfig",function(){return A}),_.d(C,"enableStreamingMode",function(){return m});var S=_("./src/controller/abr-controller.ts"),c=_("./src/controller/audio-stream-controller.ts"),y=_("./src/controller/audio-track-controller.ts"),M=_("./src/controller/subtitle-stream-controller.ts"),T=_("./src/controller/subtitle-track-controller.ts"),p=_("./src/controller/buffer-controller.ts"),u=_("./src/controller/timeline-controller.ts"),n=_("./src/controller/cap-level-controller.ts"),f=_("./src/controller/fps-controller.ts"),l=_("./src/controller/eme-controller.ts"),h=_("./src/controller/cmcd-controller.ts"),v=_("./src/utils/xhr-loader.ts"),d=_("./src/utils/fetch-loader.ts"),r=_("./src/utils/cues.ts"),t=_("./src/utils/mediakeys-helper.ts"),i=_("./src/utils/logger.ts");function e(){return e=Object.assign||function(E){for(var x=1;x<arguments.length;x++){var D=arguments[x];for(var I in D)Object.prototype.hasOwnProperty.call(D,I)&&(E[I]=D[I])}return E},e.apply(this,arguments)}function a(E,x){var D=Object.keys(E);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(E);x&&(I=I.filter(function(b){return Object.getOwnPropertyDescriptor(E,b).enumerable})),D.push.apply(D,I)}return D}function o(E){for(var x=1;x<arguments.length;x++){var D=arguments[x]!=null?arguments[x]:{};x%2?a(Object(D),!0).forEach(function(I){s(E,I,D[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(D)):a(Object(D)).forEach(function(I){Object.defineProperty(E,I,Object.getOwnPropertyDescriptor(D,I))})}return E}function s(E,x,D){return x in E?Object.defineProperty(E,x,{value:D,enumerable:!0,configurable:!0,writable:!0}):E[x]=D,E}var g=o(o({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:v.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:S.default,bufferController:p.default,capLevelController:n.default,fpsController:f.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:t.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0},L()),{},{subtitleStreamController:M.SubtitleStreamController,subtitleTrackController:T.default,timelineController:u.TimelineController,audioStreamController:c.default,audioTrackController:y.default,emeController:l.default,cmcdController:h.default});function L(){return{cueHandler:r.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function A(E,x){if((x.liveSyncDurationCount||x.liveMaxLatencyDurationCount)&&(x.liveSyncDuration||x.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(x.liveMaxLatencyDurationCount!==void 0&&(x.liveSyncDurationCount===void 0||x.liveMaxLatencyDurationCount<=x.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(x.liveMaxLatencyDuration!==void 0&&(x.liveSyncDuration===void 0||x.liveMaxLatencyDuration<=x.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return e({},E,x)}function m(E){var x=E.loader;if(x!==d.default&&x!==v.default)i.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),E.progressive=!1;else{var D=Object(d.fetchSupported)();D&&(E.loader=d.default,E.progressive=!0,E.enableSoftwareAES=!0,i.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(O,C,_){_.r(C);var S=_("./src/polyfills/number.ts"),c=_("./src/utils/ewma-bandwidth-estimator.ts"),y=_("./src/events.ts"),M=_("./src/utils/buffer-helper.ts"),T=_("./src/errors.ts"),p=_("./src/types/loader.ts"),u=_("./src/utils/logger.ts");function n(h,v){for(var d=0;d<v.length;d++){var r=v[d];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(h,r.key,r)}}function f(h,v,d){return v&&n(h.prototype,v),d&&n(h,d),h}var l=function(){function h(d){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=d;var r=d.config;this.bwEstimator=new c.default(r.abrEwmaSlowVoD,r.abrEwmaFastVoD,r.abrEwmaDefaultEstimate),this.registerListeners()}var v=h.prototype;return v.registerListeners=function(){var r=this.hls;r.on(y.Events.FRAG_LOADING,this.onFragLoading,this),r.on(y.Events.FRAG_LOADED,this.onFragLoaded,this),r.on(y.Events.FRAG_BUFFERED,this.onFragBuffered,this),r.on(y.Events.LEVEL_LOADED,this.onLevelLoaded,this),r.on(y.Events.ERROR,this.onError,this)},v.unregisterListeners=function(){var r=this.hls;r.off(y.Events.FRAG_LOADING,this.onFragLoading,this),r.off(y.Events.FRAG_LOADED,this.onFragLoaded,this),r.off(y.Events.FRAG_BUFFERED,this.onFragBuffered,this),r.off(y.Events.LEVEL_LOADED,this.onLevelLoaded,this),r.off(y.Events.ERROR,this.onError,this)},v.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},v.onFragLoading=function(r,t){var i=t.frag;if(i.type===p.PlaylistLevelType.MAIN&&!this.timer){var e;this.fragCurrent=i,this.partCurrent=(e=t.part)!=null?e:null,this.timer=self.setInterval(this.onCheck,100)}},v.onLevelLoaded=function(r,t){var i=this.hls.config;t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)},v._abandonRulesCheck=function(){var r=this.fragCurrent,t=this.partCurrent,i=this.hls,e=i.autoLevelEnabled,a=i.config,o=i.media;if(!(!r||!o)){var s=t?t.stats:r.stats,g=t?t.duration:r.duration;if(s.aborted){u.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!e||o.paused||!o.playbackRate||!o.readyState)){var L=performance.now()-s.loading.start,A=Math.abs(o.playbackRate);if(!(L<=500*g/A)){var m=i.levels,E=i.minAutoLevel,x=m[r.level],D=s.total||Math.max(s.loaded,Math.round(g*x.maxBitrate/8)),I=Math.max(1,s.bwEstimate?s.bwEstimate/8:s.loaded*1e3/L),b=(D-s.loaded)/I,R=o.currentTime,P=(M.BufferHelper.bufferInfo(o,R,a.maxBufferHole).end-R)/A;if(!(P>=2*g/A||b<=P)){var w=Number.POSITIVE_INFINITY,F;for(F=r.level-1;F>E;F--){var k=m[F].maxBitrate;if(w=g*k/(8*.8*I),w<P)break}if(!(w>=b)){var B=this.bwEstimator.getEstimate();u.logger.warn("Fragment "+r.sn+(t?" part "+t.index:"")+" of level "+r.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+F+`
      Current BW estimate: `+(Object(S.isFiniteNumber)(B)?(B/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+b.toFixed(3)+` s
      Estimated load time for the next fragment: `+w.toFixed(3)+` s
      Time to underbuffer: `+P.toFixed(3)+" s"),i.nextLoadLevel=F,this.bwEstimator.sample(L,s.loaded),this.clearTimer(),r.loader&&(this.fragCurrent=this.partCurrent=null,r.loader.abort()),i.trigger(y.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:t,stats:s})}}}}}},v.onFragLoaded=function(r,t){var i=t.frag,e=t.part;if(i.type===p.PlaylistLevelType.MAIN&&Object(S.isFiniteNumber)(i.sn)){var a=e?e.stats:i.stats,o=e?e.duration:i.duration;if(this.clearTimer(),this.lastLoadedFragLevel=i.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var s=this.hls.levels[i.level],g=(s.loaded?s.loaded.bytes:0)+a.loaded,L=(s.loaded?s.loaded.duration:0)+o;s.loaded={bytes:g,duration:L},s.realBitrate=Math.round(8*g/L)}if(i.bitrateTest){var A={stats:a,frag:i,part:e,id:i.type};this.onFragBuffered(y.Events.FRAG_BUFFERED,A),i.bitrateTest=!1}}},v.onFragBuffered=function(r,t){var i=t.frag,e=t.part,a=e?e.stats:i.stats;if(!a.aborted&&!(i.type!==p.PlaylistLevelType.MAIN||i.sn==="initSegment")){var o=a.parsing.end-a.loading.start;this.bwEstimator.sample(o,a.loaded),a.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=o/1e3:this.bitrateTestDelay=0}},v.onError=function(r,t){switch(t.details){case T.ErrorDetails.FRAG_LOAD_ERROR:case T.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},v.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},v.getNextABRAutoLevel=function(){var r=this.fragCurrent,t=this.partCurrent,i=this.hls,e=i.maxAutoLevel,a=i.config,o=i.minAutoLevel,s=i.media,g=t?t.duration:r?r.duration:0,L=s?s.currentTime:0,A=s&&s.playbackRate!==0?Math.abs(s.playbackRate):1,m=this.bwEstimator?this.bwEstimator.getEstimate():a.abrEwmaDefaultEstimate,E=(M.BufferHelper.bufferInfo(s,L,a.maxBufferHole).end-L)/A,x=this.findBestLevel(m,o,e,E,a.abrBandWidthFactor,a.abrBandWidthUpFactor);if(x>=0)return x;u.logger.trace((E?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var D=g?Math.min(g,a.maxStarvationDelay):a.maxStarvationDelay,I=a.abrBandWidthFactor,b=a.abrBandWidthUpFactor;if(!E){var R=this.bitrateTestDelay;if(R){var P=g?Math.min(g,a.maxLoadingDelay):a.maxLoadingDelay;D=P-R,u.logger.trace("bitrate test took "+Math.round(1e3*R)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*D)+" ms"),I=b=1}}return x=this.findBestLevel(m,o,e,E+D,I,b),Math.max(x,0)},v.findBestLevel=function(r,t,i,e,a,o){for(var s,g=this.fragCurrent,L=this.partCurrent,A=this.lastLoadedFragLevel,m=this.hls.levels,E=m[A],x=!!(E!=null&&(s=E.details)!==null&&s!==void 0&&s.live),D=E==null?void 0:E.codecSet,I=L?L.duration:g?g.duration:0,b=i;b>=t;b--){var R=m[b];if(!(!R||D&&R.codecSet!==D)){var P=R.details,w=(L?P==null?void 0:P.partTarget:P==null?void 0:P.averagetargetduration)||I,F=void 0;b<=A?F=a*r:F=o*r;var k=m[b].maxBitrate,B=k*w/F;if(u.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+b+"/"+Math.round(F)+"/"+k+"/"+w+"/"+e+"/"+B),F>k&&(!B||x&&!this.bitrateTestDelay||B<e))return b}}return-1},f(h,[{key:"nextAutoLevel",get:function(){var r=this._nextAutoLevel,t=this.bwEstimator;if(r!==-1&&(!t||!t.canEstimate()))return r;var i=this.getNextABRAutoLevel();return r!==-1&&(i=Math.min(r,i)),i},set:function(r){this._nextAutoLevel=r}}]),h}();C.default=l},"./src/controller/audio-stream-controller.ts":function(O,C,_){_.r(C);var S=_("./src/polyfills/number.ts"),c=_("./src/controller/base-stream-controller.ts"),y=_("./src/events.ts"),M=_("./src/utils/buffer-helper.ts"),T=_("./src/controller/fragment-tracker.ts"),p=_("./src/types/level.ts"),u=_("./src/types/loader.ts"),n=_("./src/loader/fragment.ts"),f=_("./src/demux/chunk-cache.ts"),l=_("./src/demux/transmuxer-interface.ts"),h=_("./src/types/transmuxer.ts"),v=_("./src/controller/fragment-finders.ts"),d=_("./src/utils/discontinuities.ts"),r=_("./src/errors.ts"),t=_("./src/utils/logger.ts");function i(){return i=Object.assign||function(g){for(var L=1;L<arguments.length;L++){var A=arguments[L];for(var m in A)Object.prototype.hasOwnProperty.call(A,m)&&(g[m]=A[m])}return g},i.apply(this,arguments)}function e(g,L){g.prototype=Object.create(L.prototype),g.prototype.constructor=g,a(g,L)}function a(g,L){return a=Object.setPrototypeOf||function(m,E){return m.__proto__=E,m},a(g,L)}var o=100,s=function(g){e(L,g);function L(m,E){var x;return x=g.call(this,m,E,"[audio-stream-controller]")||this,x.videoBuffer=null,x.videoTrackCC=-1,x.waitingVideoCC=-1,x.audioSwitch=!1,x.trackId=-1,x.waitingData=null,x.mainDetails=null,x.bufferFlushed=!1,x._registerListeners(),x}var A=L.prototype;return A.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},A._registerListeners=function(){var E=this.hls;E.on(y.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.on(y.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.on(y.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.on(y.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.on(y.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.on(y.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.on(y.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.on(y.Events.ERROR,this.onError,this),E.on(y.Events.BUFFER_RESET,this.onBufferReset,this),E.on(y.Events.BUFFER_CREATED,this.onBufferCreated,this),E.on(y.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.on(y.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.on(y.Events.FRAG_BUFFERED,this.onFragBuffered,this)},A._unregisterListeners=function(){var E=this.hls;E.off(y.Events.MEDIA_ATTACHED,this.onMediaAttached,this),E.off(y.Events.MEDIA_DETACHING,this.onMediaDetaching,this),E.off(y.Events.MANIFEST_LOADING,this.onManifestLoading,this),E.off(y.Events.LEVEL_LOADED,this.onLevelLoaded,this),E.off(y.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),E.off(y.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),E.off(y.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),E.off(y.Events.ERROR,this.onError,this),E.off(y.Events.BUFFER_RESET,this.onBufferReset,this),E.off(y.Events.BUFFER_CREATED,this.onBufferCreated,this),E.off(y.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),E.off(y.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),E.off(y.Events.FRAG_BUFFERED,this.onFragBuffered,this)},A.onInitPtsFound=function(E,x){var D=x.frag,I=x.id,b=x.initPTS;if(I==="main"){var R=D.cc;this.initPTS[D.cc]=b,this.log("InitPTS for cc: "+R+" found from main: "+b),this.videoTrackCC=R,this.state===c.State.WAITING_INIT_PTS&&this.tick()}},A.startLoad=function(E){if(!this.levels){this.startPosition=E,this.state=c.State.STOPPED;return}var x=this.lastCurrentTime;this.stopLoad(),this.setInterval(o),this.fragLoadError=0,x>0&&E===-1?(this.log("Override startPosition with lastCurrentTime @"+x.toFixed(3)),this.state=c.State.IDLE):(this.loadedmetadata=!1,this.state=c.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=E,this.tick()},A.doTick=function(){switch(this.state){case c.State.IDLE:this.doTickIdle();break;case c.State.WAITING_TRACK:{var E,x=this.levels,D=this.trackId,I=x==null||(E=x[D])===null||E===void 0?void 0:E.details;if(I){if(this.waitForCdnTuneIn(I))break;this.state=c.State.WAITING_INIT_PTS}break}case c.State.FRAG_LOADING_WAITING_RETRY:{var b,R=performance.now(),P=this.retryDate;(!P||R>=P||(b=this.media)!==null&&b!==void 0&&b.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=c.State.IDLE);break}case c.State.WAITING_INIT_PTS:{var w=this.waitingData;if(w){var F=w.frag,k=w.part,B=w.cache,U=w.complete;if(this.initPTS[F.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=c.State.FRAG_LOADING;var j=B.flush(),K={frag:F,part:k,payload:j,networkDetails:null};this._handleFragmentLoadProgress(K),U&&g.prototype._handleFragmentLoadComplete.call(this,K)}else if(this.videoTrackCC!==this.waitingVideoCC)t.logger.log("Waiting fragment cc ("+F.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var N=this.getLoadPosition(),Z=M.BufferHelper.bufferInfo(this.mediaBuffer,N,this.config.maxBufferHole),$=Object(v.fragmentWithinToleranceTest)(Z.end,this.config.maxFragLookUpTolerance,F);$<0&&(t.logger.log("Waiting fragment cc ("+F.cc+") @ "+F.start+" cancelled because another fragment at "+Z.end+" is needed"),this.clearWaitingFragment())}}else this.state=c.State.IDLE}}this.onTickEnd()},A.clearWaitingFragment=function(){var E=this.waitingData;E&&(this.fragmentTracker.removeFragment(E.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=c.State.IDLE)},A.onTickEnd=function(){var E=this.media;if(!(!E||!E.readyState)){var x=this.mediaBuffer?this.mediaBuffer:E,D=x.buffered;!this.loadedmetadata&&D.length&&(this.loadedmetadata=!0),this.lastCurrentTime=E.currentTime}},A.doTickIdle=function(){var E,x,D=this.hls,I=this.levels,b=this.media,R=this.trackId,P=D.config;if(!(!I||!I[R])&&!(!b&&(this.startFragRequested||!P.startFragPrefetch))){var w=I[R],F=w.details;if(!F||F.live&&this.levelLastLoaded!==R||this.waitForCdnTuneIn(F)){this.state=c.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,n.ElementaryStreamTypes.AUDIO,u.PlaylistLevelType.AUDIO));var k=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,u.PlaylistLevelType.AUDIO);if(k!==null){var B=k.len,U=this.getMaxBufferLength(),j=this.audioSwitch;if(!(B>=U&&!j)){if(!j&&this._streamEnded(k,F)){D.trigger(y.Events.BUFFER_EOS,{type:"audio"}),this.state=c.State.ENDED;return}var K=F.fragments,N=K[0].start,Z=k.end;if(j){var $=this.getLoadPosition();Z=$,F.PTSKnown&&$<N&&(k.end>N||k.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),b.currentTime=N+.05)}var Y=this.getNextFragment(Z,F);if(!Y){this.bufferFlushed=!0;return}((E=Y.decryptdata)===null||E===void 0?void 0:E.keyFormat)==="identity"&&!((x=Y.decryptdata)!==null&&x!==void 0&&x.key)?this.loadKey(Y,F):this.loadFragment(Y,F,Z)}}}},A.getMaxBufferLength=function(){var E=g.prototype.getMaxBufferLength.call(this),x=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,u.PlaylistLevelType.MAIN);return x===null?E:Math.max(E,x.len)},A.onMediaDetaching=function(){this.videoBuffer=null,g.prototype.onMediaDetaching.call(this)},A.onAudioTracksUpdated=function(E,x){var D=x.audioTracks;this.resetTransmuxer(),this.levels=D.map(function(I){return new p.Level(I)})},A.onAudioTrackSwitching=function(E,x){var D=!!x.url;this.trackId=x.id;var I=this.fragCurrent;I!=null&&I.loader&&I.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),D?this.setInterval(o):this.resetTransmuxer(),D?(this.audioSwitch=!0,this.state=c.State.IDLE):this.state=c.State.STOPPED,this.tick()},A.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},A.onLevelLoaded=function(E,x){this.mainDetails=x.details},A.onAudioTrackLoaded=function(E,x){var D,I=this.levels,b=x.details,R=x.id;if(!I){this.warn("Audio tracks were reset while loading level "+R);return}this.log("Track "+R+" loaded ["+b.startSN+","+b.endSN+"],duration:"+b.totalduration);var P=I[R],w=0;if(b.live||(D=P.details)!==null&&D!==void 0&&D.live){var F=this.mainDetails;if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed||!F)return;!P.details&&b.hasProgramDateTime&&F.hasProgramDateTime?(Object(d.alignMediaPlaylistByPDT)(b,F),w=b.fragments[0].start):w=this.alignPlaylists(b,P.details)}P.details=b,this.levelLastLoaded=R,!this.startFragRequested&&(this.mainDetails||!b.live)&&this.setStartPosition(P.details,w),this.state===c.State.WAITING_TRACK&&!this.waitForCdnTuneIn(b)&&(this.state=c.State.IDLE),this.tick()},A._handleFragmentLoadProgress=function(E){var x,D=E.frag,I=E.part,b=E.payload,R=this.config,P=this.trackId,w=this.levels;if(!w){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+D.sn+" of level "+D.level+" will not be buffered");return}var F=w[P];console.assert(F,"Audio track is defined on fragment load progress");var k=F.details;console.assert(k,"Audio track details are defined on fragment load progress");var B=R.defaultAudioCodec||F.audioCodec||"mp4a.40.2",U=this.transmuxer;U||(U=this.transmuxer=new l.default(this.hls,u.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var j=this.initPTS[D.cc],K=(x=D.initSegment)===null||x===void 0?void 0:x.data;if(j!==void 0){var N=!1,Z=I?I.index:-1,$=Z!==-1,Y=new h.ChunkMetadata(D.level,D.sn,D.stats.chunkCount,b.byteLength,Z,$);U.push(b,K,B,"",D,I,k.totalduration,N,Y,j)}else{t.logger.log("Unknown video PTS for cc "+D.cc+", waiting for video PTS before demuxing audio frag "+D.sn+" of ["+k.startSN+" ,"+k.endSN+"],track "+P);var ee=this.waitingData=this.waitingData||{frag:D,part:I,cache:new f.default,complete:!1},Q=ee.cache;Q.push(new Uint8Array(b)),this.waitingVideoCC=this.videoTrackCC,this.state=c.State.WAITING_INIT_PTS}},A._handleFragmentLoadComplete=function(E){if(this.waitingData){this.waitingData.complete=!0;return}g.prototype._handleFragmentLoadComplete.call(this,E)},A.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},A.onBufferCreated=function(E,x){var D=x.tracks.audio;D&&(this.mediaBuffer=D.buffer),x.tracks.video&&(this.videoBuffer=x.tracks.video.buffer)},A.onFragBuffered=function(E,x){var D=x.frag,I=x.part;if(D.type===u.PlaylistLevelType.AUDIO){if(this.fragContextChanged(D)){this.warn("Fragment "+D.sn+(I?" p: "+I.index:"")+" of level "+D.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}D.sn!=="initSegment"&&(this.fragPrevious=D,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(y.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(D,I)}},A.onError=function(E,x){switch(x.details){case r.ErrorDetails.FRAG_LOAD_ERROR:case r.ErrorDetails.FRAG_LOAD_TIMEOUT:case r.ErrorDetails.KEY_LOAD_ERROR:case r.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.AUDIO,x);break;case r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==c.State.ERROR&&this.state!==c.State.STOPPED&&(this.state=x.fatal?c.State.ERROR:c.State.IDLE,this.warn(x.details+" while loading frag, switching to "+this.state+" state"));break;case r.ErrorDetails.BUFFER_FULL_ERROR:if(x.parent==="audio"&&(this.state===c.State.PARSING||this.state===c.State.PARSED)){var D=!0,I=this.getFwdBufferInfo(this.mediaBuffer,u.PlaylistLevelType.AUDIO);I&&I.len>.5&&(D=!this.reduceMaxBufferLength(I.len)),D&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},A.onBufferFlushed=function(E,x){var D=x.type;D===n.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},A._handleTransmuxComplete=function(E){var x,D="audio",I=this.hls,b=E.remuxResult,R=E.chunkMeta,P=this.getCurrentContext(R);if(!P){this.warn("The loading context changed while buffering fragment "+R.sn+" of level "+R.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(R.level);return}var w=P.frag,F=P.part,k=b.audio,B=b.text,U=b.id3,j=b.initSegment;if(!this.fragContextChanged(w)){if(this.state=c.State.PARSING,this.audioSwitch&&k&&this.completeAudioSwitch(),j!=null&&j.tracks&&(this._bufferInitSegment(j.tracks,w,R),I.trigger(y.Events.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:D,tracks:j.tracks})),k){var K=k.startPTS,N=k.endPTS,Z=k.startDTS,$=k.endDTS;F&&(F.elementaryStreams[n.ElementaryStreamTypes.AUDIO]={startPTS:K,endPTS:N,startDTS:Z,endDTS:$}),w.setElementaryStreamInfo(n.ElementaryStreamTypes.AUDIO,K,N,Z,$),this.bufferFragmentData(k,w,F,R)}if(U!=null&&(x=U.samples)!==null&&x!==void 0&&x.length){var Y=i({frag:w,id:D},U);I.trigger(y.Events.FRAG_PARSING_METADATA,Y)}if(B){var ee=i({frag:w,id:D},B);I.trigger(y.Events.FRAG_PARSING_USERDATA,ee)}}},A._bufferInitSegment=function(E,x,D){if(this.state===c.State.PARSING){E.video&&delete E.video;var I=E.audio;if(!!I){I.levelCodec=I.codec,I.id="audio",this.log("Init audio buffer, container:"+I.container+", codecs[parsed]=["+I.codec+"]"),this.hls.trigger(y.Events.BUFFER_CODECS,E);var b=I.initSegment;if(b!=null&&b.byteLength){var R={type:"audio",frag:x,part:null,chunkMeta:D,parent:x.type,data:b};this.hls.trigger(y.Events.BUFFER_APPENDING,R)}this.tick()}}},A.loadFragment=function(E,x,D){var I=this.fragmentTracker.getState(E);this.fragCurrent=E,(this.audioSwitch||I===T.FragmentState.NOT_LOADED||I===T.FragmentState.PARTIAL)&&(E.sn==="initSegment"?this._loadInitSegment(E):x.live&&!Object(S.isFiniteNumber)(this.initPTS[E.cc])?(this.log("Waiting for video PTS in continuity counter "+E.cc+" of live stream before loading audio fragment "+E.sn+" of level "+this.trackId),this.state=c.State.WAITING_INIT_PTS):(this.startFragRequested=!0,g.prototype.loadFragment.call(this,E,x,D)))},A.completeAudioSwitch=function(){var E=this.hls,x=this.media,D=this.trackId;x&&(this.log("Switching audio track : flushing all audio"),g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,E.trigger(y.Events.AUDIO_TRACK_SWITCHED,{id:D})},L}(c.default);C.default=s},"./src/controller/audio-track-controller.ts":function(O,C,_){_.r(C);var S=_("./src/events.ts"),c=_("./src/errors.ts"),y=_("./src/controller/base-playlist-controller.ts"),M=_("./src/types/loader.ts");function T(l,h){for(var v=0;v<h.length;v++){var d=h[v];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(l,d.key,d)}}function p(l,h,v){return h&&T(l.prototype,h),v&&T(l,v),l}function u(l,h){l.prototype=Object.create(h.prototype),l.prototype.constructor=l,n(l,h)}function n(l,h){return n=Object.setPrototypeOf||function(d,r){return d.__proto__=r,d},n(l,h)}var f=function(l){u(h,l);function h(d){var r;return r=l.call(this,d,"[audio-track-controller]")||this,r.tracks=[],r.groupId=null,r.tracksInGroup=[],r.trackId=-1,r.trackName="",r.selectDefaultTrack=!0,r.registerListeners(),r}var v=h.prototype;return v.registerListeners=function(){var r=this.hls;r.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),r.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),r.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),r.on(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),r.on(S.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),r.on(S.Events.ERROR,this.onError,this)},v.unregisterListeners=function(){var r=this.hls;r.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),r.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),r.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),r.off(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),r.off(S.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),r.off(S.Events.ERROR,this.onError,this)},v.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,l.prototype.destroy.call(this)},v.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},v.onManifestParsed=function(r,t){this.tracks=t.audioTracks||[]},v.onAudioTrackLoaded=function(r,t){var i=t.id,e=t.details,a=this.tracksInGroup[i];if(!a){this.warn("Invalid audio track id "+i);return}var o=a.details;a.details=t.details,this.log("audioTrack "+i+" loaded ["+e.startSN+"-"+e.endSN+"]"),i===this.trackId&&(this.retryCount=0,this.playlistLoaded(i,t,o))},v.onLevelLoading=function(r,t){this.switchLevel(t.level)},v.onLevelSwitching=function(r,t){this.switchLevel(t.level)},v.switchLevel=function(r){var t=this.hls.levels[r];if(!!(t!=null&&t.audioGroupIds)){var i=t.audioGroupIds[t.urlId];if(this.groupId!==i){this.groupId=i;var e=this.tracks.filter(function(o){return!i||o.groupId===i});this.selectDefaultTrack&&!e.some(function(o){return o.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=e;var a={audioTracks:e};this.log("Updating audio tracks, "+e.length+' track(s) found in "'+i+'" group-id'),this.hls.trigger(S.Events.AUDIO_TRACKS_UPDATED,a),this.selectInitialTrack()}}},v.onError=function(r,t){l.prototype.onError.call(this,r,t),!(t.fatal||!t.context)&&t.context.type===M.PlaylistContextType.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.retryLoadingOrFail(t)},v.setAudioTrack=function(r){var t=this.tracksInGroup;if(r<0||r>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var i=t[this.trackId];this.log("Now switching to audio-track index "+r);var e=t[r],a=e.id,o=e.groupId,s=o===void 0?"":o,g=e.name,L=e.type,A=e.url;if(this.trackId=r,this.trackName=g,this.selectDefaultTrack=!1,this.hls.trigger(S.Events.AUDIO_TRACK_SWITCHING,{id:a,groupId:s,name:g,type:L,url:A}),!(e.details&&!e.details.live)){var m=this.switchParams(e.url,i==null?void 0:i.details);this.loadPlaylist(m)}},v.selectInitialTrack=function(){var r=this.tracksInGroup;console.assert(r.length,"Initial audio track should be selected when tracks are known");var t=this.trackName,i=this.findTrackId(t)||this.findTrackId();i!==-1?this.setAudioTrack(i):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},v.findTrackId=function(r){for(var t=this.tracksInGroup,i=0;i<t.length;i++){var e=t[i];if((!this.selectDefaultTrack||e.default)&&(!r||r===e.name))return e.id}return-1},v.loadPlaylist=function(r){var t=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(t)){var i=t.id,e=t.groupId,a=t.url;if(r)try{a=r.addDirectives(a)}catch(o){this.warn("Could not construct new URL with HLS Delivery Directives: "+o)}this.log("loading audio-track playlist for id: "+i),this.clearTimer(),this.hls.trigger(S.Events.AUDIO_TRACK_LOADING,{url:a,id:i,groupId:e,deliveryDirectives:r||null})}},p(h,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(r){this.selectDefaultTrack=!1,this.setAudioTrack(r)}}]),h}(y.default);C.default=f},"./src/controller/base-playlist-controller.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return p});var S=_("./src/polyfills/number.ts"),c=_("./src/types/level.ts"),y=_("./src/controller/level-helper.ts"),M=_("./src/utils/logger.ts"),T=_("./src/errors.ts"),p=function(){function u(f,l){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=M.logger.log.bind(M.logger,l+":"),this.warn=M.logger.warn.bind(M.logger,l+":"),this.hls=f}var n=u.prototype;return n.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},n.onError=function(l,h){h.fatal&&h.type===T.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},n.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},n.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},n.stopLoad=function(){this.canLoad=!1,this.clearTimer()},n.switchParams=function(l,h){var v=h==null?void 0:h.renditionReports;if(v)for(var d=0;d<v.length;d++){var r=v[d],t=""+r.URI;if(t===l.substr(-t.length)){var i=parseInt(r["LAST-MSN"]),e=parseInt(r["LAST-PART"]);if(h&&this.hls.config.lowLatencyMode){var a=Math.min(h.age-h.partTarget,h.targetduration);e!==void 0&&a>h.partTarget&&(e+=1)}if(Object(S.isFiniteNumber)(i))return new c.HlsUrlParameters(i,Object(S.isFiniteNumber)(e)?e:void 0,c.HlsSkip.No)}}},n.loadPlaylist=function(l){},n.shouldLoadTrack=function(l){return this.canLoad&&l&&!!l.url&&(!l.details||l.details.live)},n.playlistLoaded=function(l,h,v){var d=this,r=h.details,t=h.stats,i=t.loading.end?Math.max(0,self.performance.now()-t.loading.end):0;if(r.advancedDateTime=Date.now()-i,r.live||v!=null&&v.live){if(r.reloaded(v),v&&this.log("live playlist "+l+" "+(r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:"MISSED")),v&&r.fragments.length>0&&Object(y.mergeDetails)(v,r),!this.canLoad||!r.live)return;var e,a=void 0,o=void 0;if(r.canBlockReload&&r.endSN&&r.advanced){var s=this.hls.config.lowLatencyMode,g=r.lastPartSn,L=r.endSN,A=r.lastPartIndex,m=A!==-1,E=g===L,x=s?0:A;m?(a=E?L+1:g,o=E?x:A+1):a=L+1;var D=r.age,I=D+r.ageHeader,b=Math.min(I-r.partTarget,r.targetduration*1.5);if(b>0){if(v&&b>v.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+v.tuneInGoal+" to: "+b+" with playlist age: "+r.age),b=0;else{var R=Math.floor(b/r.targetduration);if(a+=R,o!==void 0){var P=Math.round(b%r.targetduration/r.partTarget);o+=P}this.log("CDN Tune-in age: "+r.ageHeader+"s last advanced "+D.toFixed(2)+"s goal: "+b+" skip sn "+R+" to part "+o)}r.tuneInGoal=b}if(e=this.getDeliveryDirectives(r,h.deliveryDirectives,a,o),s||!E){this.loadPlaylist(e);return}}else e=this.getDeliveryDirectives(r,h.deliveryDirectives,a,o);var w=Object(y.computeReloadInterval)(r,t);a!==void 0&&r.canBlockReload&&(w-=r.partTarget||1),this.log("reload live playlist "+l+" in "+Math.round(w)+" ms"),this.timer=self.setTimeout(function(){return d.loadPlaylist(e)},w)}else this.clearTimer()},n.getDeliveryDirectives=function(l,h,v,d){var r=Object(c.getSkipValue)(l,v);return h!=null&&h.skip&&l.deltaUpdateFailed&&(v=h.msn,d=h.part,r=c.HlsSkip.No),new c.HlsUrlParameters(v,d,r)},n.retryLoadingOrFail=function(l){var h=this,v=this.hls.config,d=this.retryCount<v.levelLoadingMaxRetry;if(d){var r;if(this.retryCount++,l.details.indexOf("LoadTimeOut")>-1&&(r=l.context)!==null&&r!==void 0&&r.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+l.details+'"'),this.loadPlaylist();else{var t=Math.min(Math.pow(2,this.retryCount)*v.levelLoadingRetryDelay,v.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return h.loadPlaylist()},t),this.warn("retry playlist loading #"+this.retryCount+" in "+t+' ms after "'+l.details+'"')}}else this.warn('cannot recover from error "'+l.details+'"'),this.clearTimer(),l.fatal=!0;return d},u}()},"./src/controller/base-stream-controller.ts":function(O,C,_){_.r(C),_.d(C,"State",function(){return L}),_.d(C,"default",function(){return A});var S=_("./src/polyfills/number.ts"),c=_("./src/task-loop.ts"),y=_("./src/controller/fragment-tracker.ts"),M=_("./src/utils/buffer-helper.ts"),T=_("./src/utils/logger.ts"),p=_("./src/events.ts"),u=_("./src/errors.ts"),n=_("./src/types/transmuxer.ts"),f=_("./src/utils/mp4-tools.ts"),l=_("./src/utils/discontinuities.ts"),h=_("./src/controller/fragment-finders.ts"),v=_("./src/controller/level-helper.ts"),d=_("./src/loader/fragment-loader.ts"),r=_("./src/crypt/decrypter.ts"),t=_("./src/utils/time-ranges.ts"),i=_("./src/types/loader.ts");function e(m,E){for(var x=0;x<E.length;x++){var D=E[x];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(m,D.key,D)}}function a(m,E,x){return E&&e(m.prototype,E),x&&e(m,x),m}function o(m){if(m===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return m}function s(m,E){m.prototype=Object.create(E.prototype),m.prototype.constructor=m,g(m,E)}function g(m,E){return g=Object.setPrototypeOf||function(D,I){return D.__proto__=I,D},g(m,E)}var L={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},A=function(m){s(E,m);function E(D,I,b){var R;return R=m.call(this)||this,R.hls=void 0,R.fragPrevious=null,R.fragCurrent=null,R.fragmentTracker=void 0,R.transmuxer=null,R._state=L.STOPPED,R.media=void 0,R.mediaBuffer=void 0,R.config=void 0,R.bitrateTest=!1,R.lastCurrentTime=0,R.nextLoadPosition=0,R.startPosition=0,R.loadedmetadata=!1,R.fragLoadError=0,R.retryDate=0,R.levels=null,R.fragmentLoader=void 0,R.levelLastLoaded=null,R.startFragRequested=!1,R.decrypter=void 0,R.initPTS=[],R.onvseeking=null,R.onvended=null,R.logPrefix="",R.log=void 0,R.warn=void 0,R.logPrefix=b,R.log=T.logger.log.bind(T.logger,b+":"),R.warn=T.logger.warn.bind(T.logger,b+":"),R.hls=D,R.fragmentLoader=new d.default(D.config),R.fragmentTracker=I,R.config=D.config,R.decrypter=new r.default(D,D.config),D.on(p.Events.KEY_LOADED,R.onKeyLoaded,o(R)),R}var x=E.prototype;return x.doTick=function(){this.onTickEnd()},x.onTickEnd=function(){},x.startLoad=function(I){},x.stopLoad=function(){this.fragmentLoader.abort();var I=this.fragCurrent;I&&this.fragmentTracker.removeFragment(I),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=L.STOPPED},x._streamEnded=function(I,b){var R=this.fragCurrent,P=this.fragmentTracker;if(!b.live&&R&&R.sn>=b.endSN&&!I.nextStart){var w=b.partList;if(w!=null&&w.length){var F=w[w.length-1],k=M.BufferHelper.isBuffered(this.media,F.start+F.duration/2);return k}var B=P.getState(R);return B===y.FragmentState.PARTIAL||B===y.FragmentState.OK}return!1},x.onMediaAttached=function(I,b){var R=this.media=this.mediaBuffer=b.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),R.addEventListener("seeking",this.onvseeking),R.addEventListener("ended",this.onvended);var P=this.config;this.levels&&P.autoStartLoad&&this.state===L.STOPPED&&this.startLoad(P.startPosition)},x.onMediaDetaching=function(){var I=this.media;I!=null&&I.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),I&&(I.removeEventListener("seeking",this.onvseeking),I.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},x.onMediaSeeking=function(){var I=this.config,b=this.fragCurrent,R=this.media,P=this.mediaBuffer,w=this.state,F=R?R.currentTime:0,k=M.BufferHelper.bufferInfo(P||R,F,I.maxBufferHole);if(this.log("media seeking to "+(Object(S.isFiniteNumber)(F)?F.toFixed(3):F)+", state: "+w),w===L.ENDED)this.resetLoadingState();else if(b&&!k.len){var B=I.maxFragLookUpTolerance,U=b.start-B,j=b.start+b.duration+B,K=F>j;(F<U||K)&&(K&&b.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),b.loader.abort()),this.resetLoadingState())}R&&(this.lastCurrentTime=F),!this.loadedmetadata&&!k.len&&(this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},x.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},x.onKeyLoaded=function(I,b){if(!(this.state!==L.KEY_LOADING||b.frag!==this.fragCurrent||!this.levels)){this.state=L.IDLE;var R=this.levels[b.frag.level].details;R&&this.loadFragment(b.frag,R,b.frag.start)}},x.onHandlerDestroying=function(){this.stopLoad(),m.prototype.onHandlerDestroying.call(this)},x.onHandlerDestroyed=function(){this.state=L.STOPPED,this.hls.off(p.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,m.prototype.onHandlerDestroyed.call(this)},x.loadKey=function(I,b){this.log("Loading key for "+I.sn+" of ["+b.startSN+"-"+b.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level),this.state=L.KEY_LOADING,this.fragCurrent=I,this.hls.trigger(p.Events.KEY_LOADING,{frag:I})},x.loadFragment=function(I,b,R){this._loadFragForPlayback(I,b,R)},x._loadFragForPlayback=function(I,b,R){var P=this,w=function(k){if(P.fragContextChanged(I)){P.warn("Fragment "+I.sn+(k.part?" p: "+k.part.index:"")+" of level "+I.level+" was dropped during download."),P.fragmentTracker.removeFragment(I);return}I.stats.chunkCount++,P._handleFragmentLoadProgress(k)};this._doFragLoad(I,b,R,w).then(function(F){if(!!F){P.fragLoadError=0;var k=P.state;if(P.fragContextChanged(I)){(k===L.FRAG_LOADING||k===L.BACKTRACKING||!P.fragCurrent&&k===L.PARSING)&&(P.fragmentTracker.removeFragment(I),P.state=L.IDLE);return}if("payload"in F&&(P.log("Loaded fragment "+I.sn+" of level "+I.level),P.hls.trigger(p.Events.FRAG_LOADED,F),P.state===L.BACKTRACKING)){P.fragmentTracker.backtrack(I,F),P.resetFragmentLoading(I);return}P._handleFragmentLoadComplete(F)}}).catch(function(F){P.warn(F),P.resetFragmentLoading(I)})},x.flushMainBuffer=function(I,b,R){if(R===void 0&&(R=null),!!(I-b)){var P={startOffset:I,endOffset:b,type:R};this.fragLoadError=0,this.hls.trigger(p.Events.BUFFER_FLUSHING,P)}},x._loadInitSegment=function(I){var b=this;this._doFragLoad(I).then(function(R){if(!R||b.fragContextChanged(I)||!b.levels)throw new Error("init load aborted");return R}).then(function(R){var P=b.hls,w=R.payload,F=I.decryptdata;if(w&&w.byteLength>0&&F&&F.key&&F.iv&&F.method==="AES-128"){var k=self.performance.now();return b.decrypter.webCryptoDecrypt(new Uint8Array(w),F.key.buffer,F.iv.buffer).then(function(B){var U=self.performance.now();return P.trigger(p.Events.FRAG_DECRYPTED,{frag:I,payload:B,stats:{tstart:k,tdecrypt:U}}),R.payload=B,R})}return R}).then(function(R){var P=b.fragCurrent,w=b.hls,F=b.levels;if(!F)throw new Error("init load aborted, missing levels");var k=F[I.level].details;console.assert(k,"Level details are defined when init segment is loaded");var B=I.stats;b.state=L.IDLE,b.fragLoadError=0,I.data=new Uint8Array(R.payload),B.parsing.start=B.buffering.start=self.performance.now(),B.parsing.end=B.buffering.end=self.performance.now(),R.frag===P&&w.trigger(p.Events.FRAG_BUFFERED,{stats:B,frag:P,part:null,id:I.type}),b.tick()}).catch(function(R){b.warn(R),b.resetFragmentLoading(I)})},x.fragContextChanged=function(I){var b=this.fragCurrent;return!I||!b||I.level!==b.level||I.sn!==b.sn||I.urlId!==b.urlId},x.fragBufferedComplete=function(I,b){var R=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+I.type+" sn: "+I.sn+(b?" part: "+b.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+I.level+" "+t.default.toString(M.BufferHelper.getBuffered(R))),this.state=L.IDLE,this.tick()},x._handleFragmentLoadComplete=function(I){var b=this.transmuxer;if(!!b){var R=I.frag,P=I.part,w=I.partsLoaded,F=!w||w.length===0||w.some(function(B){return!B}),k=new n.ChunkMetadata(R.level,R.sn,R.stats.chunkCount+1,0,P?P.index:-1,!F);b.flush(k)}},x._handleFragmentLoadProgress=function(I){},x._doFragLoad=function(I,b,R,P){var w=this;if(R===void 0&&(R=null),!this.levels)throw new Error("frag load aborted, missing levels");if(R=Math.max(I.start,R||0),this.config.lowLatencyMode&&b){var F=b.partList;if(F&&P){R>I.end&&b.fragmentHint&&(I=b.fragmentHint);var k=this.getNextPart(F,I,R);if(k>-1){var B=F[k];return this.log("Loading part sn: "+I.sn+" p: "+B.index+" cc: "+I.cc+" of playlist ["+b.startSN+"-"+b.endSN+"] parts [0-"+k+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(R.toFixed(3))),this.nextLoadPosition=B.start+B.duration,this.state=L.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:I,part:F[k],targetBufferTime:R}),this.doFragPartsLoad(I,F,k,P).catch(function(U){return w.handleFragLoadError(U)})}else if(!I.url||this.loadedEndOfParts(F,R))return Promise.resolve(null)}}return this.log("Loading fragment "+I.sn+" cc: "+I.cc+" "+(b?"of ["+b.startSN+"-"+b.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+I.level+", target: "+parseFloat(R.toFixed(3))),Object(S.isFiniteNumber)(I.sn)&&!this.bitrateTest&&(this.nextLoadPosition=I.start+I.duration),this.state=L.FRAG_LOADING,this.hls.trigger(p.Events.FRAG_LOADING,{frag:I,targetBufferTime:R}),this.fragmentLoader.load(I,P).catch(function(U){return w.handleFragLoadError(U)})},x.doFragPartsLoad=function(I,b,R,P){var w=this;return new Promise(function(F,k){var B=[],U=function j(K){var N=b[K];w.fragmentLoader.loadPart(I,N,P).then(function(Z){B[N.index]=Z;var $=Z.part;w.hls.trigger(p.Events.FRAG_LOADED,Z);var Y=b[K+1];if(Y&&Y.fragment===I)j(K+1);else return F({frag:I,part:$,partsLoaded:B})}).catch(k)};U(R)})},x.handleFragLoadError=function(I){var b=I.data;return b&&b.details===u.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(b.frag,b.part):this.hls.trigger(p.Events.ERROR,b),null},x._handleTransmuxerFlush=function(I){var b=this.getCurrentContext(I);if(!b||this.state!==L.PARSING){this.fragCurrent||(this.state=L.IDLE);return}var R=b.frag,P=b.part,w=b.level,F=self.performance.now();R.stats.parsing.end=F,P&&(P.stats.parsing.end=F),this.updateLevelTiming(R,P,w,I.partial)},x.getCurrentContext=function(I){var b=this.levels,R=I.level,P=I.sn,w=I.part;if(!b||!b[R])return this.warn("Levels object was unset while buffering fragment "+P+" of level "+R+". The current chunk will not be buffered."),null;var F=b[R],k=w>-1?Object(v.getPartWith)(F,P,w):null,B=k?k.fragment:Object(v.getFragmentWithSN)(F,P,this.fragCurrent);return B?{frag:B,part:k,level:F}:null},x.bufferFragmentData=function(I,b,R,P){if(!(!I||this.state!==L.PARSING)){var w=I.data1,F=I.data2,k=w;if(w&&F&&(k=Object(f.appendUint8Array)(w,F)),!(!k||!k.length)){var B={type:I.type,frag:b,part:R,chunkMeta:P,parent:b.type,data:k};this.hls.trigger(p.Events.BUFFER_APPENDING,B),I.dropped&&I.independent&&!R&&this.flushBufferGap(b)}}},x.flushBufferGap=function(I){var b=this.media;if(!!b){if(!M.BufferHelper.isBuffered(b,b.currentTime)){this.flushMainBuffer(0,I.start);return}var R=b.currentTime,P=M.BufferHelper.bufferInfo(b,R,0),w=I.duration,F=Math.min(this.config.maxFragLookUpTolerance*2,w*.25),k=Math.max(Math.min(I.start-F,P.end-F),R+F);I.start-k>F&&this.flushMainBuffer(k,I.start)}},x.getFwdBufferInfo=function(I,b){var R=this.config,P=this.getLoadPosition();if(!Object(S.isFiniteNumber)(P))return null;var w=M.BufferHelper.bufferInfo(I,P,R.maxBufferHole);if(w.len===0&&w.nextStart!==void 0){var F=this.fragmentTracker.getBufferedFrag(P,b);if(F&&w.nextStart<F.end)return M.BufferHelper.bufferInfo(I,P,Math.max(w.nextStart,R.maxBufferHole))}return w},x.getMaxBufferLength=function(I){var b=this.config,R;return I?R=Math.max(8*b.maxBufferSize/I,b.maxBufferLength):R=b.maxBufferLength,Math.min(R,b.maxMaxBufferLength)},x.reduceMaxBufferLength=function(I){var b=this.config,R=I||b.maxBufferLength;return b.maxMaxBufferLength>=R?(b.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+b.maxMaxBufferLength+"s"),!0):!1},x.getNextFragment=function(I,b){var R,P,w=b.fragments,F=w.length;if(!F)return null;var k=this.config,B=w[0].start,U;if(b.live){var j=k.initialLiveManifestSize;if(F<j)return this.warn("Not enough fragments to start playback (have: "+F+", need: "+j+")"),null;!b.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(U=this.getInitialLiveFragment(b,w),this.startPosition=U?this.hls.liveSyncPosition||U.start:I)}else I<=B&&(U=w[0]);if(!U){var K=k.lowLatencyMode?b.partEnd:b.fragmentEnd;U=this.getFragmentAtPosition(I,K,b)}return(R=U)!==null&&R!==void 0&&R.initSegment&&!((P=U)!==null&&P!==void 0&&P.initSegment.data)&&!this.bitrateTest&&(U=U.initSegment),U},x.getNextPart=function(I,b,R){for(var P=-1,w=!1,F=!0,k=0,B=I.length;k<B;k++){var U=I[k];if(F=F&&!U.independent,P>-1&&R<U.start)break;var j=U.loaded;!j&&(w||U.independent||F)&&U.fragment===b&&(P=k),w=j}return P},x.loadedEndOfParts=function(I,b){var R=I[I.length-1];return R&&b>R.start&&R.loaded},x.getInitialLiveFragment=function(I,b){var R=this.fragPrevious,P=null;if(R){if(I.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+R.programDateTime),P=Object(h.findFragmentByPDT)(b,R.endProgramDateTime,this.config.maxFragLookUpTolerance)),!P){var w=R.sn+1;if(w>=I.startSN&&w<=I.endSN){var F=b[w-I.startSN];R.cc===F.cc&&(P=F,this.log("Live playlist, switching playlist, load frag with next SN: "+P.sn))}P||(P=Object(h.findFragWithCC)(b,R.cc),P&&this.log("Live playlist, switching playlist, load frag with same CC: "+P.sn))}}else{var k=this.hls.liveSyncPosition;k!==null&&(P=this.getFragmentAtPosition(k,this.bitrateTest?I.fragmentEnd:I.edge,I))}return P},x.getFragmentAtPosition=function(I,b,R){var P=this.config,w=this.fragPrevious,F=R.fragments,k=R.endSN,B=R.fragmentHint,U=P.maxFragLookUpTolerance,j=!!(P.lowLatencyMode&&R.partList&&B);j&&B&&!this.bitrateTest&&(F=F.concat(B),k=B.sn);var K;if(I<b){var N=I>b-U?0:U;K=Object(h.findFragmentByPTS)(w,F,I,N)}else K=F[F.length-1];if(K){var Z=K.sn-R.startSN,$=w&&K.level===w.level,Y=F[Z+1],ee=this.fragmentTracker.getState(K);if(ee===y.FragmentState.BACKTRACKED){K=null;for(var Q=Z;F[Q]&&this.fragmentTracker.getState(F[Q])===y.FragmentState.BACKTRACKED;)w?K=F[Q--]:K=F[--Q];K||(K=Y)}else w&&K.sn===w.sn&&!j&&$&&(K.sn<k&&this.fragmentTracker.getState(Y)!==y.FragmentState.OK?(this.log("SN "+K.sn+" just loaded, load next one: "+Y.sn),K=Y):K=null)}return K},x.synchronizeToLiveEdge=function(I){var b=this.config,R=this.media;if(!!R){var P=this.hls.liveSyncPosition,w=R.currentTime,F=I.fragments[0].start,k=I.edge,B=w>=F-b.maxFragLookUpTolerance&&w<=k;if(P!==null&&R.duration>P&&(w<P||!B)){var U=b.liveMaxLatencyDuration!==void 0?b.liveMaxLatencyDuration:b.liveMaxLatencyDurationCount*I.targetduration;(!B&&R.readyState<4||w<k-U)&&(this.loadedmetadata||(this.nextLoadPosition=P),R.readyState&&(this.warn("Playback: "+w.toFixed(3)+" is located too far from the end of live sliding playlist: "+k+", reset currentTime to : "+P.toFixed(3)),R.currentTime=P))}}},x.alignPlaylists=function(I,b){var R=this.levels,P=this.levelLastLoaded,w=this.fragPrevious,F=P!==null?R[P]:null,k=I.fragments.length;if(!k)return this.warn("No fragments in live playlist"),0;var B=I.fragments[0].start,U=!b,j=I.alignedSliding&&Object(S.isFiniteNumber)(B);if(U||!j&&!B){Object(l.alignStream)(w,F,I);var K=I.fragments[0].start;return this.log("Live playlist sliding: "+K.toFixed(2)+" start-sn: "+(b?b.startSN:"na")+"->"+I.startSN+" prev-sn: "+(w?w.sn:"na")+" fragments: "+k),K}return B},x.waitForCdnTuneIn=function(I){var b=3;return I.live&&I.canBlockReload&&I.tuneInGoal>Math.max(I.partHoldBack,I.partTarget*b)},x.setStartPosition=function(I,b){var R=this.startPosition;if(R<b&&(R=-1),R===-1||this.lastCurrentTime===-1){var P=I.startTimeOffset;Object(S.isFiniteNumber)(P)?(R=b+P,P<0&&(R+=I.totalduration),R=Math.min(Math.max(b,R),b+I.totalduration),this.log("Start time offset "+P+" found in playlist, adjust startPosition to "+R),this.startPosition=R):I.live?R=this.hls.liveSyncPosition||b:this.startPosition=R=0,this.lastCurrentTime=R}this.nextLoadPosition=R},x.getLoadPosition=function(){var I=this.media,b=0;return this.loadedmetadata&&I?b=I.currentTime:this.nextLoadPosition&&(b=this.nextLoadPosition),b},x.handleFragLoadAborted=function(I,b){this.transmuxer&&I.sn!=="initSegment"&&I.stats.aborted&&(this.warn("Fragment "+I.sn+(b?" part"+b.index:"")+" of level "+I.level+" was aborted"),this.resetFragmentLoading(I))},x.resetFragmentLoading=function(I){(!this.fragCurrent||!this.fragContextChanged(I))&&(this.state=L.IDLE)},x.onFragmentOrKeyLoadError=function(I,b){if(!b.fatal){var R=b.frag;if(!(!R||R.type!==I)){var P=this.fragCurrent;console.assert(P&&R.sn===P.sn&&R.level===P.level&&R.urlId===P.urlId,"Frag load error must match current frag to retry");var w=this.config;if(this.fragLoadError+1<=w.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(R.level))return;var F=Math.min(Math.pow(2,this.fragLoadError)*w.fragLoadingRetryDelay,w.fragLoadingMaxRetryTimeout);this.warn("Fragment "+R.sn+" of "+I+" "+R.level+" failed to load, retrying in "+F+"ms"),this.retryDate=self.performance.now()+F,this.fragLoadError++,this.state=L.FRAG_LOADING_WAITING_RETRY}else b.levelRetry?(I===i.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=L.IDLE):(T.logger.error(b.details+" reaches max retry, redispatch as fatal ..."),b.fatal=!0,this.hls.stopLoad(),this.state=L.ERROR)}}},x.afterBufferFlushed=function(I,b,R){if(!!I){var P=M.BufferHelper.getBuffered(I);this.fragmentTracker.detectEvictedFragments(b,P,R),this.state===L.ENDED&&this.resetLoadingState()}},x.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=L.IDLE},x.resetLiveStartWhenNotLoaded=function(I){if(!this.loadedmetadata){this.startFragRequested=!1;var b=this.levels?this.levels[I].details:null;if(b!=null&&b.live)return this.startPosition=-1,this.setStartPosition(b,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},x.updateLevelTiming=function(I,b,R,P){var w=this,F=R.details;console.assert(!!F,"level.details must be defined");var k=Object.keys(I.elementaryStreams).reduce(function(B,U){var j=I.elementaryStreams[U];if(j){var K=j.endPTS-j.startPTS;if(K<=0)return w.warn("Could not parse fragment "+I.sn+" "+U+" duration reliably ("+K+") resetting transmuxer to fallback to playlist timing"),w.resetTransmuxer(),B||!1;var N=P?0:Object(v.updateFragPTSDTS)(F,I,j.startPTS,j.endPTS,j.startDTS,j.endDTS);return w.hls.trigger(p.Events.LEVEL_PTS_UPDATED,{details:F,level:R,drift:N,type:U,frag:I,start:j.startPTS,end:j.endPTS}),!0}return B},!1);k?(this.state=L.PARSED,this.hls.trigger(p.Events.FRAG_PARSED,{frag:I,part:b})):this.resetLoadingState()},x.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},a(E,[{key:"state",get:function(){return this._state},set:function(I){var b=this._state;b!==I&&(this._state=I,this.log(b+"->"+I))}}]),E}(c.default)},"./src/controller/buffer-controller.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return h});var S=_("./src/polyfills/number.ts"),c=_("./src/events.ts"),y=_("./src/utils/logger.ts"),M=_("./src/errors.ts"),T=_("./src/utils/buffer-helper.ts"),p=_("./src/utils/mediasource-helper.ts"),u=_("./src/loader/fragment.ts"),n=_("./src/controller/buffer-operation-queue.ts"),f=Object(p.getMediaSource)(),l=/([ha]vc.)(?:\.[^.,]+)+/,h=function(){function v(r){var t=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var i=t.hls,e=t.media,a=t.mediaSource;y.logger.log("[buffer-controller]: Media source opened"),e&&(t.updateMediaElementDuration(),i.trigger(c.Events.MEDIA_ATTACHED,{media:e})),a&&a.removeEventListener("sourceopen",t._onMediaSourceOpen),t.checkPendingTracks()},this._onMediaSourceClose=function(){y.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){y.logger.log("[buffer-controller]: Media source ended")},this.hls=r,this._initSourceBuffer(),this.registerListeners()}var d=v.prototype;return d.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},d.destroy=function(){this.unregisterListeners(),this.details=null},d.registerListeners=function(){var t=this.hls;t.on(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(c.Events.BUFFER_RESET,this.onBufferReset,this),t.on(c.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.on(c.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(c.Events.BUFFER_EOS,this.onBufferEos,this),t.on(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(c.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(c.Events.FRAG_PARSED,this.onFragParsed,this),t.on(c.Events.FRAG_CHANGED,this.onFragChanged,this)},d.unregisterListeners=function(){var t=this.hls;t.off(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(c.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(c.Events.BUFFER_RESET,this.onBufferReset,this),t.off(c.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.off(c.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(c.Events.BUFFER_EOS,this.onBufferEos,this),t.off(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(c.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(c.Events.FRAG_PARSED,this.onFragParsed,this),t.off(c.Events.FRAG_CHANGED,this.onFragChanged,this)},d._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new n.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},d.onManifestParsed=function(t,i){var e=2;(i.audio&&!i.video||!i.altAudio)&&(e=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e,this.details=null,y.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},d.onMediaAttaching=function(t,i){var e=this.media=i.media;if(e&&f){var a=this.mediaSource=new f;a.addEventListener("sourceopen",this._onMediaSourceOpen),a.addEventListener("sourceended",this._onMediaSourceEnded),a.addEventListener("sourceclose",this._onMediaSourceClose),e.src=self.URL.createObjectURL(a),this._objectUrl=e.src}},d.onMediaDetaching=function(){var t=this.media,i=this.mediaSource,e=this._objectUrl;if(i){if(y.logger.log("[buffer-controller]: media source detaching"),i.readyState==="open")try{i.endOfStream()}catch(a){y.logger.warn("[buffer-controller]: onMediaDetaching: "+a.message+" while calling endOfStream")}this.onBufferReset(),i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(e&&self.URL.revokeObjectURL(e),t.src===e?(t.removeAttribute("src"),t.load()):y.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(c.Events.MEDIA_DETACHED,void 0)},d.onBufferReset=function(){var t=this;this.getSourceBufferTypes().forEach(function(i){var e=t.sourceBuffer[i];try{e&&(t.removeBufferListeners(i),t.mediaSource&&t.mediaSource.removeSourceBuffer(e),t.sourceBuffer[i]=void 0)}catch(a){y.logger.warn("[buffer-controller]: Failed to reset the "+i+" buffer",a)}}),this._initSourceBuffer()},d.onBufferCodecs=function(t,i){var e=this,a=this.getSourceBufferTypes().length;Object.keys(i).forEach(function(o){if(a){var s=e.tracks[o];if(s&&typeof s.buffer.changeType=="function"){var g=i[o],L=g.codec,A=g.levelCodec,m=g.container,E=(s.levelCodec||s.codec).replace(l,"$1"),x=(A||L).replace(l,"$1");if(E!==x){var D=m+";codecs="+(A||L);e.appendChangeType(o,D)}}}else e.pendingTracks[o]=i[o]}),!a&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},d.appendChangeType=function(t,i){var e=this,a=this.operationQueue,o={execute:function(){var g=e.sourceBuffer[t];g&&(y.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+i),g.changeType(i)),a.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(g){y.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",g)}};a.append(o,t)},d.onBufferAppending=function(t,i){var e=this,a=this.hls,o=this.operationQueue,s=this.tracks,g=i.data,L=i.type,A=i.frag,m=i.part,E=i.chunkMeta,x=E.buffering[L],D=self.performance.now();x.start=D;var I=A.stats.buffering,b=m?m.stats.buffering:null;I.start===0&&(I.start=D),b&&b.start===0&&(b.start=D);var R=s.audio,P=L==="audio"&&E.id===1&&(R==null?void 0:R.container)==="audio/mpeg",w={execute:function(){if(x.executeStart=self.performance.now(),P){var k=e.sourceBuffer[L];if(k){var B=A.start-k.timestampOffset;Math.abs(B)>=.1&&(y.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+A.start+" (delta: "+B+") sn: "+A.sn+")"),k.timestampOffset=A.start)}}e.appendExecutor(g,L)},onStart:function(){},onComplete:function(){var k=self.performance.now();x.executeEnd=x.end=k,I.first===0&&(I.first=k),b&&b.first===0&&(b.first=k);var B=e.sourceBuffer,U={};for(var j in B)U[j]=T.BufferHelper.getBuffered(B[j]);e.appendError=0,e.hls.trigger(c.Events.BUFFER_APPENDED,{type:L,frag:A,part:m,chunkMeta:E,parent:A.type,timeRanges:U})},onError:function(k){y.logger.error("[buffer-controller]: Error encountered while trying to append to the "+L+" SourceBuffer",k);var B={type:M.ErrorTypes.MEDIA_ERROR,parent:A.type,details:M.ErrorDetails.BUFFER_APPEND_ERROR,err:k,fatal:!1};k.code===DOMException.QUOTA_EXCEEDED_ERR?B.details=M.ErrorDetails.BUFFER_FULL_ERROR:(e.appendError++,B.details=M.ErrorDetails.BUFFER_APPEND_ERROR,e.appendError>a.config.appendErrorMaxRetry&&(y.logger.error("[buffer-controller]: Failed "+a.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),B.fatal=!0)),a.trigger(c.Events.ERROR,B)}};o.append(w,L)},d.onBufferFlushing=function(t,i){var e=this,a=this.operationQueue,o=function(g){return{execute:e.removeExecutor.bind(e,g,i.startOffset,i.endOffset),onStart:function(){},onComplete:function(){e.hls.trigger(c.Events.BUFFER_FLUSHED,{type:g})},onError:function(A){y.logger.warn("[buffer-controller]: Failed to remove from "+g+" SourceBuffer",A)}}};i.type?a.append(o(i.type),i.type):this.getSourceBufferTypes().forEach(function(s){a.append(o(s),s)})},d.onFragParsed=function(t,i){var e=this,a=i.frag,o=i.part,s=[],g=o?o.elementaryStreams:a.elementaryStreams;g[u.ElementaryStreamTypes.AUDIOVIDEO]?s.push("audiovideo"):(g[u.ElementaryStreamTypes.AUDIO]&&s.push("audio"),g[u.ElementaryStreamTypes.VIDEO]&&s.push("video"));var L=function(){var m=self.performance.now();a.stats.buffering.end=m,o&&(o.stats.buffering.end=m);var E=o?o.stats:a.stats;e.hls.trigger(c.Events.FRAG_BUFFERED,{frag:a,part:o,stats:E,id:a.type})};s.length===0&&y.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+a.type+" level: "+a.level+" sn: "+a.sn),this.blockBuffers(L,s)},d.onFragChanged=function(t,i){this.flushBackBuffer()},d.onBufferEos=function(t,i){var e=this,a=this.getSourceBufferTypes().reduce(function(o,s){var g=e.sourceBuffer[s];return(!i.type||i.type===s)&&g&&!g.ended&&(g.ended=!0,y.logger.log("[buffer-controller]: "+s+" sourceBuffer now EOS")),o&&!!(!g||g.ended)},!0);a&&this.blockBuffers(function(){var o=e.mediaSource;!o||o.readyState!=="open"||o.endOfStream()})},d.onLevelUpdated=function(t,i){var e=i.details;!e.fragments.length||(this.details=e,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},d.flushBackBuffer=function(){var t=this.hls,i=this.details,e=this.media,a=this.sourceBuffer;if(!(!e||i===null)){var o=this.getSourceBufferTypes();if(!!o.length){var s=i.live&&t.config.liveBackBufferLength!==null?t.config.liveBackBufferLength:t.config.backBufferLength;if(!(!Object(S.isFiniteNumber)(s)||s<0)){var g=e.currentTime,L=i.levelTargetDuration,A=Math.max(s,L),m=Math.floor(g/L)*L-A;o.forEach(function(E){var x=a[E];if(x){var D=T.BufferHelper.getBuffered(x);D.length>0&&m>D.start(0)&&(t.trigger(c.Events.BACK_BUFFER_REACHED,{bufferEnd:m}),i.live&&t.trigger(c.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:m}),t.trigger(c.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:m,type:E}))}})}}}},d.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var t=this.details,i=this.hls,e=this.media,a=this.mediaSource,o=t.fragments[0].start+t.totalduration,s=e.duration,g=Object(S.isFiniteNumber)(a.duration)?a.duration:0;t.live&&i.config.liveDurationInfinity?(y.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),a.duration=1/0,this.updateSeekableRange(t)):(o>g&&o>s||!Object(S.isFiniteNumber)(s))&&(y.logger.log("[buffer-controller]: Updating Media Source duration to "+o.toFixed(3)),a.duration=o)}},d.updateSeekableRange=function(t){var i=this.mediaSource,e=t.fragments,a=e.length;if(a&&t.live&&i!==null&&i!==void 0&&i.setLiveSeekableRange){var o=Math.max(0,e[0].start),s=Math.max(o,o+t.totalduration);i.setLiveSeekableRange(o,s)}},d.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,i=this.operationQueue,e=this.pendingTracks,a=Object.keys(e).length;if(a&&!t||a===2){this.createSourceBuffers(e),this.pendingTracks={};var o=this.getSourceBufferTypes();if(o.length===0){this.hls.trigger(c.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}o.forEach(function(s){i.executeNext(s)})}},d.createSourceBuffers=function(t){var i=this.sourceBuffer,e=this.mediaSource;if(!e)throw Error("createSourceBuffers called when mediaSource was null");var a=0;for(var o in t)if(!i[o]){var s=t[o];if(!s)throw Error("source buffer exists for track "+o+", however track does not");var g=s.levelCodec||s.codec,L=s.container+";codecs="+g;y.logger.log("[buffer-controller]: creating sourceBuffer("+L+")");try{var A=i[o]=e.addSourceBuffer(L),m=o;this.addBufferListener(m,"updatestart",this._onSBUpdateStart),this.addBufferListener(m,"updateend",this._onSBUpdateEnd),this.addBufferListener(m,"error",this._onSBUpdateError),this.tracks[o]={buffer:A,codec:g,container:s.container,levelCodec:s.levelCodec,id:s.id},a++}catch(E){y.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+E.message),this.hls.trigger(c.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:E,mimeType:L})}}a&&this.hls.trigger(c.Events.BUFFER_CREATED,{tracks:this.tracks})},d._onSBUpdateStart=function(t){var i=this.operationQueue,e=i.current(t);e.onStart()},d._onSBUpdateEnd=function(t){var i=this.operationQueue,e=i.current(t);e.onComplete(),i.shiftAndExecuteNext(t)},d._onSBUpdateError=function(t,i){y.logger.error("[buffer-controller]: "+t+" SourceBuffer error",i),this.hls.trigger(c.Events.ERROR,{type:M.ErrorTypes.MEDIA_ERROR,details:M.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var e=this.operationQueue.current(t);e&&e.onError(i)},d.removeExecutor=function(t,i,e){var a=this.media,o=this.mediaSource,s=this.operationQueue,g=this.sourceBuffer,L=g[t];if(!a||!o||!L){y.logger.warn("[buffer-controller]: Attempting to remove from the "+t+" SourceBuffer, but it does not exist"),s.shiftAndExecuteNext(t);return}var A=Object(S.isFiniteNumber)(a.duration)?a.duration:1/0,m=Object(S.isFiniteNumber)(o.duration)?o.duration:1/0,E=Math.max(0,i),x=Math.min(e,A,m);x>E?(y.logger.log("[buffer-controller]: Removing ["+E+","+x+"] from the "+t+" SourceBuffer"),console.assert(!L.updating,t+" sourceBuffer must not be updating"),L.remove(E,x)):s.shiftAndExecuteNext(t)},d.appendExecutor=function(t,i){var e=this.operationQueue,a=this.sourceBuffer,o=a[i];if(!o){y.logger.warn("[buffer-controller]: Attempting to append to the "+i+" SourceBuffer, but it does not exist"),e.shiftAndExecuteNext(i);return}o.ended=!1,console.assert(!o.updating,i+" sourceBuffer must not be updating"),o.appendBuffer(t)},d.blockBuffers=function(t,i){var e=this;if(i===void 0&&(i=this.getSourceBufferTypes()),!i.length){y.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(t);return}var a=this.operationQueue,o=i.map(function(s){return a.appendBlocker(s)});Promise.all(o).then(function(){t(),i.forEach(function(s){var g=e.sourceBuffer[s];(!g||!g.updating)&&a.shiftAndExecuteNext(s)})})},d.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},d.addBufferListener=function(t,i,e){var a=this.sourceBuffer[t];if(!!a){var o=e.bind(this,t);this.listeners[t].push({event:i,listener:o}),a.addEventListener(i,o)}},d.removeBufferListeners=function(t){var i=this.sourceBuffer[t];!i||this.listeners[t].forEach(function(e){i.removeEventListener(e.event,e.listener)})},v}()},"./src/controller/buffer-operation-queue.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return c});var S=_("./src/utils/logger.ts"),c=function(){function y(T){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=T}var M=y.prototype;return M.append=function(p,u){var n=this.queues[u];n.push(p),n.length===1&&this.buffers[u]&&this.executeNext(u)},M.insertAbort=function(p,u){var n=this.queues[u];n.unshift(p),this.executeNext(u)},M.appendBlocker=function(p){var u,n=new Promise(function(l){u=l}),f={execute:u,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(f,p),n},M.executeNext=function(p){var u=this.buffers,n=this.queues,f=u[p],l=n[p];if(l.length){var h=l[0];try{h.execute()}catch(v){S.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),h.onError(v),(!f||!f.updating)&&(l.shift(),this.executeNext(p))}}},M.shiftAndExecuteNext=function(p){this.queues[p].shift(),this.executeNext(p)},M.current=function(p){return this.queues[p][0]},y}()},"./src/controller/cap-level-controller.ts":function(O,C,_){_.r(C);var S=_("./src/events.ts");function c(T,p){for(var u=0;u<p.length;u++){var n=p[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(T,n.key,n)}}function y(T,p,u){return p&&c(T.prototype,p),u&&c(T,u),T}var M=function(){function T(u){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=u,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var p=T.prototype;return p.setStreamController=function(n){this.streamController=n},p.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},p.registerListeners=function(){var n=this.hls;n.on(S.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),n.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.on(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.unregisterListener=function(){var n=this.hls;n.off(S.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),n.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),n.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),n.off(S.Events.BUFFER_CODECS,this.onBufferCodecs,this),n.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},p.onFpsDropLevelCapping=function(n,f){T.isLevelAllowed(f.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(f.droppedLevel)},p.onMediaAttaching=function(n,f){this.media=f.media instanceof HTMLVideoElement?f.media:null},p.onManifestParsed=function(n,f){var l=this.hls;this.restrictedLevels=[],this.firstLevel=f.firstLevel,l.config.capLevelToPlayerSize&&f.video&&this.startCapping()},p.onBufferCodecs=function(n,f){var l=this.hls;l.config.capLevelToPlayerSize&&f.video&&this.startCapping()},p.onMediaDetaching=function(){this.stopCapping()},p.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var n=this.hls.levels;if(n.length){var f=this.hls;f.autoLevelCapping=this.getMaxLevel(n.length-1),f.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=f.autoLevelCapping}}},p.getMaxLevel=function(n){var f=this,l=this.hls.levels;if(!l.length)return-1;var h=l.filter(function(v,d){return T.isLevelAllowed(d,f.restrictedLevels)&&d<=n});return this.clientRect=null,T.getMaxLevelByMediaSize(h,this.mediaWidth,this.mediaHeight)},p.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},p.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},p.getDimensions=function(){if(this.clientRect)return this.clientRect;var n=this.media,f={width:0,height:0};if(n){var l=n.getBoundingClientRect();f.width=l.width,f.height=l.height,!f.width&&!f.height&&(f.width=l.right-l.left||n.width||0,f.height=l.bottom-l.top||n.height||0)}return this.clientRect=f,f},T.isLevelAllowed=function(n,f){return f===void 0&&(f=[]),f.indexOf(n)===-1},T.getMaxLevelByMediaSize=function(n,f,l){if(!n||!n.length)return-1;for(var h=function(i,e){return e?i.width!==e.width||i.height!==e.height:!0},v=n.length-1,d=0;d<n.length;d+=1){var r=n[d];if((r.width>=f||r.height>=l)&&h(r,n[d+1])){v=d;break}}return v},y(T,[{key:"mediaWidth",get:function(){return this.getDimensions().width*T.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*T.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var n=1;try{n=self.devicePixelRatio}catch(f){}return n}}]),T}();C.default=M},"./src/controller/cmcd-controller.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return h});var S=_("./src/events.ts"),c=_("./src/types/cmcd.ts"),y=_("./src/utils/buffer-helper.ts"),M=_("./src/utils/logger.ts");function T(v,d){for(var r=0;r<d.length;r++){var t=d[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(v,t.key,t)}}function p(v,d,r){return d&&T(v.prototype,d),r&&T(v,r),v}function u(v,d){var r=typeof Symbol!="undefined"&&v[Symbol.iterator]||v["@@iterator"];if(r)return(r=r.call(v)).next.bind(r);if(Array.isArray(v)||(r=n(v))||d&&v&&typeof v.length=="number"){r&&(v=r);var t=0;return function(){return t>=v.length?{done:!0}:{done:!1,value:v[t++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n(v,d){if(!!v){if(typeof v=="string")return f(v,d);var r=Object.prototype.toString.call(v).slice(8,-1);if(r==="Object"&&v.constructor&&(r=v.constructor.name),r==="Map"||r==="Set")return Array.from(v);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(v,d)}}function f(v,d){(d==null||d>v.length)&&(d=v.length);for(var r=0,t=new Array(d);r<d;r++)t[r]=v[r];return t}function l(){return l=Object.assign||function(v){for(var d=1;d<arguments.length;d++){var r=arguments[d];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(v[t]=r[t])}return v},l.apply(this,arguments)}var h=function(){function v(r){var t=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){t.initialized&&(t.starved=!0),t.buffering=!0},this.onPlaying=function(){t.initialized||(t.initialized=!0),t.buffering=!1},this.applyPlaylistData=function(a){try{t.apply(a,{ot:c.CMCDObjectType.MANIFEST,su:!t.initialized})}catch(o){M.logger.warn("Could not generate manifest CMCD data.",o)}},this.applyFragmentData=function(a){try{var o=a.frag,s=t.hls.levels[o.level],g=t.getObjectType(o),L={d:o.duration*1e3,ot:g};(g===c.CMCDObjectType.VIDEO||g===c.CMCDObjectType.AUDIO||g==c.CMCDObjectType.MUXED)&&(L.br=s.bitrate/1e3,L.tb=t.getTopBandwidth(g)/1e3,L.bl=t.getBufferLength(g)),t.apply(a,L)}catch(A){M.logger.warn("Could not generate segment CMCD data.",A)}},this.hls=r;var i=this.config=r.config,e=i.cmcd;e!=null&&(i.pLoader=this.createPlaylistLoader(),i.fLoader=this.createFragmentLoader(),this.sid=e.sessionId||v.uuid(),this.cid=e.contentId,this.useHeaders=e.useHeaders===!0,this.registerListeners())}var d=v.prototype;return d.registerListeners=function(){var t=this.hls;t.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.on(S.Events.BUFFER_CREATED,this.onBufferCreated,this)},d.unregisterListeners=function(){var t=this.hls;t.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.off(S.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},d.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},d.onMediaAttached=function(t,i){this.media=i.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},d.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},d.onBufferCreated=function(t,i){var e,a;this.audioBuffer=(e=i.tracks.audio)===null||e===void 0?void 0:e.buffer,this.videoBuffer=(a=i.tracks.video)===null||a===void 0?void 0:a.buffer},d.createData=function(){var t;return{v:c.CMCDVersion,sf:c.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)===null||t===void 0?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},d.apply=function(t,i){i===void 0&&(i={}),l(i,this.createData());var e=i.ot===c.CMCDObjectType.INIT||i.ot===c.CMCDObjectType.VIDEO||i.ot===c.CMCDObjectType.MUXED;if(this.starved&&e&&(i.bs=!0,i.su=!0,this.starved=!1),i.su==null&&(i.su=this.buffering),this.useHeaders){var a=v.toHeaders(i);if(!Object.keys(a).length)return;t.headers||(t.headers={}),l(t.headers,a)}else{var o=v.toQuery(i);if(!o)return;t.url=v.appendQueryToUri(t.url,o)}},d.getObjectType=function(t){var i=t.type;if(i==="subtitle")return c.CMCDObjectType.TIMED_TEXT;if(t.sn==="initSegment")return c.CMCDObjectType.INIT;if(i==="audio")return c.CMCDObjectType.AUDIO;if(i==="main")return this.hls.audioTracks.length?c.CMCDObjectType.VIDEO:c.CMCDObjectType.MUXED},d.getTopBandwidth=function(t){var i=0,e,a=this.hls;if(t===c.CMCDObjectType.AUDIO)e=a.audioTracks;else{var o=a.maxAutoLevel,s=o>-1?o+1:a.levels.length;e=a.levels.slice(0,s)}for(var g=u(e),L;!(L=g()).done;){var A=L.value;A.bitrate>i&&(i=A.bitrate)}return i>0?i:NaN},d.getBufferLength=function(t){var i=this.hls.media,e=t===c.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!e||!i)return NaN;var a=y.BufferHelper.bufferInfo(e,i.currentTime,this.config.maxBufferHole);return a.len*1e3},d.createPlaylistLoader=function(){var t=this.config.pLoader,i=this.applyPlaylistData,e=t||this.config.loader;return function(){function a(s){this.loader=void 0,this.loader=new e(s)}var o=a.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(g,L,A){i(g),this.loader.load(g,L,A)},p(a,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),a}()},d.createFragmentLoader=function(){var t=this.config.fLoader,i=this.applyFragmentData,e=t||this.config.loader;return function(){function a(s){this.loader=void 0,this.loader=new e(s)}var o=a.prototype;return o.destroy=function(){this.loader.destroy()},o.abort=function(){this.loader.abort()},o.load=function(g,L,A){i(g),this.loader.load(g,L,A)},p(a,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),a}()},v.uuid=function(){var t=URL.createObjectURL(new Blob),i=t.toString();return URL.revokeObjectURL(t),i.substr(i.lastIndexOf("/")+1)},v.serialize=function(t){for(var i=[],e=function(P){return!Number.isNaN(P)&&P!=null&&P!==""&&P!==!1},a=function(P){return Math.round(P)},o=function(P){return a(P/100)*100},s=function(P){return encodeURIComponent(P)},g={br:a,d:a,bl:o,dl:o,mtp:o,nor:s,rtp:o,tb:a},L=Object.keys(t||{}).sort(),A=u(L),m;!(m=A()).done;){var E=m.value,x=t[E];if(!!e(x)&&!(E==="v"&&x===1)&&!(E=="pr"&&x===1)){var D=g[E];D&&(x=D(x));var I=typeof x,b=void 0;E==="ot"||E==="sf"||E==="st"?b=E+"="+x:I==="boolean"?b=E:I==="number"?b=E+"="+x:b=E+"="+JSON.stringify(x),i.push(b)}}return i.join(",")},v.toHeaders=function(t){for(var i=Object.keys(t),e={},a=["Object","Request","Session","Status"],o=[{},{},{},{}],s={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},g=0,L=i;g<L.length;g++){var A=L[g],m=s[A]!=null?s[A]:1;o[m][A]=t[A]}for(var E=0;E<o.length;E++){var x=v.serialize(o[E]);x&&(e["CMCD-"+a[E]]=x)}return e},v.toQuery=function(t){return"CMCD="+encodeURIComponent(v.serialize(t))},v.appendQueryToUri=function(t,i){if(!i)return t;var e=t.includes("?")?"&":"?";return""+t+e+i},v}()},"./src/controller/eme-controller.ts":function(O,C,_){_.r(C);var S=_("./src/events.ts"),c=_("./src/errors.ts"),y=_("./src/utils/logger.ts"),M=_("./src/utils/mediakeys-helper.ts");function T(h,v){for(var d=0;d<v.length;d++){var r=v[d];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(h,r.key,r)}}function p(h,v,d){return v&&T(h.prototype,v),d&&T(h,d),h}var u=3,n=function(v,d,r){var t={audioCapabilities:[],videoCapabilities:[]};return v.forEach(function(i){t.audioCapabilities.push({contentType:'audio/mp4; codecs="'+i+'"',robustness:r.audioRobustness||""})}),d.forEach(function(i){t.videoCapabilities.push({contentType:'video/mp4; codecs="'+i+'"',robustness:r.videoRobustness||""})}),[t]},f=function(v,d,r,t){switch(v){case M.KeySystems.WIDEVINE:return n(d,r,t);default:throw new Error("Unknown key-system: "+v)}},l=function(){function h(d){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=d,this._config=d.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var v=h.prototype;return v.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},v._registerListeners=function(){this.hls.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this)},v._unregisterListeners=function(){this.hls.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(S.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this)},v.getLicenseServerUrl=function(r){switch(r){case M.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+r+'"')},v._attemptKeySystemAccess=function(r,t,i){var e=this,a=f(r,t,i,this._drmSystemOptions);y.logger.log("Requesting encrypted media key-system access");var o=this.requestMediaKeySystemAccess(r,a);this.mediaKeysPromise=o.then(function(s){return e._onMediaKeySystemAccessObtained(r,s)}),o.catch(function(s){y.logger.error('Failed to obtain key-system "'+r+'" access:',s)})},v._onMediaKeySystemAccessObtained=function(r,t){var i=this;y.logger.log('Access for key-system "'+r+'" obtained');var e={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:r};this._mediaKeysList.push(e);var a=Promise.resolve().then(function(){return t.createMediaKeys()}).then(function(o){return e.mediaKeys=o,y.logger.log('Media-keys created for key-system "'+r+'"'),i._onMediaKeysCreated(),o});return a.catch(function(o){y.logger.error("Failed to create media-keys:",o)}),a},v._onMediaKeysCreated=function(){var r=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),r._onNewMediaKeySession(t.mediaKeysSession))})},v._onNewMediaKeySession=function(r){var t=this;y.logger.log("New key-system session "+r.sessionId),r.addEventListener("message",function(i){t._onKeySessionMessage(r,i.message)},!1)},v._onKeySessionMessage=function(r,t){y.logger.log("Got EME message event, creating license request"),this._requestLicense(t,function(i){y.logger.log("Received license data (length: "+(i&&i.byteLength)+"), updating key-session"),r.update(i)})},v.onMediaEncrypted=function(r){var t=this;if(y.logger.log('Media is encrypted using "'+r.initDataType+'" init data type'),!this.mediaKeysPromise){y.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var i=function(a){!t._media||(t._attemptSetMediaKeys(a),t._generateRequestWithPreferredKeySession(r.initDataType,r.initData))};this.mediaKeysPromise.then(i).catch(i)},v._attemptSetMediaKeys=function(r){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var t=this._mediaKeysList[0];if(!t||!t.mediaKeys){y.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}y.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(t.mediaKeys),this._hasSetMediaKeys=!0}},v._generateRequestWithPreferredKeySession=function(r,t){var i=this,e=this._mediaKeysList[0];if(!e){y.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(e.mediaKeysSessionInitialized){y.logger.warn("Key-Session already initialized but requested again");return}var a=e.mediaKeysSession;if(!a){y.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!t){y.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}y.logger.log('Generating key-session request for "'+r+'" init data type'),e.mediaKeysSessionInitialized=!0,a.generateRequest(r,t).then(function(){y.logger.debug("Key-session generation succeeded")}).catch(function(o){y.logger.error("Error generating key-session request:",o),i.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},v._createLicenseXhr=function(r,t,i){var e=new XMLHttpRequest;e.responseType="arraybuffer",e.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,e,r,t,i);var a=this._licenseXhrSetup;if(a)try{a.call(this.hls,e,r),a=void 0}catch(o){y.logger.error(o)}try{e.readyState||e.open("POST",r,!0),a&&a.call(this.hls,e,r)}catch(o){throw new Error("issue setting up KeySystem license XHR "+o)}return e},v._onLicenseRequestReadyStageChange=function(r,t,i,e){switch(r.readyState){case 4:if(r.status===200){this._requestLicenseFailureCount=0,y.logger.log("License request succeeded");var a=r.response,o=this._licenseResponseCallback;if(o)try{a=o.call(this.hls,r,t)}catch(g){y.logger.error(g)}e(a)}else{if(y.logger.error("License Request XHR failed ("+t+"). Status: "+r.status+" ("+r.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u){this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var s=u-this._requestLicenseFailureCount+1;y.logger.warn("Retrying license request, "+s+" attempts left"),this._requestLicense(i,e)}break}},v._generateLicenseRequestChallenge=function(r,t){switch(r.mediaKeySystemDomain){case M.KeySystems.WIDEVINE:return t}throw new Error("unsupported key-system: "+r.mediaKeySystemDomain)},v._requestLicense=function(r,t){y.logger.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i){y.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var e=this.getLicenseServerUrl(i.mediaKeySystemDomain),a=this._createLicenseXhr(e,r,t);y.logger.log("Sending license request to URL: "+e);var o=this._generateLicenseRequestChallenge(i,r);a.send(o)}catch(s){y.logger.error("Failure requesting DRM license: "+s),this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.KEY_SYSTEM_ERROR,details:c.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},v.onMediaAttached=function(r,t){if(!!this._emeEnabled){var i=t.media;this._media=i,i.addEventListener("encrypted",this._onMediaEncrypted)}},v.onMediaDetached=function(){var r=this._media,t=this._mediaKeysList;!r||(r.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(t.map(function(i){if(i.mediaKeysSession)return i.mediaKeysSession.close().catch(function(){})})).then(function(){return r.setMediaKeys(null)}).catch(function(){}))},v.onManifestParsed=function(r,t){if(!!this._emeEnabled){var i=t.levels.map(function(a){return a.audioCodec}).filter(function(a){return!!a}),e=t.levels.map(function(a){return a.videoCodec}).filter(function(a){return!!a});this._attemptKeySystemAccess(M.KeySystems.WIDEVINE,i,e)}},p(h,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),h}();C.default=l},"./src/controller/fps-controller.ts":function(O,C,_){_.r(C);var S=_("./src/events.ts"),c=_("./src/utils/logger.ts"),y=function(){function M(p){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=p,this.registerListeners()}var T=M.prototype;return T.setStreamController=function(u){this.streamController=u},T.registerListeners=function(){this.hls.on(S.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},T.unregisterListeners=function(){this.hls.off(S.Events.MEDIA_ATTACHING,this.onMediaAttaching)},T.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},T.onMediaAttaching=function(u,n){var f=this.hls.config;if(f.capLevelOnFPSDrop){var l=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=l,l&&typeof l.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),f.fpsDroppedMonitoringPeriod)}},T.checkFPS=function(u,n,f){var l=performance.now();if(n){if(this.lastTime){var h=l-this.lastTime,v=f-this.lastDroppedFrames,d=n-this.lastDecodedFrames,r=1e3*v/h,t=this.hls;if(t.trigger(S.Events.FPS_DROP,{currentDropped:v,currentDecoded:d,totalDroppedFrames:f}),r>0&&v>t.config.fpsDroppedMonitoringThreshold*d){var i=t.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+i),i>0&&(t.autoLevelCapping===-1||t.autoLevelCapping>=i)&&(i=i-1,t.trigger(S.Events.FPS_DROP_LEVEL_CAPPING,{level:i,droppedLevel:t.currentLevel}),t.autoLevelCapping=i,this.streamController.nextLevelSwitch())}}this.lastTime=l,this.lastDroppedFrames=f,this.lastDecodedFrames=n}},T.checkFPSInterval=function(){var u=this.media;if(u)if(this.isVideoPlaybackQualityAvailable){var n=u.getVideoPlaybackQuality();this.checkFPS(u,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(u,u.webkitDecodedFrameCount,u.webkitDroppedFrameCount)},M}();C.default=y},"./src/controller/fragment-finders.ts":function(O,C,_){_.r(C),_.d(C,"findFragmentByPDT",function(){return y}),_.d(C,"findFragmentByPTS",function(){return M}),_.d(C,"fragmentWithinToleranceTest",function(){return T}),_.d(C,"pdtWithinToleranceTest",function(){return p}),_.d(C,"findFragWithCC",function(){return u});var S=_("./src/polyfills/number.ts"),c=_("./src/utils/binary-search.ts");function y(n,f,l){if(f===null||!Array.isArray(n)||!n.length||!Object(S.isFiniteNumber)(f))return null;var h=n[0].programDateTime;if(f<(h||0))return null;var v=n[n.length-1].endProgramDateTime;if(f>=(v||0))return null;l=l||0;for(var d=0;d<n.length;++d){var r=n[d];if(p(f,l,r))return r}return null}function M(n,f,l,h){l===void 0&&(l=0),h===void 0&&(h=0);var v=null;if(n?v=f[n.sn-f[0].sn+1]||null:l===0&&f[0].start===0&&(v=f[0]),v&&T(l,h,v)===0)return v;var d=c.default.search(f,T.bind(null,l,h));return d||v}function T(n,f,l){n===void 0&&(n=0),f===void 0&&(f=0);var h=Math.min(f,l.duration+(l.deltaPTS?l.deltaPTS:0));return l.start+l.duration-h<=n?1:l.start-h>n&&l.start?-1:0}function p(n,f,l){var h=Math.min(f,l.duration+(l.deltaPTS?l.deltaPTS:0))*1e3,v=l.endProgramDateTime||0;return v-h>n}function u(n,f){return c.default.search(n,function(l){return l.cc<f?1:l.cc>f?-1:0})}},"./src/controller/fragment-tracker.ts":function(O,C,_){_.r(C),_.d(C,"FragmentState",function(){return y}),_.d(C,"FragmentTracker",function(){return M});var S=_("./src/events.ts"),c=_("./src/types/loader.ts"),y;(function(u){u.NOT_LOADED="NOT_LOADED",u.BACKTRACKED="BACKTRACKED",u.APPENDING="APPENDING",u.PARTIAL="PARTIAL",u.OK="OK"})(y||(y={}));var M=function(){function u(f){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=f,this._registerListeners()}var n=u.prototype;return n._registerListeners=function(){var l=this.hls;l.on(S.Events.BUFFER_APPENDED,this.onBufferAppended,this),l.on(S.Events.FRAG_BUFFERED,this.onFragBuffered,this),l.on(S.Events.FRAG_LOADED,this.onFragLoaded,this)},n._unregisterListeners=function(){var l=this.hls;l.off(S.Events.BUFFER_APPENDED,this.onBufferAppended,this),l.off(S.Events.FRAG_BUFFERED,this.onFragBuffered,this),l.off(S.Events.FRAG_LOADED,this.onFragLoaded,this)},n.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},n.getAppendedFrag=function(l,h){if(h===c.PlaylistLevelType.MAIN){var v=this.activeFragment,d=this.activeParts;if(!v)return null;if(d)for(var r=d.length;r--;){var t=d[r],i=t?t.end:v.appendedPTS;if(t.start<=l&&i!==void 0&&l<=i)return r>9&&(this.activeParts=d.slice(r-9)),t}else if(v.start<=l&&v.appendedPTS!==void 0&&l<=v.appendedPTS)return v}return this.getBufferedFrag(l,h)},n.getBufferedFrag=function(l,h){for(var v=this.fragments,d=Object.keys(v),r=d.length;r--;){var t=v[d[r]];if((t==null?void 0:t.body.type)===h&&t.buffered){var i=t.body;if(i.start<=l&&l<=i.end)return i}}return null},n.detectEvictedFragments=function(l,h,v){var d=this;Object.keys(this.fragments).forEach(function(r){var t=d.fragments[r];if(!!t){if(!t.buffered){t.body.type===v&&d.removeFragment(t.body);return}var i=t.range[l];!i||i.time.some(function(e){var a=!d.isTimeBuffered(e.startPTS,e.endPTS,h);return a&&d.removeFragment(t.body),a})}})},n.detectPartialFragments=function(l){var h=this,v=this.timeRanges,d=l.frag,r=l.part;if(!(!v||d.sn==="initSegment")){var t=p(d),i=this.fragments[t];!i||(Object.keys(v).forEach(function(e){var a=d.elementaryStreams[e];if(!!a){var o=v[e],s=r!==null||a.partial===!0;i.range[e]=h.getBufferedTimes(d,r,s,o)}}),i.backtrack=i.loaded=null,Object.keys(i.range).length?i.buffered=!0:this.removeFragment(i.body))}},n.fragBuffered=function(l){var h=p(l),v=this.fragments[h];v&&(v.backtrack=v.loaded=null,v.buffered=!0)},n.getBufferedTimes=function(l,h,v,d){for(var r={time:[],partial:v},t=h?h.start:l.start,i=h?h.end:l.end,e=l.minEndPTS||i,a=l.maxStartPTS||t,o=0;o<d.length;o++){var s=d.start(o)-this.bufferPadding,g=d.end(o)+this.bufferPadding;if(a>=s&&e<=g){r.time.push({startPTS:Math.max(t,d.start(o)),endPTS:Math.min(i,d.end(o))});break}else if(t<g&&i>s)r.partial=!0,r.time.push({startPTS:Math.max(t,d.start(o)),endPTS:Math.min(i,d.end(o))});else if(i<=s)break}return r},n.getPartialFragment=function(l){var h=null,v,d,r,t=0,i=this.bufferPadding,e=this.fragments;return Object.keys(e).forEach(function(a){var o=e[a];!o||T(o)&&(d=o.body.start-i,r=o.body.end+i,l>=d&&l<=r&&(v=Math.min(l-d,r-l),t<=v&&(h=o.body,t=v)))}),h},n.getState=function(l){var h=p(l),v=this.fragments[h];return v?v.buffered?T(v)?y.PARTIAL:y.OK:v.backtrack?y.BACKTRACKED:y.APPENDING:y.NOT_LOADED},n.backtrack=function(l,h){var v=p(l),d=this.fragments[v];if(!d||d.backtrack)return null;var r=d.backtrack=h||d.loaded;return d.loaded=null,r},n.getBacktrackData=function(l){var h=p(l),v=this.fragments[h];if(v){var d,r=v.backtrack;if(r!=null&&(d=r.payload)!==null&&d!==void 0&&d.byteLength)return r;this.removeFragment(l)}return null},n.isTimeBuffered=function(l,h,v){for(var d,r,t=0;t<v.length;t++){if(d=v.start(t)-this.bufferPadding,r=v.end(t)+this.bufferPadding,l>=d&&h<=r)return!0;if(h<=d)return!1}return!1},n.onFragLoaded=function(l,h){var v=h.frag,d=h.part;if(!(v.sn==="initSegment"||v.bitrateTest||d)){var r=p(v);this.fragments[r]={body:v,loaded:h,backtrack:null,buffered:!1,range:Object.create(null)}}},n.onBufferAppended=function(l,h){var v=this,d=h.frag,r=h.part,t=h.timeRanges;if(d.type===c.PlaylistLevelType.MAIN)if(this.activeFragment=d,r){var i=this.activeParts;i||(this.activeParts=i=[]),i.push(r)}else this.activeParts=null;this.timeRanges=t,Object.keys(t).forEach(function(e){var a=t[e];if(v.detectEvictedFragments(e,a),!r)for(var o=0;o<a.length;o++)d.appendedPTS=Math.max(a.end(o),d.appendedPTS||0)})},n.onFragBuffered=function(l,h){this.detectPartialFragments(h)},n.hasFragment=function(l){var h=p(l);return!!this.fragments[h]},n.removeFragmentsInRange=function(l,h,v){var d=this;Object.keys(this.fragments).forEach(function(r){var t=d.fragments[r];if(!!t&&t.buffered){var i=t.body;i.type===v&&i.start<h&&i.end>l&&d.removeFragment(i)}})},n.removeFragment=function(l){var h=p(l);l.stats.loaded=0,l.clearElementaryStreamInfo(),delete this.fragments[h]},n.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},u}();function T(u){var n,f;return u.buffered&&(((n=u.range.video)===null||n===void 0?void 0:n.partial)||((f=u.range.audio)===null||f===void 0?void 0:f.partial))}function p(u){return u.type+"_"+u.level+"_"+u.urlId+"_"+u.sn}},"./src/controller/gap-controller.ts":function(O,C,_){_.r(C),_.d(C,"STALL_MINIMUM_DURATION_MS",function(){return T}),_.d(C,"MAX_START_GAP_JUMP",function(){return p}),_.d(C,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return u}),_.d(C,"SKIP_BUFFER_RANGE_START",function(){return n}),_.d(C,"default",function(){return f});var S=_("./src/utils/buffer-helper.ts"),c=_("./src/errors.ts"),y=_("./src/events.ts"),M=_("./src/utils/logger.ts"),T=250,p=2,u=.1,n=.05,f=function(){function l(v,d,r,t){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=v,this.media=d,this.fragmentTracker=r,this.hls=t}var h=l.prototype;return h.destroy=function(){this.hls=this.fragmentTracker=this.media=null},h.poll=function(d){var r=this.config,t=this.media,i=this.stalled,e=t.currentTime,a=t.seeking,o=this.seeking&&!a,s=!this.seeking&&a;if(this.seeking=a,e!==d){if(this.moved=!0,i!==null){if(this.stallReported){var g=self.performance.now()-i;M.logger.warn("playback not stuck anymore @"+e+", after "+Math.round(g)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((s||o)&&(this.stalled=null),!(t.paused||t.ended||t.playbackRate===0||!S.BufferHelper.getBuffered(t).length)){var L=S.BufferHelper.bufferInfo(t,e,0),A=L.len>0,m=L.nextStart||0;if(!(!A&&!m)){if(a){var E=L.len>p,x=!m||m-e>p&&!this.fragmentTracker.getPartialFragment(e);if(E||x)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var D,I=Math.max(m,L.start||0)-e,b=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,R=b==null||(D=b.details)===null||D===void 0?void 0:D.live,P=R?b.details.targetduration*2:p;if(I>0&&I<=P){this._trySkipBufferHole(null);return}}var w=self.performance.now();if(i===null){this.stalled=w;return}var F=w-i;!a&&F>=T&&this._reportStall(L.len);var k=S.BufferHelper.bufferInfo(t,e,r.maxBufferHole);this._tryFixBufferStall(k,F)}}},h._tryFixBufferStall=function(d,r){var t=this.config,i=this.fragmentTracker,e=this.media,a=e.currentTime,o=i.getPartialFragment(a);if(o){var s=this._trySkipBufferHole(o);if(s)return}d.len>t.maxBufferHole&&r>t.highBufferWatchdogPeriod*1e3&&(M.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},h._reportStall=function(d){var r=this.hls,t=this.media,i=this.stallReported;i||(this.stallReported=!0,M.logger.warn("Playback stalling at @"+t.currentTime+" due to low buffer (buffer="+d+")"),r.trigger(y.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:d}))},h._trySkipBufferHole=function(d){for(var r=this.config,t=this.hls,i=this.media,e=i.currentTime,a=0,o=S.BufferHelper.getBuffered(i),s=0;s<o.length;s++){var g=o.start(s);if(e+r.maxBufferHole>=a&&e<g){var L=Math.max(g+n,i.currentTime+u);return M.logger.warn("skipping hole, adjusting currentTime from "+e+" to "+L),this.moved=!0,this.stalled=null,i.currentTime=L,d&&t.trigger(y.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+e+" to "+L,frag:d}),L}a=o.end(s)}return 0},h._tryNudgeBuffer=function(){var d=this.config,r=this.hls,t=this.media,i=t.currentTime,e=(this.nudgeRetry||0)+1;if(this.nudgeRetry=e,e<d.nudgeMaxRetry){var a=i+e*d.nudgeOffset;M.logger.warn("Nudging 'currentTime' from "+i+" to "+a),t.currentTime=a,r.trigger(y.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else M.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+d.nudgeMaxRetry+" nudges"),r.trigger(y.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},l}()},"./src/controller/id3-track-controller.ts":function(O,C,_){_.r(C);var S=_("./src/events.ts"),c=_("./src/utils/texttrack-utils.ts"),y=_("./src/demux/id3.ts"),M=.25,T=function(){function p(n){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=n,this._registerListeners()}var u=p.prototype;return u.destroy=function(){this._unregisterListeners()},u._registerListeners=function(){var f=this.hls;f.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u._unregisterListeners=function(){var f=this.hls;f.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(S.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},u.onMediaAttached=function(f,l){this.media=l.media},u.onMediaDetaching=function(){!this.id3Track||(Object(c.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},u.getID3Track=function(f){if(!!this.media){for(var l=0;l<f.length;l++){var h=f[l];if(h.kind==="metadata"&&h.label==="id3")return Object(c.sendAddTrackEvent)(h,this.media),h}return this.media.addTextTrack("metadata","id3")}},u.onFragParsingMetadata=function(f,l){if(!!this.media){var h=l.frag,v=l.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var d=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,r=0;r<v.length;r++){var t=y.getID3Frames(v[r].data);if(t){var i=v[r].pts,e=r<v.length-1?v[r+1].pts:h.end,a=e-i;a<=0&&(e=i+M);for(var o=0;o<t.length;o++){var s=t[o];if(!y.isTimeStampFrame(s)){var g=new d(i,e,"");g.value=s,this.id3Track.addCue(g)}}}}}},u.onBufferFlushing=function(f,l){var h=l.startOffset,v=l.endOffset,d=l.type;if(!d||d==="audio"){var r=this.id3Track;r&&Object(c.removeCuesInRange)(r,h,v)}},p}();C.default=T},"./src/controller/latency-controller.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return p});var S=_("./src/errors.ts"),c=_("./src/events.ts"),y=_("./src/utils/logger.ts");function M(u,n){for(var f=0;f<n.length;f++){var l=n[f];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}function T(u,n,f){return n&&M(u.prototype,n),f&&M(u,f),u}var p=function(){function u(f){var l=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return l.timeupdate()},this.hls=f,this.config=f.config,this.registerListeners()}var n=u.prototype;return n.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},n.registerListeners=function(){this.hls.on(c.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(c.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(c.Events.ERROR,this.onError,this)},n.unregisterListeners=function(){this.hls.off(c.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(c.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(c.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(c.Events.ERROR,this.onError)},n.onMediaAttached=function(l,h){this.media=h.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},n.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},n.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},n.onLevelUpdated=function(l,h){var v=h.details;this.levelDetails=v,v.advanced&&this.timeupdate(),!v.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},n.onError=function(l,h){h.details===S.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,y.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},n.timeupdate=function(){var l=this.media,h=this.levelDetails;if(!(!l||!h)){this.currentTime=l.currentTime;var v=this.computeLatency();if(v!==null){this._latency=v;var d=this.config,r=d.lowLatencyMode,t=d.maxLiveSyncPlaybackRate;if(!(!r||t===1)){var i=this.targetLatency;if(i!==null){var e=v-i,a=Math.min(this.maxLatency,i+h.targetduration),o=e<a;if(h.live&&o&&e>.05&&this.forwardBufferLength>1){var s=Math.min(2,Math.max(1,t)),g=Math.round(2/(1+Math.exp(-.75*e-this.edgeStalled))*20)/20;l.playbackRate=Math.min(s,Math.max(1,g))}else l.playbackRate!==1&&l.playbackRate!==0&&(l.playbackRate=1)}}}}},n.estimateLiveEdge=function(){var l=this.levelDetails;return l===null?null:l.edge+l.age},n.computeLatency=function(){var l=this.estimateLiveEdge();return l===null?null:l-this.currentTime},T(u,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var l=this.config,h=this.levelDetails;return l.liveMaxLatencyDuration!==void 0?l.liveMaxLatencyDuration:h?l.liveMaxLatencyDurationCount*h.targetduration:0}},{key:"targetLatency",get:function(){var l=this.levelDetails;if(l===null)return null;var h=l.holdBack,v=l.partHoldBack,d=l.targetduration,r=this.config,t=r.liveSyncDuration,i=r.liveSyncDurationCount,e=r.lowLatencyMode,a=this.hls.userConfig,o=e&&v||h;(a.liveSyncDuration||a.liveSyncDurationCount||o===0)&&(o=t!==void 0?t:i*d);var s=d,g=1;return o+Math.min(this.stallCount*g,s)}},{key:"liveSyncPosition",get:function(){var l=this.estimateLiveEdge(),h=this.targetLatency,v=this.levelDetails;if(l===null||h===null||v===null)return null;var d=v.edge,r=l-h-this.edgeStalled,t=d-v.totalduration,i=d-(this.config.lowLatencyMode&&v.partTarget||v.targetduration);return Math.min(Math.max(t,r),i)}},{key:"drift",get:function(){var l=this.levelDetails;return l===null?1:l.drift}},{key:"edgeStalled",get:function(){var l=this.levelDetails;if(l===null)return 0;var h=(this.config.lowLatencyMode&&l.partTarget||l.targetduration)*3;return Math.max(l.age-h,0)}},{key:"forwardBufferLength",get:function(){var l=this.media,h=this.levelDetails;if(!l||!h)return 0;var v=l.buffered.length;return v?l.buffered.end(v-1):h.edge-this.currentTime}}]),u}()},"./src/controller/level-controller.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return r});var S=_("./src/types/level.ts"),c=_("./src/events.ts"),y=_("./src/errors.ts"),M=_("./src/utils/codecs.ts"),T=_("./src/controller/level-helper.ts"),p=_("./src/controller/base-playlist-controller.ts"),u=_("./src/types/loader.ts");function n(){return n=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var e=arguments[i];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a])}return t},n.apply(this,arguments)}function f(t,i){for(var e=0;e<i.length;e++){var a=i[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function l(t,i,e){return i&&f(t.prototype,i),e&&f(t,e),t}function h(t,i){t.prototype=Object.create(i.prototype),t.prototype.constructor=t,v(t,i)}function v(t,i){return v=Object.setPrototypeOf||function(a,o){return a.__proto__=o,a},v(t,i)}var d=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r=function(t){h(i,t);function i(a){var o;return o=t.call(this,a,"[level-controller]")||this,o._levels=[],o._firstLevel=-1,o._startLevel=void 0,o.currentLevelIndex=-1,o.manualLevelIndex=-1,o.onParsedComplete=void 0,o._registerListeners(),o}var e=i.prototype;return e._registerListeners=function(){var o=this.hls;o.on(c.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.on(c.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(c.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.on(c.Events.FRAG_LOADED,this.onFragLoaded,this),o.on(c.Events.ERROR,this.onError,this)},e._unregisterListeners=function(){var o=this.hls;o.off(c.Events.MANIFEST_LOADED,this.onManifestLoaded,this),o.off(c.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(c.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),o.off(c.Events.FRAG_LOADED,this.onFragLoaded,this),o.off(c.Events.ERROR,this.onError,this)},e.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,t.prototype.destroy.call(this)},e.startLoad=function(){var o=this._levels;o.forEach(function(s){s.loadError=0}),t.prototype.startLoad.call(this)},e.onManifestLoaded=function(o,s){var g=[],L=[],A=[],m,E={},x,D=!1,I=!1,b=!1;if(s.levels.forEach(function(F){var k=F.attrs;D=D||!!(F.width&&F.height),I=I||!!F.videoCodec,b=b||!!F.audioCodec,d&&F.audioCodec&&F.audioCodec.indexOf("mp4a.40.34")!==-1&&(F.audioCodec=void 0);var B=F.bitrate+"-"+F.attrs.RESOLUTION+"-"+F.attrs.CODECS;x=E[B],x?x.url.push(F.url):(x=new S.Level(F),E[B]=x,g.push(x)),k&&(k.AUDIO&&Object(T.addGroupId)(x,"audio",k.AUDIO),k.SUBTITLES&&Object(T.addGroupId)(x,"text",k.SUBTITLES))}),(D||I)&&b&&(g=g.filter(function(F){var k=F.videoCodec,B=F.width,U=F.height;return!!k||!!(B&&U)})),g=g.filter(function(F){var k=F.audioCodec,B=F.videoCodec;return(!k||Object(M.isCodecSupportedInMp4)(k,"audio"))&&(!B||Object(M.isCodecSupportedInMp4)(B,"video"))}),s.audioTracks&&(L=s.audioTracks.filter(function(F){return!F.audioCodec||Object(M.isCodecSupportedInMp4)(F.audioCodec,"audio")}),Object(T.assignTrackIdsByGroup)(L)),s.subtitles&&(A=s.subtitles,Object(T.assignTrackIdsByGroup)(A)),g.length>0){m=g[0].bitrate,g.sort(function(F,k){return F.bitrate-k.bitrate}),this._levels=g;for(var R=0;R<g.length;R++)if(g[R].bitrate===m){this._firstLevel=R,this.log("manifest loaded, "+g.length+" level(s) found, first bitrate: "+m);break}var P=b&&!I,w={levels:g,audioTracks:L,subtitleTracks:A,firstLevel:this._firstLevel,stats:s.stats,audio:b,video:I,altAudio:!P&&L.some(function(F){return!!F.url})};this.hls.trigger(c.Events.MANIFEST_PARSED,w),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(c.Events.ERROR,{type:y.ErrorTypes.MEDIA_ERROR,details:y.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:s.url,reason:"no level with compatible codecs found in manifest"})},e.onError=function(o,s){if(t.prototype.onError.call(this,o,s),!s.fatal){var g=s.context,L=this._levels[this.currentLevelIndex];if(g&&(g.type===u.PlaylistContextType.AUDIO_TRACK&&L.audioGroupIds&&g.groupId===L.audioGroupIds[L.urlId]||g.type===u.PlaylistContextType.SUBTITLE_TRACK&&L.textGroupIds&&g.groupId===L.textGroupIds[L.urlId])){this.redundantFailover(this.currentLevelIndex);return}var A=!1,m=!0,E;switch(s.details){case y.ErrorDetails.FRAG_LOAD_ERROR:case y.ErrorDetails.FRAG_LOAD_TIMEOUT:case y.ErrorDetails.KEY_LOAD_ERROR:case y.ErrorDetails.KEY_LOAD_TIMEOUT:if(s.frag){var x=this._levels[s.frag.level];x?(x.fragmentError++,x.fragmentError>this.hls.config.fragLoadingMaxRetry&&(E=s.frag.level)):E=s.frag.level}break;case y.ErrorDetails.LEVEL_LOAD_ERROR:case y.ErrorDetails.LEVEL_LOAD_TIMEOUT:g&&(g.deliveryDirectives&&(m=!1),E=g.level),A=!0;break;case y.ErrorDetails.REMUX_ALLOC_ERROR:E=s.level,A=!0;break}E!==void 0&&this.recoverLevel(s,E,A,m)}},e.recoverLevel=function(o,s,g,L){var A=o.details,m=this._levels[s];if(m.loadError++,g){var E=this.retryLoadingOrFail(o);if(E)o.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(L){var x=m.url.length;if(x>1&&m.loadError<x)o.levelRetry=!0,this.redundantFailover(s);else if(this.manualLevelIndex===-1){var D=s===0?this._levels.length-1:s-1;this.currentLevelIndex!==D&&this._levels[D].loadError===0&&(this.warn(A+": switch to "+D),o.levelRetry=!0,this.hls.nextAutoLevel=D)}}},e.redundantFailover=function(o){var s=this._levels[o],g=s.url.length;if(g>1){var L=(s.urlId+1)%g;this.warn("Switching to redundant URL-id "+L),this._levels.forEach(function(A){A.urlId=L}),this.level=o}},e.onFragLoaded=function(o,s){var g=s.frag;if(g!==void 0&&g.type===u.PlaylistLevelType.MAIN){var L=this._levels[g.level];L!==void 0&&(L.fragmentError=0,L.loadError=0)}},e.onLevelLoaded=function(o,s){var g,L=s.level,A=s.details,m=this._levels[L];if(!m){var E;this.warn("Invalid level index "+L),(E=s.deliveryDirectives)!==null&&E!==void 0&&E.skip&&(A.deltaUpdateFailed=!0);return}L===this.currentLevelIndex?(m.fragmentError===0&&(m.loadError=0,this.retryCount=0),this.playlistLoaded(L,s,m.details)):(g=s.deliveryDirectives)!==null&&g!==void 0&&g.skip&&(A.deltaUpdateFailed=!0)},e.onAudioTrackSwitched=function(o,s){var g=this.hls.levels[this.currentLevelIndex];if(!!g&&g.audioGroupIds){for(var L=-1,A=this.hls.audioTracks[s.id].groupId,m=0;m<g.audioGroupIds.length;m++)if(g.audioGroupIds[m]===A){L=m;break}L!==g.urlId&&(g.urlId=L,this.startLoad())}},e.loadPlaylist=function(o){var s=this.currentLevelIndex,g=this._levels[s];if(this.canLoad&&g&&g.url.length>0){var L=g.urlId,A=g.url[L];if(o)try{A=o.addDirectives(A)}catch(m){this.warn("Could not construct new URL with HLS Delivery Directives: "+m)}this.log("Attempt loading level index "+s+(o?" at sn "+o.msn+" part "+o.part:"")+" with URL-id "+L+" "+A),this.clearTimer(),this.hls.trigger(c.Events.LEVEL_LOADING,{url:A,level:s,id:L,deliveryDirectives:o||null})}},e.removeLevel=function(o,s){var g=function(m,E){return E!==s},L=this._levels.filter(function(A,m){return m!==o?!0:A.url.length>1&&s!==void 0?(A.url=A.url.filter(g),A.audioGroupIds&&(A.audioGroupIds=A.audioGroupIds.filter(g)),A.textGroupIds&&(A.textGroupIds=A.textGroupIds.filter(g)),A.urlId=0,!0):!1}).map(function(A,m){var E=A.details;return E!=null&&E.fragments&&E.fragments.forEach(function(x){x.level=m}),A});this._levels=L,this.hls.trigger(c.Events.LEVELS_UPDATED,{levels:L})},l(i,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(o){var s,g=this._levels;if(g.length!==0&&!(this.currentLevelIndex===o&&(s=g[o])!==null&&s!==void 0&&s.details)){if(o<0||o>=g.length){var L=o<0;if(this.hls.trigger(c.Events.ERROR,{type:y.ErrorTypes.OTHER_ERROR,details:y.ErrorDetails.LEVEL_SWITCH_ERROR,level:o,fatal:L,reason:"invalid level idx"}),L)return;o=Math.min(o,g.length-1)}this.clearTimer();var A=this.currentLevelIndex,m=g[A],E=g[o];this.log("switching to level "+o+" from "+A),this.currentLevelIndex=o;var x=n({},E,{level:o,maxBitrate:E.maxBitrate,uri:E.uri,urlId:E.urlId});delete x._urlId,this.hls.trigger(c.Events.LEVEL_SWITCHING,x);var D=E.details;if(!D||D.live){var I=this.switchParams(E.uri,m==null?void 0:m.details);this.loadPlaylist(I)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(o){this.manualLevelIndex=o,this._startLevel===void 0&&(this._startLevel=o),o!==-1&&(this.level=o)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(o){this._firstLevel=o}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var o=this.hls.config.startLevel;return o!==void 0?o:this._firstLevel}else return this._startLevel},set:function(o){this._startLevel=o}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(o){this.level=o,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=o)}}]),i}(p.default)},"./src/controller/level-helper.ts":function(O,C,_){_.r(C),_.d(C,"addGroupId",function(){return y}),_.d(C,"assignTrackIdsByGroup",function(){return M}),_.d(C,"updatePTS",function(){return T}),_.d(C,"updateFragPTSDTS",function(){return u}),_.d(C,"mergeDetails",function(){return n}),_.d(C,"mapPartIntersection",function(){return f}),_.d(C,"mapFragmentIntersection",function(){return l}),_.d(C,"adjustSliding",function(){return h}),_.d(C,"addSliding",function(){return v}),_.d(C,"computeReloadInterval",function(){return d}),_.d(C,"getFragmentWithSN",function(){return r}),_.d(C,"getPartWith",function(){return t});var S=_("./src/polyfills/number.ts"),c=_("./src/utils/logger.ts");function y(i,e,a){switch(e){case"audio":i.audioGroupIds||(i.audioGroupIds=[]),i.audioGroupIds.push(a);break;case"text":i.textGroupIds||(i.textGroupIds=[]),i.textGroupIds.push(a);break}}function M(i){var e={};i.forEach(function(a){var o=a.groupId||"";a.id=e[o]=e[o]||0,e[o]++})}function T(i,e,a){var o=i[e],s=i[a];p(o,s)}function p(i,e){var a=e.startPTS;if(Object(S.isFiniteNumber)(a)){var o=0,s;e.sn>i.sn?(o=a-i.start,s=i):(o=i.start-a,s=e),s.duration!==o&&(s.duration=o)}else if(e.sn>i.sn){var g=i.cc===e.cc;g&&i.minEndPTS?e.start=i.start+(i.minEndPTS-i.start):e.start=i.start+i.duration}else e.start=Math.max(i.start-e.duration,0)}function u(i,e,a,o,s,g){var L=o-a;L<=0&&(c.logger.warn("Fragment should have a positive duration",e),o=a+e.duration,g=s+e.duration);var A=a,m=o,E=e.startPTS,x=e.endPTS;if(Object(S.isFiniteNumber)(E)){var D=Math.abs(E-a);Object(S.isFiniteNumber)(e.deltaPTS)?e.deltaPTS=Math.max(D,e.deltaPTS):e.deltaPTS=D,A=Math.max(a,E),a=Math.min(a,E),s=Math.min(s,e.startDTS),m=Math.min(o,x),o=Math.max(o,x),g=Math.max(g,e.endDTS)}e.duration=o-a;var I=a-e.start;e.appendedPTS=o,e.start=e.startPTS=a,e.maxStartPTS=A,e.startDTS=s,e.endPTS=o,e.minEndPTS=m,e.endDTS=g;var b=e.sn;if(!i||b<i.startSN||b>i.endSN)return 0;var R,P=b-i.startSN,w=i.fragments;for(w[P]=e,R=P;R>0;R--)p(w[R],w[R-1]);for(R=P;R<w.length-1;R++)p(w[R],w[R+1]);return i.fragmentHint&&p(w[w.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,I}function n(i,e){for(var a=null,o=i.fragments,s=o.length-1;s>=0;s--){var g=o[s].initSegment;if(g){a=g;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;var L=0,A;if(l(i,e,function(R,P){R.relurl&&(L=R.cc-P.cc),Object(S.isFiniteNumber)(R.startPTS)&&Object(S.isFiniteNumber)(R.endPTS)&&(P.start=P.startPTS=R.startPTS,P.startDTS=R.startDTS,P.appendedPTS=R.appendedPTS,P.maxStartPTS=R.maxStartPTS,P.endPTS=R.endPTS,P.endDTS=R.endDTS,P.minEndPTS=R.minEndPTS,P.duration=R.endPTS-R.startPTS,P.duration&&(A=P),e.PTSKnown=e.alignedSliding=!0),P.elementaryStreams=R.elementaryStreams,P.loader=R.loader,P.stats=R.stats,P.urlId=R.urlId,R.initSegment&&(P.initSegment=R.initSegment,a=R.initSegment)}),a){var m=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;m.forEach(function(R){var P;(!R.initSegment||R.initSegment.relurl===((P=a)===null||P===void 0?void 0:P.relurl))&&(R.initSegment=a)})}if(e.skippedSegments&&(e.deltaUpdateFailed=e.fragments.some(function(R){return!R}),e.deltaUpdateFailed)){c.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var E=e.skippedSegments;E--;)e.fragments.shift();e.startSN=e.fragments[0].sn,e.startCC=e.fragments[0].cc}var x=e.fragments;if(L){c.logger.warn("discontinuity sliding from playlist, take drift into account");for(var D=0;D<x.length;D++)x[D].cc+=L}e.skippedSegments&&(e.startCC=e.fragments[0].cc),f(i.partList,e.partList,function(R,P){P.elementaryStreams=R.elementaryStreams,P.stats=R.stats}),A?u(e,A,A.startPTS,A.endPTS,A.startDTS,A.endDTS):h(i,e),x.length&&(e.totalduration=e.edge-x[0].start),e.driftStartTime=i.driftStartTime,e.driftStart=i.driftStart;var I=e.advancedDateTime;if(e.advanced&&I){var b=e.edge;e.driftStart||(e.driftStartTime=I,e.driftStart=b),e.driftEndTime=I,e.driftEnd=b}else e.driftEndTime=i.driftEndTime,e.driftEnd=i.driftEnd,e.advancedDateTime=i.advancedDateTime}function f(i,e,a){if(i&&e)for(var o=0,s=0,g=i.length;s<=g;s++){var L=i[s],A=e[s+o];L&&A&&L.index===A.index&&L.fragment.sn===A.fragment.sn?a(L,A):o--}}function l(i,e,a){for(var o=e.skippedSegments,s=Math.max(i.startSN,e.startSN)-e.startSN,g=(i.fragmentHint?1:0)+(o?e.endSN:Math.min(i.endSN,e.endSN))-e.startSN,L=e.startSN-i.startSN,A=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,m=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments,E=s;E<=g;E++){var x=m[L+E],D=A[E];o&&!D&&E<o&&(D=e.fragments[E]=x),x&&D&&a(x,D)}}function h(i,e){var a=e.startSN+e.skippedSegments-i.startSN,o=i.fragments;a<0||a>=o.length||v(e,o[a].start)}function v(i,e){if(e){for(var a=i.fragments,o=i.skippedSegments;o<a.length;o++)a[o].start+=e;i.fragmentHint&&(i.fragmentHint.start+=e)}}function d(i,e){var a=1e3*i.levelTargetDuration,o=a/2,s=i.age,g=s>0&&s<a*3,L=e.loading.end-e.loading.start,A,m=i.availabilityDelay;if(i.updated===!1)if(g){var E=333*i.misses;A=Math.max(Math.min(o,L*2),E),i.availabilityDelay=(i.availabilityDelay||0)+A}else A=o;else g?(m=Math.min(m||a/2,s),i.availabilityDelay=m,A=m+a-s):A=a-L;return Math.round(A)}function r(i,e,a){if(!i||!i.details)return null;var o=i.details,s=o.fragments[e-o.startSN];return s||(s=o.fragmentHint,s&&s.sn===e)?s:e<o.startSN&&a&&a.sn===e?a:null}function t(i,e,a){if(!i||!i.details)return null;var o=i.details.partList;if(o)for(var s=o.length;s--;){var g=o[s];if(g.index===a&&g.fragment.sn===e)return g}return null}},"./src/controller/stream-controller.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return o});var S=_("./src/polyfills/number.ts"),c=_("./src/controller/base-stream-controller.ts"),y=_("./src/is-supported.ts"),M=_("./src/events.ts"),T=_("./src/utils/buffer-helper.ts"),p=_("./src/controller/fragment-tracker.ts"),u=_("./src/types/loader.ts"),n=_("./src/loader/fragment.ts"),f=_("./src/demux/transmuxer-interface.ts"),l=_("./src/types/transmuxer.ts"),h=_("./src/controller/gap-controller.ts"),v=_("./src/errors.ts"),d=_("./src/utils/logger.ts");function r(s,g){for(var L=0;L<g.length;L++){var A=g[L];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(s,A.key,A)}}function t(s,g,L){return g&&r(s.prototype,g),L&&r(s,L),s}function i(s,g){s.prototype=Object.create(g.prototype),s.prototype.constructor=s,e(s,g)}function e(s,g){return e=Object.setPrototypeOf||function(A,m){return A.__proto__=m,A},e(s,g)}var a=100,o=function(s){i(g,s);function g(A,m){var E;return E=s.call(this,A,m,"[stream-controller]")||this,E.audioCodecSwap=!1,E.gapController=null,E.level=-1,E._forceStartLoad=!1,E.altAudio=!1,E.audioOnly=!1,E.fragPlaying=null,E.onvplaying=null,E.onvseeked=null,E.fragLastKbps=0,E.stalled=!1,E.couldBacktrack=!1,E.audioCodecSwitch=!1,E.videoBuffer=null,E._registerListeners(),E}var L=g.prototype;return L._registerListeners=function(){var m=this.hls;m.on(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.on(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.on(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.on(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),m.on(M.Events.LEVEL_LOADING,this.onLevelLoading,this),m.on(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.on(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),m.on(M.Events.ERROR,this.onError,this),m.on(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),m.on(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),m.on(M.Events.BUFFER_CREATED,this.onBufferCreated,this),m.on(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),m.on(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),m.on(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L._unregisterListeners=function(){var m=this.hls;m.off(M.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.off(M.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.off(M.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.off(M.Events.MANIFEST_PARSED,this.onManifestParsed,this),m.off(M.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.off(M.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),m.off(M.Events.ERROR,this.onError,this),m.off(M.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),m.off(M.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),m.off(M.Events.BUFFER_CREATED,this.onBufferCreated,this),m.off(M.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),m.off(M.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),m.off(M.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},L.startLoad=function(m){if(this.levels){var E=this.lastCurrentTime,x=this.hls;if(this.stopLoad(),this.setInterval(a),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var D=x.startLevel;D===-1&&(x.config.testBandwidth?(D=0,this.bitrateTest=!0):D=x.nextAutoLevel),this.level=x.nextLoadLevel=D,this.loadedmetadata=!1}E>0&&m===-1&&(this.log("Override startPosition with lastCurrentTime @"+E.toFixed(3)),m=E),this.state=c.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=m,this.tick()}else this._forceStartLoad=!0,this.state=c.State.STOPPED},L.stopLoad=function(){this._forceStartLoad=!1,s.prototype.stopLoad.call(this)},L.doTick=function(){switch(this.state){case c.State.IDLE:this.doTickIdle();break;case c.State.WAITING_LEVEL:{var m,E=this.levels,x=this.level,D=E==null||(m=E[x])===null||m===void 0?void 0:m.details;if(D&&(!D.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(D))break;this.state=c.State.IDLE;break}break}case c.State.FRAG_LOADING_WAITING_RETRY:{var I,b=self.performance.now(),R=this.retryDate;(!R||b>=R||(I=this.media)!==null&&I!==void 0&&I.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=c.State.IDLE)}break}this.onTickEnd()},L.onTickEnd=function(){s.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},L.doTickIdle=function(){var m,E,x=this.hls,D=this.levelLastLoaded,I=this.levels,b=this.media,R=x.config,P=x.nextLoadLevel;if(!(D===null||!b&&(this.startFragRequested||!R.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!I||!I[P])){var w=I[P];this.level=x.nextLoadLevel=P;var F=w.details;if(!F||this.state===c.State.WAITING_LEVEL||F.live&&this.levelLastLoaded!==P){this.state=c.State.WAITING_LEVEL;return}var k=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:b,u.PlaylistLevelType.MAIN);if(k!==null){var B=k.len,U=this.getMaxBufferLength(w.maxBitrate);if(!(B>=U)){if(this._streamEnded(k,F)){var j={};this.altAudio&&(j.type="video"),this.hls.trigger(M.Events.BUFFER_EOS,j),this.state=c.State.ENDED;return}var K=k.end,N=this.getNextFragment(K,F);if(this.couldBacktrack&&!this.fragPrevious&&N&&N.sn!=="initSegment"){var Z=N.sn-F.startSN;Z>1&&(N=F.fragments[Z-1],this.fragmentTracker.removeFragment(N))}if(N&&this.fragmentTracker.getState(N)===p.FragmentState.OK&&this.nextLoadPosition>K){var $=this.audioOnly&&!this.altAudio?n.ElementaryStreamTypes.AUDIO:n.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(b,$,u.PlaylistLevelType.MAIN),N=this.getNextFragment(this.nextLoadPosition,F)}!N||(N.initSegment&&!N.initSegment.data&&!this.bitrateTest&&(N=N.initSegment),((m=N.decryptdata)===null||m===void 0?void 0:m.keyFormat)==="identity"&&!((E=N.decryptdata)!==null&&E!==void 0&&E.key)?this.loadKey(N,F):this.loadFragment(N,F,K))}}}},L.loadFragment=function(m,E,x){var D,I=this.fragmentTracker.getState(m);if(this.fragCurrent=m,I===p.FragmentState.BACKTRACKED){var b=this.fragmentTracker.getBacktrackData(m);if(b){this._handleFragmentLoadProgress(b),this._handleFragmentLoadComplete(b);return}else I=p.FragmentState.NOT_LOADED}I===p.FragmentState.NOT_LOADED||I===p.FragmentState.PARTIAL?m.sn==="initSegment"?this._loadInitSegment(m):this.bitrateTest?(m.bitrateTest=!0,this.log("Fragment "+m.sn+" of level "+m.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(m)):(this.startFragRequested=!0,s.prototype.loadFragment.call(this,m,E,x)):I===p.FragmentState.APPENDING?this.reduceMaxBufferLength(m.duration)&&this.fragmentTracker.removeFragment(m):((D=this.media)===null||D===void 0?void 0:D.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},L.getAppendedFrag=function(m){var E=this.fragmentTracker.getAppendedFrag(m,u.PlaylistLevelType.MAIN);return E&&"fragment"in E?E.fragment:E},L.getBufferedFrag=function(m){return this.fragmentTracker.getBufferedFrag(m,u.PlaylistLevelType.MAIN)},L.followingBufferedFrag=function(m){return m?this.getBufferedFrag(m.end+.5):null},L.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},L.nextLevelSwitch=function(){var m=this.levels,E=this.media;if(E!=null&&E.readyState){var x,D=this.getAppendedFrag(E.currentTime);if(D&&D.start>1&&this.flushMainBuffer(0,D.start-1),!E.paused&&m){var I=this.hls.nextLoadLevel,b=m[I],R=this.fragLastKbps;R&&this.fragCurrent?x=this.fragCurrent.duration*b.maxBitrate/(1e3*R)+1:x=0}else x=0;var P=this.getBufferedFrag(E.currentTime+x);if(P){var w=this.followingBufferedFrag(P);if(w){this.abortCurrentFrag();var F=w.maxStartPTS?w.maxStartPTS:w.start,k=w.duration,B=Math.max(P.end,F+Math.min(Math.max(k-this.config.maxFragLookUpTolerance,k*.5),k*.75));this.flushMainBuffer(B,Number.POSITIVE_INFINITY)}}}},L.abortCurrentFrag=function(){var m=this.fragCurrent;this.fragCurrent=null,m!=null&&m.loader&&m.loader.abort(),this.state===c.State.KEY_LOADING&&(this.state=c.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},L.flushMainBuffer=function(m,E){s.prototype.flushMainBuffer.call(this,m,E,this.altAudio?"video":null)},L.onMediaAttached=function(m,E){s.prototype.onMediaAttached.call(this,m,E);var x=E.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),x.addEventListener("playing",this.onvplaying),x.addEventListener("seeked",this.onvseeked),this.gapController=new h.default(this.config,x,this.fragmentTracker,this.hls)},L.onMediaDetaching=function(){var m=this.media;m&&(m.removeEventListener("playing",this.onvplaying),m.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),s.prototype.onMediaDetaching.call(this)},L.onMediaPlaying=function(){this.tick()},L.onMediaSeeked=function(){var m=this.media,E=m?m.currentTime:null;Object(S.isFiniteNumber)(E)&&this.log("Media seeked to "+E.toFixed(3)),this.tick()},L.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(M.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},L.onManifestParsed=function(m,E){var x=!1,D=!1,I;E.levels.forEach(function(b){I=b.audioCodec,I&&(I.indexOf("mp4a.40.2")!==-1&&(x=!0),I.indexOf("mp4a.40.5")!==-1&&(D=!0))}),this.audioCodecSwitch=x&&D&&!Object(y.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=E.levels,this.startFragRequested=!1},L.onLevelLoading=function(m,E){var x=this.levels;if(!(!x||this.state!==c.State.IDLE)){var D=x[E.level];(!D.details||D.details.live&&this.levelLastLoaded!==E.level||this.waitForCdnTuneIn(D.details))&&(this.state=c.State.WAITING_LEVEL)}},L.onLevelLoaded=function(m,E){var x,D=this.levels,I=E.level,b=E.details,R=b.totalduration;if(!D){this.warn("Levels were reset while loading level "+I);return}this.log("Level "+I+" loaded ["+b.startSN+","+b.endSN+"], cc ["+b.startCC+", "+b.endCC+"] duration:"+R);var P=this.fragCurrent;P&&(this.state===c.State.FRAG_LOADING||this.state===c.State.FRAG_LOADING_WAITING_RETRY)&&P.level!==E.level&&P.loader&&(this.state=c.State.IDLE,P.loader.abort());var w=D[I],F=0;if(b.live||(x=w.details)!==null&&x!==void 0&&x.live){if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed)return;F=this.alignPlaylists(b,w.details)}if(w.details=b,this.levelLastLoaded=I,this.hls.trigger(M.Events.LEVEL_UPDATED,{details:b,level:I}),this.state===c.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(b))return;this.state=c.State.IDLE}this.startFragRequested?b.live&&this.synchronizeToLiveEdge(b):this.setStartPosition(b,F),this.tick()},L._handleFragmentLoadProgress=function(m){var E,x=m.frag,D=m.part,I=m.payload,b=this.levels;if(!b){this.warn("Levels were reset while fragment load was in progress. Fragment "+x.sn+" of level "+x.level+" will not be buffered");return}var R=b[x.level],P=R.details;if(!P){this.warn("Dropping fragment "+x.sn+" of level "+x.level+" after level details were reset");return}var w=R.videoCodec,F=P.PTSKnown||!P.live,k=(E=x.initSegment)===null||E===void 0?void 0:E.data,B=this._getAudioCodec(R),U=this.transmuxer=this.transmuxer||new f.default(this.hls,u.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),j=D?D.index:-1,K=j!==-1,N=new l.ChunkMetadata(x.level,x.sn,x.stats.chunkCount,I.byteLength,j,K),Z=this.initPTS[x.cc];U.push(I,k,B,w,x,D,P.totalduration,F,N,Z)},L.onAudioTrackSwitching=function(m,E){var x=this.altAudio,D=!!E.url,I=E.id;if(!D){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var b=this.fragCurrent;b!=null&&b.loader&&(this.log("Switching to main audio track, cancel main fragment load"),b.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var R=this.hls;x&&R.trigger(M.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),R.trigger(M.Events.AUDIO_TRACK_SWITCHED,{id:I})}},L.onAudioTrackSwitched=function(m,E){var x=E.id,D=!!this.hls.audioTracks[x].url;if(D){var I=this.videoBuffer;I&&this.mediaBuffer!==I&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=I)}this.altAudio=D,this.tick()},L.onBufferCreated=function(m,E){var x=E.tracks,D,I,b=!1;for(var R in x){var P=x[R];if(P.id==="main"){if(I=R,D=P,R==="video"){var w=x[R];w&&(this.videoBuffer=w.buffer)}}else b=!0}b&&D?(this.log("Alternate track found, use "+I+".buffered to schedule main fragment loading"),this.mediaBuffer=D.buffer):this.mediaBuffer=this.media},L.onFragBuffered=function(m,E){var x=E.frag,D=E.part;if(!(x&&x.type!==u.PlaylistLevelType.MAIN)){if(this.fragContextChanged(x)){this.warn("Fragment "+x.sn+(D?" p: "+D.index:"")+" of level "+x.level+" finished buffering, but was aborted. state: "+this.state),this.state===c.State.PARSED&&(this.state=c.State.IDLE);return}var I=D?D.stats:x.stats;this.fragLastKbps=Math.round(8*I.total/(I.buffering.end-I.loading.first)),x.sn!=="initSegment"&&(this.fragPrevious=x),this.fragBufferedComplete(x,D)}},L.onError=function(m,E){switch(E.details){case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:case v.ErrorDetails.KEY_LOAD_ERROR:case v.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(u.PlaylistLevelType.MAIN,E);break;case v.ErrorDetails.LEVEL_LOAD_ERROR:case v.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==c.State.ERROR&&(E.fatal?(this.warn(""+E.details),this.state=c.State.ERROR):!E.levelRetry&&this.state===c.State.WAITING_LEVEL&&(this.state=c.State.IDLE));break;case v.ErrorDetails.BUFFER_FULL_ERROR:if(E.parent==="main"&&(this.state===c.State.PARSING||this.state===c.State.PARSED)){var x=!0,D=this.getFwdBufferInfo(this.media,u.PlaylistLevelType.MAIN);D&&D.len>.5&&(x=!this.reduceMaxBufferLength(D.len)),x&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},L.checkBuffer=function(){var m=this.media,E=this.gapController;if(!(!m||!E||!m.readyState)){var x=T.BufferHelper.getBuffered(m);!this.loadedmetadata&&x.length?(this.loadedmetadata=!0,this.seekToStartPos()):E.poll(this.lastCurrentTime),this.lastCurrentTime=m.currentTime}},L.onFragLoadEmergencyAborted=function(){this.state=c.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},L.onBufferFlushed=function(m,E){var x=E.type;if(x!==n.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var D=(x===n.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(D,x,u.PlaylistLevelType.MAIN)}},L.onLevelsUpdated=function(m,E){this.levels=E.levels},L.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},L.seekToStartPos=function(){var m=this.media,E=m.currentTime,x=this.startPosition;if(x>=0&&E<x){if(m.seeking){d.logger.log("could not seek to "+x+", already seeking at "+E);return}var D=T.BufferHelper.getBuffered(m),I=D.length?D.start(0):0,b=I-x;b>0&&(b<this.config.maxBufferHole||b<this.config.maxFragLookUpTolerance)&&(d.logger.log("adjusting start position by "+b+" to match buffer start"),x+=b,this.startPosition=x),this.log("seek to target start position "+x+" from current time "+E),m.currentTime=x}},L._getAudioCodec=function(m){var E=this.config.defaultAudioCodec||m.audioCodec;return this.audioCodecSwap&&E&&(this.log("Swapping audio codec"),E.indexOf("mp4a.40.5")!==-1?E="mp4a.40.2":E="mp4a.40.5"),E},L._loadBitrateTestFrag=function(m){var E=this;this._doFragLoad(m).then(function(x){var D=E.hls;if(!(!x||D.nextLoadLevel||E.fragContextChanged(m))){E.fragLoadError=0,E.state=c.State.IDLE,E.startFragRequested=!1,E.bitrateTest=!1;var I=m.stats;I.parsing.start=I.parsing.end=I.buffering.start=I.buffering.end=self.performance.now(),D.trigger(M.Events.FRAG_LOADED,x)}})},L._handleTransmuxComplete=function(m){var E,x="main",D=this.hls,I=m.remuxResult,b=m.chunkMeta,R=this.getCurrentContext(b);if(!R){this.warn("The loading context changed while buffering fragment "+b.sn+" of level "+b.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(b.level);return}var P=R.frag,w=R.part,F=R.level,k=I.video,B=I.text,U=I.id3,j=I.initSegment,K=this.altAudio?void 0:I.audio;if(!this.fragContextChanged(P)){if(this.state=c.State.PARSING,j){j.tracks&&(this._bufferInitSegment(F,j.tracks,P,b),D.trigger(M.Events.FRAG_PARSING_INIT_SEGMENT,{frag:P,id:x,tracks:j.tracks}));var N=j.initPTS,Z=j.timescale;Object(S.isFiniteNumber)(N)&&(this.initPTS[P.cc]=N,D.trigger(M.Events.INIT_PTS_FOUND,{frag:P,id:x,initPTS:N,timescale:Z}))}if(k&&I.independent!==!1){if(F.details){var $=k.startPTS,Y=k.endPTS,ee=k.startDTS,Q=k.endDTS;if(w)w.elementaryStreams[k.type]={startPTS:$,endPTS:Y,startDTS:ee,endDTS:Q};else if(k.firstKeyFrame&&k.independent&&(this.couldBacktrack=!0),k.dropped&&k.independent){var G=this.getLoadPosition()+this.config.maxBufferHole;if(G<$){this.backtrack(P);return}P.setElementaryStreamInfo(k.type,P.start,Y,P.start,Q,!0)}P.setElementaryStreamInfo(k.type,$,Y,ee,Q),this.bufferFragmentData(k,P,w,b)}}else if(I.independent===!1){this.backtrack(P);return}if(K){var q=K.startPTS,te=K.endPTS,ie=K.startDTS,ne=K.endDTS;w&&(w.elementaryStreams[n.ElementaryStreamTypes.AUDIO]={startPTS:q,endPTS:te,startDTS:ie,endDTS:ne}),P.setElementaryStreamInfo(n.ElementaryStreamTypes.AUDIO,q,te,ie,ne),this.bufferFragmentData(K,P,w,b)}if(U!=null&&(E=U.samples)!==null&&E!==void 0&&E.length){var le={frag:P,id:x,samples:U.samples};D.trigger(M.Events.FRAG_PARSING_METADATA,le)}if(B){var ae={frag:P,id:x,samples:B.samples};D.trigger(M.Events.FRAG_PARSING_USERDATA,ae)}}},L._bufferInitSegment=function(m,E,x,D){var I=this;if(this.state===c.State.PARSING){this.audioOnly=!!E.audio&&!E.video,this.altAudio&&!this.audioOnly&&delete E.audio;var b=E.audio,R=E.video,P=E.audiovideo;if(b){var w=m.audioCodec,F=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(w&&(w.indexOf("mp4a.40.5")!==-1?w="mp4a.40.2":w="mp4a.40.5"),b.metadata.channelCount!==1&&F.indexOf("firefox")===-1&&(w="mp4a.40.5")),F.indexOf("android")!==-1&&b.container!=="audio/mpeg"&&(w="mp4a.40.2",this.log("Android: force audio codec to "+w)),m.audioCodec&&m.audioCodec!==w&&this.log('Swapping manifest audio codec "'+m.audioCodec+'" for "'+w+'"'),b.levelCodec=w,b.id="main",this.log("Init audio buffer, container:"+b.container+", codecs[selected/level/parsed]=["+(w||"")+"/"+(m.audioCodec||"")+"/"+b.codec+"]")}R&&(R.levelCodec=m.videoCodec,R.id="main",this.log("Init video buffer, container:"+R.container+", codecs[level/parsed]=["+(m.videoCodec||"")+"/"+R.codec+"]")),P&&this.log("Init audiovideo buffer, container:"+P.container+", codecs[level/parsed]=["+(m.attrs.CODECS||"")+"/"+P.codec+"]"),this.hls.trigger(M.Events.BUFFER_CODECS,E),Object.keys(E).forEach(function(k){var B=E[k],U=B.initSegment;U!=null&&U.byteLength&&I.hls.trigger(M.Events.BUFFER_APPENDING,{type:k,data:U,frag:x,part:null,chunkMeta:D,parent:x.type})}),this.tick()}},L.backtrack=function(m){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(m);var E=this.fragmentTracker.backtrack(m);this.fragPrevious=null,this.nextLoadPosition=m.start,E?this.resetFragmentLoading(m):this.state=c.State.BACKTRACKING},L.checkFragmentChanged=function(){var m=this.media,E=null;if(m&&m.readyState>1&&m.seeking===!1){var x=m.currentTime;if(T.BufferHelper.isBuffered(m,x)?E=this.getAppendedFrag(x):T.BufferHelper.isBuffered(m,x+.1)&&(E=this.getAppendedFrag(x+.1)),E){var D=this.fragPlaying,I=E.level;(!D||E.sn!==D.sn||D.level!==I||E.urlId!==D.urlId)&&(this.hls.trigger(M.Events.FRAG_CHANGED,{frag:E}),(!D||D.level!==I)&&this.hls.trigger(M.Events.LEVEL_SWITCHED,{level:I}),this.fragPlaying=E)}}},t(g,[{key:"nextLevel",get:function(){var m=this.nextBufferedFrag;return m?m.level:-1}},{key:"currentLevel",get:function(){var m=this.media;if(m){var E=this.getAppendedFrag(m.currentTime);if(E)return E.level}return-1}},{key:"nextBufferedFrag",get:function(){var m=this.media;if(m){var E=this.getAppendedFrag(m.currentTime);return this.followingBufferedFrag(E)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),g}(c.default)},"./src/controller/subtitle-stream-controller.ts":function(O,C,_){_.r(C),_.d(C,"SubtitleStreamController",function(){return t});var S=_("./src/events.ts"),c=_("./src/utils/buffer-helper.ts"),y=_("./src/controller/fragment-finders.ts"),M=_("./src/utils/discontinuities.ts"),T=_("./src/controller/level-helper.ts"),p=_("./src/controller/fragment-tracker.ts"),u=_("./src/controller/base-stream-controller.ts"),n=_("./src/types/loader.ts"),f=_("./src/types/level.ts");function l(i,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}function h(i,e,a){return e&&l(i.prototype,e),a&&l(i,a),i}function v(i,e){i.prototype=Object.create(e.prototype),i.prototype.constructor=i,d(i,e)}function d(i,e){return d=Object.setPrototypeOf||function(o,s){return o.__proto__=s,o},d(i,e)}var r=500,t=function(i){v(e,i);function e(o,s){var g;return g=i.call(this,o,s,"[subtitle-stream-controller]")||this,g.levels=[],g.currentTrackId=-1,g.tracksBuffered=[],g.mainDetails=null,g._registerListeners(),g}var a=e.prototype;return a.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},a._registerListeners=function(){var s=this.hls;s.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.on(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.on(S.Events.ERROR,this.onError,this),s.on(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.on(S.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.on(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.on(S.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.on(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},a._unregisterListeners=function(){var s=this.hls;s.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),s.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),s.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),s.off(S.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.off(S.Events.ERROR,this.onError,this),s.off(S.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),s.off(S.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),s.off(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),s.off(S.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),s.off(S.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},a.startLoad=function(){this.stopLoad(),this.state=u.State.IDLE,this.setInterval(r),this.tick()},a.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},a.onLevelLoaded=function(s,g){this.mainDetails=g.details},a.onSubtitleFragProcessed=function(s,g){var L=g.frag,A=g.success;if(this.fragPrevious=L,this.state=u.State.IDLE,!!A){var m=this.tracksBuffered[this.currentTrackId];if(!!m){for(var E,x=L.start,D=0;D<m.length;D++)if(x>=m[D].start&&x<=m[D].end){E=m[D];break}var I=L.start+L.duration;E?E.end=I:(E={start:x,end:I},m.push(E)),this.fragmentTracker.fragBuffered(L)}}},a.onBufferFlushing=function(s,g){var L=g.startOffset,A=g.endOffset;if(L===0&&A!==Number.POSITIVE_INFINITY){var m=this.currentTrackId,E=this.levels;if(!E.length||!E[m]||!E[m].details)return;var x=E[m].details,D=x.targetduration,I=A-D;if(I<=0)return;g.endOffsetSubtitles=Math.max(0,I),this.tracksBuffered.forEach(function(b){for(var R=0;R<b.length;){if(b[R].end<=I){b.shift();continue}else if(b[R].start<I)b[R].start=I;else break;R++}}),this.fragmentTracker.removeFragmentsInRange(L,I,n.PlaylistLevelType.SUBTITLE)}},a.onError=function(s,g){var L,A=g.frag;!A||A.type!==n.PlaylistLevelType.SUBTITLE||((L=this.fragCurrent)!==null&&L!==void 0&&L.loader&&this.fragCurrent.loader.abort(),this.state=u.State.IDLE)},a.onSubtitleTracksUpdated=function(s,g){var L=this,A=g.subtitleTracks;this.tracksBuffered=[],this.levels=A.map(function(m){return new f.Level(m)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(m){L.tracksBuffered[m.id]=[]}),this.mediaBuffer=null},a.onSubtitleTrackSwitch=function(s,g){if(this.currentTrackId=g.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var L=this.levels[this.currentTrackId];L!=null&&L.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,L&&this.setInterval(r)},a.onSubtitleTrackLoaded=function(s,g){var L,A=g.details,m=g.id,E=this.currentTrackId,x=this.levels;if(!!x.length){var D=x[E];if(!(m>=x.length||m!==E||!D)){if(this.mediaBuffer=this.mediaBufferTimeRanges,A.live||(L=D.details)!==null&&L!==void 0&&L.live){var I=this.mainDetails;if(A.deltaUpdateFailed||!I)return;var b=I.fragments[0];if(!D.details)A.hasProgramDateTime&&I.hasProgramDateTime?Object(M.alignMediaPlaylistByPDT)(A,I):b&&Object(T.addSliding)(A,b.start);else{var R=this.alignPlaylists(A,D.details);R===0&&b&&Object(T.addSliding)(A,b.start)}}if(D.details=A,this.levelLastLoaded=m,this.tick(),A.live&&!this.fragCurrent&&this.media&&this.state===u.State.IDLE){var P=Object(y.findFragmentByPTS)(null,A.fragments,this.media.currentTime,0);P||(this.warn("Subtitle playlist not aligned with playback"),D.details=void 0)}}}},a._handleFragmentLoadComplete=function(s){var g=s.frag,L=s.payload,A=g.decryptdata,m=this.hls;if(!this.fragContextChanged(g)&&L&&L.byteLength>0&&A&&A.key&&A.iv&&A.method==="AES-128"){var E=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(L),A.key.buffer,A.iv.buffer).then(function(x){var D=performance.now();m.trigger(S.Events.FRAG_DECRYPTED,{frag:g,payload:x,stats:{tstart:E,tdecrypt:D}})})}},a.doTick=function(){if(!this.media){this.state=u.State.IDLE;return}if(this.state===u.State.IDLE){var s,g=this.currentTrackId,L=this.levels;if(!L.length||!L[g]||!L[g].details)return;var A=L[g].details,m=A.targetduration,E=this.config,x=this.media,D=c.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,x.currentTime-m,E.maxBufferHole),I=D.end,b=D.len,R=this.getMaxBufferLength()+m;if(b>R)return;console.assert(A,"Subtitle track details are defined on idle subtitle stream controller tick");var P=A.fragments,w=P.length,F=A.edge,k,B=this.fragPrevious;if(I<F){var U=E.maxFragLookUpTolerance;k=Object(y.findFragmentByPTS)(B,P,I,U),!k&&B&&B.start<P[0].start&&(k=P[0])}else k=P[w-1];(s=k)!==null&&s!==void 0&&s.encrypted?this.loadKey(k,A):k&&this.fragmentTracker.getState(k)===p.FragmentState.NOT_LOADED&&this.loadFragment(k,A,I)}},a.loadFragment=function(s,g,L){this.fragCurrent=s,i.prototype.loadFragment.call(this,s,g,L)},h(e,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),e}(u.default)},"./src/controller/subtitle-track-controller.ts":function(O,C,_){_.r(C);var S=_("./src/events.ts"),c=_("./src/utils/texttrack-utils.ts"),y=_("./src/controller/base-playlist-controller.ts"),M=_("./src/types/loader.ts");function T(h,v){for(var d=0;d<v.length;d++){var r=v[d];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(h,r.key,r)}}function p(h,v,d){return v&&T(h.prototype,v),d&&T(h,d),h}function u(h,v){h.prototype=Object.create(v.prototype),h.prototype.constructor=h,n(h,v)}function n(h,v){return n=Object.setPrototypeOf||function(r,t){return r.__proto__=t,r},n(h,v)}var f=function(h){u(v,h);function v(r){var t;return t=h.call(this,r,"[subtitle-track-controller]")||this,t.media=null,t.tracks=[],t.groupId=null,t.tracksInGroup=[],t.trackId=-1,t.selectDefaultTrack=!0,t.queuedDefaultTrack=-1,t.trackChangeListener=function(){return t.onTextTracksChanged()},t.asyncPollTrackChange=function(){return t.pollTrackChange(0)},t.useTextTrackPolling=!1,t.subtitlePollingInterval=-1,t.subtitleDisplay=!0,t.registerListeners(),t}var d=v.prototype;return d.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,h.prototype.destroy.call(this)},d.registerListeners=function(){var t=this.hls;t.on(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(S.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.on(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.on(S.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){var t=this.hls;t.off(S.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(S.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(S.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(S.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(S.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(S.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),t.off(S.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),t.off(S.Events.ERROR,this.onError,this)},d.onMediaAttached=function(t,i){this.media=i.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},d.pollTrackChange=function(t){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,t)},d.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var t=l(this.media.textTracks);t.forEach(function(i){Object(c.clearCurrentCues)(i)}),this.subtitleTrack=-1,this.media=null}},d.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},d.onManifestParsed=function(t,i){this.tracks=i.subtitleTracks},d.onSubtitleTrackLoaded=function(t,i){var e=i.id,a=i.details,o=this.trackId,s=this.tracksInGroup[o];if(!s){this.warn("Invalid subtitle track id "+e);return}var g=s.details;s.details=i.details,this.log("subtitle track "+e+" loaded ["+a.startSN+"-"+a.endSN+"]"),e===this.trackId&&(this.retryCount=0,this.playlistLoaded(e,i,g))},d.onLevelLoading=function(t,i){this.switchLevel(i.level)},d.onLevelSwitching=function(t,i){this.switchLevel(i.level)},d.switchLevel=function(t){var i=this.hls.levels[t];if(!!(i!=null&&i.textGroupIds)){var e=i.textGroupIds[i.urlId];if(this.groupId!==e){var a=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,o=this.tracks.filter(function(L){return!e||L.groupId===e});this.tracksInGroup=o;var s=this.findTrackId(a==null?void 0:a.name)||this.findTrackId();this.groupId=e;var g={subtitleTracks:o};this.log("Updating subtitle tracks, "+o.length+' track(s) found in "'+e+'" group-id'),this.hls.trigger(S.Events.SUBTITLE_TRACKS_UPDATED,g),s!==-1&&this.setSubtitleTrack(s,a)}}},d.findTrackId=function(t){for(var i=this.tracksInGroup,e=0;e<i.length;e++){var a=i[e];if((!this.selectDefaultTrack||a.default)&&(!t||t===a.name))return a.id}return-1},d.onError=function(t,i){h.prototype.onError.call(this,t,i),!(i.fatal||!i.context)&&i.context.type===M.PlaylistContextType.SUBTITLE_TRACK&&i.context.id===this.trackId&&i.context.groupId===this.groupId&&this.retryLoadingOrFail(i)},d.loadPlaylist=function(t){var i=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(i)){var e=i.id,a=i.groupId,o=i.url;if(t)try{o=t.addDirectives(o)}catch(s){this.warn("Could not construct new URL with HLS Delivery Directives: "+s)}this.log("Loading subtitle playlist for id "+e),this.hls.trigger(S.Events.SUBTITLE_TRACK_LOADING,{url:o,id:e,groupId:a,deliveryDirectives:t||null})}},d.toggleTrackModes=function(t){var i=this,e=this.media,a=this.subtitleDisplay,o=this.trackId;if(!!e){var s=l(e.textTracks),g=s.filter(function(m){return m.groupId===i.groupId});if(t===-1)[].slice.call(s).forEach(function(m){m.mode="disabled"});else{var L=g[o];L&&(L.mode="disabled")}var A=g[t];A&&(A.mode=a?"showing":"hidden")}},d.setSubtitleTrack=function(t,i){var e,a=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=t;return}if(this.trackId!==t&&this.toggleTrackModes(t),!(this.trackId===t&&(t===-1||(e=a[t])!==null&&e!==void 0&&e.details)||t<-1||t>=a.length)){this.clearTimer();var o=a[t];if(this.log("Switching to subtitle track "+t),this.trackId=t,o){var s=o.id,g=o.groupId,L=g===void 0?"":g,A=o.name,m=o.type,E=o.url;this.hls.trigger(S.Events.SUBTITLE_TRACK_SWITCH,{id:s,groupId:L,name:A,type:m,url:E});var x=this.switchParams(o.url,i==null?void 0:i.details);this.loadPlaylist(x)}else this.hls.trigger(S.Events.SUBTITLE_TRACK_SWITCH,{id:t})}},d.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var t=-1,i=l(this.media.textTracks),e=0;e<i.length;e++)if(i[e].mode==="hidden")t=e;else if(i[e].mode==="showing"){t=e;break}this.subtitleTrack!==t&&(this.subtitleTrack=t)}},p(v,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.selectDefaultTrack=!1;var i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(t,i)}}]),v}(y.default);function l(h){for(var v=[],d=0;d<h.length;d++){var r=h[d];r.kind==="subtitles"&&r.label&&v.push(h[d])}return v}C.default=f},"./src/controller/timeline-controller.ts":function(O,C,_){_.r(C),_.d(C,"TimelineController",function(){return l});var S=_("./src/polyfills/number.ts"),c=_("./src/events.ts"),y=_("./src/utils/cea-608-parser.ts"),M=_("./src/utils/output-filter.ts"),T=_("./src/utils/webvtt-parser.ts"),p=_("./src/utils/texttrack-utils.ts"),u=_("./src/utils/imsc1-ttml-parser.ts"),n=_("./src/types/loader.ts"),f=_("./src/utils/logger.ts"),l=function(){function r(i){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=d(),this.captionsProperties=void 0,this.hls=i,this.config=i.config,this.Cues=i.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var e=new M.default(this,"textTrack1"),a=new M.default(this,"textTrack2"),o=new M.default(this,"textTrack3"),s=new M.default(this,"textTrack4");this.cea608Parser1=new y.default(1,e,a),this.cea608Parser2=new y.default(3,o,s)}i.on(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(c.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(c.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(c.Events.FRAG_LOADING,this.onFragLoading,this),i.on(c.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(c.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.on(c.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.on(c.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.on(c.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.on(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var t=r.prototype;return t.destroy=function(){var e=this.hls;e.off(c.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(c.Events.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),e.off(c.Events.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(c.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(c.Events.FRAG_LOADING,this.onFragLoading,this),e.off(c.Events.FRAG_LOADED,this.onFragLoaded,this),e.off(c.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(c.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(c.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(c.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(c.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},t.addCues=function(e,a,o,s,g){for(var L=!1,A=g.length;A--;){var m=g[A],E=v(m[0],m[1],a,o);if(E>=0&&(m[0]=Math.min(m[0],a),m[1]=Math.max(m[1],o),L=!0,E/(o-a)>.5))return}if(L||g.push([a,o]),this.config.renderTextTracksNatively){var x=this.captionsTracks[e];this.Cues.newCue(x,a,o,s)}else{var D=this.Cues.newCue(null,a,o,s);this.hls.trigger(c.Events.CUES_PARSED,{type:"captions",cues:D,track:e})}},t.onInitPtsFound=function(e,a){var o=this,s=a.frag,g=a.id,L=a.initPTS,A=a.timescale,m=this.unparsedVttFrags;g==="main"&&(this.initPTS[s.cc]=L,this.timescale[s.cc]=A),m.length&&(this.unparsedVttFrags=[],m.forEach(function(E){o.onFragLoaded(c.Events.FRAG_LOADED,E)}))},t.getExistingTrack=function(e){var a=this.media;if(a)for(var o=0;o<a.textTracks.length;o++){var s=a.textTracks[o];if(s[e])return s}return null},t.createCaptionsTrack=function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)},t.createNativeTrack=function(e){if(!this.captionsTracks[e]){var a=this.captionsProperties,o=this.captionsTracks,s=this.media,g=a[e],L=g.label,A=g.languageCode,m=this.getExistingTrack(e);if(m)o[e]=m,Object(p.clearCurrentCues)(o[e]),Object(p.sendAddTrackEvent)(o[e],s);else{var E=this.createTextTrack("captions",L,A);E&&(E[e]=!0,o[e]=E)}}},t.createNonNativeTrack=function(e){if(!this.nonNativeCaptionsTracks[e]){var a=this.captionsProperties[e];if(!!a){var o=a.label,s={_id:e,label:o,kind:"captions",default:a.media?!!a.media.default:!1,closedCaptions:a.media};this.nonNativeCaptionsTracks[e]=s,this.hls.trigger(c.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}}},t.createTextTrack=function(e,a,o){var s=this.media;if(!!s)return s.addTextTrack(e,a,o)},t.onMediaAttaching=function(e,a){this.media=a.media,this._cleanTracks()},t.onMediaDetaching=function(){var e=this.captionsTracks;Object.keys(e).forEach(function(a){Object(p.clearCurrentCues)(e[a]),delete e[a]}),this.nonNativeCaptionsTracks={}},t.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=d(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},t._cleanTracks=function(){var e=this.media;if(!!e){var a=e.textTracks;if(a)for(var o=0;o<a.length;o++)Object(p.clearCurrentCues)(a[o])}},t.onSubtitleTracksUpdated=function(e,a){var o=this;this.textTracks=[];var s=a.subtitleTracks||[],g=s.some(function(E){return E.textCodec===u.IMSC1_CODEC});if(this.config.enableWebVTT||g&&this.config.enableIMSC1){var L=this.tracks&&s&&this.tracks.length===s.length;if(this.tracks=s||[],this.config.renderTextTracksNatively){var A=this.media?this.media.textTracks:[];this.tracks.forEach(function(E,x){var D;if(x<A.length){for(var I=null,b=0;b<A.length;b++)if(h(A[b],E)){I=A[b];break}I&&(D=I)}D?Object(p.clearCurrentCues)(D):(D=o.createTextTrack("subtitles",E.name,E.lang),D&&(D.mode="disabled")),D&&(D.groupId=E.groupId,o.textTracks.push(D))})}else if(!L&&this.tracks&&this.tracks.length){var m=this.tracks.map(function(E){return{label:E.name,kind:E.type.toLowerCase(),default:E.default,subtitleTrack:E}});this.hls.trigger(c.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:m})}}},t.onManifestLoaded=function(e,a){var o=this;this.config.enableCEA708Captions&&a.captions&&a.captions.forEach(function(s){var g=/(?:CC|SERVICE)([1-4])/.exec(s.instreamId);if(!!g){var L="textTrack"+g[1],A=o.captionsProperties[L];!A||(A.label=s.name,s.lang&&(A.languageCode=s.lang),A.media=s)}})},t.onFragLoading=function(e,a){var o=this.cea608Parser1,s=this.cea608Parser2,g=this.lastSn,L=this.lastPartIndex;if(!(!this.enabled||!(o&&s))&&a.frag.type===n.PlaylistLevelType.MAIN){var A,m,E=a.frag.sn,x=(A=a==null||(m=a.part)===null||m===void 0?void 0:m.index)!=null?A:-1;E===g+1||E===g&&x===L+1||(o.reset(),s.reset()),this.lastSn=E,this.lastPartIndex=x}},t.onFragLoaded=function(e,a){var o=a.frag,s=a.payload,g=this.initPTS,L=this.unparsedVttFrags;if(o.type===n.PlaylistLevelType.SUBTITLE)if(s.byteLength){if(!Object(S.isFiniteNumber)(g[o.cc])){L.push(a),g.length&&this.hls.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Missing initial subtitle PTS")});return}var A=o.decryptdata,m="stats"in a;if(A==null||A.key==null||A.method!=="AES-128"||m){var E=this.tracks[o.level],x=this.vttCCs;x[o.cc]||(x[o.cc]={start:o.start,prevCC:this.prevCC,new:!0},this.prevCC=o.cc),E&&E.textCodec===u.IMSC1_CODEC?this._parseIMSC1(o,s):this._parseVTTs(o,s,x)}}else this.hls.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:o,error:new Error("Empty subtitle payload")})},t._parseIMSC1=function(e,a){var o=this,s=this.hls;Object(u.parseIMSC1)(a,this.initPTS[e.cc],this.timescale[e.cc],function(g){o._appendCues(g,e.level),s.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(g){f.logger.log("Failed to parse IMSC1: "+g),s.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:g})})},t._parseVTTs=function(e,a,o){var s=this,g=this.hls;Object(T.parseWebVTT)(a,this.initPTS[e.cc],this.timescale[e.cc],o,e.cc,e.start,function(L){s._appendCues(L,e.level),g.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},function(L){s._fallbackToIMSC1(e,a),f.logger.log("Failed to parse VTT cue: "+L),g.trigger(c.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:L})})},t._fallbackToIMSC1=function(e,a){var o=this,s=this.tracks[e.level];s.textCodec||Object(u.parseIMSC1)(a,this.initPTS[e.cc],this.timescale[e.cc],function(){s.textCodec=u.IMSC1_CODEC,o._parseIMSC1(e,a)},function(){s.textCodec="wvtt"})},t._appendCues=function(e,a){var o=this.hls;if(this.config.renderTextTracksNatively){var s=this.textTracks[a];if(s.mode==="disabled")return;e.forEach(function(A){return Object(p.addCueToTrack)(s,A)})}else{var g=this.tracks[a],L=g.default?"default":"subtitles"+a;o.trigger(c.Events.CUES_PARSED,{type:"subtitles",cues:e,track:L})}},t.onFragDecrypted=function(e,a){var o=a.frag;if(o.type===n.PlaylistLevelType.SUBTITLE){if(!Object(S.isFiniteNumber)(this.initPTS[o.cc])){this.unparsedVttFrags.push(a);return}this.onFragLoaded(c.Events.FRAG_LOADED,a)}},t.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},t.onFragParsingUserdata=function(e,a){var o=this.cea608Parser1,s=this.cea608Parser2;if(!(!this.enabled||!(o&&s)))for(var g=0;g<a.samples.length;g++){var L=a.samples[g].bytes;if(L){var A=this.extractCea608Data(L);o.addData(a.samples[g].pts,A[0]),s.addData(a.samples[g].pts,A[1])}}},t.onBufferFlushing=function(e,a){var o=a.startOffset,s=a.endOffset,g=a.endOffsetSubtitles,L=a.type,A=this.media;if(!(!A||A.currentTime<s)){if(!L||L==="video"){var m=this.captionsTracks;Object.keys(m).forEach(function(x){return Object(p.removeCuesInRange)(m[x],o,s)})}if(this.config.renderTextTracksNatively&&o===0&&g!==void 0){var E=this.textTracks;Object.keys(E).forEach(function(x){return Object(p.removeCuesInRange)(E[x],o,g)})}}},t.extractCea608Data=function(e){for(var a=e[0]&31,o=2,s=[[],[]],g=0;g<a;g++){var L=e[o++],A=127&e[o++],m=127&e[o++],E=(4&L)!==0,x=3&L;A===0&&m===0||E&&(x===0||x===1)&&(s[x].push(A),s[x].push(m))}return s},r}();function h(r,t){return r&&r.label===t.name&&!(r.textTrack1||r.textTrack2)}function v(r,t,i,e){return Math.min(t,e)-Math.max(r,i)}function d(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return S});var S=function(){function c(M,T){this.subtle=void 0,this.aesIV=void 0,this.subtle=M,this.aesIV=T}var y=c.prototype;return y.decrypt=function(T,p){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},p,T)},c}()},"./src/crypt/aes-decryptor.ts":function(O,C,_){_.r(C),_.d(C,"removePadding",function(){return c}),_.d(C,"default",function(){return y});var S=_("./src/utils/typed-array.ts");function c(M){var T=M.byteLength,p=T&&new DataView(M.buffer).getUint8(T-1);return p?Object(S.sliceUint8)(M,0,T-p):M}var y=function(){function M(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var T=M.prototype;return T.uint8ArrayToUint32Array_=function(u){for(var n=new DataView(u),f=new Uint32Array(4),l=0;l<4;l++)f[l]=n.getUint32(l*4);return f},T.initTable=function(){var u=this.sBox,n=this.invSBox,f=this.subMix,l=f[0],h=f[1],v=f[2],d=f[3],r=this.invSubMix,t=r[0],i=r[1],e=r[2],a=r[3],o=new Uint32Array(256),s=0,g=0,L=0;for(L=0;L<256;L++)L<128?o[L]=L<<1:o[L]=L<<1^283;for(L=0;L<256;L++){var A=g^g<<1^g<<2^g<<3^g<<4;A=A>>>8^A&255^99,u[s]=A,n[A]=s;var m=o[s],E=o[m],x=o[E],D=o[A]*257^A*16843008;l[s]=D<<24|D>>>8,h[s]=D<<16|D>>>16,v[s]=D<<8|D>>>24,d[s]=D,D=x*16843009^E*65537^m*257^s*16843008,t[A]=D<<24|D>>>8,i[A]=D<<16|D>>>16,e[A]=D<<8|D>>>24,a[A]=D,s?(s=m^o[o[o[x^m]]],g^=o[o[g]]):s=g=1}},T.expandKey=function(u){for(var n=this.uint8ArrayToUint32Array_(u),f=!0,l=0;l<n.length&&f;)f=n[l]===this.key[l],l++;if(!f){this.key=n;var h=this.keySize=n.length;if(h!==4&&h!==6&&h!==8)throw new Error("Invalid aes key size="+h);var v=this.ksRows=(h+6+1)*4,d,r,t=this.keySchedule=new Uint32Array(v),i=this.invKeySchedule=new Uint32Array(v),e=this.sBox,a=this.rcon,o=this.invSubMix,s=o[0],g=o[1],L=o[2],A=o[3],m,E;for(d=0;d<v;d++){if(d<h){m=t[d]=n[d];continue}E=m,d%h===0?(E=E<<8|E>>>24,E=e[E>>>24]<<24|e[E>>>16&255]<<16|e[E>>>8&255]<<8|e[E&255],E^=a[d/h|0]<<24):h>6&&d%h===4&&(E=e[E>>>24]<<24|e[E>>>16&255]<<16|e[E>>>8&255]<<8|e[E&255]),t[d]=m=(t[d-h]^E)>>>0}for(r=0;r<v;r++)d=v-r,r&3?E=t[d]:E=t[d-4],r<4||d<=4?i[r]=E:i[r]=s[e[E>>>24]]^g[e[E>>>16&255]]^L[e[E>>>8&255]]^A[e[E&255]],i[r]=i[r]>>>0}},T.networkToHostOrderSwap=function(u){return u<<24|(u&65280)<<8|(u&16711680)>>8|u>>>24},T.decrypt=function(u,n,f){for(var l=this.keySize+6,h=this.invKeySchedule,v=this.invSBox,d=this.invSubMix,r=d[0],t=d[1],i=d[2],e=d[3],a=this.uint8ArrayToUint32Array_(f),o=a[0],s=a[1],g=a[2],L=a[3],A=new Int32Array(u),m=new Int32Array(A.length),E,x,D,I,b,R,P,w,F,k,B,U,j,K,N=this.networkToHostOrderSwap;n<A.length;){for(F=N(A[n]),k=N(A[n+1]),B=N(A[n+2]),U=N(A[n+3]),b=F^h[0],R=U^h[1],P=B^h[2],w=k^h[3],j=4,K=1;K<l;K++)E=r[b>>>24]^t[R>>16&255]^i[P>>8&255]^e[w&255]^h[j],x=r[R>>>24]^t[P>>16&255]^i[w>>8&255]^e[b&255]^h[j+1],D=r[P>>>24]^t[w>>16&255]^i[b>>8&255]^e[R&255]^h[j+2],I=r[w>>>24]^t[b>>16&255]^i[R>>8&255]^e[P&255]^h[j+3],b=E,R=x,P=D,w=I,j=j+4;E=v[b>>>24]<<24^v[R>>16&255]<<16^v[P>>8&255]<<8^v[w&255]^h[j],x=v[R>>>24]<<24^v[P>>16&255]<<16^v[w>>8&255]<<8^v[b&255]^h[j+1],D=v[P>>>24]<<24^v[w>>16&255]<<16^v[b>>8&255]<<8^v[R&255]^h[j+2],I=v[w>>>24]<<24^v[b>>16&255]<<16^v[R>>8&255]<<8^v[P&255]^h[j+3],m[n]=N(E^o),m[n+1]=N(I^s),m[n+2]=N(D^g),m[n+3]=N(x^L),o=F,s=k,g=B,L=U,n=n+4}return m.buffer},M}()},"./src/crypt/decrypter.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return n});var S=_("./src/crypt/aes-crypto.ts"),c=_("./src/crypt/fast-aes-key.ts"),y=_("./src/crypt/aes-decryptor.ts"),M=_("./src/utils/logger.ts"),T=_("./src/utils/mp4-tools.ts"),p=_("./src/utils/typed-array.ts"),u=16,n=function(){function f(h,v,d){var r=d===void 0?{}:d,t=r.removePKCS7Padding,i=t===void 0?!0:t;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=h,this.config=v,this.removePKCS7Padding=i,i)try{var e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(a){}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var l=f.prototype;return l.destroy=function(){this.observer=null},l.isSync=function(){return this.config.enableSoftwareAES},l.flush=function(){var v=this.currentResult;if(!v){this.reset();return}var d=new Uint8Array(v);return this.reset(),this.removePKCS7Padding?Object(y.removePadding)(d):d},l.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},l.decrypt=function(v,d,r,t){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(v),d,r);var i=this.flush();i&&t(i.buffer)}else this.webCryptoDecrypt(new Uint8Array(v),d,r).then(t)},l.softwareDecrypt=function(v,d,r){var t=this.currentIV,i=this.currentResult,e=this.remainderData;this.logOnce("JS AES decrypt"),e&&(v=Object(T.appendUint8Array)(e,v),this.remainderData=null);var a=this.getValidChunk(v);if(!a.length)return null;t&&(r=t);var o=this.softwareDecrypter;o||(o=this.softwareDecrypter=new y.default),o.expandKey(d);var s=i;return this.currentResult=o.decrypt(a.buffer,0,r),this.currentIV=Object(p.sliceUint8)(a,-16).buffer,s||null},l.webCryptoDecrypt=function(v,d,r){var t=this,i=this.subtle;return(this.key!==d||!this.fastAesKey)&&(this.key=d,this.fastAesKey=new c.default(i,d)),this.fastAesKey.expandKey().then(function(e){if(!i)return Promise.reject(new Error("web crypto not initialized"));var a=new S.default(i,r);return a.decrypt(v.buffer,e)}).catch(function(e){return t.onWebCryptoError(e,v,d,r)})},l.onWebCryptoError=function(v,d,r,t){return M.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",v),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(d,r,t)},l.getValidChunk=function(v){var d=v,r=v.length-v.length%u;return r!==v.length&&(d=Object(p.sliceUint8)(v,0,r),this.remainderData=Object(p.sliceUint8)(v,r)),d},l.logOnce=function(v){!this.logEnabled||(M.logger.log("[decrypter.ts]: "+v),this.logEnabled=!1)},f}()},"./src/crypt/fast-aes-key.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return S});var S=function(){function c(M,T){this.subtle=void 0,this.key=void 0,this.subtle=M,this.key=T}var y=c.prototype;return y.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},c}()},"./src/demux/aacdemuxer.ts":function(O,C,_){_.r(C);var S=_("./src/demux/base-audio-demuxer.ts"),c=_("./src/demux/adts.ts"),y=_("./src/utils/logger.ts"),M=_("./src/demux/id3.ts");function T(n,f){n.prototype=Object.create(f.prototype),n.prototype.constructor=n,p(n,f)}function p(n,f){return p=Object.setPrototypeOf||function(h,v){return h.__proto__=v,h},p(n,f)}var u=function(n){T(f,n);function f(h,v){var d;return d=n.call(this)||this,d.observer=void 0,d.config=void 0,d.observer=h,d.config=v,d}var l=f.prototype;return l.resetInitSegment=function(v,d,r){n.prototype.resetInitSegment.call(this,v,d,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:v,duration:r,inputTimeScale:9e4,dropped:0}},f.probe=function(v){if(!v)return!1;for(var d=M.getID3Data(v,0)||[],r=d.length,t=v.length;r<t;r++)if(c.probe(v,r))return y.logger.log("ADTS sync word found !"),!0;return!1},l.canParse=function(v,d){return c.canParse(v,d)},l.appendFrame=function(v,d,r){c.initTrackConfig(v,this.observer,d,r,v.manifestCodec);var t=c.appendFrame(v,d,r,this.initPTS,this.frameIndex);if(t&&t.missing===0)return t},f}(S.default);u.minProbeByteLength=9,C.default=u},"./src/demux/adts.ts":function(O,C,_){_.r(C),_.d(C,"getAudioConfig",function(){return M}),_.d(C,"isHeaderPattern",function(){return T}),_.d(C,"getHeaderLength",function(){return p}),_.d(C,"getFullFrameLength",function(){return u}),_.d(C,"canGetFrameLength",function(){return n}),_.d(C,"isHeader",function(){return f}),_.d(C,"canParse",function(){return l}),_.d(C,"probe",function(){return h}),_.d(C,"initTrackConfig",function(){return v}),_.d(C,"getFrameDuration",function(){return d}),_.d(C,"parseFrameHeader",function(){return r}),_.d(C,"appendFrame",function(){return t});var S=_("./src/utils/logger.ts"),c=_("./src/errors.ts"),y=_("./src/events.ts");function M(i,e,a,o){var s,g,L,A,m=navigator.userAgent.toLowerCase(),E=o,x=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];s=((e[a+2]&192)>>>6)+1;var D=(e[a+2]&60)>>>2;if(D>x.length-1){i.trigger(y.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+D});return}return L=(e[a+2]&1)<<2,L|=(e[a+3]&192)>>>6,S.logger.log("manifest codec:"+o+", ADTS type:"+s+", samplingIndex:"+D),/firefox/i.test(m)?D>=6?(s=5,A=new Array(4),g=D-3):(s=2,A=new Array(2),g=D):m.indexOf("android")!==-1?(s=2,A=new Array(2),g=D):(s=5,A=new Array(4),o&&(o.indexOf("mp4a.40.29")!==-1||o.indexOf("mp4a.40.5")!==-1)||!o&&D>=6?g=D-3:((o&&o.indexOf("mp4a.40.2")!==-1&&(D>=6&&L===1||/vivaldi/i.test(m))||!o&&L===1)&&(s=2,A=new Array(2)),g=D)),A[0]=s<<3,A[0]|=(D&14)>>1,A[1]|=(D&1)<<7,A[1]|=L<<3,s===5&&(A[1]|=(g&14)>>1,A[2]=(g&1)<<7,A[2]|=2<<2,A[3]=0),{config:A,samplerate:x[D],channelCount:L,codec:"mp4a.40."+s,manifestCodec:E}}function T(i,e){return i[e]===255&&(i[e+1]&246)===240}function p(i,e){return i[e+1]&1?7:9}function u(i,e){return(i[e+3]&3)<<11|i[e+4]<<3|(i[e+5]&224)>>>5}function n(i,e){return e+5<i.length}function f(i,e){return e+1<i.length&&T(i,e)}function l(i,e){return n(i,e)&&T(i,e)&&u(i,e)<=i.length-e}function h(i,e){if(f(i,e)){var a=p(i,e);if(e+a>=i.length)return!1;var o=u(i,e);if(o<=a)return!1;var s=e+o;return s===i.length||f(i,s)}return!1}function v(i,e,a,o,s){if(!i.samplerate){var g=M(e,a,o,s);if(!g)return;i.config=g.config,i.samplerate=g.samplerate,i.channelCount=g.channelCount,i.codec=g.codec,i.manifestCodec=g.manifestCodec,S.logger.log("parsed codec:"+i.codec+", rate:"+g.samplerate+", channels:"+g.channelCount)}}function d(i){return 1024*9e4/i}function r(i,e,a,o,s){var g=p(i,e),L=u(i,e);if(L-=g,L>0){var A=a+o*s;return{headerLength:g,frameLength:L,stamp:A}}}function t(i,e,a,o,s){var g=d(i.samplerate),L=r(e,a,o,s,g);if(L){var A=L.frameLength,m=L.headerLength,E=L.stamp,x=m+A,D=Math.max(0,a+x-e.length),I;D?(I=new Uint8Array(x-m),I.set(e.subarray(a+m,e.length),0)):I=e.subarray(a+m,a+x);var b={unit:I,pts:E};return D||i.samples.push(b),{sample:b,length:x,missing:D}}}},"./src/demux/base-audio-demuxer.ts":function(O,C,_){_.r(C),_.d(C,"initPTSFn",function(){return u});var S=_("./src/polyfills/number.ts"),c=_("./src/demux/id3.ts"),y=_("./src/demux/dummy-demuxed-track.ts"),M=_("./src/utils/mp4-tools.ts"),T=_("./src/utils/typed-array.ts"),p=function(){function n(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var f=n.prototype;return f.resetInitSegment=function(h,v,d){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},f.resetTimeStamp=function(){},f.resetContiguity=function(){},f.canParse=function(h,v){return!1},f.appendFrame=function(h,v,d){},f.demux=function(h,v){this.cachedData&&(h=Object(M.appendUint8Array)(this.cachedData,h),this.cachedData=null);var d=c.getID3Data(h,0),r=d?d.length:0,t,i,e=this._audioTrack,a=this._id3Track,o=d?c.getTimeStamp(d):void 0,s=h.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=u(o,v)),d&&d.length>0&&a.samples.push({pts:this.initPTS,dts:this.initPTS,data:d}),i=this.initPTS;r<s;){if(this.canParse(h,r)){var g=this.appendFrame(e,h,r);g?(this.frameIndex++,i=g.sample.pts,r+=g.length,t=r):r=s}else c.canParse(h,r)?(d=c.getID3Data(h,r),a.samples.push({pts:i,dts:i,data:d}),r+=d.length,t=r):r++;if(r===s&&t!==s){var L=Object(T.sliceUint8)(h,t);this.cachedData?this.cachedData=Object(M.appendUint8Array)(this.cachedData,L):this.cachedData=L}}return{audioTrack:e,avcTrack:Object(y.dummyTrack)(),id3Track:a,textTrack:Object(y.dummyTrack)()}},f.demuxSampleAes=function(h,v,d){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},f.flush=function(h){var v=this.cachedData;return v&&(this.cachedData=null,this.demux(v,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(y.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(y.dummyTrack)()}},f.destroy=function(){},n}(),u=function(f,l){return Object(S.isFiniteNumber)(f)?f*90:l*9e4};C.default=p},"./src/demux/chunk-cache.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return S});var S=function(){function y(){this.chunks=[],this.dataLength=0}var M=y.prototype;return M.push=function(p){this.chunks.push(p),this.dataLength+=p.length},M.flush=function(){var p=this.chunks,u=this.dataLength,n;if(p.length)p.length===1?n=p[0]:n=c(p,u);else return new Uint8Array(0);return this.reset(),n},M.reset=function(){this.chunks.length=0,this.dataLength=0},y}();function c(y,M){for(var T=new Uint8Array(M),p=0,u=0;u<y.length;u++){var n=y[u];T.set(n,p),p+=n.length}return T}},"./src/demux/dummy-demuxed-track.ts":function(O,C,_){_.r(C),_.d(C,"dummyTrack",function(){return S});function S(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(O,C,_){_.r(C);var S=_("./src/utils/logger.ts"),c=function(){function y(T){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=T,this.bytesAvailable=T.byteLength,this.word=0,this.bitsAvailable=0}var M=y.prototype;return M.loadWord=function(){var p=this.data,u=this.bytesAvailable,n=p.byteLength-u,f=new Uint8Array(4),l=Math.min(4,u);if(l===0)throw new Error("no bytes available");f.set(p.subarray(n,n+l)),this.word=new DataView(f.buffer).getUint32(0),this.bitsAvailable=l*8,this.bytesAvailable-=l},M.skipBits=function(p){var u;this.bitsAvailable>p?(this.word<<=p,this.bitsAvailable-=p):(p-=this.bitsAvailable,u=p>>3,p-=u>>3,this.bytesAvailable-=u,this.loadWord(),this.word<<=p,this.bitsAvailable-=p)},M.readBits=function(p){var u=Math.min(this.bitsAvailable,p),n=this.word>>>32-u;return p>32&&S.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=u,this.bitsAvailable>0?this.word<<=u:this.bytesAvailable>0&&this.loadWord(),u=p-u,u>0&&this.bitsAvailable?n<<u|this.readBits(u):n},M.skipLZ=function(){var p;for(p=0;p<this.bitsAvailable;++p)if((this.word&2147483648>>>p)!==0)return this.word<<=p,this.bitsAvailable-=p,p;return this.loadWord(),p+this.skipLZ()},M.skipUEG=function(){this.skipBits(1+this.skipLZ())},M.skipEG=function(){this.skipBits(1+this.skipLZ())},M.readUEG=function(){var p=this.skipLZ();return this.readBits(p+1)-1},M.readEG=function(){var p=this.readUEG();return 1&p?1+p>>>1:-1*(p>>>1)},M.readBoolean=function(){return this.readBits(1)===1},M.readUByte=function(){return this.readBits(8)},M.readUShort=function(){return this.readBits(16)},M.readUInt=function(){return this.readBits(32)},M.skipScalingList=function(p){for(var u=8,n=8,f,l=0;l<p;l++)n!==0&&(f=this.readEG(),n=(u+f+256)%256),u=n===0?u:n},M.readSPS=function(){var p=0,u=0,n=0,f=0,l,h,v,d=this.readUByte.bind(this),r=this.readBits.bind(this),t=this.readUEG.bind(this),i=this.readBoolean.bind(this),e=this.skipBits.bind(this),a=this.skipEG.bind(this),o=this.skipUEG.bind(this),s=this.skipScalingList.bind(this);d();var g=d();if(r(5),e(3),d(),o(),g===100||g===110||g===122||g===244||g===44||g===83||g===86||g===118||g===128){var L=t();if(L===3&&e(1),o(),o(),e(1),i())for(h=L!==3?8:12,v=0;v<h;v++)i()&&(v<6?s(16):s(64))}o();var A=t();if(A===0)t();else if(A===1)for(e(1),a(),a(),l=t(),v=0;v<l;v++)a();o(),e(1);var m=t(),E=t(),x=r(1);x===0&&e(1),e(1),i()&&(p=t(),u=t(),n=t(),f=t());var D=[1,1];if(i()&&i()){var I=d();switch(I){case 1:D=[1,1];break;case 2:D=[12,11];break;case 3:D=[10,11];break;case 4:D=[16,11];break;case 5:D=[40,33];break;case 6:D=[24,11];break;case 7:D=[20,11];break;case 8:D=[32,11];break;case 9:D=[80,33];break;case 10:D=[18,11];break;case 11:D=[15,11];break;case 12:D=[64,33];break;case 13:D=[160,99];break;case 14:D=[4,3];break;case 15:D=[3,2];break;case 16:D=[2,1];break;case 255:{D=[d()<<8|d(),d()<<8|d()];break}}}return{width:Math.ceil((m+1)*16-p*2-u*2),height:(2-x)*(E+1)*16-(x?2:4)*(n+f),pixelRatio:D}},M.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},y}();C.default=c},"./src/demux/id3.ts":function(O,C,_){_.r(C),_.d(C,"isHeader",function(){return S}),_.d(C,"isFooter",function(){return c}),_.d(C,"getID3Data",function(){return y}),_.d(C,"canParse",function(){return T}),_.d(C,"getTimeStamp",function(){return p}),_.d(C,"isTimeStampFrame",function(){return u}),_.d(C,"getID3Frames",function(){return f}),_.d(C,"decodeFrame",function(){return l}),_.d(C,"utf8ArrayToStr",function(){return t}),_.d(C,"testables",function(){return i});var S=function(s,g){return g+10<=s.length&&s[g]===73&&s[g+1]===68&&s[g+2]===51&&s[g+3]<255&&s[g+4]<255&&s[g+6]<128&&s[g+7]<128&&s[g+8]<128&&s[g+9]<128},c=function(s,g){return g+10<=s.length&&s[g]===51&&s[g+1]===68&&s[g+2]===73&&s[g+3]<255&&s[g+4]<255&&s[g+6]<128&&s[g+7]<128&&s[g+8]<128&&s[g+9]<128},y=function(s,g){for(var L=g,A=0;S(s,g);){A+=10;var m=M(s,g+6);A+=m,c(s,g+10)&&(A+=10),g+=A}if(A>0)return s.subarray(L,L+A)},M=function(s,g){var L=0;return L=(s[g]&127)<<21,L|=(s[g+1]&127)<<14,L|=(s[g+2]&127)<<7,L|=s[g+3]&127,L},T=function(s,g){return S(s,g)&&M(s,g+6)+10<=s.length-g},p=function(s){for(var g=f(s),L=0;L<g.length;L++){var A=g[L];if(u(A))return r(A)}},u=function(s){return s&&s.key==="PRIV"&&s.info==="com.apple.streaming.transportStreamTimestamp"},n=function(s){var g=String.fromCharCode(s[0],s[1],s[2],s[3]),L=M(s,4),A=10;return{type:g,size:L,data:s.subarray(A,A+L)}},f=function(s){for(var g=0,L=[];S(s,g);){var A=M(s,g+6);g+=10;for(var m=g+A;g+8<m;){var E=n(s.subarray(g)),x=l(E);x&&L.push(x),g+=E.size+10}c(s,g)&&(g+=10)}return L},l=function(s){return s.type==="PRIV"?h(s):s.type[0]==="W"?d(s):v(s)},h=function(s){if(!(s.size<2)){var g=t(s.data,!0),L=new Uint8Array(s.data.subarray(g.length+1));return{key:s.type,info:g,data:L.buffer}}},v=function(s){if(!(s.size<2)){if(s.type==="TXXX"){var g=1,L=t(s.data.subarray(g),!0);g+=L.length+1;var A=t(s.data.subarray(g));return{key:s.type,info:L,data:A}}var m=t(s.data.subarray(1));return{key:s.type,data:m}}},d=function(s){if(s.type==="WXXX"){if(s.size<2)return;var g=1,L=t(s.data.subarray(g),!0);g+=L.length+1;var A=t(s.data.subarray(g));return{key:s.type,info:L,data:A}}var m=t(s.data);return{key:s.type,data:m}},r=function(s){if(s.data.byteLength===8){var g=new Uint8Array(s.data),L=g[3]&1,A=(g[4]<<23)+(g[5]<<15)+(g[6]<<7)+g[7];return A/=45,L&&(A+=4772185884e-2),Math.round(A)}},t=function(s,g){g===void 0&&(g=!1);var L=a();if(L){var A=L.decode(s);if(g){var m=A.indexOf("\0");return m!==-1?A.substring(0,m):A}return A.replace(/\0/g,"")}for(var E=s.length,x,D,I,b="",R=0;R<E;){if(x=s[R++],x===0&&g)return b;if(x===0||x===3)continue;switch(x>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:b+=String.fromCharCode(x);break;case 12:case 13:D=s[R++],b+=String.fromCharCode((x&31)<<6|D&63);break;case 14:D=s[R++],I=s[R++],b+=String.fromCharCode((x&15)<<12|(D&63)<<6|(I&63)<<0);break}}return b},i={decodeTextFrame:v},e;function a(){return!e&&typeof self.TextDecoder!="undefined"&&(e=new self.TextDecoder("utf-8")),e}},"./src/demux/mp3demuxer.ts":function(O,C,_){_.r(C);var S=_("./src/demux/base-audio-demuxer.ts"),c=_("./src/demux/id3.ts"),y=_("./src/utils/logger.ts"),M=_("./src/demux/mpegaudio.ts");function T(n,f){n.prototype=Object.create(f.prototype),n.prototype.constructor=n,p(n,f)}function p(n,f){return p=Object.setPrototypeOf||function(h,v){return h.__proto__=v,h},p(n,f)}var u=function(n){T(f,n);function f(){return n.apply(this,arguments)||this}var l=f.prototype;return l.resetInitSegment=function(v,d,r){n.prototype.resetInitSegment.call(this,v,d,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:v,duration:r,inputTimeScale:9e4,dropped:0}},f.probe=function(v){if(!v)return!1;for(var d=c.getID3Data(v,0)||[],r=d.length,t=v.length;r<t;r++)if(M.probe(v,r))return y.logger.log("MPEG Audio sync word found !"),!0;return!1},l.canParse=function(v,d){return M.canParse(v,d)},l.appendFrame=function(v,d,r){if(this.initPTS!==null)return M.appendFrame(v,d,r,this.initPTS,this.frameIndex)},f}(S.default);u.minProbeByteLength=4,C.default=u},"./src/demux/mp4demuxer.ts":function(O,C,_){_.r(C);var S=_("./src/utils/mp4-tools.ts"),c=_("./src/demux/dummy-demuxed-track.ts"),y=function(){function M(p,u){this.remainderData=null,this.config=void 0,this.config=u}var T=M.prototype;return T.resetTimeStamp=function(){},T.resetInitSegment=function(){},T.resetContiguity=function(){},M.probe=function(u){return Object(S.findBox)({data:u,start:0,end:Math.min(u.length,16384)},["moof"]).length>0},T.demux=function(u){var n=u,f=Object(c.dummyTrack)();if(this.config.progressive){this.remainderData&&(n=Object(S.appendUint8Array)(this.remainderData,u));var l=Object(S.segmentValidRange)(n);this.remainderData=l.remainder,f.samples=l.valid||new Uint8Array}else f.samples=n;return{audioTrack:Object(c.dummyTrack)(),avcTrack:f,id3Track:Object(c.dummyTrack)(),textTrack:Object(c.dummyTrack)()}},T.flush=function(){var u=Object(c.dummyTrack)();return u.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(c.dummyTrack)(),avcTrack:u,id3Track:Object(c.dummyTrack)(),textTrack:Object(c.dummyTrack)()}},T.demuxSampleAes=function(u,n,f){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},T.destroy=function(){},M}();y.minProbeByteLength=1024,C.default=y},"./src/demux/mpegaudio.ts":function(O,C,_){_.r(C),_.d(C,"appendFrame",function(){return p}),_.d(C,"parseHeader",function(){return u}),_.d(C,"isHeaderPattern",function(){return n}),_.d(C,"isHeader",function(){return f}),_.d(C,"canParse",function(){return l}),_.d(C,"probe",function(){return h});var S=null,c=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],y=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],M=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],T=[0,1,1,4];function p(v,d,r,t,i){if(!(r+24>d.length)){var e=u(d,r);if(e&&r+e.frameLength<=d.length){var a=e.samplesPerFrame*9e4/e.sampleRate,o=t+i*a,s={unit:d.subarray(r,r+e.frameLength),pts:o,dts:o};return v.config=[],v.channelCount=e.channelCount,v.samplerate=e.sampleRate,v.samples.push(s),{sample:s,length:e.frameLength,missing:0}}}}function u(v,d){var r=v[d+1]>>3&3,t=v[d+1]>>1&3,i=v[d+2]>>4&15,e=v[d+2]>>2&3;if(r!==1&&i!==0&&i!==15&&e!==3){var a=v[d+2]>>1&1,o=v[d+3]>>6,s=r===3?3-t:t===3?3:4,g=c[s*14+i-1]*1e3,L=r===3?0:r===2?1:2,A=y[L*3+e],m=o===3?1:2,E=M[r][t],x=T[t],D=E*8*x,I=Math.floor(E*g/A+a)*x;if(S===null){var b=navigator.userAgent||"",R=b.match(/Chrome\/(\d+)/i);S=R?parseInt(R[1]):0}var P=!!S&&S<=87;return P&&t===2&&g>=224e3&&o===0&&(v[d+3]=v[d+3]|128),{sampleRate:A,channelCount:m,frameLength:I,samplesPerFrame:D}}}function n(v,d){return v[d]===255&&(v[d+1]&224)===224&&(v[d+1]&6)!==0}function f(v,d){return d+1<v.length&&n(v,d)}function l(v,d){var r=4;return n(v,d)&&r<=v.length-d}function h(v,d){if(d+1<v.length&&n(v,d)){var r=4,t=u(v,d),i=r;t!=null&&t.frameLength&&(i=t.frameLength);var e=d+i;return e===v.length||f(v,e)}return!1}},"./src/demux/sample-aes.ts":function(O,C,_){_.r(C);var S=_("./src/crypt/decrypter.ts"),c=_("./src/demux/tsdemuxer.ts"),y=function(){function M(p,u,n){this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new S.default(p,u,{removePKCS7Padding:!1})}var T=M.prototype;return T.decryptBuffer=function(u,n){this.decrypter.decrypt(u,this.keyData.key.buffer,this.keyData.iv.buffer,n)},T.decryptAacSample=function(u,n,f,l){var h=u[n].unit,v=h.subarray(16,h.length-h.length%16),d=v.buffer.slice(v.byteOffset,v.byteOffset+v.length),r=this;this.decryptBuffer(d,function(t){var i=new Uint8Array(t);h.set(i,16),l||r.decryptAacSamples(u,n+1,f)})},T.decryptAacSamples=function(u,n,f){for(;;n++){if(n>=u.length){f();return}if(!(u[n].unit.length<32)){var l=this.decrypter.isSync();if(this.decryptAacSample(u,n,f,l),!l)return}}},T.getAvcEncryptedData=function(u){for(var n=Math.floor((u.length-48)/160)*16+16,f=new Int8Array(n),l=0,h=32;h<u.length-16;h+=160,l+=16)f.set(u.subarray(h,h+16),l);return f},T.getAvcDecryptedUnit=function(u,n){for(var f=new Uint8Array(n),l=0,h=32;h<u.length-16;h+=160,l+=16)u.set(f.subarray(l,l+16),h);return u},T.decryptAvcSample=function(u,n,f,l,h,v){var d=Object(c.discardEPB)(h.data),r=this.getAvcEncryptedData(d),t=this;this.decryptBuffer(r.buffer,function(i){h.data=t.getAvcDecryptedUnit(d,i),v||t.decryptAvcSamples(u,n,f+1,l)})},T.decryptAvcSamples=function(u,n,f,l){if(u instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;n++,f=0){if(n>=u.length){l();return}for(var h=u[n].units;!(f>=h.length);f++){var v=h[f];if(!(v.data.length<=48||v.type!==1&&v.type!==5)){var d=this.decrypter.isSync();if(this.decryptAvcSample(u,n,f,l,v,d),!d)return}}}},M}();C.default=y},"./src/demux/transmuxer-interface.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return f});var S=_("./node_modules/webworkify-webpack/index.js"),c=_("./src/events.ts"),y=_("./src/demux/transmuxer.ts"),M=_("./src/utils/logger.ts"),T=_("./src/errors.ts"),p=_("./src/utils/mediasource-helper.ts"),u=_("./node_modules/eventemitter3/index.js"),n=Object(p.getMediaSource)()||{isTypeSupported:function(){return!1}},f=function(){function l(v,d,r,t){var i=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=v,this.id=d,this.onTransmuxComplete=r,this.onFlush=t;var e=v.config,a=function(A,m){m=m||{},m.frag=i.frag,m.id=i.id,v.trigger(A,m)};this.observer=new u.EventEmitter,this.observer.on(c.Events.FRAG_DECRYPTED,a),this.observer.on(c.Events.ERROR,a);var o={mp4:n.isTypeSupported("video/mp4"),mpeg:n.isTypeSupported("audio/mpeg"),mp3:n.isTypeSupported('audio/mp4; codecs="mp3"')},s=navigator.vendor;if(e.enableWorker&&typeof Worker!="undefined"){M.logger.log("demuxing in webworker");var g;try{g=this.worker=S("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),g.addEventListener("message",this.onwmsg),g.onerror=function(L){v.trigger(c.Events.ERROR,{type:T.ErrorTypes.OTHER_ERROR,details:T.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(L.message+"  ("+L.filename+":"+L.lineno+")")})},g.postMessage({cmd:"init",typeSupported:o,vendor:s,id:d,config:JSON.stringify(e)})}catch(L){M.logger.warn("Error in worker:",L),M.logger.error("Error while initializing DemuxerWorker, fallback to inline"),g&&self.URL.revokeObjectURL(g.objectURL),this.transmuxer=new y.default(this.observer,o,e,s,d),this.worker=null}}else this.transmuxer=new y.default(this.observer,o,e,s,d)}var h=l.prototype;return h.destroy=function(){var d=this.worker;if(d)d.removeEventListener("message",this.onwmsg),d.terminate(),this.worker=null;else{var r=this.transmuxer;r&&(r.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.observer=null},h.push=function(d,r,t,i,e,a,o,s,g,L){var A,m,E=this;g.transmuxing.start=self.performance.now();var x=this.transmuxer,D=this.worker,I=a?a.start:e.start,b=e.decryptdata,R=this.frag,P=!(R&&e.cc===R.cc),w=!(R&&g.level===R.level),F=R?g.sn-R.sn:-1,k=this.part?g.part-this.part.index:1,B=!w&&(F===1||F===0&&k===1),U=self.performance.now();(w||F||e.stats.parsing.start===0)&&(e.stats.parsing.start=U),a&&(k||!B)&&(a.stats.parsing.start=U);var j=!(R&&((A=e.initSegment)===null||A===void 0?void 0:A.url)===((m=R.initSegment)===null||m===void 0?void 0:m.url)),K=new y.TransmuxState(P,B,s,w,I,j);if(!B||P||j){M.logger.log("[transmuxer-interface, "+e.type+"]: Starting new transmux session for sn: "+g.sn+" p: "+g.part+" level: "+g.level+" id: "+g.id+`
        discontinuity: `+P+`
        trackSwitch: `+w+`
        contiguous: `+B+`
        accurateTimeOffset: `+s+`
        timeOffset: `+I+`
        initSegmentChange: `+j);var N=new y.TransmuxConfig(t,i,r,o,L);this.configureTransmuxer(N)}if(this.frag=e,this.part=a,D)D.postMessage({cmd:"demux",data:d,decryptdata:b,chunkMeta:g,state:K},d instanceof ArrayBuffer?[d]:[]);else if(x){var Z=x.push(d,b,g,K);Object(y.isPromise)(Z)?Z.then(function($){E.handleTransmuxComplete($)}):this.handleTransmuxComplete(Z)}},h.flush=function(d){var r=this;d.transmuxing.start=self.performance.now();var t=this.transmuxer,i=this.worker;if(i)i.postMessage({cmd:"flush",chunkMeta:d});else if(t){var e=t.flush(d);Object(y.isPromise)(e)?e.then(function(a){r.handleFlushResult(a,d)}):this.handleFlushResult(e,d)}},h.handleFlushResult=function(d,r){var t=this;d.forEach(function(i){t.handleTransmuxComplete(i)}),this.onFlush(r)},h.onWorkerMessage=function(d){var r=d.data,t=this.hls;switch(r.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(r.data);break}case"flush":{this.onFlush(r.data);break}default:{r.data=r.data||{},r.data.frag=this.frag,r.data.id=this.id,t.trigger(r.event,r.data);break}}},h.configureTransmuxer=function(d){var r=this.worker,t=this.transmuxer;r?r.postMessage({cmd:"configure",config:d}):t&&t.configure(d)},h.handleTransmuxComplete=function(d){d.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(d)},l}()},"./src/demux/transmuxer-worker.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return T});var S=_("./src/demux/transmuxer.ts"),c=_("./src/events.ts"),y=_("./src/utils/logger.ts"),M=_("./node_modules/eventemitter3/index.js");function T(l){var h=new M.EventEmitter,v=function(r,t){l.postMessage({event:r,data:t})};h.on(c.Events.FRAG_DECRYPTED,v),h.on(c.Events.ERROR,v),l.addEventListener("message",function(d){var r=d.data;switch(r.cmd){case"init":{var t=JSON.parse(r.config);l.transmuxer=new S.default(h,r.typeSupported,t,r.vendor,r.id),Object(y.enableLogs)(t.debug),v("init",null);break}case"configure":{l.transmuxer.configure(r.config);break}case"demux":{var i=l.transmuxer.push(r.data,r.decryptdata,r.chunkMeta,r.state);Object(S.isPromise)(i)?i.then(function(o){p(l,o)}):p(l,i);break}case"flush":{var e=r.chunkMeta,a=l.transmuxer.flush(e);Object(S.isPromise)(a)?a.then(function(o){n(l,o,e)}):n(l,a,e);break}}})}function p(l,h){if(!f(h.remuxResult)){var v=[],d=h.remuxResult,r=d.audio,t=d.video;r&&u(v,r),t&&u(v,t),l.postMessage({event:"transmuxComplete",data:h},v)}}function u(l,h){h.data1&&l.push(h.data1.buffer),h.data2&&l.push(h.data2.buffer)}function n(l,h,v){h.forEach(function(d){p(l,d)}),l.postMessage({event:"flush",data:v})}function f(l){return!l.audio&&!l.video&&!l.text&&!l.id3&&!l.initSegment}},"./src/demux/transmuxer.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return i}),_.d(C,"isPromise",function(){return o}),_.d(C,"TransmuxConfig",function(){return s}),_.d(C,"TransmuxState",function(){return g});var S=_("./src/events.ts"),c=_("./src/errors.ts"),y=_("./src/crypt/decrypter.ts"),M=_("./src/demux/aacdemuxer.ts"),T=_("./src/demux/mp4demuxer.ts"),p=_("./src/demux/tsdemuxer.ts"),u=_("./src/demux/mp3demuxer.ts"),n=_("./src/remux/mp4-remuxer.ts"),f=_("./src/remux/passthrough-remuxer.ts"),l=_("./src/demux/chunk-cache.ts"),h=_("./src/utils/mp4-tools.ts"),v=_("./src/utils/logger.ts"),d;try{d=self.performance.now.bind(self.performance)}catch(L){v.logger.debug("Unable to use Performance API on this environment"),d=self.Date.now}var r=[{demux:p.default,remux:n.default},{demux:T.default,remux:f.default},{demux:M.default,remux:n.default},{demux:u.default,remux:n.default}],t=1024;r.forEach(function(L){var A=L.demux;t=Math.max(t,A.minProbeByteLength)});var i=function(){function L(m,E,x,D,I){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new l.default,this.observer=m,this.typeSupported=E,this.config=x,this.vendor=D,this.id=I}var A=L.prototype;return A.configure=function(E){this.transmuxConfig=E,this.decrypter&&this.decrypter.reset()},A.push=function(E,x,D,I){var b=this,R=D.transmuxing;R.executeStart=d();var P=new Uint8Array(E),w=this.cache,F=this.config,k=this.currentTransmuxState,B=this.transmuxConfig;I&&(this.currentTransmuxState=I);var U=e(P,x);if(U&&U.method==="AES-128"){var j=this.getDecrypter();if(F.enableSoftwareAES){var K=j.softwareDecrypt(P,U.key.buffer,U.iv.buffer);if(!K)return R.executeEnd=d(),a(D);P=new Uint8Array(K)}else return this.decryptionPromise=j.webCryptoDecrypt(P,U.key.buffer,U.iv.buffer).then(function(se){var fe=b.push(se,null,D);return b.decryptionPromise=null,fe}),this.decryptionPromise}var N=I||k,Z=N.contiguous,$=N.discontinuity,Y=N.trackSwitch,ee=N.accurateTimeOffset,Q=N.timeOffset,G=N.initSegmentChange,q=B.audioCodec,te=B.videoCodec,ie=B.defaultInitPts,ne=B.duration,le=B.initSegmentData;if(($||Y||G)&&this.resetInitSegment(le,q,te,ne),($||G)&&this.resetInitialTimestamp(ie),Z||this.resetContiguity(),this.needsProbing(P,$,Y)){if(w.dataLength){var ae=w.flush();P=Object(h.appendUint8Array)(ae,P)}this.configureTransmuxer(P,B)}var oe=this.transmux(P,U,Q,ee,D),J=this.currentTransmuxState;return J.contiguous=!0,J.discontinuity=!1,J.trackSwitch=!1,R.executeEnd=d(),oe},A.flush=function(E){var x=this,D=E.transmuxing;D.executeStart=d();var I=this.decrypter,b=this.cache,R=this.currentTransmuxState,P=this.decryptionPromise;if(P)return P.then(function(){return x.flush(E)});var w=[],F=R.timeOffset;if(I){var k=I.flush();k&&w.push(this.push(k,null,E))}var B=b.dataLength;b.reset();var U=this.demuxer,j=this.remuxer;if(!U||!j)return B>=t&&this.observer.emit(S.Events.ERROR,S.Events.ERROR,{type:c.ErrorTypes.MEDIA_ERROR,details:c.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),D.executeEnd=d(),[a(E)];var K=U.flush(F);return o(K)?K.then(function(N){return x.flushRemux(w,N,E),w}):(this.flushRemux(w,K,E),w)},A.flushRemux=function(E,x,D){var I=x.audioTrack,b=x.avcTrack,R=x.id3Track,P=x.textTrack,w=this.currentTransmuxState,F=w.accurateTimeOffset,k=w.timeOffset;v.logger.log("[transmuxer.ts]: Flushed fragment "+D.sn+(D.part>-1?" p: "+D.part:"")+" of level "+D.level);var B=this.remuxer.remux(I,b,R,P,k,F,!0,this.id);E.push({remuxResult:B,chunkMeta:D}),D.transmuxing.executeEnd=d()},A.resetInitialTimestamp=function(E){var x=this.demuxer,D=this.remuxer;!x||!D||(x.resetTimeStamp(E),D.resetTimeStamp(E))},A.resetContiguity=function(){var E=this.demuxer,x=this.remuxer;!E||!x||(E.resetContiguity(),x.resetNextTimestamp())},A.resetInitSegment=function(E,x,D,I){var b=this.demuxer,R=this.remuxer;!b||!R||(b.resetInitSegment(x,D,I),R.resetInitSegment(E,x,D))},A.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},A.transmux=function(E,x,D,I,b){var R;return x&&x.method==="SAMPLE-AES"?R=this.transmuxSampleAes(E,x,D,I,b):R=this.transmuxUnencrypted(E,D,I,b),R},A.transmuxUnencrypted=function(E,x,D,I){var b=this.demuxer.demux(E,x,!1,!this.config.progressive),R=b.audioTrack,P=b.avcTrack,w=b.id3Track,F=b.textTrack,k=this.remuxer.remux(R,P,w,F,x,D,!1,this.id);return{remuxResult:k,chunkMeta:I}},A.transmuxSampleAes=function(E,x,D,I,b){var R=this;return this.demuxer.demuxSampleAes(E,x,D).then(function(P){var w=R.remuxer.remux(P.audioTrack,P.avcTrack,P.id3Track,P.textTrack,D,I,!1,R.id);return{remuxResult:w,chunkMeta:b}})},A.configureTransmuxer=function(E,x){for(var D=this.config,I=this.observer,b=this.typeSupported,R=this.vendor,P=x.audioCodec,w=x.defaultInitPts,F=x.duration,k=x.initSegmentData,B=x.videoCodec,U,j=0,K=r.length;j<K;j++)if(r[j].demux.probe(E)){U=r[j];break}U||(v.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),U={demux:T.default,remux:f.default});var N=this.demuxer,Z=this.remuxer,$=U.remux,Y=U.demux;(!Z||!(Z instanceof $))&&(this.remuxer=new $(I,D,b,R)),(!N||!(N instanceof Y))&&(this.demuxer=new Y(I,D,b),this.probe=Y.probe),this.resetInitSegment(k,P,B,F),this.resetInitialTimestamp(w)},A.needsProbing=function(E,x,D){return!this.demuxer||!this.remuxer||x||D},A.getDecrypter=function(){var E=this.decrypter;return E||(E=this.decrypter=new y.default(this.observer,this.config)),E},L}();function e(L,A){var m=null;return L.byteLength>0&&A!=null&&A.key!=null&&A.iv!==null&&A.method!=null&&(m=A),m}var a=function(A){return{remuxResult:{},chunkMeta:A}};function o(L){return"then"in L&&L.then instanceof Function}var s=function(A,m,E,x,D){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=A,this.videoCodec=m,this.initSegmentData=E,this.duration=x,this.defaultInitPts=D},g=function(A,m,E,x,D,I){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=A,this.contiguous=m,this.accurateTimeOffset=E,this.trackSwitch=x,this.timeOffset=D,this.initSegmentChange=I}},"./src/demux/tsdemuxer.ts":function(O,C,_){_.r(C),_.d(C,"discardEPB",function(){return a});var S=_("./src/demux/adts.ts"),c=_("./src/demux/mpegaudio.ts"),y=_("./src/demux/exp-golomb.ts"),M=_("./src/demux/id3.ts"),T=_("./src/demux/sample-aes.ts"),p=_("./src/events.ts"),u=_("./src/utils/mp4-tools.ts"),n=_("./src/utils/logger.ts"),f=_("./src/errors.ts"),l={video:1,audio:2,id3:3,text:4},h=function(){function o(g,L,A){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=g,this.config=L,this.typeSupported=A}o.probe=function(L){var A=o.syncOffset(L);return A<0?!1:(A&&n.logger.warn("MPEG2-TS detected but first sync word found @ offset "+A+", junk ahead ?"),!0)},o.syncOffset=function(L){for(var A=Math.min(1e3,L.length-564),m=0;m<A;){if(L[m]===71&&L[m+188]===71&&L[m+2*188]===71)return m;m++}return-1},o.createTrack=function(L,A){return{container:L==="video"||L==="audio"?"video/mp2t":void 0,type:L,id:l[L],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:L==="audio"?A:void 0}};var s=o.prototype;return s.resetInitSegment=function(L,A,m){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=o.createTrack("video",m),this._audioTrack=o.createTrack("audio",m),this._id3Track=o.createTrack("id3",m),this._txtTrack=o.createTrack("text",m),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=L,this.videoCodec=A,this._duration=m},s.resetTimeStamp=function(){},s.resetContiguity=function(){var L=this._audioTrack,A=this._avcTrack,m=this._id3Track;L&&(L.pesData=null),A&&(A.pesData=null),m&&(m.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},s.demux=function(L,A,m,E){m===void 0&&(m=!1),E===void 0&&(E=!1),m||(this.sampleAes=null);var x,D=this._avcTrack,I=this._audioTrack,b=this._id3Track,R=D.pid,P=D.pesData,w=I.pid,F=b.pid,k=I.pesData,B=b.pesData,U=!1,j=this.pmtParsed,K=this._pmtId,N=L.length;if(this.remainderData&&(L=Object(u.appendUint8Array)(this.remainderData,L),N=L.length,this.remainderData=null),N<188&&!E)return this.remainderData=L,{audioTrack:I,avcTrack:D,id3Track:b,textTrack:this._txtTrack};var Z=Math.max(0,o.syncOffset(L));N-=(N+Z)%188,N<L.byteLength&&!E&&(this.remainderData=new Uint8Array(L.buffer,N,L.buffer.byteLength-N));for(var $=0,Y=Z;Y<N;Y+=188)if(L[Y]===71){var ee=!!(L[Y+1]&64),Q=((L[Y+1]&31)<<8)+L[Y+2],G=(L[Y+3]&48)>>4,q=void 0;if(G>1){if(q=Y+5+L[Y+4],q===Y+188)continue}else q=Y+4;switch(Q){case R:ee&&(P&&(x=t(P))&&this.parseAVCPES(x,!1),P={data:[],size:0}),P&&(P.data.push(L.subarray(q,Y+188)),P.size+=Y+188-q);break;case w:ee&&(k&&(x=t(k))&&(I.isAAC?this.parseAACPES(x):this.parseMPEGPES(x)),k={data:[],size:0}),k&&(k.data.push(L.subarray(q,Y+188)),k.size+=Y+188-q);break;case F:ee&&(B&&(x=t(B))&&this.parseID3PES(x),B={data:[],size:0}),B&&(B.data.push(L.subarray(q,Y+188)),B.size+=Y+188-q);break;case 0:ee&&(q+=L[q]+1),K=this._pmtId=d(L,q);break;case K:{ee&&(q+=L[q]+1);var te=r(L,q,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,m);R=te.avc,R>0&&(D.pid=R),w=te.audio,w>0&&(I.pid=w,I.isAAC=te.isAAC),F=te.id3,F>0&&(b.pid=F),U&&!j&&(n.logger.log("reparse from beginning"),U=!1,Y=Z-188),j=this.pmtParsed=!0;break}case 17:case 8191:break;default:U=!0;break}}else $++;$>0&&this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+$+" TS packet/s that do not start with 0x47"}),D.pesData=P,I.pesData=k,b.pesData=B;var ie={audioTrack:I,avcTrack:D,id3Track:b,textTrack:this._txtTrack};return E&&this.extractRemainingSamples(ie),ie},s.flush=function(){var L=this.remainderData;this.remainderData=null;var A;return L?A=this.demux(L,-1,!1,!0):A={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(A),this.sampleAes?this.decrypt(A,this.sampleAes):A},s.extractRemainingSamples=function(L){var A=L.audioTrack,m=L.avcTrack,E=L.id3Track,x=m.pesData,D=A.pesData,I=E.pesData,b;x&&(b=t(x))?(this.parseAVCPES(b,!0),m.pesData=null):m.pesData=x,D&&(b=t(D))?(A.isAAC?this.parseAACPES(b):this.parseMPEGPES(b),A.pesData=null):(D!=null&&D.size&&n.logger.log("last AAC PES packet truncated,might overlap between fragments"),A.pesData=D),I&&(b=t(I))?(this.parseID3PES(b),E.pesData=null):E.pesData=I},s.demuxSampleAes=function(L,A,m){var E=this.demux(L,m,!0,!this.config.progressive),x=this.sampleAes=new T.default(this.observer,this.config,A);return this.decrypt(E,x)},s.decrypt=function(L,A){return new Promise(function(m){var E=L.audioTrack,x=L.avcTrack;E.samples&&E.isAAC?A.decryptAacSamples(E.samples,0,function(){x.samples?A.decryptAvcSamples(x.samples,0,0,function(){m(L)}):m(L)}):x.samples&&A.decryptAvcSamples(x.samples,0,0,function(){m(L)})})},s.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},s.parseAVCPES=function(L,A){var m=this,E=this._avcTrack,x=this.parseAVCNALu(L.data),D=this.avcSample,I,b=!1;L.data=null,D&&x.length&&!E.audFound&&(i(D,E),D=this.avcSample=v(!1,L.pts,L.dts,"")),x.forEach(function(R){switch(R.type){case 1:{I=!0,D||(D=m.avcSample=v(!0,L.pts,L.dts,"")),D.frame=!0;var P=R.data;if(b&&P.length>4){var w=new y.default(P).readSliceType();(w===2||w===4||w===7||w===9)&&(D.key=!0)}break}case 5:I=!0,D||(D=m.avcSample=v(!0,L.pts,L.dts,"")),D.key=!0,D.frame=!0;break;case 6:{I=!0;var F=new y.default(a(R.data));F.readUByte();for(var k=0,B=0,U=!1,j=0;!U&&F.bytesAvailable>1;){k=0;do j=F.readUByte(),k+=j;while(j===255);B=0;do j=F.readUByte(),B+=j;while(j===255);if(k===4&&F.bytesAvailable!==0){U=!0;var K=F.readUByte();if(K===181){var N=F.readUShort();if(N===49){var Z=F.readUInt();if(Z===1195456820){var $=F.readUByte();if($===3){for(var Y=F.readUByte(),ee=F.readUByte(),Q=31&Y,G=[Y,ee],q=0;q<Q;q++)G.push(F.readUByte()),G.push(F.readUByte()),G.push(F.readUByte());e(m._txtTrack.samples,{type:3,pts:L.pts,bytes:G})}}}}}else if(k===5&&F.bytesAvailable!==0){if(U=!0,B>16){for(var te=[],ie=0;ie<16;ie++)te.push(F.readUByte().toString(16)),(ie===3||ie===5||ie===7||ie===9)&&te.push("-");for(var ne=B-16,le=new Uint8Array(ne),ae=0;ae<ne;ae++)le[ae]=F.readUByte();e(m._txtTrack.samples,{pts:L.pts,payloadType:k,uuid:te.join(""),userData:Object(M.utf8ArrayToStr)(le),userDataBytes:le})}}else if(B<F.bytesAvailable)for(var oe=0;oe<B;oe++)F.readUByte()}break}case 7:if(I=!0,b=!0,!E.sps){var J=new y.default(R.data),se=J.readSPS();E.width=se.width,E.height=se.height,E.pixelRatio=se.pixelRatio,E.sps=[R.data],E.duration=m._duration;for(var fe=R.data.subarray(1,4),de="avc1.",ge=0;ge<3;ge++){var ue=fe[ge].toString(16);ue.length<2&&(ue="0"+ue),de+=ue}E.codec=de}break;case 8:I=!0,E.pps||(E.pps=[R.data]);break;case 9:I=!1,E.audFound=!0,D&&i(D,E),D=m.avcSample=v(!1,L.pts,L.dts,"");break;case 12:I=!1;break;default:I=!1,D&&(D.debug+="unknown NAL "+R.type+" ");break}if(D&&I){var De=D.units;De.push(R)}}),A&&D&&(i(D,E),this.avcSample=null)},s.getLastNalUnit=function(){var L,A=this.avcSample,m;if(!A||A.units.length===0){var E=this._avcTrack.samples;A=E[E.length-1]}if((L=A)!==null&&L!==void 0&&L.units){var x=A.units;m=x[x.length-1]}return m},s.parseAVCNALu=function(L){var A=L.byteLength,m=this._avcTrack,E=m.naluState||0,x=E,D=[],I=0,b,R,P,w=-1,F=0;for(E===-1&&(w=0,F=L[0]&31,E=0,I=1);I<A;){if(b=L[I++],!E){E=b?0:1;continue}if(E===1){E=b?0:2;continue}if(!b)E=3;else if(b===1){if(w>=0){var k={data:L.subarray(w,I-E-1),type:F};D.push(k)}else{var B=this.getLastNalUnit();if(B&&(x&&I<=4-x&&B.state&&(B.data=B.data.subarray(0,B.data.byteLength-x)),R=I-E-1,R>0)){var U=new Uint8Array(B.data.byteLength+R);U.set(B.data,0),U.set(L.subarray(0,R),B.data.byteLength),B.data=U,B.state=0}}I<A?(P=L[I]&31,w=I,F=P,E=0):E=-1}else E=0}if(w>=0&&E>=0){var j={data:L.subarray(w,A),type:F,state:E};D.push(j)}if(D.length===0){var K=this.getLastNalUnit();if(K){var N=new Uint8Array(K.data.byteLength+L.byteLength);N.set(K.data,0),N.set(L,K.data.byteLength),K.data=N}}return m.naluState=E,D},s.parseAACPES=function(L){var A=0,m=this._audioTrack,E=this.aacOverFlow,x=L.data;if(E){this.aacOverFlow=null;var D=E.sample.unit.byteLength,I=Math.min(E.missing,D),b=D-I;E.sample.unit.set(x.subarray(0,I),b),m.samples.push(E.sample),A=E.missing}var R,P;for(R=A,P=x.length;R<P-1&&!S.isHeader(x,R);R++);if(R!==A){var w,F;if(R<P-1?(w="AAC PES did not start with ADTS header,offset:"+R,F=!1):(w="no ADTS header found in AAC PES",F=!0),n.logger.warn("parsing error:"+w),this.observer.emit(p.Events.ERROR,p.Events.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.FRAG_PARSING_ERROR,fatal:F,reason:w}),F)return}S.initTrackConfig(m,this.observer,x,R,this.audioCodec);var k;if(L.pts!==void 0)k=L.pts;else if(E){var B=S.getFrameDuration(m.samplerate);k=E.sample.pts+B}else{n.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var U=0;R<P;)if(S.isHeader(x,R)){if(R+5<P){var j=S.appendFrame(m,x,R,k,U);if(j)if(j.missing)this.aacOverFlow=j;else{R+=j.length,U++;continue}}break}else R++},s.parseMPEGPES=function(L){var A=L.data,m=A.length,E=0,x=0,D=L.pts;if(D===void 0){n.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;x<m;)if(c.isHeader(A,x)){var I=c.appendFrame(this._audioTrack,A,x,D,E);if(I)x+=I.length,E++;else break}else x++},s.parseID3PES=function(L){if(L.pts===void 0){n.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(L)},o}();h.minProbeByteLength=188;function v(o,s,g,L){return{key:o,frame:!1,pts:s,dts:g,units:[],debug:L,length:0}}function d(o,s){return(o[s+10]&31)<<8|o[s+11]}function r(o,s,g,L){var A={audio:-1,avc:-1,id3:-1,isAAC:!0},m=(o[s+1]&15)<<8|o[s+2],E=s+3+m-4,x=(o[s+10]&15)<<8|o[s+11];for(s+=12+x;s<E;){var D=(o[s+1]&31)<<8|o[s+2];switch(o[s]){case 207:if(!L){n.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:A.audio===-1&&(A.audio=D);break;case 21:A.id3===-1&&(A.id3=D);break;case 219:if(!L){n.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:A.avc===-1&&(A.avc=D);break;case 3:case 4:g?A.audio===-1&&(A.audio=D,A.isAAC=!1):n.logger.log("MPEG audio found, not supported in this browser");break;case 36:n.logger.warn("Unsupported HEVC stream type found");break}s+=((o[s+3]&15)<<8|o[s+4])+5}return A}function t(o){var s=0,g,L,A,m,E,x=o.data;if(!o||o.size===0)return null;for(;x[0].length<19&&x.length>1;){var D=new Uint8Array(x[0].length+x[1].length);D.set(x[0]),D.set(x[1],x[0].length),x[0]=D,x.splice(1,1)}g=x[0];var I=(g[0]<<16)+(g[1]<<8)+g[2];if(I===1){if(L=(g[4]<<8)+g[5],L&&L>o.size-6)return null;var b=g[7];b&192&&(m=(g[9]&14)*536870912+(g[10]&255)*4194304+(g[11]&254)*16384+(g[12]&255)*128+(g[13]&254)/2,b&64?(E=(g[14]&14)*536870912+(g[15]&255)*4194304+(g[16]&254)*16384+(g[17]&255)*128+(g[18]&254)/2,m-E>60*9e4&&(n.logger.warn(Math.round((m-E)/9e4)+"s delta between PTS and DTS, align them"),m=E)):E=m),A=g[8];var R=A+9;if(o.size<=R)return null;o.size-=R;for(var P=new Uint8Array(o.size),w=0,F=x.length;w<F;w++){g=x[w];var k=g.byteLength;if(R)if(R>k){R-=k;continue}else g=g.subarray(R),k-=R,R=0;P.set(g,s),s+=k}return L&&(L-=A+3),{data:P,pts:m,dts:E,len:L}}return null}function i(o,s){if(o.units.length&&o.frame){if(o.pts===void 0){var g=s.samples,L=g.length;if(L){var A=g[L-1];o.pts=A.pts,o.dts=A.dts}else{s.dropped++;return}}s.samples.push(o)}o.debug.length&&n.logger.log(o.pts+"/"+o.dts+":"+o.debug)}function e(o,s){var g=o.length;if(g>0){if(s.pts>=o[g-1].pts)o.push(s);else for(var L=g-1;L>=0;L--)if(s.pts<o[L].pts){o.splice(L,0,s);break}}else o.push(s)}function a(o){for(var s=o.byteLength,g=[],L=1;L<s-2;)o[L]===0&&o[L+1]===0&&o[L+2]===3?(g.push(L+2),L+=2):L++;if(g.length===0)return o;var A=s-g.length,m=new Uint8Array(A),E=0;for(L=0;L<A;E++,L++)E===g[0]&&(E++,g.shift()),m[L]=o[E];return m}C.default=h},"./src/errors.ts":function(O,C,_){_.r(C),_.d(C,"ErrorTypes",function(){return S}),_.d(C,"ErrorDetails",function(){return c});var S;(function(y){y.NETWORK_ERROR="networkError",y.MEDIA_ERROR="mediaError",y.KEY_SYSTEM_ERROR="keySystemError",y.MUX_ERROR="muxError",y.OTHER_ERROR="otherError"})(S||(S={}));var c;(function(y){y.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",y.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",y.KEY_SYSTEM_NO_SESSION="keySystemNoSession",y.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",y.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",y.MANIFEST_LOAD_ERROR="manifestLoadError",y.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",y.MANIFEST_PARSING_ERROR="manifestParsingError",y.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",y.LEVEL_EMPTY_ERROR="levelEmptyError",y.LEVEL_LOAD_ERROR="levelLoadError",y.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",y.LEVEL_SWITCH_ERROR="levelSwitchError",y.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",y.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",y.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",y.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",y.FRAG_LOAD_ERROR="fragLoadError",y.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",y.FRAG_DECRYPT_ERROR="fragDecryptError",y.FRAG_PARSING_ERROR="fragParsingError",y.REMUX_ALLOC_ERROR="remuxAllocError",y.KEY_LOAD_ERROR="keyLoadError",y.KEY_LOAD_TIMEOUT="keyLoadTimeOut",y.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",y.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",y.BUFFER_APPEND_ERROR="bufferAppendError",y.BUFFER_APPENDING_ERROR="bufferAppendingError",y.BUFFER_STALLED_ERROR="bufferStalledError",y.BUFFER_FULL_ERROR="bufferFullError",y.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",y.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",y.INTERNAL_EXCEPTION="internalException",y.INTERNAL_ABORTED="aborted",y.UNKNOWN="unknown"})(c||(c={}))},"./src/events.ts":function(O,C,_){_.r(C),_.d(C,"Events",function(){return S});var S;(function(c){c.MEDIA_ATTACHING="hlsMediaAttaching",c.MEDIA_ATTACHED="hlsMediaAttached",c.MEDIA_DETACHING="hlsMediaDetaching",c.MEDIA_DETACHED="hlsMediaDetached",c.BUFFER_RESET="hlsBufferReset",c.BUFFER_CODECS="hlsBufferCodecs",c.BUFFER_CREATED="hlsBufferCreated",c.BUFFER_APPENDING="hlsBufferAppending",c.BUFFER_APPENDED="hlsBufferAppended",c.BUFFER_EOS="hlsBufferEos",c.BUFFER_FLUSHING="hlsBufferFlushing",c.BUFFER_FLUSHED="hlsBufferFlushed",c.MANIFEST_LOADING="hlsManifestLoading",c.MANIFEST_LOADED="hlsManifestLoaded",c.MANIFEST_PARSED="hlsManifestParsed",c.LEVEL_SWITCHING="hlsLevelSwitching",c.LEVEL_SWITCHED="hlsLevelSwitched",c.LEVEL_LOADING="hlsLevelLoading",c.LEVEL_LOADED="hlsLevelLoaded",c.LEVEL_UPDATED="hlsLevelUpdated",c.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",c.LEVELS_UPDATED="hlsLevelsUpdated",c.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",c.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",c.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",c.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",c.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",c.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",c.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",c.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",c.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",c.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",c.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",c.CUES_PARSED="hlsCuesParsed",c.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",c.INIT_PTS_FOUND="hlsInitPtsFound",c.FRAG_LOADING="hlsFragLoading",c.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",c.FRAG_LOADED="hlsFragLoaded",c.FRAG_DECRYPTED="hlsFragDecrypted",c.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",c.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",c.FRAG_PARSING_METADATA="hlsFragParsingMetadata",c.FRAG_PARSED="hlsFragParsed",c.FRAG_BUFFERED="hlsFragBuffered",c.FRAG_CHANGED="hlsFragChanged",c.FPS_DROP="hlsFpsDrop",c.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",c.ERROR="hlsError",c.DESTROYING="hlsDestroying",c.KEY_LOADING="hlsKeyLoading",c.KEY_LOADED="hlsKeyLoaded",c.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",c.BACK_BUFFER_REACHED="hlsBackBufferReached"})(S||(S={}))},"./src/hls.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return e});var S=_("./node_modules/url-toolkit/src/url-toolkit.js"),c=_("./src/loader/playlist-loader.ts"),y=_("./src/loader/key-loader.ts"),M=_("./src/controller/id3-track-controller.ts"),T=_("./src/controller/latency-controller.ts"),p=_("./src/controller/level-controller.ts"),u=_("./src/controller/fragment-tracker.ts"),n=_("./src/controller/stream-controller.ts"),f=_("./src/is-supported.ts"),l=_("./src/utils/logger.ts"),h=_("./src/config.ts"),v=_("./node_modules/eventemitter3/index.js"),d=_("./src/events.ts"),r=_("./src/errors.ts");function t(a,o){for(var s=0;s<o.length;s++){var g=o[s];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(a,g.key,g)}}function i(a,o,s){return o&&t(a.prototype,o),s&&t(a,s),a}var e=function(){a.isSupported=function(){return Object(f.isSupported)()};function a(s){s===void 0&&(s={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new v.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var g=this.config=Object(h.mergeConfig)(a.DefaultConfig,s);this.userConfig=s,Object(l.enableLogs)(g.debug),this._autoLevelCapping=-1,g.progressive&&Object(h.enableStreamingMode)(g);var L=g.abrController,A=g.bufferController,m=g.capLevelController,E=g.fpsController,x=this.abrController=new L(this),D=this.bufferController=new A(this),I=this.capLevelController=new m(this),b=new E(this),R=new c.default(this),P=new y.default(this),w=new M.default(this),F=this.levelController=new p.default(this),k=new u.FragmentTracker(this),B=this.streamController=new n.default(this,k);I.setStreamController(B),b.setStreamController(B);var U=[F,B];this.networkControllers=U;var j=[R,P,x,D,I,b,w,k];this.audioTrackController=this.createController(g.audioTrackController,null,U),this.createController(g.audioStreamController,k,U),this.subtitleTrackController=this.createController(g.subtitleTrackController,null,U),this.createController(g.subtitleStreamController,k,U),this.createController(g.timelineController,null,j),this.emeController=this.createController(g.emeController,null,j),this.cmcdController=this.createController(g.cmcdController,null,j),this.latencyController=this.createController(T.default,null,j),this.coreComponents=j}var o=a.prototype;return o.createController=function(g,L,A){if(g){var m=L?new g(this,L):new g(this);return A&&A.push(m),m}return null},o.on=function(g,L,A){A===void 0&&(A=this),this._emitter.on(g,L,A)},o.once=function(g,L,A){A===void 0&&(A=this),this._emitter.once(g,L,A)},o.removeAllListeners=function(g){this._emitter.removeAllListeners(g)},o.off=function(g,L,A,m){A===void 0&&(A=this),this._emitter.off(g,L,A,m)},o.listeners=function(g){return this._emitter.listeners(g)},o.emit=function(g,L,A){return this._emitter.emit(g,L,A)},o.trigger=function(g,L){if(this.config.debug)return this.emit(g,g,L);try{return this.emit(g,g,L)}catch(A){l.logger.error("An internal error happened while handling event "+g+'. Error message: "'+A.message+'". Here is a stacktrace:',A),this.trigger(d.Events.ERROR,{type:r.ErrorTypes.OTHER_ERROR,details:r.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:g,error:A})}return!1},o.listenerCount=function(g){return this._emitter.listenerCount(g)},o.destroy=function(){l.logger.log("destroy"),this.trigger(d.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(g){return g.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(g){return g.destroy()}),this.coreComponents.length=0},o.attachMedia=function(g){l.logger.log("attachMedia"),this._media=g,this.trigger(d.Events.MEDIA_ATTACHING,{media:g})},o.detachMedia=function(){l.logger.log("detachMedia"),this.trigger(d.Events.MEDIA_DETACHING,void 0),this._media=null},o.loadSource=function(g){this.stopLoad();var L=this.media,A=this.url,m=this.url=S.buildAbsoluteURL(self.location.href,g,{alwaysNormalize:!0});l.logger.log("loadSource:"+m),L&&A&&A!==m&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(L)),this.trigger(d.Events.MANIFEST_LOADING,{url:g})},o.startLoad=function(g){g===void 0&&(g=-1),l.logger.log("startLoad("+g+")"),this.networkControllers.forEach(function(L){L.startLoad(g)})},o.stopLoad=function(){l.logger.log("stopLoad"),this.networkControllers.forEach(function(g){g.stopLoad()})},o.swapAudioCodec=function(){l.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},o.recoverMediaError=function(){l.logger.log("recoverMediaError");var g=this._media;this.detachMedia(),g&&this.attachMedia(g)},o.removeLevel=function(g,L){L===void 0&&(L=0),this.levelController.removeLevel(g,L)},i(a,[{key:"levels",get:function(){var g=this.levelController.levels;return g||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(g){l.logger.log("set currentLevel:"+g),this.loadLevel=g,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(g){l.logger.log("set nextLevel:"+g),this.levelController.manualLevel=g,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(g){l.logger.log("set loadLevel:"+g),this.levelController.manualLevel=g}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(g){this.levelController.nextLoadLevel=g}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(g){l.logger.log("set firstLevel:"+g),this.levelController.firstLevel=g}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(g){l.logger.log("set startLevel:"+g),g!==-1&&(g=Math.max(g,this.minAutoLevel)),this.levelController.startLevel=g}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(g){var L=!!g;L!==this.config.capLevelToPlayerSize&&(L?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=L)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(g){this._autoLevelCapping!==g&&(l.logger.log("set autoLevelCapping:"+g),this._autoLevelCapping=g)}},{key:"bandwidthEstimate",get:function(){var g=this.abrController.bwEstimator;return g?g.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var g=this.levels,L=this.config.minAutoBitrate;if(!g)return 0;for(var A=g.length,m=0;m<A;m++)if(g[m].maxBitrate>L)return m;return 0}},{key:"maxAutoLevel",get:function(){var g=this.levels,L=this.autoLevelCapping,A;return L===-1&&g&&g.length?A=g.length-1:A=L,A}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(g){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,g)}},{key:"audioTracks",get:function(){var g=this.audioTrackController;return g?g.audioTracks:[]}},{key:"audioTrack",get:function(){var g=this.audioTrackController;return g?g.audioTrack:-1},set:function(g){var L=this.audioTrackController;L&&(L.audioTrack=g)}},{key:"subtitleTracks",get:function(){var g=this.subtitleTrackController;return g?g.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var g=this.subtitleTrackController;return g?g.subtitleTrack:-1},set:function(g){var L=this.subtitleTrackController;L&&(L.subtitleTrack=g)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var g=this.subtitleTrackController;return g?g.subtitleDisplay:!1},set:function(g){var L=this.subtitleTrackController;L&&(L.subtitleDisplay=g)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(g){this.config.lowLatencyMode=g}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.1.5"}},{key:"Events",get:function(){return d.Events}},{key:"ErrorTypes",get:function(){return r.ErrorTypes}},{key:"ErrorDetails",get:function(){return r.ErrorDetails}},{key:"DefaultConfig",get:function(){return a.defaultConfig?a.defaultConfig:h.hlsDefaultConfig},set:function(g){a.defaultConfig=g}}]),a}();e.defaultConfig=void 0},"./src/is-supported.ts":function(O,C,_){_.r(C),_.d(C,"isSupported",function(){return y}),_.d(C,"changeTypeSupported",function(){return M});var S=_("./src/utils/mediasource-helper.ts");function c(){return self.SourceBuffer||self.WebKitSourceBuffer}function y(){var T=Object(S.getMediaSource)();if(!T)return!1;var p=c(),u=T&&typeof T.isTypeSupported=="function"&&T.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!p||p.prototype&&typeof p.prototype.appendBuffer=="function"&&typeof p.prototype.remove=="function";return!!u&&!!n}function M(){var T,p=c();return typeof(p==null||(T=p.prototype)===null||T===void 0?void 0:T.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return h}),_.d(C,"LoadError",function(){return d});var S=_("./src/polyfills/number.ts"),c=_("./src/errors.ts");function y(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t)}function M(r){var t=typeof Map=="function"?new Map:void 0;return M=function(e){if(e===null||!u(e))return e;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t!="undefined"){if(t.has(e))return t.get(e);t.set(e,a)}function a(){return T(e,arguments,f(this).constructor)}return a.prototype=Object.create(e.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),n(a,e)},M(r)}function T(r,t,i){return p()?T=Reflect.construct:T=function(a,o,s){var g=[null];g.push.apply(g,o);var L=Function.bind.apply(a,g),A=new L;return s&&n(A,s.prototype),A},T.apply(null,arguments)}function p(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(r){return!1}}function u(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function n(r,t){return n=Object.setPrototypeOf||function(e,a){return e.__proto__=a,e},n(r,t)}function f(r){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},f(r)}var l=Math.pow(2,17),h=function(){function r(i){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=i}var t=r.prototype;return t.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},t.abort=function(){this.loader&&this.loader.abort()},t.load=function(e,a){var o=this,s=e.url;if(!s)return Promise.reject(new d({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,networkDetails:null},"Fragment does not have a "+(s?"part list":"url")));this.abort();var g=this.config,L=g.fLoader,A=g.loader;return new Promise(function(m,E){o.loader&&o.loader.destroy();var x=o.loader=e.loader=L?new L(g):new A(g),D=v(e),I={timeout:g.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:g.fragLoadingMaxRetryTimeout,highWaterMark:l};e.stats=x.stats,x.load(D,I,{onSuccess:function(R,P,w,F){o.resetLoader(e,x),m({frag:e,part:null,payload:R.data,networkDetails:F})},onError:function(R,P,w){o.resetLoader(e,x),E(new d({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:R,networkDetails:w}))},onAbort:function(R,P,w){o.resetLoader(e,x),E(new d({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,networkDetails:w}))},onTimeout:function(R,P,w){o.resetLoader(e,x),E(new d({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,networkDetails:w}))},onProgress:function(R,P,w,F){a&&a({frag:e,part:null,payload:w,networkDetails:F})}})})},t.loadPart=function(e,a,o){var s=this;this.abort();var g=this.config,L=g.fLoader,A=g.loader;return new Promise(function(m,E){s.loader&&s.loader.destroy();var x=s.loader=e.loader=L?new L(g):new A(g),D=v(e,a),I={timeout:g.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:g.fragLoadingMaxRetryTimeout,highWaterMark:l};a.stats=x.stats,x.load(D,I,{onSuccess:function(R,P,w,F){s.resetLoader(e,x),s.updateStatsFromPart(e,a);var k={frag:e,part:a,payload:R.data,networkDetails:F};o(k),m(k)},onError:function(R,P,w){s.resetLoader(e,x),E(new d({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:a,response:R,networkDetails:w}))},onAbort:function(R,P,w){e.stats.aborted=a.stats.aborted,s.resetLoader(e,x),E(new d({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:e,part:a,networkDetails:w}))},onTimeout:function(R,P,w){s.resetLoader(e,x),E(new d({type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:a,networkDetails:w}))}})})},t.updateStatsFromPart=function(e,a){var o=e.stats,s=a.stats,g=s.total;if(o.loaded+=s.loaded,g){var L=Math.round(e.duration/a.duration),A=Math.min(Math.round(o.loaded/g),L),m=L-A,E=m*Math.round(o.loaded/A);o.total=o.loaded+E}else o.total=Math.max(o.loaded,o.total);var x=o.loading,D=s.loading;x.start?x.first+=D.first-D.start:(x.start=D.start,x.first=D.first),x.end=D.end},t.resetLoader=function(e,a){e.loader=null,this.loader===a&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),a.destroy()},r}();function v(r,t){t===void 0&&(t=null);var i=t||r,e={frag:r,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},a=i.byteRangeStartOffset,o=i.byteRangeEndOffset;return Object(S.isFiniteNumber)(a)&&Object(S.isFiniteNumber)(o)&&(e.rangeStart=a,e.rangeEnd=o),e}var d=function(r){y(t,r);function t(i){for(var e,a=arguments.length,o=new Array(a>1?a-1:0),s=1;s<a;s++)o[s-1]=arguments[s];return e=r.call.apply(r,[this].concat(o))||this,e.data=void 0,e.data=i,e}return t}(M(Error))},"./src/loader/fragment.ts":function(O,C,_){_.r(C),_.d(C,"ElementaryStreamTypes",function(){return l}),_.d(C,"BaseSegment",function(){return h}),_.d(C,"Fragment",function(){return v}),_.d(C,"Part",function(){return d});var S=_("./src/polyfills/number.ts"),c=_("./node_modules/url-toolkit/src/url-toolkit.js"),y=_("./src/utils/logger.ts"),M=_("./src/loader/level-key.ts"),T=_("./src/loader/load-stats.ts");function p(r,t){r.prototype=Object.create(t.prototype),r.prototype.constructor=r,u(r,t)}function u(r,t){return u=Object.setPrototypeOf||function(e,a){return e.__proto__=a,e},u(r,t)}function n(r,t){for(var i=0;i<t.length;i++){var e=t[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}function f(r,t,i){return t&&n(r.prototype,t),i&&n(r,i),r}var l;(function(r){r.AUDIO="audio",r.VIDEO="video",r.AUDIOVIDEO="audiovideo"})(l||(l={}));var h=function(){function r(i){var e;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(e={},e[l.AUDIO]=null,e[l.VIDEO]=null,e[l.AUDIOVIDEO]=null,e),this.baseurl=i}var t=r.prototype;return t.setByteRange=function(e,a){var o=e.split("@",2),s=[];o.length===1?s[0]=a?a.byteRangeEndOffset:0:s[0]=parseInt(o[1]),s[1]=parseInt(o[0])+s[0],this._byteRange=s},f(r,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(c.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),r}(),v=function(r){p(t,r);function t(e,a){var o;return o=r.call(this,a)||this,o._decryptdata=null,o.rawProgramDateTime=null,o.programDateTime=null,o.tagList=[],o.duration=0,o.sn=0,o.levelkey=void 0,o.type=void 0,o.loader=null,o.level=-1,o.cc=0,o.startPTS=void 0,o.endPTS=void 0,o.appendedPTS=void 0,o.startDTS=void 0,o.endDTS=void 0,o.start=0,o.deltaPTS=void 0,o.maxStartPTS=void 0,o.minEndPTS=void 0,o.stats=new T.LoadStats,o.urlId=0,o.data=void 0,o.bitrateTest=!1,o.title=null,o.initSegment=null,o.type=e,o}var i=t.prototype;return i.createInitializationVector=function(a){for(var o=new Uint8Array(16),s=12;s<16;s++)o[s]=a>>8*(15-s)&255;return o},i.setDecryptDataFromLevelKey=function(a,o){var s=a;return(a==null?void 0:a.method)==="AES-128"&&a.uri&&!a.iv&&(s=M.LevelKey.fromURI(a.uri),s.method=a.method,s.iv=this.createInitializationVector(o),s.keyFormat="identity"),s},i.setElementaryStreamInfo=function(a,o,s,g,L,A){A===void 0&&(A=!1);var m=this.elementaryStreams,E=m[a];if(!E){m[a]={startPTS:o,endPTS:s,startDTS:g,endDTS:L,partial:A};return}E.startPTS=Math.min(E.startPTS,o),E.endPTS=Math.max(E.endPTS,s),E.startDTS=Math.min(E.startDTS,g),E.endDTS=Math.max(E.endDTS,L)},i.clearElementaryStreamInfo=function(){var a=this.elementaryStreams;a[l.AUDIO]=null,a[l.VIDEO]=null,a[l.AUDIOVIDEO]=null},f(t,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var a=this.sn;typeof a!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&y.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),a=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,a)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(S.isFiniteNumber)(this.programDateTime))return null;var a=Object(S.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+a*1e3}},{key:"encrypted",get:function(){var a;return!!((a=this.decryptdata)!==null&&a!==void 0&&a.keyFormat&&this.decryptdata.uri)}}]),t}(h),d=function(r){p(t,r);function t(i,e,a,o,s){var g;g=r.call(this,a)||this,g.fragOffset=0,g.duration=0,g.gap=!1,g.independent=!1,g.relurl=void 0,g.fragment=void 0,g.index=void 0,g.stats=new T.LoadStats,g.duration=i.decimalFloatingPoint("DURATION"),g.gap=i.bool("GAP"),g.independent=i.bool("INDEPENDENT"),g.relurl=i.enumeratedString("URI"),g.fragment=e,g.index=o;var L=i.enumeratedString("BYTERANGE");return L&&g.setByteRange(L,s),s&&(g.fragOffset=s.fragOffset+s.duration),g}return f(t,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),t}(h)},"./src/loader/key-loader.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return M});var S=_("./src/events.ts"),c=_("./src/errors.ts"),y=_("./src/utils/logger.ts"),M=function(){function T(u){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=u,this._registerListeners()}var p=T.prototype;return p._registerListeners=function(){this.hls.on(S.Events.KEY_LOADING,this.onKeyLoading,this)},p._unregisterListeners=function(){this.hls.off(S.Events.KEY_LOADING,this.onKeyLoading)},p.destroy=function(){this._unregisterListeners();for(var n in this.loaders){var f=this.loaders[n];f&&f.destroy()}this.loaders={}},p.onKeyLoading=function(n,f){var l=f.frag,h=l.type,v=this.loaders[h];if(!l.decryptdata){y.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var d=l.decryptdata.uri;if(d!==this.decrypturl||this.decryptkey===null){var r=this.hls.config;if(v&&(y.logger.warn("abort previous key loader for type:"+h),v.abort()),!d){y.logger.warn("key uri is falsy");return}var t=r.loader,i=l.loader=this.loaders[h]=new t(r);this.decrypturl=d,this.decryptkey=null;var e={url:d,frag:l,responseType:"arraybuffer"},a={timeout:r.fragLoadingTimeOut,maxRetry:0,retryDelay:r.fragLoadingRetryDelay,maxRetryDelay:r.fragLoadingMaxRetryTimeout,highWaterMark:0},o={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};i.load(e,a,o)}else this.decryptkey&&(l.decryptdata.key=this.decryptkey,this.hls.trigger(S.Events.KEY_LOADED,{frag:l}))},p.loadsuccess=function(n,f,l){var h=l.frag;if(!h.decryptdata){y.logger.error("after key load, decryptdata unset");return}this.decryptkey=h.decryptdata.key=new Uint8Array(n.data),h.loader=null,delete this.loaders[h.type],this.hls.trigger(S.Events.KEY_LOADED,{frag:h})},p.loaderror=function(n,f){var l=f.frag,h=l.loader;h&&h.abort(),delete this.loaders[l.type],this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:l,response:n})},p.loadtimeout=function(n,f){var l=f.frag,h=l.loader;h&&h.abort(),delete this.loaders[l.type],this.hls.trigger(S.Events.ERROR,{type:c.ErrorTypes.NETWORK_ERROR,details:c.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:l})},T}()},"./src/loader/level-details.ts":function(O,C,_){_.r(C),_.d(C,"LevelDetails",function(){return T});var S=_("./src/polyfills/number.ts");function c(p,u){for(var n=0;n<u.length;n++){var f=u[n];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(p,f.key,f)}}function y(p,u,n){return u&&c(p.prototype,u),n&&c(p,n),p}var M=10,T=function(){function p(n){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=n}var u=p.prototype;return u.reloaded=function(f){if(!f){this.advanced=!0,this.updated=!0;return}var l=this.lastPartSn-f.lastPartSn,h=this.lastPartIndex-f.lastPartIndex;this.updated=this.endSN!==f.endSN||!!h||!!l,this.advanced=this.endSN>f.endSN||l>0||l===0&&h>0,this.updated||this.advanced?this.misses=Math.floor(f.misses*.6):this.misses=f.misses+1,this.availabilityDelay=f.availabilityDelay},y(p,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(S.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||M}},{key:"drift",get:function(){var f=this.driftEndTime-this.driftStartTime;if(f>0){var l=this.driftEnd-this.driftStart;return l*1e3/f}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var f;return(f=this.fragments)!==null&&f!==void 0&&f.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var f;return(f=this.partList)!==null&&f!==void 0&&f.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),p}()},"./src/loader/level-key.ts":function(O,C,_){_.r(C),_.d(C,"LevelKey",function(){return M});var S=_("./node_modules/url-toolkit/src/url-toolkit.js");function c(T,p){for(var u=0;u<p.length;u++){var n=p[u];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(T,n.key,n)}}function y(T,p,u){return p&&c(T.prototype,p),u&&c(T,u),T}var M=function(){T.fromURL=function(u,n){return new T(u,n)},T.fromURI=function(u){return new T(u)};function T(p,u){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,u?this._uri=Object(S.buildAbsoluteURL)(p,u,{alwaysNormalize:!0}):this._uri=p}return y(T,[{key:"uri",get:function(){return this._uri}}]),T}()},"./src/loader/load-stats.ts":function(O,C,_){_.r(C),_.d(C,"LoadStats",function(){return S});var S=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return t});var S=_("./src/polyfills/number.ts"),c=_("./node_modules/url-toolkit/src/url-toolkit.js"),y=_("./src/loader/fragment.ts"),M=_("./src/loader/level-details.ts"),T=_("./src/loader/level-key.ts"),p=_("./src/utils/attr-list.ts"),u=_("./src/utils/logger.ts"),n=_("./src/utils/codecs.ts"),f=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,l=/#EXT-X-MEDIA:(.*)/g,h=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),v=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),d=/\.(mp4|m4s|m4v|m4a)$/i;function r(s){var g,L;return d.test((g=(L=c.parseURL(s))===null||L===void 0?void 0:L.path)!=null?g:"")}var t=function(){function s(){}return s.findGroup=function(L,A){for(var m=0;m<L.length;m++){var E=L[m];if(E.id===A)return E}},s.convertAVC1ToAVCOTI=function(L){var A=L.split(".");if(A.length>2){var m=A.shift()+".";return m+=parseInt(A.shift()).toString(16),m+=("000"+parseInt(A.shift()).toString(16)).substr(-4),m}return L},s.resolve=function(L,A){return c.buildAbsoluteURL(A,L,{alwaysNormalize:!0})},s.parseMasterPlaylist=function(L,A){var m=[],E={},x=!1;f.lastIndex=0;for(var D;(D=f.exec(L))!=null;)if(D[1]){var I=new p.AttrList(D[1]),b={attrs:I,bitrate:I.decimalInteger("AVERAGE-BANDWIDTH")||I.decimalInteger("BANDWIDTH"),name:I.NAME,url:s.resolve(D[2],A)},R=I.decimalResolution("RESOLUTION");R&&(b.width=R.width,b.height=R.height),i((I.CODECS||"").split(/[ ,]+/).filter(function(w){return w}),b),b.videoCodec&&b.videoCodec.indexOf("avc1")!==-1&&(b.videoCodec=s.convertAVC1ToAVCOTI(b.videoCodec)),m.push(b)}else if(D[3]){var P=new p.AttrList(D[3]);P["DATA-ID"]&&(x=!0,E[P["DATA-ID"]]=P)}return{levels:m,sessionData:x?E:null}},s.parseMasterPlaylistMedia=function(L,A,m,E){E===void 0&&(E=[]);var x,D=[],I=0;for(l.lastIndex=0;(x=l.exec(L))!==null;){var b=new p.AttrList(x[1]);if(b.TYPE===m){var R={attrs:b,bitrate:0,id:I++,groupId:b["GROUP-ID"],instreamId:b["INSTREAM-ID"],name:b.NAME||b.LANGUAGE||"",type:m,default:b.bool("DEFAULT"),autoselect:b.bool("AUTOSELECT"),forced:b.bool("FORCED"),lang:b.LANGUAGE,url:b.URI?s.resolve(b.URI,A):""};if(E.length){var P=s.findGroup(E,R.groupId)||E[0];e(R,P,"audioCodec"),e(R,P,"textCodec")}D.push(R)}}return D},s.parseLevelPlaylist=function(L,A,m,E,x){var D=new M.LevelDetails(A),I=D.fragments,b=null,R=0,P=0,w=0,F=0,k=null,B=new y.Fragment(E,A),U,j,K,N=-1,Z=!1;for(h.lastIndex=0,D.m3u8=L;(U=h.exec(L))!==null;){Z&&(Z=!1,B=new y.Fragment(E,A),B.start=w,B.sn=R,B.cc=F,B.level=m,b&&(B.initSegment=b,B.rawProgramDateTime=b.rawProgramDateTime));var $=U[1];if($){B.duration=parseFloat($);var Y=(" "+U[2]).slice(1);B.title=Y||null,B.tagList.push(Y?["INF",$,Y]:["INF",$])}else if(U[3])Object(S.isFiniteNumber)(B.duration)&&(B.start=w,K&&(B.levelkey=K),B.sn=R,B.level=m,B.cc=F,B.urlId=x,I.push(B),B.relurl=(" "+U[3]).slice(1),o(B,k),k=B,w+=B.duration,R++,P=0,Z=!0);else if(U[4]){var ee=(" "+U[4]).slice(1);k?B.setByteRange(ee,k):B.setByteRange(ee)}else if(U[5])B.rawProgramDateTime=(" "+U[5]).slice(1),B.tagList.push(["PROGRAM-DATE-TIME",B.rawProgramDateTime]),N===-1&&(N=I.length);else{if(U=U[0].match(v),!U){u.logger.warn("No matches on slow regex match for level playlist!");continue}for(j=1;j<U.length&&typeof U[j]=="undefined";j++);var Q=(" "+U[j]).slice(1),G=(" "+U[j+1]).slice(1),q=U[j+2]?(" "+U[j+2]).slice(1):"";switch(Q){case"PLAYLIST-TYPE":D.type=G.toUpperCase();break;case"MEDIA-SEQUENCE":R=D.startSN=parseInt(G);break;case"SKIP":{var te=new p.AttrList(G),ie=te.decimalInteger("SKIPPED-SEGMENTS");if(Object(S.isFiniteNumber)(ie)){D.skippedSegments=ie;for(var ne=ie;ne--;)I.unshift(null);R+=ie}var le=te.enumeratedString("RECENTLY-REMOVED-DATERANGES");le&&(D.recentlyRemovedDateranges=le.split("	"));break}case"TARGETDURATION":D.targetduration=parseFloat(G);break;case"VERSION":D.version=parseInt(G);break;case"EXTM3U":break;case"ENDLIST":D.live=!1;break;case"#":(G||q)&&B.tagList.push(q?[G,q]:[G]);break;case"DIS":F++;case"GAP":B.tagList.push([Q]);break;case"BITRATE":B.tagList.push([Q,G]);break;case"DISCONTINUITY-SEQ":F=parseInt(G);break;case"KEY":{var ae,oe=new p.AttrList(G),J=oe.enumeratedString("METHOD"),se=oe.URI,fe=oe.hexadecimalInteger("IV"),de=oe.enumeratedString("KEYFORMATVERSIONS"),ge=oe.enumeratedString("KEYID"),ue=(ae=oe.enumeratedString("KEYFORMAT"))!=null?ae:"identity",De=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(De.indexOf(ue)>-1){u.logger.warn("Keyformat "+ue+" is not supported from the manifest");continue}else if(ue!=="identity")continue;J&&(K=T.LevelKey.fromURL(A,se),se&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(J)>=0&&(K.method=J,K.keyFormat=ue,ge&&(K.keyID=ge),de&&(K.keyFormatVersions=de),K.iv=fe));break}case"START":{var pe=new p.AttrList(G),Te=pe.decimalFloatingPoint("TIME-OFFSET");Object(S.isFiniteNumber)(Te)&&(D.startTimeOffset=Te);break}case"MAP":{var W=new p.AttrList(G);B.relurl=W.URI,W.BYTERANGE&&B.setByteRange(W.BYTERANGE),B.level=m,B.sn="initSegment",K&&(B.levelkey=K),B.initSegment=null,b=B,Z=!0;break}case"SERVER-CONTROL":{var z=new p.AttrList(G);D.canBlockReload=z.bool("CAN-BLOCK-RELOAD"),D.canSkipUntil=z.optionalFloat("CAN-SKIP-UNTIL",0),D.canSkipDateRanges=D.canSkipUntil>0&&z.bool("CAN-SKIP-DATERANGES"),D.partHoldBack=z.optionalFloat("PART-HOLD-BACK",0),D.holdBack=z.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var V=new p.AttrList(G);D.partTarget=V.decimalFloatingPoint("PART-TARGET");break}case"PART":{var X=D.partList;X||(X=D.partList=[]);var H=P>0?X[X.length-1]:void 0,re=P++,ce=new y.Part(new p.AttrList(G),B,A,re,H);X.push(ce),B.duration+=ce.duration;break}case"PRELOAD-HINT":{var _e=new p.AttrList(G);D.preloadHint=_e;break}case"RENDITION-REPORT":{var Se=new p.AttrList(G);D.renditionReports=D.renditionReports||[],D.renditionReports.push(Se);break}default:u.logger.warn("line parsed but not handled: "+U);break}}}k&&!k.relurl?(I.pop(),w-=k.duration,D.partList&&(D.fragmentHint=k)):D.partList&&(o(B,k),B.cc=F,D.fragmentHint=B);var Me=I.length,Le=I[0],Ie=I[Me-1];if(w+=D.skippedSegments*D.targetduration,w>0&&Me&&Ie){D.averagetargetduration=w/Me;var Pe=Ie.sn;D.endSN=Pe!=="initSegment"?Pe:0,Le&&(D.startCC=Le.cc,Le.initSegment||D.fragments.every(function(we){return we.relurl&&r(we.relurl)})&&(u.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),B=new y.Fragment(E,A),B.relurl=Ie.relurl,B.level=m,B.sn="initSegment",Le.initSegment=B,D.needSidxRanges=!0))}else D.endSN=0,D.startCC=0;return D.fragmentHint&&(w+=D.fragmentHint.duration),D.totalduration=w,D.endCC=F,N>0&&a(I,N),D},s}();function i(s,g){["video","audio","text"].forEach(function(L){var A=s.filter(function(E){return Object(n.isCodecType)(E,L)});if(A.length){var m=A.filter(function(E){return E.lastIndexOf("avc1",0)===0||E.lastIndexOf("mp4a",0)===0});g[L+"Codec"]=m.length>0?m[0]:A[0],s=s.filter(function(E){return A.indexOf(E)===-1})}}),g.unknownCodecs=s}function e(s,g,L){var A=g[L];A&&(s[L]=A)}function a(s,g){for(var L=s[g],A=g;A--;){var m=s[A];if(!m)return;m.programDateTime=L.programDateTime-m.duration*1e3,L=m}}function o(s,g){s.rawProgramDateTime?s.programDateTime=Date.parse(s.rawProgramDateTime):g!=null&&g.programDateTime&&(s.programDateTime=g.endProgramDateTime),Object(S.isFiniteNumber)(s.programDateTime)||(s.programDateTime=null,s.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(O,C,_){_.r(C);var S=_("./src/polyfills/number.ts"),c=_("./src/events.ts"),y=_("./src/errors.ts"),M=_("./src/utils/logger.ts"),T=_("./src/utils/mp4-tools.ts"),p=_("./src/loader/m3u8-parser.ts"),u=_("./src/types/loader.ts"),n=_("./src/utils/attr-list.ts");function f(v){var d=v.type;switch(d){case u.PlaylistContextType.AUDIO_TRACK:return u.PlaylistLevelType.AUDIO;case u.PlaylistContextType.SUBTITLE_TRACK:return u.PlaylistLevelType.SUBTITLE;default:return u.PlaylistLevelType.MAIN}}function l(v,d){var r=v.url;return(r===void 0||r.indexOf("data:")===0)&&(r=d.url),r}var h=function(){function v(r){this.hls=void 0,this.loaders=Object.create(null),this.hls=r,this.registerListeners()}var d=v.prototype;return d.registerListeners=function(){var t=this.hls;t.on(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(c.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(c.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(c.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},d.unregisterListeners=function(){var t=this.hls;t.off(c.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(c.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(c.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(c.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},d.createInternalLoader=function(t){var i=this.hls.config,e=i.pLoader,a=i.loader,o=e||a,s=new o(i);return t.loader=s,this.loaders[t.type]=s,s},d.getInternalLoader=function(t){return this.loaders[t.type]},d.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},d.destroyInternalLoaders=function(){for(var t in this.loaders){var i=this.loaders[t];i&&i.destroy(),this.resetInternalLoader(t)}},d.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},d.onManifestLoading=function(t,i){var e=i.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:u.PlaylistContextType.MANIFEST,url:e,deliveryDirectives:null})},d.onLevelLoading=function(t,i){var e=i.id,a=i.level,o=i.url,s=i.deliveryDirectives;this.load({id:e,groupId:null,level:a,responseType:"text",type:u.PlaylistContextType.LEVEL,url:o,deliveryDirectives:s})},d.onAudioTrackLoading=function(t,i){var e=i.id,a=i.groupId,o=i.url,s=i.deliveryDirectives;this.load({id:e,groupId:a,level:null,responseType:"text",type:u.PlaylistContextType.AUDIO_TRACK,url:o,deliveryDirectives:s})},d.onSubtitleTrackLoading=function(t,i){var e=i.id,a=i.groupId,o=i.url,s=i.deliveryDirectives;this.load({id:e,groupId:a,level:null,responseType:"text",type:u.PlaylistContextType.SUBTITLE_TRACK,url:o,deliveryDirectives:s})},d.load=function(t){var i,e=this.hls.config,a=this.getInternalLoader(t);if(a){var o=a.context;if(o&&o.url===t.url){M.logger.trace("[playlist-loader]: playlist request ongoing");return}M.logger.log("[playlist-loader]: aborting previous loader for type: "+t.type),a.abort()}var s,g,L,A;switch(t.type){case u.PlaylistContextType.MANIFEST:s=e.manifestLoadingMaxRetry,g=e.manifestLoadingTimeOut,L=e.manifestLoadingRetryDelay,A=e.manifestLoadingMaxRetryTimeout;break;case u.PlaylistContextType.LEVEL:case u.PlaylistContextType.AUDIO_TRACK:case u.PlaylistContextType.SUBTITLE_TRACK:s=0,g=e.levelLoadingTimeOut;break;default:s=e.levelLoadingMaxRetry,g=e.levelLoadingTimeOut,L=e.levelLoadingRetryDelay,A=e.levelLoadingMaxRetryTimeout;break}if(a=this.createInternalLoader(t),(i=t.deliveryDirectives)!==null&&i!==void 0&&i.part){var m;if(t.type===u.PlaylistContextType.LEVEL&&t.level!==null?m=this.hls.levels[t.level].details:t.type===u.PlaylistContextType.AUDIO_TRACK&&t.id!==null?m=this.hls.audioTracks[t.id].details:t.type===u.PlaylistContextType.SUBTITLE_TRACK&&t.id!==null&&(m=this.hls.subtitleTracks[t.id].details),m){var E=m.partTarget,x=m.targetduration;E&&x&&(g=Math.min(Math.max(E*3,x*.8)*1e3,g))}}var D={timeout:g,maxRetry:s,retryDelay:L,maxRetryDelay:A,highWaterMark:0},I={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};a.load(t,D,I)},d.loadsuccess=function(t,i,e,a){if(a===void 0&&(a=null),e.isSidxRequest){this.handleSidxRequest(t,e),this.handlePlaylistLoaded(t,i,e,a);return}this.resetInternalLoader(e.type);var o=t.data;if(o.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(t,e,"no EXTM3U delimiter",a);return}i.parsing.start=performance.now(),o.indexOf("#EXTINF:")>0||o.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,i,e,a):this.handleMasterPlaylist(t,i,e,a)},d.loaderror=function(t,i,e){e===void 0&&(e=null),this.handleNetworkError(i,e,!1,t)},d.loadtimeout=function(t,i,e){e===void 0&&(e=null),this.handleNetworkError(i,e,!0)},d.handleMasterPlaylist=function(t,i,e,a){var o=this.hls,s=t.data,g=l(t,e),L=p.default.parseMasterPlaylist(s,g),A=L.levels,m=L.sessionData;if(!A.length){this.handleManifestParsingError(t,e,"no level found in manifest",a);return}var E=A.map(function(P){return{id:P.attrs.AUDIO,audioCodec:P.audioCodec}}),x=A.map(function(P){return{id:P.attrs.SUBTITLES,textCodec:P.textCodec}}),D=p.default.parseMasterPlaylistMedia(s,g,"AUDIO",E),I=p.default.parseMasterPlaylistMedia(s,g,"SUBTITLES",x),b=p.default.parseMasterPlaylistMedia(s,g,"CLOSED-CAPTIONS");if(D.length){var R=D.some(function(P){return!P.url});!R&&A[0].audioCodec&&!A[0].attrs.AUDIO&&(M.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),D.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new n.AttrList({}),bitrate:0,url:""}))}o.trigger(c.Events.MANIFEST_LOADED,{levels:A,audioTracks:D,subtitles:I,captions:b,url:g,stats:i,networkDetails:a,sessionData:m})},d.handleTrackOrLevelPlaylist=function(t,i,e,a){var o=this.hls,s=e.id,g=e.level,L=e.type,A=l(t,e),m=Object(S.isFiniteNumber)(s)?s:0,E=Object(S.isFiniteNumber)(g)?g:m,x=f(e),D=p.default.parseLevelPlaylist(t.data,A,E,x,m);if(!D.fragments.length){o.trigger(c.Events.ERROR,{type:y.ErrorTypes.NETWORK_ERROR,details:y.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:A,reason:"no fragments found in level",level:typeof e.level=="number"?e.level:void 0});return}if(L===u.PlaylistContextType.MANIFEST){var I={attrs:new n.AttrList({}),bitrate:0,details:D,name:"",url:A};o.trigger(c.Events.MANIFEST_LOADED,{levels:[I],audioTracks:[],url:A,stats:i,networkDetails:a,sessionData:null})}if(i.parsing.end=performance.now(),D.needSidxRanges){var b,R=(b=D.fragments[0].initSegment)===null||b===void 0?void 0:b.url;this.load({url:R,isSidxRequest:!0,type:L,level:g,levelDetails:D,id:s,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}e.levelDetails=D,this.handlePlaylistLoaded(t,i,e,a)},d.handleSidxRequest=function(t,i){var e=Object(T.parseSegmentIndex)(new Uint8Array(t.data));if(!!e){var a=e.references,o=i.levelDetails;a.forEach(function(s,g){var L=s.info,A=o.fragments[g];A.byteRange.length===0&&A.setByteRange(String(1+L.end-L.start)+"@"+String(L.start)),A.initSegment&&A.initSegment.setByteRange(String(e.moovEndOffset)+"@0")})}},d.handleManifestParsingError=function(t,i,e,a){this.hls.trigger(c.Events.ERROR,{type:y.ErrorTypes.NETWORK_ERROR,details:y.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:i.type===u.PlaylistContextType.MANIFEST,url:t.url,reason:e,response:t,context:i,networkDetails:a})},d.handleNetworkError=function(t,i,e,a){e===void 0&&(e=!1),M.logger.warn("[playlist-loader]: A network "+(e?"timeout":"error")+" occurred while loading "+t.type+" level: "+t.level+" id: "+t.id+' group-id: "'+t.groupId+'"');var o=y.ErrorDetails.UNKNOWN,s=!1,g=this.getInternalLoader(t);switch(t.type){case u.PlaylistContextType.MANIFEST:o=e?y.ErrorDetails.MANIFEST_LOAD_TIMEOUT:y.ErrorDetails.MANIFEST_LOAD_ERROR,s=!0;break;case u.PlaylistContextType.LEVEL:o=e?y.ErrorDetails.LEVEL_LOAD_TIMEOUT:y.ErrorDetails.LEVEL_LOAD_ERROR,s=!1;break;case u.PlaylistContextType.AUDIO_TRACK:o=e?y.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:y.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,s=!1;break;case u.PlaylistContextType.SUBTITLE_TRACK:o=e?y.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:y.ErrorDetails.SUBTITLE_LOAD_ERROR,s=!1;break}g&&this.resetInternalLoader(t.type);var L={type:y.ErrorTypes.NETWORK_ERROR,details:o,fatal:s,url:t.url,loader:g,context:t,networkDetails:i};a&&(L.response=a),this.hls.trigger(c.Events.ERROR,L)},d.handlePlaylistLoaded=function(t,i,e,a){var o=e.type,s=e.level,g=e.id,L=e.groupId,A=e.loader,m=e.levelDetails,E=e.deliveryDirectives;if(!(m!=null&&m.targetduration)){this.handleManifestParsingError(t,e,"invalid target duration",a);return}if(!!A)switch(m.live&&(A.getCacheAge&&(m.ageHeader=A.getCacheAge()||0),(!A.getCacheAge||isNaN(m.ageHeader))&&(m.ageHeader=0)),o){case u.PlaylistContextType.MANIFEST:case u.PlaylistContextType.LEVEL:this.hls.trigger(c.Events.LEVEL_LOADED,{details:m,level:s||0,id:g||0,stats:i,networkDetails:a,deliveryDirectives:E});break;case u.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(c.Events.AUDIO_TRACK_LOADED,{details:m,id:g||0,groupId:L||"",stats:i,networkDetails:a,deliveryDirectives:E});break;case u.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(c.Events.SUBTITLE_TRACK_LOADED,{details:m,id:g||0,groupId:L||"",stats:i,networkDetails:a,deliveryDirectives:E});break}},v}();C.default=h},"./src/polyfills/number.ts":function(O,C,_){_.r(C),_.d(C,"isFiniteNumber",function(){return S}),_.d(C,"MAX_SAFE_INTEGER",function(){return c});var S=Number.isFinite||function(y){return typeof y=="number"&&isFinite(y)},c=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(O,C,_){_.r(C);var S=function(){function c(){}return c.getSilentFrame=function(M,T){switch(M){case"mp4a.40.2":if(T===1)return new Uint8Array([0,200,0,128,35,128]);if(T===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(T===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(T===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(T===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(T===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(T===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(T===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(T===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},c}();C.default=S},"./src/remux/mp4-generator.ts":function(O,C,_){_.r(C);var S=Math.pow(2,32)-1,c=function(){function y(){}return y.init=function(){y.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var T;for(T in y.types)y.types.hasOwnProperty(T)&&(y.types[T]=[T.charCodeAt(0),T.charCodeAt(1),T.charCodeAt(2),T.charCodeAt(3)]);var p=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),u=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);y.HDLR_TYPES={video:p,audio:u};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),f=new Uint8Array([0,0,0,0,0,0,0,0]);y.STTS=y.STSC=y.STCO=f,y.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),y.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),y.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),y.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var l=new Uint8Array([105,115,111,109]),h=new Uint8Array([97,118,99,49]),v=new Uint8Array([0,0,0,1]);y.FTYP=y.box(y.types.ftyp,l,v,l,h),y.DINF=y.box(y.types.dinf,y.box(y.types.dref,n))},y.box=function(T){for(var p=8,u=arguments.length,n=new Array(u>1?u-1:0),f=1;f<u;f++)n[f-1]=arguments[f];for(var l=n.length,h=l;l--;)p+=n[l].byteLength;var v=new Uint8Array(p);for(v[0]=p>>24&255,v[1]=p>>16&255,v[2]=p>>8&255,v[3]=p&255,v.set(T,4),l=0,p=8;l<h;l++)v.set(n[l],p),p+=n[l].byteLength;return v},y.hdlr=function(T){return y.box(y.types.hdlr,y.HDLR_TYPES[T])},y.mdat=function(T){return y.box(y.types.mdat,T)},y.mdhd=function(T,p){p*=T;var u=Math.floor(p/(S+1)),n=Math.floor(p%(S+1));return y.box(y.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,T>>24&255,T>>16&255,T>>8&255,T&255,u>>24,u>>16&255,u>>8&255,u&255,n>>24,n>>16&255,n>>8&255,n&255,85,196,0,0]))},y.mdia=function(T){return y.box(y.types.mdia,y.mdhd(T.timescale,T.duration),y.hdlr(T.type),y.minf(T))},y.mfhd=function(T){return y.box(y.types.mfhd,new Uint8Array([0,0,0,0,T>>24,T>>16&255,T>>8&255,T&255]))},y.minf=function(T){return T.type==="audio"?y.box(y.types.minf,y.box(y.types.smhd,y.SMHD),y.DINF,y.stbl(T)):y.box(y.types.minf,y.box(y.types.vmhd,y.VMHD),y.DINF,y.stbl(T))},y.moof=function(T,p,u){return y.box(y.types.moof,y.mfhd(T),y.traf(u,p))},y.moov=function(T){for(var p=T.length,u=[];p--;)u[p]=y.trak(T[p]);return y.box.apply(null,[y.types.moov,y.mvhd(T[0].timescale,T[0].duration)].concat(u).concat(y.mvex(T)))},y.mvex=function(T){for(var p=T.length,u=[];p--;)u[p]=y.trex(T[p]);return y.box.apply(null,[y.types.mvex].concat(u))},y.mvhd=function(T,p){p*=T;var u=Math.floor(p/(S+1)),n=Math.floor(p%(S+1)),f=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,T>>24&255,T>>16&255,T>>8&255,T&255,u>>24,u>>16&255,u>>8&255,u&255,n>>24,n>>16&255,n>>8&255,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return y.box(y.types.mvhd,f)},y.sdtp=function(T){var p=T.samples||[],u=new Uint8Array(4+p.length),n,f;for(n=0;n<p.length;n++)f=p[n].flags,u[n+4]=f.dependsOn<<4|f.isDependedOn<<2|f.hasRedundancy;return y.box(y.types.sdtp,u)},y.stbl=function(T){return y.box(y.types.stbl,y.stsd(T),y.box(y.types.stts,y.STTS),y.box(y.types.stsc,y.STSC),y.box(y.types.stsz,y.STSZ),y.box(y.types.stco,y.STCO))},y.avc1=function(T){var p=[],u=[],n,f,l;for(n=0;n<T.sps.length;n++)f=T.sps[n],l=f.byteLength,p.push(l>>>8&255),p.push(l&255),p=p.concat(Array.prototype.slice.call(f));for(n=0;n<T.pps.length;n++)f=T.pps[n],l=f.byteLength,u.push(l>>>8&255),u.push(l&255),u=u.concat(Array.prototype.slice.call(f));var h=y.box(y.types.avcC,new Uint8Array([1,p[3],p[4],p[5],255,224|T.sps.length].concat(p).concat([T.pps.length]).concat(u))),v=T.width,d=T.height,r=T.pixelRatio[0],t=T.pixelRatio[1];return y.box(y.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,v>>8&255,v&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h,y.box(y.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),y.box(y.types.pasp,new Uint8Array([r>>24,r>>16&255,r>>8&255,r&255,t>>24,t>>16&255,t>>8&255,t&255])))},y.esds=function(T){var p=T.config.length;return new Uint8Array([0,0,0,0,3,23+p,0,1,0,4,15+p,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([p]).concat(T.config).concat([6,1,2]))},y.mp4a=function(T){var p=T.samplerate;return y.box(y.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,T.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]),y.box(y.types.esds,y.esds(T)))},y.mp3=function(T){var p=T.samplerate;return y.box(y.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,T.channelCount,0,16,0,0,0,0,p>>8&255,p&255,0,0]))},y.stsd=function(T){return T.type==="audio"?!T.isAAC&&T.codec==="mp3"?y.box(y.types.stsd,y.STSD,y.mp3(T)):y.box(y.types.stsd,y.STSD,y.mp4a(T)):y.box(y.types.stsd,y.STSD,y.avc1(T))},y.tkhd=function(T){var p=T.id,u=T.duration*T.timescale,n=T.width,f=T.height,l=Math.floor(u/(S+1)),h=Math.floor(u%(S+1));return y.box(y.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,p>>24&255,p>>16&255,p>>8&255,p&255,0,0,0,0,l>>24,l>>16&255,l>>8&255,l&255,h>>24,h>>16&255,h>>8&255,h&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,n&255,0,0,f>>8&255,f&255,0,0]))},y.traf=function(T,p){var u=y.sdtp(T),n=T.id,f=Math.floor(p/(S+1)),l=Math.floor(p%(S+1));return y.box(y.types.traf,y.box(y.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,n&255])),y.box(y.types.tfdt,new Uint8Array([1,0,0,0,f>>24,f>>16&255,f>>8&255,f&255,l>>24,l>>16&255,l>>8&255,l&255])),y.trun(T,u.length+16+20+8+16+8+8),u)},y.trak=function(T){return T.duration=T.duration||4294967295,y.box(y.types.trak,y.tkhd(T),y.mdia(T))},y.trex=function(T){var p=T.id;return y.box(y.types.trex,new Uint8Array([0,0,0,0,p>>24,p>>16&255,p>>8&255,p&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},y.trun=function(T,p){var u=T.samples||[],n=u.length,f=12+16*n,l=new Uint8Array(f),h,v,d,r,t,i;for(p+=8+f,l.set([0,0,15,1,n>>>24&255,n>>>16&255,n>>>8&255,n&255,p>>>24&255,p>>>16&255,p>>>8&255,p&255],0),h=0;h<n;h++)v=u[h],d=v.duration,r=v.size,t=v.flags,i=v.cts,l.set([d>>>24&255,d>>>16&255,d>>>8&255,d&255,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t.isLeading<<2|t.dependsOn,t.isDependedOn<<6|t.hasRedundancy<<4|t.paddingValue<<1|t.isNonSync,t.degradPrio&240<<8,t.degradPrio&15,i>>>24&255,i>>>16&255,i>>>8&255,i&255],12+16*h);return y.box(y.types.trun,l)},y.initSegment=function(T){y.types||y.init();var p=y.moov(T),u=new Uint8Array(y.FTYP.byteLength+p.byteLength);return u.set(y.FTYP),u.set(p,y.FTYP.byteLength),u},y}();c.types=void 0,c.HDLR_TYPES=void 0,c.STTS=void 0,c.STSC=void 0,c.STCO=void 0,c.STSZ=void 0,c.VMHD=void 0,c.SMHD=void 0,c.STSD=void 0,c.FTYP=void 0,c.DINF=void 0,C.default=c},"./src/remux/mp4-remuxer.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return i}),_.d(C,"normalizePts",function(){return e});var S=_("./src/polyfills/number.ts"),c=_("./src/remux/aac-helper.ts"),y=_("./src/remux/mp4-generator.ts"),M=_("./src/events.ts"),T=_("./src/errors.ts"),p=_("./src/utils/logger.ts"),u=_("./src/types/loader.ts"),n=_("./src/utils/timescale-conversion.ts");function f(){return f=Object.assign||function(g){for(var L=1;L<arguments.length;L++){var A=arguments[L];for(var m in A)Object.prototype.hasOwnProperty.call(A,m)&&(g[m]=A[m])}return g},f.apply(this,arguments)}var l=10*1e3,h=1024,v=1152,d=null,r=null,t=!1,i=function(){function g(A,m,E,x){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=A,this.config=m,this.typeSupported=E,this.ISGenerated=!1,d===null){var D=navigator.userAgent||"",I=D.match(/Chrome\/(\d+)/i);d=I?parseInt(I[1]):0}if(r===null){var b=navigator.userAgent.match(/Safari\/(\d+)/i);r=b?parseInt(b[1]):0}t=!!d&&d<75||!!r&&r<600}var L=g.prototype;return L.destroy=function(){},L.resetTimeStamp=function(m){p.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=m},L.resetNextTimestamp=function(){p.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},L.resetInitSegment=function(){p.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},L.getVideoStartPts=function(m){var E=!1,x=m.reduce(function(D,I){var b=I.pts-D;return b<-4294967296?(E=!0,e(D,I.pts)):b>0?D:I.pts},m[0].pts);return E&&p.logger.debug("PTS rollover detected"),x},L.remux=function(m,E,x,D,I,b,R,P){var w,F,k,B,U,j,K=I,N=I,Z=m.pid>-1,$=E.pid>-1,Y=E.samples.length,ee=m.samples.length>0,Q=Y>1,G=(!Z||ee)&&(!$||Q)||this.ISGenerated||R;if(G){this.ISGenerated||(k=this.generateIS(m,E,I));var q=this.isVideoContiguous,te=-1;if(Q&&(te=a(E.samples),!q&&this.config.forceKeyFrameOnDiscontinuity))if(j=!0,te>0){p.logger.warn("[mp4-remuxer]: Dropped "+te+" out of "+Y+" video samples due to a missing keyframe");var ie=this.getVideoStartPts(E.samples);E.samples=E.samples.slice(te),E.dropped+=te,N+=(E.samples[0].pts-ie)/(E.timescale||9e4)}else te===-1&&(p.logger.warn("[mp4-remuxer]: No keyframe found out of "+Y+" video samples"),j=!1);if(this.ISGenerated){if(ee&&Q){var ne=this.getVideoStartPts(E.samples),le=e(m.samples[0].pts,ne)-ne,ae=le/E.inputTimeScale;K+=Math.max(0,ae),N+=Math.max(0,-ae)}if(ee){if(m.samplerate||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),k=this.generateIS(m,E,I)),F=this.remuxAudio(m,K,this.isAudioContiguous,b,$||Q||P===u.PlaylistLevelType.AUDIO?N:void 0),Q){var oe=F?F.endPTS-F.startPTS:0;E.inputTimeScale||(p.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),k=this.generateIS(m,E,I)),w=this.remuxVideo(E,N,q,oe)}}else Q&&(w=this.remuxVideo(E,N,q,0));w&&(w.firstKeyFrame=te,w.independent=te!==-1)}}return this.ISGenerated&&(x.samples.length&&(U=this.remuxID3(x,I)),D.samples.length&&(B=this.remuxText(D,I))),{audio:F,video:w,initSegment:k,independent:j,text:B,id3:U}},L.generateIS=function(m,E,x){var D=m.samples,I=E.samples,b=this.typeSupported,R={},P=!Object(S.isFiniteNumber)(this._initPTS),w="audio/mp4",F,k,B;if(P&&(F=k=1/0),m.config&&D.length&&(m.timescale=m.samplerate,m.isAAC||(b.mpeg?(w="audio/mpeg",m.codec=""):b.mp3&&(m.codec="mp3")),R.audio={id:"audio",container:w,codec:m.codec,initSegment:!m.isAAC&&b.mpeg?new Uint8Array(0):y.default.initSegment([m]),metadata:{channelCount:m.channelCount}},P&&(B=m.inputTimeScale,F=k=D[0].pts-Math.round(B*x))),E.sps&&E.pps&&I.length&&(E.timescale=E.inputTimeScale,R.video={id:"main",container:"video/mp4",codec:E.codec,initSegment:y.default.initSegment([E]),metadata:{width:E.width,height:E.height}},P)){B=E.inputTimeScale;var U=this.getVideoStartPts(I),j=Math.round(B*x);k=Math.min(k,e(I[0].dts,U)-j),F=Math.min(F,U-j)}if(Object.keys(R).length)return this.ISGenerated=!0,P&&(this._initPTS=F,this._initDTS=k),{tracks:R,initPTS:F,timescale:B}},L.remuxVideo=function(m,E,x,D){var I=m.inputTimeScale,b=m.samples,R=[],P=b.length,w=this._initPTS,F=this.nextAvcDts,k=8,B,U,j,K=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY,Z=0,$=!1;if(!x||F===null){var Y=E*I,ee=b[0].pts-e(b[0].dts,b[0].pts);F=Y-ee}for(var Q=0;Q<P;Q++){var G=b[Q];if(G.pts=e(G.pts-w,F),G.dts=e(G.dts-w,F),G.dts>G.pts){var q=18e3;Z=Math.max(Math.min(Z,G.pts-G.dts),-1*q)}G.dts<b[Q>0?Q-1:Q].dts&&($=!0)}$&&b.sort(function(je,ze){var at=je.dts-ze.dts,st=je.pts-ze.pts;return at||st}),U=b[0].dts,j=b[b.length-1].dts;var te=Math.round((j-U)/(P-1));if(Z<0){if(Z<te*-2){p.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(n.toMsFromMpegTsClock)(-te,!0)+" ms");for(var ie=Z,ne=0;ne<P;ne++)b[ne].dts=ie=Math.max(ie,b[ne].pts-te),b[ne].pts=Math.max(ie,b[ne].pts)}else{p.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(n.toMsFromMpegTsClock)(Z,!0)+" ms to overcome this issue");for(var le=0;le<P;le++)b[le].dts=b[le].dts+Z}U=b[0].dts}if(x){var ae=U-F,oe=ae>te,J=ae<-1;if(oe||J){oe?p.logger.warn("AVC: "+Object(n.toMsFromMpegTsClock)(ae,!0)+" ms ("+ae+"dts) hole between fragments detected, filling it"):p.logger.warn("AVC: "+Object(n.toMsFromMpegTsClock)(-ae,!0)+" ms ("+ae+"dts) overlapping between fragments detected"),U=F;var se=b[0].pts-ae;b[0].dts=U,b[0].pts=se,p.logger.log("Video: First PTS/DTS adjusted: "+Object(n.toMsFromMpegTsClock)(se,!0)+"/"+Object(n.toMsFromMpegTsClock)(U,!0)+", delta: "+Object(n.toMsFromMpegTsClock)(ae,!0)+" ms")}}t&&(U=Math.max(0,U));for(var fe=0,de=0,ge=0;ge<P;ge++){for(var ue=b[ge],De=ue.units,pe=De.length,Te=0,W=0;W<pe;W++)Te+=De[W].data.length;de+=Te,fe+=pe,ue.length=Te,ue.dts=Math.max(ue.dts,U),ue.pts=Math.max(ue.pts,ue.dts,0),K=Math.min(ue.pts,K),N=Math.max(ue.pts,N)}j=b[P-1].dts;var z=de+4*fe+8,V;try{V=new Uint8Array(z)}catch(je){this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:T.ErrorTypes.MUX_ERROR,details:T.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:z,reason:"fail allocating video mdat "+z});return}var X=new DataView(V.buffer);X.setUint32(0,z),V.set(y.default.types.mdat,4);for(var H=0;H<P;H++){for(var re=b[H],ce=re.units,_e=0,Se=0,Me=ce.length;Se<Me;Se++){var Le=ce[Se],Ie=Le.data,Pe=Le.data.byteLength;X.setUint32(k,Pe),k+=4,V.set(Ie,k),k+=Pe,_e+=4+Pe}if(H<P-1)B=b[H+1].dts-re.dts;else{var we=this.config,Fe=re.dts-b[H>0?H-1:H].dts;if(we.stretchShortVideoTrack&&this.nextAudioPts!==null){var et=Math.floor(we.maxBufferHole*I),Ue=(D?K+D*I:this.nextAudioPts)-re.pts;Ue>et?(B=Ue-Fe,B<0&&(B=Fe),p.logger.log("[mp4-remuxer]: It is approximately "+Ue/90+" ms to the next segment; using duration "+B/90+" ms for the last video frame.")):B=Fe}else B=Fe}var tt=Math.round(re.pts-re.dts);R.push(new o(re.key,B,_e,tt))}if(R.length&&d&&d<70){var Ge=R[0].flags;Ge.dependsOn=2,Ge.isNonSync=0}console.assert(B!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=F=j+B,this.isVideoContiguous=!0;var rt=y.default.moof(m.sequenceNumber++,U,f({},m,{samples:R})),it="video",nt={data1:rt,data2:V,startPTS:K/I,endPTS:(N+B)/I,startDTS:U/I,endDTS:F/I,type:it,hasAudio:!1,hasVideo:!0,nb:R.length,dropped:m.dropped};return m.samples=[],m.dropped=0,console.assert(V.length,"MDAT length must not be zero"),nt},L.remuxAudio=function(m,E,x,D,I){var b=m.inputTimeScale,R=m.samplerate?m.samplerate:b,P=b/R,w=m.isAAC?h:v,F=w*P,k=this._initPTS,B=!m.isAAC&&this.typeSupported.mpeg,U=[],j=m.samples,K=B?0:8,N=this.nextAudioPts||-1,Z=E*b;if(this.isAudioContiguous=x=x||j.length&&N>0&&(D&&Math.abs(Z-N)<9e3||Math.abs(e(j[0].pts-k,Z)-N)<20*F),j.forEach(function(Ie){Ie.pts=e(Ie.pts-k,Z)}),!x||N<0){if(j=j.filter(function(Ie){return Ie.pts>=0}),!j.length)return;I===0?N=0:D?N=Math.max(0,Z):N=j[0].pts}if(m.isAAC)for(var $=I!==void 0,Y=this.config.maxAudioFramesDrift,ee=0,Q=N;ee<j.length;ee++){var G=j[ee],q=G.pts,te=q-Q,ie=Math.abs(1e3*te/b);if(te<=-Y*F&&$)ee===0&&(p.logger.warn("Audio frame @ "+(q/b).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*te/b)+" ms."),this.nextAudioPts=N=Q=q);else if(te>=Y*F&&ie<l&&$){var ne=Math.round(te/F);Q=q-ne*F,Q<0&&(ne--,Q+=F),ee===0&&(this.nextAudioPts=N=Q),p.logger.warn("[mp4-remuxer]: Injecting "+ne+" audio frame @ "+(Q/b).toFixed(3)+"s due to "+Math.round(1e3*te/b)+" ms gap.");for(var le=0;le<ne;le++){var ae=Math.max(Q,0),oe=c.default.getSilentFrame(m.manifestCodec||m.codec,m.channelCount);oe||(p.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),oe=G.unit.subarray()),j.splice(ee,0,{unit:oe,pts:ae}),Q+=F,ee++}}G.pts=Q,Q+=F}for(var J=null,se=null,fe,de=0,ge=j.length;ge--;)de+=j[ge].unit.byteLength;for(var ue=0,De=j.length;ue<De;ue++){var pe=j[ue],Te=pe.unit,W=pe.pts;if(se!==null){var z=U[ue-1];z.duration=Math.round((W-se)/P)}else if(x&&m.isAAC&&(W=N),J=W,de>0){de+=K;try{fe=new Uint8Array(de)}catch(Ie){this.observer.emit(M.Events.ERROR,M.Events.ERROR,{type:T.ErrorTypes.MUX_ERROR,details:T.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:de,reason:"fail allocating audio mdat "+de});return}if(!B){var V=new DataView(fe.buffer);V.setUint32(0,de),fe.set(y.default.types.mdat,4)}}else return;fe.set(Te,K);var X=Te.byteLength;K+=X,U.push(new o(!0,w,X,0)),se=W}var H=U.length;if(!!H){var re=U[U.length-1];this.nextAudioPts=N=se+P*re.duration;var ce=B?new Uint8Array(0):y.default.moof(m.sequenceNumber++,J/P,f({},m,{samples:U}));m.samples=[];var _e=J/b,Se=N/b,Me="audio",Le={data1:ce,data2:fe,startPTS:_e,endPTS:Se,startDTS:_e,endDTS:Se,type:Me,hasAudio:!0,hasVideo:!1,nb:H};return this.isAudioContiguous=!0,console.assert(fe.length,"MDAT length must not be zero"),Le}},L.remuxEmptyAudio=function(m,E,x,D){var I=m.inputTimeScale,b=m.samplerate?m.samplerate:I,R=I/b,P=this.nextAudioPts,w=(P!==null?P:D.startDTS*I)+this._initDTS,F=D.endDTS*I+this._initDTS,k=R*h,B=Math.ceil((F-w)/k),U=c.default.getSilentFrame(m.manifestCodec||m.codec,m.channelCount);if(p.logger.warn("[mp4-remuxer]: remux empty Audio"),!U){p.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var j=[],K=0;K<B;K++){var N=w+K*k;j.push({unit:U,pts:N,dts:N})}return m.samples=j,this.remuxAudio(m,E,x,!1)},L.remuxID3=function(m,E){var x=m.samples.length;if(!!x){for(var D=m.inputTimeScale,I=this._initPTS,b=this._initDTS,R=0;R<x;R++){var P=m.samples[R];P.pts=e(P.pts-I,E*D)/D,P.dts=e(P.dts-b,E*D)/D}var w=m.samples;return m.samples=[],{samples:w}}},L.remuxText=function(m,E){var x=m.samples.length;if(!!x){for(var D=m.inputTimeScale,I=this._initPTS,b=0;b<x;b++){var R=m.samples[b];R.pts=e(R.pts-I,E*D)/D}m.samples.sort(function(w,F){return w.pts-F.pts});var P=m.samples;return m.samples=[],{samples:P}}},g}();function e(g,L){var A;if(L===null)return g;for(L<g?A=-8589934592:A=8589934592;Math.abs(g-L)>4294967296;)g+=A;return g}function a(g){for(var L=0;L<g.length;L++)if(g[L].key)return L;return-1}var o=function(L,A,m,E){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=A,this.size=m,this.cts=E,this.flags=new s(L)},s=function(L){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=L?2:1,this.isNonSync=L?0:1}},"./src/remux/passthrough-remuxer.ts":function(O,C,_){_.r(C);var S=_("./src/polyfills/number.ts"),c=_("./src/utils/mp4-tools.ts"),y=_("./src/loader/fragment.ts"),M=_("./src/utils/logger.ts"),T=function(){function n(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var f=n.prototype;return f.destroy=function(){},f.resetTimeStamp=function(h){this.initPTS=h,this.lastEndDTS=null},f.resetNextTimestamp=function(){this.lastEndDTS=null},f.resetInitSegment=function(h,v,d){this.audioCodec=v,this.videoCodec=d,this.generateInitSegment(h),this.emitInitSegment=!0},f.generateInitSegment=function(h){var v=this.audioCodec,d=this.videoCodec;if(!h||!h.byteLength){this.initTracks=void 0,this.initData=void 0;return}var r=this.initData=Object(c.parseInitSegment)(h);v||(v=u(r.audio,y.ElementaryStreamTypes.AUDIO)),d||(d=u(r.video,y.ElementaryStreamTypes.VIDEO));var t={};r.audio&&r.video?t.audiovideo={container:"video/mp4",codec:v+","+d,initSegment:h,id:"main"}:r.audio?t.audio={container:"audio/mp4",codec:v,initSegment:h,id:"audio"}:r.video?t.video={container:"video/mp4",codec:d,initSegment:h,id:"main"}:M.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=t},f.remux=function(h,v,d,r,t){var i=this.initPTS,e=this.lastEndDTS,a={audio:void 0,video:void 0,text:r,id3:d,initSegment:void 0};Object(S.isFiniteNumber)(e)||(e=this.lastEndDTS=t||0);var o=v.samples;if(!o||!o.length)return a;var s={initPTS:void 0,timescale:1},g=this.initData;if((!g||!g.length)&&(this.generateInitSegment(o),g=this.initData),!g||!g.length)return M.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),a;this.emitInitSegment&&(s.tracks=this.initTracks,this.emitInitSegment=!1),Object(S.isFiniteNumber)(i)||(this.initPTS=s.initPTS=i=p(g,o,e));var L=Object(c.getDuration)(o,g),A=e,m=L+A;Object(c.offsetStartDTS)(g,o,i),L>0?this.lastEndDTS=m:(M.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var E=!!g.audio,x=!!g.video,D="";E&&(D+="audio"),x&&(D+="video");var I={data1:o,startPTS:A,startDTS:A,endPTS:m,endDTS:m,type:D,hasAudio:E,hasVideo:x,nb:1,dropped:0};return a.audio=I.type==="audio"?I:void 0,a.video=I.type!=="audio"?I:void 0,a.text=r,a.id3=d,a.initSegment=s,a},n}(),p=function(f,l,h){return Object(c.getStartDTS)(f,l)-h};function u(n,f){var l=n==null?void 0:n.codec;return l&&l.length>4?l:l==="hvc1"?"hvc1.1.c.L120.90":l==="av01"?"av01.0.04M.08":l==="avc1"||f===y.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}C.default=T},"./src/task-loop.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return S});var S=function(){function c(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var y=c.prototype;return y.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},y.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},y.onHandlerDestroyed=function(){},y.hasInterval=function(){return!!this._tickInterval},y.hasNextTick=function(){return!!this._tickTimer},y.setInterval=function(T){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,T),!0)},y.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},y.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},y.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},y.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},y.doTick=function(){},c}()},"./src/types/cmcd.ts":function(O,C,_){_.r(C),_.d(C,"CMCDVersion",function(){return S}),_.d(C,"CMCDObjectType",function(){return c}),_.d(C,"CMCDStreamingFormat",function(){return y}),_.d(C,"CMCDStreamType",function(){return M});var S=1,c;(function(T){T.MANIFEST="m",T.AUDIO="a",T.VIDEO="v",T.MUXED="av",T.INIT="i",T.CAPTION="c",T.TIMED_TEXT="tt",T.KEY="k",T.OTHER="o"})(c||(c={}));var y;(function(T){T.DASH="d",T.HLS="h",T.SMOOTH="s",T.OTHER="o"})(y||(y={}));var M;(function(T){T.VOD="v",T.LIVE="l"})(M||(M={}))},"./src/types/level.ts":function(O,C,_){_.r(C),_.d(C,"HlsSkip",function(){return y}),_.d(C,"getSkipValue",function(){return M}),_.d(C,"HlsUrlParameters",function(){return T}),_.d(C,"Level",function(){return p});function S(u,n){for(var f=0;f<n.length;f++){var l=n[f];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}function c(u,n,f){return n&&S(u.prototype,n),f&&S(u,f),u}var y;(function(u){u.No="",u.Yes="YES",u.v2="v2"})(y||(y={}));function M(u,n){var f=u.canSkipUntil,l=u.canSkipDateRanges,h=u.endSN,v=n!==void 0?n-h:0;return f&&v<f?l?y.v2:y.Yes:y.No}var T=function(){function u(f,l,h){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=f,this.part=l,this.skip=h}var n=u.prototype;return n.addDirectives=function(l){var h=new self.URL(l);return this.msn!==void 0&&h.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&h.searchParams.set("_HLS_part",this.part.toString()),this.skip&&h.searchParams.set("_HLS_skip",this.skip),h.toString()},u}(),p=function(){function u(n){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[n.url],this.attrs=n.attrs,this.bitrate=n.bitrate,n.details&&(this.details=n.details),this.id=n.id||0,this.name=n.name,this.width=n.width||0,this.height=n.height||0,this.audioCodec=n.audioCodec,this.videoCodec=n.videoCodec,this.unknownCodecs=n.unknownCodecs,this.codecSet=[n.videoCodec,n.audioCodec].filter(function(f){return f}).join(",").replace(/\.[^.,]+/g,"")}return c(u,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(f){var l=f%this.url.length;this._urlId!==l&&(this.details=void 0,this._urlId=l)}}]),u}()},"./src/types/loader.ts":function(O,C,_){_.r(C),_.d(C,"PlaylistContextType",function(){return S}),_.d(C,"PlaylistLevelType",function(){return c});var S;(function(y){y.MANIFEST="manifest",y.LEVEL="level",y.AUDIO_TRACK="audioTrack",y.SUBTITLE_TRACK="subtitleTrack"})(S||(S={}));var c;(function(y){y.MAIN="main",y.AUDIO="audio",y.SUBTITLE="subtitle"})(c||(c={}))},"./src/types/transmuxer.ts":function(O,C,_){_.r(C),_.d(C,"ChunkMetadata",function(){return S});var S=function(M,T,p,u,n,f){u===void 0&&(u=0),n===void 0&&(n=-1),f===void 0&&(f=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=c(),this.buffering={audio:c(),video:c(),audiovideo:c()},this.level=M,this.sn=T,this.id=p,this.size=u,this.part=n,this.partial=f};function c(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(O,C,_){_.r(C),_.d(C,"AttrList",function(){return y});var S=/^(\d+)x(\d+)$/,c=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,y=function(){function M(p){typeof p=="string"&&(p=M.parseAttrList(p));for(var u in p)p.hasOwnProperty(u)&&(this[u]=p[u])}var T=M.prototype;return T.decimalInteger=function(u){var n=parseInt(this[u],10);return n>Number.MAX_SAFE_INTEGER?1/0:n},T.hexadecimalInteger=function(u){if(this[u]){var n=(this[u]||"0x").slice(2);n=(n.length&1?"0":"")+n;for(var f=new Uint8Array(n.length/2),l=0;l<n.length/2;l++)f[l]=parseInt(n.slice(l*2,l*2+2),16);return f}else return null},T.hexadecimalIntegerAsNumber=function(u){var n=parseInt(this[u],16);return n>Number.MAX_SAFE_INTEGER?1/0:n},T.decimalFloatingPoint=function(u){return parseFloat(this[u])},T.optionalFloat=function(u,n){var f=this[u];return f?parseFloat(f):n},T.enumeratedString=function(u){return this[u]},T.bool=function(u){return this[u]==="YES"},T.decimalResolution=function(u){var n=S.exec(this[u]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}},M.parseAttrList=function(u){var n,f={},l='"';for(c.lastIndex=0;(n=c.exec(u))!==null;){var h=n[2];h.indexOf(l)===0&&h.lastIndexOf(l)===h.length-1&&(h=h.slice(1,-1)),f[n[1]]=h}return f},M}()},"./src/utils/binary-search.ts":function(O,C,_){_.r(C);var S={search:function(y,M){for(var T=0,p=y.length-1,u=null,n=null;T<=p;){u=(T+p)/2|0,n=y[u];var f=M(n);if(f>0)T=u+1;else if(f<0)p=u-1;else return n}return null}};C.default=S},"./src/utils/buffer-helper.ts":function(O,C,_){_.r(C),_.d(C,"BufferHelper",function(){return y});var S=_("./src/utils/logger.ts"),c={length:0,start:function(){return 0},end:function(){return 0}},y=function(){function M(){}return M.isBuffered=function(p,u){try{if(p){for(var n=M.getBuffered(p),f=0;f<n.length;f++)if(u>=n.start(f)&&u<=n.end(f))return!0}}catch(l){}return!1},M.bufferInfo=function(p,u,n){try{if(p){var f=M.getBuffered(p),l=[],h;for(h=0;h<f.length;h++)l.push({start:f.start(h),end:f.end(h)});return this.bufferedInfo(l,u,n)}}catch(v){}return{len:0,start:u,end:u,nextStart:void 0}},M.bufferedInfo=function(p,u,n){u=Math.max(0,u),p.sort(function(s,g){var L=s.start-g.start;return L||g.end-s.end});var f=[];if(n)for(var l=0;l<p.length;l++){var h=f.length;if(h){var v=f[h-1].end;p[l].start-v<n?p[l].end>v&&(f[h-1].end=p[l].end):f.push(p[l])}else f.push(p[l])}else f=p;for(var d=0,r,t=u,i=u,e=0;e<f.length;e++){var a=f[e].start,o=f[e].end;if(u+n>=a&&u<o)t=a,i=o,d=i-u;else if(u+n<a){r=a;break}}return{len:d,start:t||0,end:i||0,nextStart:r}},M.getBuffered=function(p){try{return p.buffered}catch(u){return S.logger.log("failed to get media.buffered",u),c}},M}()},"./src/utils/cea-608-parser.ts":function(O,C,_){_.r(C),_.d(C,"Row",function(){return i}),_.d(C,"CaptionScreen",function(){return e});var S=_("./src/utils/logger.ts"),c={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},y=function(m){var E=m;return c.hasOwnProperty(m)&&(E=c[m]),String.fromCharCode(E)},M=15,T=100,p={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},u={17:2,18:4,21:6,22:8,23:10,19:13,20:15},n={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},f={25:2,26:4,29:6,30:8,31:10,27:13,28:15},l=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],h;(function(A){A[A.ERROR=0]="ERROR",A[A.TEXT=1]="TEXT",A[A.WARNING=2]="WARNING",A[A.INFO=2]="INFO",A[A.DEBUG=3]="DEBUG",A[A.DATA=3]="DATA"})(h||(h={}));var v=function(){function A(){this.time=null,this.verboseLevel=h.ERROR}var m=A.prototype;return m.log=function(x,D){this.verboseLevel>=x&&S.logger.log(this.time+" ["+x+"] "+D)},A}(),d=function(m){for(var E=[],x=0;x<m.length;x++)E.push(m[x].toString(16));return E},r=function(){function A(E,x,D,I,b){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=E||"white",this.underline=x||!1,this.italics=D||!1,this.background=I||"black",this.flash=b||!1}var m=A.prototype;return m.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},m.setStyles=function(x){for(var D=["foreground","underline","italics","background","flash"],I=0;I<D.length;I++){var b=D[I];x.hasOwnProperty(b)&&(this[b]=x[b])}},m.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},m.equals=function(x){return this.foreground===x.foreground&&this.underline===x.underline&&this.italics===x.italics&&this.background===x.background&&this.flash===x.flash},m.copy=function(x){this.foreground=x.foreground,this.underline=x.underline,this.italics=x.italics,this.background=x.background,this.flash=x.flash},m.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},A}(),t=function(){function A(E,x,D,I,b,R){this.uchar=void 0,this.penState=void 0,this.uchar=E||" ",this.penState=new r(x,D,I,b,R)}var m=A.prototype;return m.reset=function(){this.uchar=" ",this.penState.reset()},m.setChar=function(x,D){this.uchar=x,this.penState.copy(D)},m.setPenState=function(x){this.penState.copy(x)},m.equals=function(x){return this.uchar===x.uchar&&this.penState.equals(x.penState)},m.copy=function(x){this.uchar=x.uchar,this.penState.copy(x.penState)},m.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},A}(),i=function(){function A(E){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var x=0;x<T;x++)this.chars.push(new t);this.logger=E,this.pos=0,this.currPenState=new r}var m=A.prototype;return m.equals=function(x){for(var D=!0,I=0;I<T;I++)if(!this.chars[I].equals(x.chars[I])){D=!1;break}return D},m.copy=function(x){for(var D=0;D<T;D++)this.chars[D].copy(x.chars[D])},m.isEmpty=function(){for(var x=!0,D=0;D<T;D++)if(!this.chars[D].isEmpty()){x=!1;break}return x},m.setCursor=function(x){this.pos!==x&&(this.pos=x),this.pos<0?(this.logger.log(h.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>T&&(this.logger.log(h.DEBUG,"Too large cursor position "+this.pos),this.pos=T)},m.moveCursor=function(x){var D=this.pos+x;if(x>1)for(var I=this.pos+1;I<D+1;I++)this.chars[I].setPenState(this.currPenState);this.setCursor(D)},m.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},m.insertChar=function(x){x>=144&&this.backSpace();var D=y(x);if(this.pos>=T){this.logger.log(h.ERROR,"Cannot insert "+x.toString(16)+" ("+D+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(D,this.currPenState),this.moveCursor(1)},m.clearFromPos=function(x){var D;for(D=x;D<T;D++)this.chars[D].reset()},m.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},m.clearToEndOfRow=function(){this.clearFromPos(this.pos)},m.getTextString=function(){for(var x=[],D=!0,I=0;I<T;I++){var b=this.chars[I].uchar;b!==" "&&(D=!1),x.push(b)}return D?"":x.join("")},m.setPenStyles=function(x){this.currPenState.setStyles(x);var D=this.chars[this.pos];D.setPenState(this.currPenState)},A}(),e=function(){function A(E){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var x=0;x<M;x++)this.rows.push(new i(E));this.logger=E,this.currRow=M-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var m=A.prototype;return m.reset=function(){for(var x=0;x<M;x++)this.rows[x].clear();this.currRow=M-1},m.equals=function(x){for(var D=!0,I=0;I<M;I++)if(!this.rows[I].equals(x.rows[I])){D=!1;break}return D},m.copy=function(x){for(var D=0;D<M;D++)this.rows[D].copy(x.rows[D])},m.isEmpty=function(){for(var x=!0,D=0;D<M;D++)if(!this.rows[D].isEmpty()){x=!1;break}return x},m.backSpace=function(){var x=this.rows[this.currRow];x.backSpace()},m.clearToEndOfRow=function(){var x=this.rows[this.currRow];x.clearToEndOfRow()},m.insertChar=function(x){var D=this.rows[this.currRow];D.insertChar(x)},m.setPen=function(x){var D=this.rows[this.currRow];D.setPenStyles(x)},m.moveCursor=function(x){var D=this.rows[this.currRow];D.moveCursor(x)},m.setCursor=function(x){this.logger.log(h.INFO,"setCursor: "+x);var D=this.rows[this.currRow];D.setCursor(x)},m.setPAC=function(x){this.logger.log(h.INFO,"pacData = "+JSON.stringify(x));var D=x.row-1;if(this.nrRollUpRows&&D<this.nrRollUpRows-1&&(D=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==D){for(var I=0;I<M;I++)this.rows[I].clear();var b=this.currRow+1-this.nrRollUpRows,R=this.lastOutputScreen;if(R){var P=R.rows[b].cueStartTime,w=this.logger.time;if(P&&w!==null&&P<w)for(var F=0;F<this.nrRollUpRows;F++)this.rows[D-this.nrRollUpRows+F+1].copy(R.rows[b+F])}}this.currRow=D;var k=this.rows[this.currRow];if(x.indent!==null){var B=x.indent,U=Math.max(B-1,0);k.setCursor(x.indent),x.color=k.chars[U].penState.foreground}var j={foreground:x.color,underline:x.underline,italics:x.italics,background:"black",flash:!1};this.setPen(j)},m.setBkgData=function(x){this.logger.log(h.INFO,"bkgData = "+JSON.stringify(x)),this.backSpace(),this.setPen(x),this.insertChar(32)},m.setRollUpRows=function(x){this.nrRollUpRows=x},m.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(h.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(h.TEXT,this.getDisplayText());var x=this.currRow+1-this.nrRollUpRows,D=this.rows.splice(x,1)[0];D.clear(),this.rows.splice(this.currRow,0,D),this.logger.log(h.INFO,"Rolling up")},m.getDisplayText=function(x){x=x||!1;for(var D=[],I="",b=-1,R=0;R<M;R++){var P=this.rows[R].getTextString();P&&(b=R+1,x?D.push("Row "+b+": '"+P+"'"):D.push(P.trim()))}return D.length>0&&(x?I="["+D.join(" | ")+"]":I=D.join(`
`)),I},m.getTextAndFormat=function(){return this.rows},A}(),a=function(){function A(E,x,D){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=E,this.outputFilter=x,this.mode=null,this.verbose=0,this.displayedMemory=new e(D),this.nonDisplayedMemory=new e(D),this.lastOutputScreen=new e(D),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=D}var m=A.prototype;return m.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[M-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},m.getHandler=function(){return this.outputFilter},m.setHandler=function(x){this.outputFilter=x},m.setPAC=function(x){this.writeScreen.setPAC(x)},m.setBkgData=function(x){this.writeScreen.setBkgData(x)},m.setMode=function(x){x!==this.mode&&(this.mode=x,this.logger.log(h.INFO,"MODE="+x),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=x)},m.insertChars=function(x){for(var D=0;D<x.length;D++)this.writeScreen.insertChar(x[D]);var I=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(h.INFO,I+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(h.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},m.ccRCL=function(){this.logger.log(h.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},m.ccBS=function(){this.logger.log(h.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},m.ccAOF=function(){},m.ccAON=function(){},m.ccDER=function(){this.logger.log(h.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},m.ccRU=function(x){this.logger.log(h.INFO,"RU("+x+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(x)},m.ccFON=function(){this.logger.log(h.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},m.ccRDC=function(){this.logger.log(h.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},m.ccTR=function(){this.logger.log(h.INFO,"TR"),this.setMode("MODE_TEXT")},m.ccRTD=function(){this.logger.log(h.INFO,"RTD"),this.setMode("MODE_TEXT")},m.ccEDM=function(){this.logger.log(h.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},m.ccCR=function(){this.logger.log(h.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},m.ccENM=function(){this.logger.log(h.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},m.ccEOC=function(){if(this.logger.log(h.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var x=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=x,this.writeScreen=this.nonDisplayedMemory,this.logger.log(h.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},m.ccTO=function(x){this.logger.log(h.INFO,"TO("+x+") - Tab Offset"),this.writeScreen.moveCursor(x)},m.ccMIDROW=function(x){var D={flash:!1};if(D.underline=x%2===1,D.italics=x>=46,D.italics)D.foreground="white";else{var I=Math.floor(x/2)-16,b=["white","green","blue","cyan","red","yellow","magenta"];D.foreground=b[I]}this.logger.log(h.INFO,"MIDROW: "+JSON.stringify(D)),this.writeScreen.setPen(D)},m.outputDataUpdate=function(x){x===void 0&&(x=!1);var D=this.logger.time;D!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=D:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,D,this.lastOutputScreen),x&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:D),this.lastOutputScreen.copy(this.displayedMemory))},m.cueSplitAtTime=function(x){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,x,this.displayedMemory),this.cueStartTime=x))},A}(),o=function(){function A(E,x,D){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var I=new v;this.channels=[null,new a(E,x,I),new a(E+1,D,I)],this.cmdHistory=L(),this.logger=I}var m=A.prototype;return m.getHandler=function(x){return this.channels[x].getHandler()},m.setHandler=function(x,D){this.channels[x].setHandler(D)},m.addData=function(x,D){var I,b,R,P=!1;this.logger.time=x;for(var w=0;w<D.length;w+=2)if(b=D[w]&127,R=D[w+1]&127,!(b===0&&R===0)){if(this.logger.log(h.DATA,"["+d([D[w],D[w+1]])+"] -> ("+d([b,R])+")"),I=this.parseCmd(b,R),I||(I=this.parseMidrow(b,R)),I||(I=this.parsePAC(b,R)),I||(I=this.parseBackgroundAttributes(b,R)),!I&&(P=this.parseChars(b,R),P)){var F=this.currentChannel;if(F&&F>0){var k=this.channels[F];k.insertChars(P)}else this.logger.log(h.WARNING,"No channel found yet. TEXT-MODE?")}!I&&!P&&this.logger.log(h.WARNING,"Couldn't parse cleaned data "+d([b,R])+" orig: "+d([D[w],D[w+1]]))}},m.parseCmd=function(x,D){var I=this.cmdHistory,b=(x===20||x===28||x===21||x===29)&&D>=32&&D<=47,R=(x===23||x===31)&&D>=33&&D<=35;if(!(b||R))return!1;if(g(x,D,I))return s(null,null,I),this.logger.log(h.DEBUG,"Repeated command ("+d([x,D])+") is dropped"),!0;var P=x===20||x===21||x===23?1:2,w=this.channels[P];return x===20||x===21||x===28||x===29?D===32?w.ccRCL():D===33?w.ccBS():D===34?w.ccAOF():D===35?w.ccAON():D===36?w.ccDER():D===37?w.ccRU(2):D===38?w.ccRU(3):D===39?w.ccRU(4):D===40?w.ccFON():D===41?w.ccRDC():D===42?w.ccTR():D===43?w.ccRTD():D===44?w.ccEDM():D===45?w.ccCR():D===46?w.ccENM():D===47&&w.ccEOC():w.ccTO(D-32),s(x,D,I),this.currentChannel=P,!0},m.parseMidrow=function(x,D){var I=0;if((x===17||x===25)&&D>=32&&D<=47){if(x===17?I=1:I=2,I!==this.currentChannel)return this.logger.log(h.ERROR,"Mismatch channel in midrow parsing"),!1;var b=this.channels[I];return b?(b.ccMIDROW(D),this.logger.log(h.DEBUG,"MIDROW ("+d([x,D])+")"),!0):!1}return!1},m.parsePAC=function(x,D){var I,b=this.cmdHistory,R=(x>=17&&x<=23||x>=25&&x<=31)&&D>=64&&D<=127,P=(x===16||x===24)&&D>=64&&D<=95;if(!(R||P))return!1;if(g(x,D,b))return s(null,null,b),!0;var w=x<=23?1:2;D>=64&&D<=95?I=w===1?p[x]:n[x]:I=w===1?u[x]:f[x];var F=this.channels[w];return F?(F.setPAC(this.interpretPAC(I,D)),s(x,D,b),this.currentChannel=w,!0):!1},m.interpretPAC=function(x,D){var I,b={color:null,italics:!1,indent:null,underline:!1,row:x};return D>95?I=D-96:I=D-64,b.underline=(I&1)===1,I<=13?b.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(I/2)]:I<=15?(b.italics=!0,b.color="white"):b.indent=Math.floor((I-16)/2)*4,b},m.parseChars=function(x,D){var I,b=null,R=null;if(x>=25?(I=2,R=x-8):(I=1,R=x),R>=17&&R<=19){var P;R===17?P=D+80:R===18?P=D+112:P=D+144,this.logger.log(h.INFO,"Special char '"+y(P)+"' in channel "+I),b=[P]}else x>=32&&x<=127&&(b=D===0?[x]:[x,D]);if(b){var w=d(b);this.logger.log(h.DEBUG,"Char codes =  "+w.join(",")),s(x,D,this.cmdHistory)}return b},m.parseBackgroundAttributes=function(x,D){var I=(x===16||x===24)&&D>=32&&D<=47,b=(x===23||x===31)&&D>=45&&D<=47;if(!(I||b))return!1;var R,P={};x===16||x===24?(R=Math.floor((D-32)/2),P.background=l[R],D%2===1&&(P.background=P.background+"_semi")):D===45?P.background="transparent":(P.foreground="black",D===47&&(P.underline=!0));var w=x<=23?1:2,F=this.channels[w];return F.setBkgData(P),s(x,D,this.cmdHistory),!0},m.reset=function(){for(var x=0;x<Object.keys(this.channels).length;x++){var D=this.channels[x];D&&D.reset()}this.cmdHistory=L()},m.cueSplitAtTime=function(x){for(var D=0;D<this.channels.length;D++){var I=this.channels[D];I&&I.cueSplitAtTime(x)}},A}();function s(A,m,E){E.a=A,E.b=m}function g(A,m,E){return E.a===A&&E.b===m}function L(){return{a:null,b:null}}C.default=o},"./src/utils/codecs.ts":function(O,C,_){_.r(C),_.d(C,"isCodecType",function(){return c}),_.d(C,"isCodecSupportedInMp4",function(){return y});var S={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function c(M,T){var p=S[T];return!!p&&p[M.slice(0,4)]===!0}function y(M,T){return MediaSource.isTypeSupported((T||"video")+'/mp4;codecs="'+M+'"')}},"./src/utils/cues.ts":function(O,C,_){_.r(C);var S=_("./src/utils/vttparser.ts"),c=_("./src/utils/webvtt-parser.ts"),y=_("./src/utils/texttrack-utils.ts"),M=/\s/,T={newCue:function(u,n,f,l){for(var h=[],v,d,r,t,i,e=self.VTTCue||self.TextTrackCue,a=0;a<l.rows.length;a++)if(v=l.rows[a],r=!0,t=0,i="",!v.isEmpty()){for(var o=0;o<v.chars.length;o++)M.test(v.chars[o].uchar)&&r?t++:(i+=v.chars[o].uchar,r=!1);v.cueStartTime=n,n===f&&(f+=1e-4),t>=16?t--:t++;var s=Object(S.fixLineBreaks)(i.trim()),g=Object(c.generateCueId)(n,f,s);(!u||!u.cues||!u.cues.getCueById(g))&&(d=new e(n,f,s),d.id=g,d.line=a+1,d.align="left",d.position=10+Math.min(80,Math.floor(t*8/32)*10),h.push(d))}return u&&h.length&&(h.sort(function(L,A){return L.line==="auto"||A.line==="auto"?0:L.line>8&&A.line>8?A.line-L.line:L.line-A.line}),h.forEach(function(L){return Object(y.addCueToTrack)(u,L)})),h}};C.default=T},"./src/utils/discontinuities.ts":function(O,C,_){_.r(C),_.d(C,"findFirstFragWithCC",function(){return M}),_.d(C,"shouldAlignOnDiscontinuities",function(){return T}),_.d(C,"findDiscontinuousReferenceFrag",function(){return p}),_.d(C,"adjustSlidingStart",function(){return n}),_.d(C,"alignStream",function(){return f}),_.d(C,"alignPDT",function(){return h}),_.d(C,"alignFragmentByPDTDelta",function(){return v}),_.d(C,"alignMediaPlaylistByPDT",function(){return d});var S=_("./src/polyfills/number.ts"),c=_("./src/utils/logger.ts"),y=_("./src/controller/level-helper.ts");function M(r,t){for(var i=null,e=0,a=r.length;e<a;e++){var o=r[e];if(o&&o.cc===t){i=o;break}}return i}function T(r,t,i){return!!(t.details&&(i.endCC>i.startCC||r&&r.cc<i.startCC))}function p(r,t){var i=r.fragments,e=t.fragments;if(!e.length||!i.length){c.logger.log("No fragments to align");return}var a=M(i,e[0].cc);if(!a||a&&!a.startPTS){c.logger.log("No frag in previous level to align on");return}return a}function u(r,t){if(r){var i=r.start+t;r.start=r.startPTS=i,r.endPTS=i+r.duration}}function n(r,t){for(var i=t.fragments,e=0,a=i.length;e<a;e++)u(i[e],r);t.fragmentHint&&u(t.fragmentHint,r),t.alignedSliding=!0}function f(r,t,i){!t||(l(r,i,t),!i.alignedSliding&&t.details&&h(i,t.details),!i.alignedSliding&&t.details&&!i.skippedSegments&&Object(y.adjustSliding)(t.details,i))}function l(r,t,i){if(T(r,i,t)){var e=p(i.details,t);e&&Object(S.isFiniteNumber)(e.start)&&(c.logger.log("Adjusting PTS using last level due to CC increase within current level "+t.url),n(e.start,t))}}function h(r,t){if(!(!t.fragments.length||!r.hasProgramDateTime||!t.hasProgramDateTime)){var i=t.fragments[0].programDateTime,e=r.fragments[0].programDateTime,a=(e-i)/1e3+t.fragments[0].start;a&&Object(S.isFiniteNumber)(a)&&(c.logger.log("Adjusting PTS using programDateTime delta "+(e-i)+"ms, sliding:"+a.toFixed(3)+" "+r.url+" "),n(a,r))}}function v(r,t){var i=r.programDateTime;if(!!i){var e=(i-t)/1e3;r.start=r.startPTS=e,r.endPTS=e+r.duration}}function d(r,t){if(!(!t.fragments.length||!r.hasProgramDateTime||!t.hasProgramDateTime)){var i=t.fragments[0].programDateTime,e=t.fragments[0].start,a=i-e*1e3;r.fragments.forEach(function(o){v(o,a)}),r.fragmentHint&&v(r.fragmentHint,a),r.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(O,C,_){_.r(C);var S=_("./src/utils/ewma.ts"),c=function(){function y(T,p,u){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=u,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new S.default(T),this.fast_=new S.default(p)}var M=y.prototype;return M.update=function(p,u){var n=this.slow_,f=this.fast_;this.slow_.halfLife!==p&&(this.slow_=new S.default(p,n.getEstimate(),n.getTotalWeight())),this.fast_.halfLife!==u&&(this.fast_=new S.default(u,f.getEstimate(),f.getTotalWeight()))},M.sample=function(p,u){p=Math.max(p,this.minDelayMs_);var n=8*u,f=p/1e3,l=n/f;this.fast_.sample(f,l),this.slow_.sample(f,l)},M.canEstimate=function(){var p=this.fast_;return p&&p.getTotalWeight()>=this.minWeight_},M.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},M.destroy=function(){},y}();C.default=c},"./src/utils/ewma.ts":function(O,C,_){_.r(C);var S=function(){function c(M,T,p){T===void 0&&(T=0),p===void 0&&(p=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=M,this.alpha_=M?Math.exp(Math.log(.5)/M):0,this.estimate_=T,this.totalWeight_=p}var y=c.prototype;return y.sample=function(T,p){var u=Math.pow(this.alpha_,T);this.estimate_=p*(1-u)+u*this.estimate_,this.totalWeight_+=T},y.getTotalWeight=function(){return this.totalWeight_},y.getEstimate=function(){if(this.alpha_){var T=1-Math.pow(this.alpha_,this.totalWeight_);if(T)return this.estimate_/T}return this.estimate_},c}();C.default=S},"./src/utils/fetch-loader.ts":function(O,C,_){_.r(C),_.d(C,"fetchSupported",function(){return v});var S=_("./src/polyfills/number.ts"),c=_("./src/loader/load-stats.ts"),y=_("./src/demux/chunk-cache.ts");function M(e,a){e.prototype=Object.create(a.prototype),e.prototype.constructor=e,f(e,a)}function T(e){var a=typeof Map=="function"?new Map:void 0;return T=function(s){if(s===null||!n(s))return s;if(typeof s!="function")throw new TypeError("Super expression must either be null or a function");if(typeof a!="undefined"){if(a.has(s))return a.get(s);a.set(s,g)}function g(){return p(s,arguments,l(this).constructor)}return g.prototype=Object.create(s.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),f(g,s)},T(e)}function p(e,a,o){return u()?p=Reflect.construct:p=function(g,L,A){var m=[null];m.push.apply(m,L);var E=Function.bind.apply(g,m),x=new E;return A&&f(x,A.prototype),x},p.apply(null,arguments)}function u(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function n(e){return Function.toString.call(e).indexOf("[native code]")!==-1}function f(e,a){return f=Object.setPrototypeOf||function(s,g){return s.__proto__=g,s},f(e,a)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)},l(e)}function h(){return h=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var o=arguments[a];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(e[s]=o[s])}return e},h.apply(this,arguments)}function v(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}var d=function(){function e(o){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=o.fetchSetup||t,this.controller=new self.AbortController,this.stats=new c.LoadStats}var a=e.prototype;return a.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},a.abortInternal=function(){var s=this.response;(!s||!s.ok)&&(this.stats.aborted=!0,this.controller.abort())},a.abort=function(){var s;this.abortInternal(),(s=this.callbacks)!==null&&s!==void 0&&s.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},a.load=function(s,g,L){var A=this,m=this.stats;if(m.loading.start)throw new Error("Loader can only be used once.");m.loading.start=self.performance.now();var E=r(s,this.controller.signal),x=L.onProgress,D=s.responseType==="arraybuffer",I=D?"byteLength":"length";this.context=s,this.config=g,this.callbacks=L,this.request=this.fetchSetup(s,E),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){A.abortInternal(),L.onTimeout(m,s,A.response)},g.timeout),self.fetch(this.request).then(function(b){if(A.response=A.loader=b,!b.ok){var R=b.status,P=b.statusText;throw new i(P||"fetch, bad network response",R,b)}return m.loading.first=Math.max(self.performance.now(),m.loading.start),m.total=parseInt(b.headers.get("Content-Length")||"0"),x&&Object(S.isFiniteNumber)(g.highWaterMark)?A.loadProgressively(b,m,s,g.highWaterMark,x):D?b.arrayBuffer():b.text()}).then(function(b){var R=A.response;self.clearTimeout(A.requestTimeout),m.loading.end=Math.max(self.performance.now(),m.loading.first),m.loaded=m.total=b[I];var P={url:R.url,data:b};x&&!Object(S.isFiniteNumber)(g.highWaterMark)&&x(m,s,b,R),L.onSuccess(P,m,s,R)}).catch(function(b){if(self.clearTimeout(A.requestTimeout),!m.aborted){var R=b.code||0;L.onError({code:R,text:b.message},s,b.details)}})},a.getCacheAge=function(){var s=null;if(this.response){var g=this.response.headers.get("age");s=g?parseFloat(g):null}return s},a.loadProgressively=function(s,g,L,A,m){A===void 0&&(A=0);var E=new y.default,x=s.body.getReader(),D=function I(){return x.read().then(function(b){if(b.done)return E.dataLength&&m(g,L,E.flush(),s),Promise.resolve(new ArrayBuffer(0));var R=b.value,P=R.length;return g.loaded+=P,P<A||E.dataLength?(E.push(R),E.dataLength>=A&&m(g,L,E.flush(),s)):m(g,L,R,s),I()}).catch(function(){return Promise.reject()})};return D()},e}();function r(e,a){var o={method:"GET",mode:"cors",credentials:"same-origin",signal:a,headers:new self.Headers(h({},e.headers))};return e.rangeEnd&&o.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),o}function t(e,a){return new self.Request(e.url,a)}var i=function(e){M(a,e);function a(o,s,g){var L;return L=e.call(this,o)||this,L.code=void 0,L.details=void 0,L.code=s,L.details=g,L}return a}(T(Error));C.default=d},"./src/utils/imsc1-ttml-parser.ts":function(O,C,_){_.r(C),_.d(C,"IMSC1_CODEC",function(){return n}),_.d(C,"parseIMSC1",function(){return v});var S=_("./src/utils/mp4-tools.ts"),c=_("./src/utils/vttparser.ts"),y=_("./src/utils/vttcue.ts"),M=_("./src/demux/id3.ts"),T=_("./src/utils/timescale-conversion.ts"),p=_("./src/utils/webvtt-parser.ts");function u(){return u=Object.assign||function(A){for(var m=1;m<arguments.length;m++){var E=arguments[m];for(var x in E)Object.prototype.hasOwnProperty.call(E,x)&&(A[x]=E[x])}return A},u.apply(this,arguments)}var n="stpp.ttml.im1t",f=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,l=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,h={left:"start",center:"center",right:"end",start:"start",end:"end"};function v(A,m,E,x,D){var I=Object(S.findBox)(new Uint8Array(A),["mdat"]);if(I.length===0){D(new Error("Could not parse IMSC1 mdat"));return}var b=I[0],R=Object(M.utf8ArrayToStr)(new Uint8Array(A,b.start,b.end-b.start)),P=Object(T.toTimescaleFromScale)(m,1,E);try{x(d(R,P))}catch(w){D(w)}}function d(A,m){var E=new DOMParser,x=E.parseFromString(A,"text/xml"),D=x.getElementsByTagName("tt")[0];if(!D)throw new Error("Invalid ttml");var I={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},b=Object.keys(I).reduce(function(k,B){return k[B]=D.getAttribute("ttp:"+B)||I[B],k},{}),R=D.getAttribute("xml:space")!=="preserve",P=t(r(D,"styling","style")),w=t(r(D,"layout","region")),F=r(D,"body","[begin]");return[].map.call(F,function(k){var B=i(k,R);if(!B||!k.hasAttribute("begin"))return null;var U=s(k.getAttribute("begin"),b),j=s(k.getAttribute("dur"),b),K=s(k.getAttribute("end"),b);if(U===null)throw o(k);if(K===null){if(j===null)throw o(k);K=U+j}var N=new y.default(U-m,K-m,B);N.id=Object(p.generateCueId)(N.startTime,N.endTime,N.text);var Z=w[k.getAttribute("region")],$=P[k.getAttribute("style")];N.position=10,N.size=80;var Y=e(Z,$),ee=Y.textAlign;if(ee){var Q=h[ee];Q&&(N.lineAlign=Q),N.align=ee}return u(N,Y),N}).filter(function(k){return k!==null})}function r(A,m,E){var x=A.getElementsByTagName(m)[0];return x?[].slice.call(x.querySelectorAll(E)):[]}function t(A){return A.reduce(function(m,E){var x=E.getAttribute("xml:id");return x&&(m[x]=E),m},{})}function i(A,m){return[].slice.call(A.childNodes).reduce(function(E,x,D){var I;return x.nodeName==="br"&&D?E+`
`:(I=x.childNodes)!==null&&I!==void 0&&I.length?i(x,m):m?E+x.textContent.trim().replace(/\s+/g," "):E+x.textContent},"")}function e(A,m){var E="http://www.w3.org/ns/ttml#styling",x=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return x.reduce(function(D,I){var b=a(m,E,I)||a(A,E,I);return b&&(D[I]=b),D},{})}function a(A,m,E){return A.hasAttributeNS(m,E)?A.getAttributeNS(m,E):null}function o(A){return new Error("Could not parse ttml timestamp "+A)}function s(A,m){if(!A)return null;var E=Object(c.parseTimeStamp)(A);return E===null&&(f.test(A)?E=g(A,m):l.test(A)&&(E=L(A,m))),E}function g(A,m){var E=f.exec(A),x=(E[4]|0)+(E[5]|0)/m.subFrameRate;return(E[1]|0)*3600+(E[2]|0)*60+(E[3]|0)+x/m.frameRate}function L(A,m){var E=l.exec(A),x=Number(E[1]),D=E[2];switch(D){case"h":return x*3600;case"m":return x*60;case"ms":return x*1e3;case"f":return x/m.frameRate;case"t":return x/m.tickRate}return x}},"./src/utils/logger.ts":function(O,C,_){_.r(C),_.d(C,"enableLogs",function(){return p}),_.d(C,"logger",function(){return u});var S=function(){},c={trace:S,debug:S,log:S,warn:S,info:S,error:S},y=c;function M(n){var f=self.console[n];return f?f.bind(self.console,"["+n+"] >"):S}function T(n){for(var f=arguments.length,l=new Array(f>1?f-1:0),h=1;h<f;h++)l[h-1]=arguments[h];l.forEach(function(v){y[v]=n[v]?n[v].bind(n):M(v)})}function p(n){if(self.console&&n===!0||typeof n=="object"){T(n,"debug","log","info","warn","error");try{y.log()}catch(f){y=c}}else y=c}var u=y},"./src/utils/mediakeys-helper.ts":function(O,C,_){_.r(C),_.d(C,"KeySystems",function(){return S}),_.d(C,"requestMediaKeySystemAccess",function(){return c});var S;(function(y){y.WIDEVINE="com.widevine.alpha",y.PLAYREADY="com.microsoft.playready"})(S||(S={}));var c=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(O,C,_){_.r(C),_.d(C,"getMediaSource",function(){return S});function S(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(O,C,_){_.r(C),_.d(C,"bin2str",function(){return T}),_.d(C,"readUint16",function(){return p}),_.d(C,"readUint32",function(){return u}),_.d(C,"writeUint32",function(){return n}),_.d(C,"findBox",function(){return f}),_.d(C,"parseSegmentIndex",function(){return l}),_.d(C,"parseInitSegment",function(){return h}),_.d(C,"getStartDTS",function(){return v}),_.d(C,"getDuration",function(){return d}),_.d(C,"computeRawDurationFromSamples",function(){return r}),_.d(C,"offsetStartDTS",function(){return t}),_.d(C,"segmentValidRange",function(){return i}),_.d(C,"appendUint8Array",function(){return e});var S=_("./src/utils/typed-array.ts"),c=_("./src/loader/fragment.ts"),y=Math.pow(2,32)-1,M=[].push;function T(a){return String.fromCharCode.apply(null,a)}function p(a,o){"data"in a&&(o+=a.start,a=a.data);var s=a[o]<<8|a[o+1];return s<0?65536+s:s}function u(a,o){"data"in a&&(o+=a.start,a=a.data);var s=a[o]<<24|a[o+1]<<16|a[o+2]<<8|a[o+3];return s<0?4294967296+s:s}function n(a,o,s){"data"in a&&(o+=a.start,a=a.data),a[o]=s>>24,a[o+1]=s>>16&255,a[o+2]=s>>8&255,a[o+3]=s&255}function f(a,o){var s=[];if(!o.length)return s;var g,L,A;"data"in a?(g=a.data,L=a.start,A=a.end):(g=a,L=0,A=g.byteLength);for(var m=L;m<A;){var E=u(g,m),x=T(g.subarray(m+4,m+8)),D=E>1?m+E:A;if(x===o[0])if(o.length===1)s.push({data:g,start:m+8,end:D});else{var I=f({data:g,start:m+8,end:D},o.slice(1));I.length&&M.apply(s,I)}m=D}return s}function l(a){var o=f(a,["moov"]),s=o[0],g=s?s.end:null,L=f(a,["sidx"]);if(!L||!L[0])return null;var A=[],m=L[0],E=m.data[0],x=E===0?8:16,D=u(m,x);x+=4;var I=0,b=0;E===0?x+=8:x+=16,x+=2;var R=m.end+b,P=p(m,x);x+=2;for(var w=0;w<P;w++){var F=x,k=u(m,F);F+=4;var B=k&2147483647,U=(k&2147483648)>>>31;if(U===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var j=u(m,F);F+=4,A.push({referenceSize:B,subsegmentDuration:j,info:{duration:j/D,start:R,end:R+B-1}}),R+=B,F+=4,x=F}return{earliestPresentationTime:I,timescale:D,version:E,referencesCount:P,references:A,moovEndOffset:g}}function h(a){for(var o=[],s=f(a,["moov","trak"]),g=0;g<s.length;g++){var L=s[g],A=f(L,["tkhd"])[0];if(A){var m=A.data[A.start],E=m===0?12:20,x=u(A,E),D=f(L,["mdia","mdhd"])[0];if(D){m=D.data[D.start],E=m===0?12:20;var I=u(D,E),b=f(L,["mdia","hdlr"])[0];if(b){var R=T(b.data.subarray(b.start+8,b.start+12)),P={soun:c.ElementaryStreamTypes.AUDIO,vide:c.ElementaryStreamTypes.VIDEO}[R];if(P){var w=f(L,["mdia","minf","stbl","stsd"])[0],F=void 0;w&&(F=T(w.data.subarray(w.start+12,w.start+16))),o[x]={timescale:I,type:P},o[P]={timescale:I,id:x,codec:F}}}}}}var k=f(a,["moov","mvex","trex"]);return k.forEach(function(B){var U=u(B,4),j=o[U];j&&(j.default={duration:u(B,12),flags:u(B,20)})}),o}function v(a,o){return f(o,["moof","traf"]).reduce(function(s,g){var L=f(g,["tfdt"])[0],A=L.data[L.start],m=f(g,["tfhd"]).reduce(function(E,x){var D=u(x,4),I=a[D];if(I){var b=u(L,4);A===1&&(b*=Math.pow(2,32),b+=u(L,8));var R=I.timescale||9e4,P=b/R;if(isFinite(P)&&(E===null||P<E))return P}return E},null);return m!==null&&isFinite(m)&&(s===null||m<s)?m:s},null)||0}function d(a,o){for(var s=0,g=0,L=0,A=f(a,["moof","traf"]),m=0;m<A.length;m++){var E=A[m],x=f(E,["tfhd"])[0],D=u(x,4),I=o[D];if(!!I){var b=I.default,R=u(x,0)|(b==null?void 0:b.flags),P=b==null?void 0:b.duration;R&8&&(R&2?P=u(x,12):P=u(x,8));for(var w=I.timescale||9e4,F=f(E,["trun"]),k=0;k<F.length;k++){if(s=r(F[k]),!s&&P){var B=u(F[k],4);s=P*B}I.type===c.ElementaryStreamTypes.VIDEO?g+=s/w:I.type===c.ElementaryStreamTypes.AUDIO&&(L+=s/w)}}}if(g===0&&L===0){var U=l(a);if(U!=null&&U.references)return U.references.reduce(function(j,K){return j+K.info.duration||0},0)}return g||L}function r(a){var o=u(a,0),s=8;o&1&&(s+=4),o&4&&(s+=4);for(var g=0,L=u(a,4),A=0;A<L;A++){if(o&256){var m=u(a,s);g+=m,s+=4}o&512&&(s+=4),o&1024&&(s+=4),o&2048&&(s+=4)}return g}function t(a,o,s){f(o,["moof","traf"]).forEach(function(g){f(g,["tfhd"]).forEach(function(L){var A=u(L,4),m=a[A];if(!!m){var E=m.timescale||9e4;f(g,["tfdt"]).forEach(function(x){var D=x.data[x.start],I=u(x,4);if(D===0)n(x,4,I-s*E);else{I*=Math.pow(2,32),I+=u(x,8),I-=s*E,I=Math.max(I,0);var b=Math.floor(I/(y+1)),R=Math.floor(I%(y+1));n(x,4,b),n(x,8,R)}})}})})}function i(a){var o={valid:null,remainder:null},s=f(a,["moof"]);if(s){if(s.length<2)return o.remainder=a,o}else return o;var g=s[s.length-1];return o.valid=Object(S.sliceUint8)(a,0,g.start-8),o.remainder=Object(S.sliceUint8)(a,g.start-8),o}function e(a,o){var s=new Uint8Array(a.length+o.length);return s.set(a),s.set(o,a.length),s}},"./src/utils/output-filter.ts":function(O,C,_){_.r(C),_.d(C,"default",function(){return S});var S=function(){function c(M,T){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=M,this.trackName=T}var y=c.prototype;return y.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},y.newCue=function(T,p,u){(this.startTime===null||this.startTime>T)&&(this.startTime=T),this.endTime=p,this.screen=u,this.timelineController.createCaptionsTrack(this.trackName)},y.reset=function(){this.cueRanges=[],this.startTime=null},c}()},"./src/utils/texttrack-utils.ts":function(O,C,_){_.r(C),_.d(C,"sendAddTrackEvent",function(){return c}),_.d(C,"addCueToTrack",function(){return y}),_.d(C,"clearCurrentCues",function(){return M}),_.d(C,"removeCuesInRange",function(){return T}),_.d(C,"getCuesInRange",function(){return u});var S=_("./src/utils/logger.ts");function c(n,f){var l;try{l=new Event("addtrack")}catch(h){l=document.createEvent("Event"),l.initEvent("addtrack",!1,!1)}l.track=n,f.dispatchEvent(l)}function y(n,f){var l=n.mode;if(l==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(f.id))try{if(n.addCue(f),!n.cues.getCueById(f.id))throw new Error("addCue is failed for: "+f)}catch(v){S.logger.debug("[texttrack-utils]: "+v);var h=new self.TextTrackCue(f.startTime,f.endTime,f.text);h.id=f.id,n.addCue(h)}l==="disabled"&&(n.mode=l)}function M(n){var f=n.mode;if(f==="disabled"&&(n.mode="hidden"),n.cues)for(var l=n.cues.length;l--;)n.removeCue(n.cues[l]);f==="disabled"&&(n.mode=f)}function T(n,f,l){var h=n.mode;if(h==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0)for(var v=u(n.cues,f,l),d=0;d<v.length;d++)n.removeCue(v[d]);h==="disabled"&&(n.mode=h)}function p(n,f){if(f<n[0].startTime)return 0;var l=n.length-1;if(f>n[l].endTime)return-1;for(var h=0,v=l;h<=v;){var d=Math.floor((v+h)/2);if(f<n[d].startTime)v=d-1;else if(f>n[d].startTime&&h<l)h=d+1;else return d}return n[h].startTime-f<f-n[v].startTime?h:v}function u(n,f,l){var h=[],v=p(n,f);if(v>-1)for(var d=v,r=n.length;d<r;d++){var t=n[d];if(t.startTime>=f&&t.endTime<=l)h.push(t);else if(t.startTime>l)return h}return h}},"./src/utils/time-ranges.ts":function(O,C,_){_.r(C);var S={toString:function(y){for(var M="",T=y.length,p=0;p<T;p++)M+="["+y.start(p).toFixed(3)+","+y.end(p).toFixed(3)+"]";return M}};C.default=S},"./src/utils/timescale-conversion.ts":function(O,C,_){_.r(C),_.d(C,"toTimescaleFromBase",function(){return c}),_.d(C,"toTimescaleFromScale",function(){return y}),_.d(C,"toMsFromMpegTsClock",function(){return M}),_.d(C,"toMpegTsClockFromTimescale",function(){return T});var S=9e4;function c(p,u,n,f){n===void 0&&(n=1),f===void 0&&(f=!1);var l=p*u*n;return f?Math.round(l):l}function y(p,u,n,f){return n===void 0&&(n=1),f===void 0&&(f=!1),c(p,u,1/n,f)}function M(p,u){return u===void 0&&(u=!1),c(p,1e3,1/S,u)}function T(p,u){return u===void 0&&(u=1),c(p,S,1/u)}},"./src/utils/typed-array.ts":function(O,C,_){_.r(C),_.d(C,"sliceUint8",function(){return S});function S(c,y,M){return Uint8Array.prototype.slice?c.slice(y,M):new Uint8Array(Array.prototype.slice.call(c,y,M))}},"./src/utils/vttcue.ts":function(O,C,_){_.r(C),C.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var S=["","lr","rl"],c=["start","middle","end","left","right"];function y(n,f){if(typeof f!="string"||!Array.isArray(n))return!1;var l=f.toLowerCase();return~n.indexOf(l)?l:!1}function M(n){return y(S,n)}function T(n){return y(c,n)}function p(n){for(var f=arguments.length,l=new Array(f>1?f-1:0),h=1;h<f;h++)l[h-1]=arguments[h];for(var v=1;v<arguments.length;v++){var d=arguments[v];for(var r in d)n[r]=d[r]}return n}function u(n,f,l){var h=this,v={enumerable:!0};h.hasBeenReset=!1;var d="",r=!1,t=n,i=f,e=l,a=null,o="",s=!0,g="auto",L="start",A=50,m="middle",E=50,x="middle";Object.defineProperty(h,"id",p({},v,{get:function(){return d},set:function(I){d=""+I}})),Object.defineProperty(h,"pauseOnExit",p({},v,{get:function(){return r},set:function(I){r=!!I}})),Object.defineProperty(h,"startTime",p({},v,{get:function(){return t},set:function(I){if(typeof I!="number")throw new TypeError("Start time must be set to a number.");t=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",p({},v,{get:function(){return i},set:function(I){if(typeof I!="number")throw new TypeError("End time must be set to a number.");i=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",p({},v,{get:function(){return e},set:function(I){e=""+I,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",p({},v,{get:function(){return a},set:function(I){a=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",p({},v,{get:function(){return o},set:function(I){var b=M(I);if(b===!1)throw new SyntaxError("An invalid or illegal string was specified.");o=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",p({},v,{get:function(){return s},set:function(I){s=!!I,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",p({},v,{get:function(){return g},set:function(I){if(typeof I!="number"&&I!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");g=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",p({},v,{get:function(){return L},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");L=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",p({},v,{get:function(){return A},set:function(I){if(I<0||I>100)throw new Error("Position must be between 0 and 100.");A=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",p({},v,{get:function(){return m},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");m=b,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",p({},v,{get:function(){return E},set:function(I){if(I<0||I>100)throw new Error("Size must be between 0 and 100.");E=I,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",p({},v,{get:function(){return x},set:function(I){var b=T(I);if(!b)throw new SyntaxError("An invalid or illegal string was specified.");x=b,this.hasBeenReset=!0}})),h.displayState=void 0}return u.prototype.getCueAsHTML=function(){var n=self.WebVTT;return n.convertCueToDOMTree(self,this.text)},u}()},"./src/utils/vttparser.ts":function(O,C,_){_.r(C),_.d(C,"parseTimeStamp",function(){return y}),_.d(C,"fixLineBreaks",function(){return f}),_.d(C,"VTTParser",function(){return l});var S=_("./src/utils/vttcue.ts"),c=function(){function h(){}var v=h.prototype;return v.decode=function(r,t){if(!r)return"";if(typeof r!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(r))},h}();function y(h){function v(r,t,i,e){return(r|0)*3600+(t|0)*60+(i|0)+parseFloat(e||0)}var d=h.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return d?parseFloat(d[2])>59?v(d[2],d[3],0,d[4]):v(d[1],d[2],d[3],d[4]):null}var M=function(){function h(){this.values=Object.create(null)}var v=h.prototype;return v.set=function(r,t){!this.get(r)&&t!==""&&(this.values[r]=t)},v.get=function(r,t,i){return i?this.has(r)?this.values[r]:t[i]:this.has(r)?this.values[r]:t},v.has=function(r){return r in this.values},v.alt=function(r,t,i){for(var e=0;e<i.length;++e)if(t===i[e]){this.set(r,t);break}},v.integer=function(r,t){/^-?\d+$/.test(t)&&this.set(r,parseInt(t,10))},v.percent=function(r,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var i=parseFloat(t);if(i>=0&&i<=100)return this.set(r,i),!0}return!1},h}();function T(h,v,d,r){var t=r?h.split(r):[h];for(var i in t)if(typeof t[i]=="string"){var e=t[i].split(d);if(e.length===2){var a=e[0],o=e[1];v(a,o)}}}var p=new S.default(0,0,""),u=p.align==="middle"?"middle":"center";function n(h,v,d){var r=h;function t(){var a=y(h);if(a===null)throw new Error("Malformed timestamp: "+r);return h=h.replace(/^[^\sa-zA-Z-]+/,""),a}function i(a,o){var s=new M;T(a,function(A,m){var E;switch(A){case"region":for(var x=d.length-1;x>=0;x--)if(d[x].id===m){s.set(A,d[x].region);break}break;case"vertical":s.alt(A,m,["rl","lr"]);break;case"line":E=m.split(","),s.integer(A,E[0]),s.percent(A,E[0])&&s.set("snapToLines",!1),s.alt(A,E[0],["auto"]),E.length===2&&s.alt("lineAlign",E[1],["start",u,"end"]);break;case"position":E=m.split(","),s.percent(A,E[0]),E.length===2&&s.alt("positionAlign",E[1],["start",u,"end","line-left","line-right","auto"]);break;case"size":s.percent(A,m);break;case"align":s.alt(A,m,["start",u,"end","left","right"]);break}},/:/,/\s/),o.region=s.get("region",null),o.vertical=s.get("vertical","");var g=s.get("line","auto");g==="auto"&&p.line===-1&&(g=-1),o.line=g,o.lineAlign=s.get("lineAlign","start"),o.snapToLines=s.get("snapToLines",!0),o.size=s.get("size",100),o.align=s.get("align",u);var L=s.get("position","auto");L==="auto"&&p.position===50&&(L=o.align==="start"||o.align==="left"?0:o.align==="end"||o.align==="right"?100:50),o.position=L}function e(){h=h.replace(/^\s+/,"")}if(e(),v.startTime=t(),e(),h.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);h=h.substr(3),e(),v.endTime=t(),e(),i(h,v)}function f(h){return h.replace(/<br(?: \/)?>/gi,`
`)}var l=function(){function h(){this.state="INITIAL",this.buffer="",this.decoder=new c,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var v=h.prototype;return v.parse=function(r){var t=this;r&&(t.buffer+=t.decoder.decode(r,{stream:!0}));function i(){var L=t.buffer,A=0;for(L=f(L);A<L.length&&L[A]!=="\r"&&L[A]!==`
`;)++A;var m=L.substr(0,A);return L[A]==="\r"&&++A,L[A]===`
`&&++A,t.buffer=L.substr(A),m}function e(L){T(L,function(A,m){},/:/)}try{var a="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;a=i();var o=a.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!o||!o[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var s=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(s?s=!1:a=i(),t.state){case"HEADER":/:/.test(a)?e(a):a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new S.default(0,0,""),t.state="CUE",a.indexOf("-->")===-1){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{n(a,t.cue,t.regionList)}catch(L){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{var g=a.indexOf("-->")!==-1;if(!a||g&&(s=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=a}continue;case"BADCUE":a||(t.state="ID")}}}catch(L){t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},v.flush=function(){var r=this;try{if((r.cue||r.state==="HEADER")&&(r.buffer+=`

`,r.parse()),r.state==="INITIAL"||r.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){r.onparsingerror&&r.onparsingerror(t)}return r.onflush&&r.onflush(),this},h}()},"./src/utils/webvtt-parser.ts":function(O,C,_){_.r(C),_.d(C,"generateCueId",function(){return l}),_.d(C,"parseWebVTT",function(){return v});var S=_("./src/polyfills/number.ts"),c=_("./src/utils/vttparser.ts"),y=_("./src/demux/id3.ts"),M=_("./src/utils/timescale-conversion.ts"),T=_("./src/remux/mp4-remuxer.ts"),p=/\r\n|\n\r|\n|\r/g,u=function(r,t,i){return i===void 0&&(i=0),r.substr(i,t.length)===t},n=function(r){var t=parseInt(r.substr(-3)),i=parseInt(r.substr(-6,2)),e=parseInt(r.substr(-9,2)),a=r.length>9?parseInt(r.substr(0,r.indexOf(":"))):0;if(!Object(S.isFiniteNumber)(t)||!Object(S.isFiniteNumber)(i)||!Object(S.isFiniteNumber)(e)||!Object(S.isFiniteNumber)(a))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+r);return t+=1e3*i,t+=60*1e3*e,t+=60*60*1e3*a,t},f=function(r){for(var t=5381,i=r.length;i;)t=t*33^r.charCodeAt(--i);return(t>>>0).toString()};function l(d,r,t){return f(d.toString())+f(r.toString())+f(t)}var h=function(r,t,i){var e=r[t],a=r[e.prevCC];if(!a||!a.new&&e.new){r.ccOffset=r.presentationOffset=e.start,e.new=!1;return}for(;(o=a)!==null&&o!==void 0&&o.new;){var o;r.ccOffset+=e.start-a.start,e.new=!1,e=a,a=r[e.prevCC]}r.presentationOffset=i};function v(d,r,t,i,e,a,o,s){var g=new c.VTTParser,L=Object(y.utf8ArrayToStr)(new Uint8Array(d)).trim().replace(p,`
`).split(`
`),A=[],m=Object(M.toMpegTsClockFromTimescale)(r,t),E="00:00.000",x=0,D=0,I,b=!0,R=!1;g.oncue=function(P){var w=i[e],F=i.ccOffset,k=(x-m)/9e4;if(w!=null&&w.new&&(D!==void 0?F=i.ccOffset=w.start:h(i,e,k)),k&&(F=k-i.presentationOffset),R){var B=P.endTime-P.startTime,U=Object(T.normalizePts)((P.startTime+F-D)*9e4,a*9e4)/9e4;P.startTime=U,P.endTime=U+B}var j=P.text.trim();P.text=decodeURIComponent(encodeURIComponent(j)),P.id||(P.id=l(P.startTime,P.endTime,j)),P.endTime>0&&A.push(P)},g.onparsingerror=function(P){I=P},g.onflush=function(){if(I){s(I);return}o(A)},L.forEach(function(P){if(b)if(u(P,"X-TIMESTAMP-MAP=")){b=!1,R=!0,P.substr(16).split(",").forEach(function(w){u(w,"LOCAL:")?E=w.substr(6):u(w,"MPEGTS:")&&(x=parseInt(w.substr(7)))});try{D=n(E)/1e3}catch(w){R=!1,I=w}return}else P===""&&(b=!1);g.parse(P+`
`)}),g.flush()}},"./src/utils/xhr-loader.ts":function(O,C,_){_.r(C);var S=_("./src/utils/logger.ts"),c=_("./src/loader/load-stats.ts"),y=/^age:\s*[\d.]+\s*$/m,M=function(){function T(u){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=u?u.xhrSetup:null,this.stats=new c.LoadStats,this.retryDelay=0}var p=T.prototype;return p.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},p.abortInternal=function(){var n=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),n&&(n.onreadystatechange=null,n.onprogress=null,n.readyState!==4&&(this.stats.aborted=!0,n.abort()))},p.abort=function(){var n;this.abortInternal(),(n=this.callbacks)!==null&&n!==void 0&&n.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},p.load=function(n,f,l){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=n,this.config=f,this.callbacks=l,this.retryDelay=f.retryDelay,this.loadInternal()},p.loadInternal=function(){var n=this.config,f=this.context;if(!!n){var l=this.loader=new self.XMLHttpRequest,h=this.stats;h.loading.first=0,h.loaded=0;var v=this.xhrSetup;try{if(v)try{v(l,f.url)}catch(t){l.open("GET",f.url,!0),v(l,f.url)}l.readyState||l.open("GET",f.url,!0);var d=this.context.headers;if(d)for(var r in d)l.setRequestHeader(r,d[r])}catch(t){this.callbacks.onError({code:l.status,text:t.message},f,l);return}f.rangeEnd&&l.setRequestHeader("Range","bytes="+f.rangeStart+"-"+(f.rangeEnd-1)),l.onreadystatechange=this.readystatechange.bind(this),l.onprogress=this.loadprogress.bind(this),l.responseType=f.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.timeout),l.send()}},p.readystatechange=function(){var n=this.context,f=this.loader,l=this.stats;if(!(!n||!f)){var h=f.readyState,v=this.config;if(!l.aborted&&h>=2)if(self.clearTimeout(this.requestTimeout),l.loading.first===0&&(l.loading.first=Math.max(self.performance.now(),l.loading.start)),h===4){f.onreadystatechange=null,f.onprogress=null;var d=f.status;if(d>=200&&d<300){l.loading.end=Math.max(self.performance.now(),l.loading.first);var r,t;if(n.responseType==="arraybuffer"?(r=f.response,t=r.byteLength):(r=f.responseText,t=r.length),l.loaded=l.total=t,!this.callbacks)return;var i=this.callbacks.onProgress;if(i&&i(l,n,r,f),!this.callbacks)return;var e={url:f.responseURL,data:r};this.callbacks.onSuccess(e,l,n,f)}else l.retry>=v.maxRetry||d>=400&&d<499?(S.logger.error(d+" while loading "+n.url),this.callbacks.onError({code:d,text:f.statusText},n,f)):(S.logger.warn(d+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,v.maxRetryDelay),l.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),v.timeout)}},p.loadtimeout=function(){S.logger.warn("timeout while loading "+this.context.url);var n=this.callbacks;n&&(this.abortInternal(),n.onTimeout(this.stats,this.context,this.loader))},p.loadprogress=function(n){var f=this.stats;f.loaded=n.loaded,n.lengthComputable&&(f.total=n.total)},p.getCacheAge=function(){var n=null;if(this.loader&&y.test(this.loader.getAllResponseHeaders())){var f=this.loader.getResponseHeader("age");n=f?parseFloat(f):null}return n},T}();C.default=M}}).default})})(qe);var $e=We(qe.exports);const Oe=he=>(Tt("data-v-223125bc"),he=he(),St(),he),Yt=Oe(()=>ye("div",{class:"artplayer-app"},null,-1)),Zt={key:0,class:"zfile-video-switch-tools"},Qt=Re("\u4E0A\u4E00\u4E2A\u89C6\u9891"),$t=Re("\u4E0B\u4E00\u4E2A\u89C6\u9891"),Xt=Re(" \u76F4\u63A5\u4E0B\u8F7D "),Jt=Oe(()=>ye("img",{src:Mt,alt:"\u4E0B\u8F7D"},null,-1)),qt=Re(" \u4F7F\u7528\u8FC5\u96F7\u4E0B\u8F7D "),er=Oe(()=>ye("img",{src:It,alt:"\u8FC5\u96F7"},null,-1)),tr=Re(" \u4F7F\u7528 motrix \u4E0B\u8F7D "),rr=Oe(()=>ye("img",{src:bt,alt:"motrix"},null,-1)),ir=Re(" \u4F7F\u7528 PotPlayer \u64AD\u653E "),nr=Oe(()=>ye("img",{src:Rt,alt:"PotPlayer"},null,-1)),ar=Re(" \u4F7F\u7528 IINA \u64AD\u653E "),sr=Oe(()=>ye("img",{src:Ot,alt:"IINA"},null,-1)),or=Re(" \u4F7F\u7528 VLC \u64AD\u653E "),lr=Oe(()=>ye("img",{src:Ct,alt:"VLC"},null,-1)),ur=Re(" \u4F7F\u7528 nPlayer \u64AD\u653E "),fr=Oe(()=>ye("img",{src:Pt,alt:"nPlayer"},null,-1)),dr=Re(" \u4F7F\u7528 MXPlayer(Free) \u64AD\u653E "),cr=Oe(()=>ye("img",{src:wt,alt:"MXPlayer(Free)"},null,-1)),hr=Re(" \u4F7F\u7528 MXPlayer(Pro) \u64AD\u653E "),vr=Oe(()=>ye("img",{src:Ft,alt:"MXPlayer(Pro)"},null,-1)),pr={__name:"VideoPlayer",setup(he){let ve=ct();mt();let{getPathPwd:O}=gt(),{currentPath:C,storageKey:_}=yt(),S=ht(),c=vt();const y=L=>{let A=[];return S.filterFileByType("video").forEach(m=>{A.push({default:m.name===L,html:m.name,url:m.url})}),A};let M=Et(null);const T=L=>{switch(L){case"download":window.location=M.value.url;break;case"thunder":window.location=`thunder://${btoa("AA"+M.value.url+"ZZ")}`;break;case"motrix":window.location=`motrix://new-task?uri=${encodeURIComponent(M.value.url)}&out=${encodeURIComponent(M.value.name)}`;break;case"potplayer":window.location=`potplayer://${encodeURI(M.value.url)}`;break;case"iina":window.location=`iina://weblink?url=${encodeURIComponent(M.value.url)}`;break;case"vlc":window.location=`vlc://${M.value.url}`;break;case"nplayer":window.location=`nplayer-${M.value.url}`;break;case"mxplayer":window.location="intent:"+M.value.url+"#Intent;package=com.mxtech.videoplayer.ad;S.title="+M.value.name+";end";break;case"mxplayer-pro":window.location="intent:"+M.value.url+"#Intent;package=com.mxtech.videoplayer.pro;S.title="+M.value.name+";end";break}},p=L=>{let A=S.filterFileByType("video");u();for(let m=0;m<A.length;m++)if(A[m].name===L)return{prev:A[m-1]||null,next:A[m+1]||null}},u=()=>{let L=JSON.parse(localStorage.getItem("_h5_player_play_progress_"));if(L){for(let A of Object.keys(L))A.endsWith(L[A].progress)&&delete L[A];localStorage.setItem("_h5_player_play_progress_",JSON.stringify(L))}},n=L=>{let A=[];return S.fileList.find((m,E)=>{let x=m.name.toLowerCase();(x===L+".vtt"||x===L+".srt"||x===L+".ass")&&A.push({default:A.length===0,url:m.url,html:x})}),A.length>0&&A.push({url:"",html:"\u5173\u95ED\u5B57\u5E55"}),A};let f='<i class="art-icon art-icon-not-hidden"><svg t="1662978336444" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="968" width="128" height="128"><path d="M711.456 377.184c32.736 31.52 60.928 72.256 84.64 122.208a40.64 40.64 0 0 1 0 34.72c-63.776 135.04-160.48 202.528-290.112 202.528-46.752 0-89.248-8.832-127.456-26.464l37.184-37.184c27.52 10.048 57.6 15.104 90.272 15.104 108.864 0 188.48-55.168 244.608-171.296-21.088-43.584-45.44-78.56-73.44-105.28l34.304-34.336z m13.024-122.816l28.768 28.8a5.376 5.376 0 0 1 0 7.616L272.96 771.04a5.408 5.408 0 0 1-7.648 0l-28.8-28.8a5.376 5.376 0 0 1 0-7.616l71.36-71.36c-35.84-32.384-66.56-75.392-92.032-129.088a40.64 40.64 0 0 1 0-34.72C279.68 364.48 376.384 296.96 505.984 296.96c50.752 0 96.448 10.4 137.12 31.168l73.76-73.728a5.376 5.376 0 0 1 7.616 0z m-218.496 91.136c-108.8 0-188.416 55.168-244.608 171.296 22.944 47.36 49.792 84.608 80.928 112.096l56.256-56.256a118.688 118.688 0 0 1 160.576-160.576l47.424-47.424c-30.336-12.832-63.776-19.136-100.576-19.136z m-70.016 137.088a75.616 75.616 0 0 0-4.64 57.28l95.04-95.04a75.616 75.616 0 0 0-90.4 37.76z m60.416 109.504a75.456 75.456 0 0 0 82.144-82.112l35.616-35.616a118.72 118.72 0 0 1-153.376 153.344l35.616-35.616z" p-id="969"></path></svg></i>',l='<i class="art-icon art-icon-hidden"><svg t="1662978261880" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4451" width="128" height="128"><path d="M512.032 648a136.128 136.128 0 0 1-136-136c0-74.976 60.992-136 136-136s136 61.024 136 136a136.128 136.128 0 0 1-136 136z m0-224c-48.544 0-88 39.456-88 88s39.456 88 88 88 88-39.456 88-88-39.456-88-88-88z" p-id="4452"></path><path d="M512.032 743.616a327.68 327.68 0 0 1-231.872-95.616L142.88 512l137.28-136a327.68 327.68 0 0 1 231.872-95.584c87.328 0 169.664 33.952 231.872 95.584l137.28 136-137.28 136a327.52 327.52 0 0 1-231.872 95.616zM206.528 512l107.424 101.952c53.152 52.672 123.488 81.696 198.048 81.696s144.896-29.024 198.08-81.696L817.536 512l-107.424-101.952c-53.152-52.672-123.488-81.696-198.048-81.696s-144.896 29.024-198.08 81.696L206.528 512z" p-id="4453"></path></svg></i>',h='<i class="art-icon art-icon-video-list"><svg t="1650551038453" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12028" width="20" height="20"><path d="M111.395066 179.64038l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12029"></path><path d="M111.395066 468.067418l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12030"></path><path d="M111.395066 756.493433l801.208844 0 0 87.866187-801.208844 0 0-87.866187Z" p-id="12031"></path></svg></i>',v=`<i class="art-icon art-icon-subtitle"><svg xmlns="http://www.w3.org/2000/svg" height="22" width="22" viewBox="0 0 48 48">
    <path d="M0 0h48v48H0z" fill="none"></path>
    <path d="M40 8H8c-2.21 0-4 1.79-4 4v24c0 2.21 1.79 4 4 4h32c2.21 0 4-1.79 4-4V12c0-2.21-1.79-4-4-4zM8 24h8v4H8v-4zm20 12H8v-4h20v4zm12 0h-8v-4h8v4zm0-8H20v-4h20v4z"></path>
</svg></i>`,d='<i class="art-icon art-icon-next-video"><svg height="25" width="25"  viewBox="0 0 22 22"><path d="M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"></path></svg></i>',r='<i class="art-icon art-icon-prev-video" style="transform: scale(-1,1);"><svg height="25" width="25"  viewBox="0 0 22 22"><path d="M16 5a1 1 0 00-1 1v4.615a1.431 1.431 0 00-.615-.829L7.21 5.23A1.439 1.439 0 005 6.445v9.11a1.44 1.44 0 002.21 1.215l7.175-4.555a1.436 1.436 0 00.616-.828V16a1 1 0 002 0V6C17 5.448 16.552 5 16 5z"></path></svg></i>';const t=Ne("zfile-video-auto-player-next",!1),i=Ne("zfile-video-auto-player",!1),e=Ne("zfile-video-hiddle-tools",!1);let a=null;const o=(L,A)=>Ae(this,null,function*(){var w;M.value={name:L,url:A},document.querySelector(".zfile-video-dialog .el-dialog__title").innerHTML=L,a&&a.destroy();let m="mp4";L.toLowerCase().endsWith("flv")?m="flv":L.toLowerCase().endsWith("m3u8")&&(m="m3u8");let E=ve.removeDuplicateSeparator(`${C.value}/${L}`),x=ve.removeDuplicateSeparator(`${C.value}/__${L}__/video.m3u8`),D={storageKey:_.value,path:x,password:O()},I=!1,b=yield pt(D);if(((w=b==null?void 0:b.data)==null?void 0:w.code)===0&&(console.log("\u68C0\u6D4B\u5230\u5F53\u524D\u4E3A h5ai_dplayer \u517C\u5BB9\u6A21\u5F0F, \u66FF\u6362\u64AD\u653E\u6587\u4EF6\u4E3A: "+x),m="m3u8",I=!0),m==="m3u8"){let F=ve.removeDuplicateSeparator(c.globalConfig.domain+"/"+c.globalConfig.directLinkPrefix+"/"+_.value+"/"+(I?x:E));M.value.url=F,console.log("\u68C0\u6D4B\u5230\u5F53\u524D\u64AD\u653E\u7684\u6587\u4EF6\u4E3A m3u8, \u4E3A\u4E86\u6B63\u5E38\u52A0\u8F7D ts \u6587\u4EF6, \u66FF\u6362 m3u8 \u4E3A\u76F4\u94FE: "+F)}let R={container:".artplayer-app",title:L,url:M.value.url,type:m,setting:!0,playbackRate:!0,flip:!0,fullscreen:!0,fastForward:!0,autoOrientation:!0,aspectRatio:!0,fullscreenWeb:!0,theme:"#23ade5",lock:!0,subtitleOffset:!0,miniProgressBar:!0,autoplay:i.value,whitelist:["*"],moreVideoAttr:{"x5-video-player-type":"h5","x5-video-player-fullscreen":!1,"x5-video-orientation":"portraint",preload:"metadata",crossOrigin:"anonymous"},customType:{flv:function(F,k){if(Qe.isSupported()){const B=Qe.createPlayer({type:"flv",url:k});B.attachMediaElement(F),B.load()}else a.notice.show="\u4E0D\u652F\u6301\u64AD\u653E\u683C\u5F0F\uFF1Aflv"},m3u8:function(F,k){if($e.isSupported()){const B=new $e;B.loadSource(k),B.attachMedia(F)}else{const B=F.canPlayType("application/vnd.apple.mpegurl");B==="probably"||B=="maybe"?F.src=k:a.notice.show="\u4E0D\u652F\u6301\u64AD\u653E\u683C\u5F0F\uFF1Am3u8"}}},contextmenu:[{html:"\u4E0B\u8F7D",click:function(){window.open(A)}}],settings:[{html:"\u81EA\u52A8\u64AD\u653E",tooltip:i.value?"\u5F00\u542F":"\u5173\u95ED",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:i.value,onSwitch:function(F,k,B){const U=!F.switch;return i.value=U,a.autoplay=U,F.tooltip=U?"\u5F00\u542F":"\u5173\u95ED",U}},{html:"\u81EA\u52A8\u64AD\u653E\u4E0B\u4E00\u4E2A\u89C6\u9891",tooltip:t.value?"\u5F00\u542F":"\u5173\u95ED",icon:'<img width="22" heigth="22" src="data:image/svg+xml;base64,Cjxzdmcgdmlld0JveD0iMCAwIDgwIDgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48ZGVmcz48cGF0aCBpZD0icGlkLTY0LXN2Z28tYSIgZD0iTTAgMGg4MHY4MEgweiI+PC9wYXRoPjxwYXRoIGQ9Ik01Mi41NDYgOC4wMTRhMy45OTggMy45OTggMCAwMTQuMjIyIDMuMDc3Yy4xMDQuNDQ2LjA5My44MDguMDM5IDEuMTM4YTIuNzQgMi43NCAwIDAxLS4zMTIuODgxYy0uMDczLjEzMi0uMTYuMjU0LS4yNDYuMzc2bC0uMjU3LjM2Ni0uNTIxLjczYy0uNy45NjktMS40MTUgMS45MjYtMi4xNTQgMi44NjZsLS4wMTUuMDJhMjQwLjk0NSAyNDAuOTQ1IDAgMDE1Ljk4Ni4zNDFsMS42NDMuMTIzLjgyMi4wNjYuNDEuMDM0LjIwNi4wMTguMTAzLjAwOC4xMTUuMDEyYzEuMjY2LjExNiAyLjUxNi40NSAzLjY3Ny45NzVhMTEuNjYzIDExLjY2MyAwIDAxMy4xNjYgMi4xMTRjLjkzMS44NyAxLjcxOSAxLjg5NSAyLjMyMSAzLjAyMmExMS41OTUgMTEuNTk1IDAgMDExLjIyNCAzLjYxM2MuMDMuMTU3LjA0Ni4zMTYuMDY4LjQ3NGwuMDE1LjExOS4wMTMuMTEyLjAyMi4yMDYuMDg1LjgyMi4xNTkgMS42NDZjLjEgMS4wOTguMTkgMi4xOTguMjcgMy4yOTguMzE1IDQuNC40NjMgOC44MjkuMzYgMTMuMjU1YTE2Ni40ODkgMTY2LjQ4OSAwIDAxLS44NDMgMTMuMjEzYy0uMDEyLjEyNy0uMDM0LjI5Ny0uMDUzLjQ1NGE3LjU4OSA3LjU4OSAwIDAxLS4wNzIuNDc1bC0uMDQuMjM3LS4wNS4yMzZhMTEuNzYyIDExLjc2MiAwIDAxLS43NCAyLjI4NyAxMS43NTUgMTEuNzU1IDAgMDEtNS4xMTggNS41NyAxMS43MDUgMTEuNzA1IDAgMDEtMy42MjMgMS4yNjNjLS4xNTguMDI0LS4zMTYuMDUyLS40NzUuMDcybC0uNDc3LjA1My0uODIxLjA3MS0xLjY0NC4xMzRjLTEuMDk2LjA4Ni0yLjE5Mi4xNi0zLjI4OC4yM2EyNjAuMDggMjYwLjA4IDAgMDEtNi41NzguMzI1Yy04Ljc3Mi4zMjQtMTcuNTQ2LjIyLTI2LjMxMy0uMzAyYTI0Mi40NTggMjQyLjQ1OCAwIDAxLTMuMjg3LS4yMmwtMS42NDMtLjEyOS0uODIyLS4wNjktLjQxLS4wMzUtLjIwNi0uMDE4Yy0uMDY4LS4wMDYtLjEzMy0uMDEtLjIxOC0uMDJhMTEuNTY2IDExLjU2NiAwIDAxLTMuNy0uOTkyIDExLjczMiAxMS43MzIgMCAwMS01LjQ5Ny01LjE3OCAxMS43MyAxMS43MyAwIDAxLTEuMjE1LTMuNjI3Yy0uMDI0LS4xNTgtLjA1MS0uMzE2LS4wNjctLjQ3NWwtLjAyNi0uMjM4LS4wMTMtLjExOS0uMDEtLjEwMy0uMDctLjgyMy0uMTMyLTEuNjQ4YTE5MC42MzcgMTkwLjYzNyAwIDAxLS4yMi0zLjI5OGMtLjI1Ni00LjM5OS0uMzU4LTguODE3LS4yNTgtMTMuMjMzLjA5OS00LjQxMi4zNzItOC44MTEuNzg4LTEzLjE5N2ExMS42NSAxMS42NSAwIDAxMy4wMzktNi44MzUgMTEuNTg1IDExLjU4NSAwIDAxNi41NzItMy41NjNjLjE1Ny0uMDIzLjMxMi0uMDUxLjQ3LS4wN2wuNDctLjA1LjgyLS4wNyAxLjY0My0uMTNhMjI4LjQ5MyAyMjguNDkzIDAgMDE2LjY0Ny0uNDA1bC0uMDQxLS4wNWE4OC4xNDUgODguMTQ1IDAgMDEtMi4xNTQtMi44NjdsLS41Mi0uNzMtLjI1OC0uMzY2Yy0uMDg2LS4xMjItLjE3My0uMjQ0LS4yNDYtLjM3NmEyLjc0IDIuNzQgMCAwMS0uMzEyLS44ODEgMi44MDggMi44MDggMCAwMS4wNC0xLjEzOCAzLjk5OCAzLjk5OCAwIDAxNC4yMi0zLjA3NyAyLjggMi44IDAgMDExLjA5My4zMTNjLjI5NC4xNTUuNTM4LjM0Ny43NDIuNTY4LjEwMi4xMS4xOS4yMy4yOC4zNWwuMjcuMzU5LjUzMi43MmE4OC4wNTkgODguMDU5IDAgMDEyLjA2IDIuOTM2IDczLjAzNiA3My4wMzYgMCAwMTEuOTI5IDMuMDNjLjE4Ny4zMTMuMzczLjYyOC41NTYuOTQ1IDIuNzI0LS4wNDcgNS40NDctLjA1NiA4LjE3LS4wMzguNzQ4LjAwNiAxLjQ5Ni4wMTUgMi4yNDQuMDI2LjE4LS4zMTMuMzY0LS42MjQuNTQ5LS45MzRhNzMuMjgxIDczLjI4MSAwIDAxMS45My0zLjAzIDg4LjczNyA4OC43MzcgMCAwMTIuMDU5LTIuOTM1bC41MzMtLjcyLjI2OC0uMzU5Yy4wOS0uMTIuMTc5LS4yNC4yODEtLjM1YTIuOCAyLjggMCAwMTEuODM0LS44ODF6TTMwLjEzIDM0LjYzMWE0IDQgMCAwMC0uNDE4IDEuNDIgOTEuMTU3IDkxLjE1NyAwIDAwLS40NDYgOS4xMjhjMCAyLjgyOC4xMjEgNS42NTYuMzY0IDguNDgzbC4xMSAxLjIxMmE0IDQgMCAwMDUuODU4IDMuMTQzYzIuODItMS40OTggNS41NS0zLjAzMyA4LjE5My00LjYwNmExNzcuNDEgMTc3LjQxIDAgMDA1Ljg5Ni0zLjY2NmwxLjQzNC0uOTQyYTQgNCAwIDAwLjA0Ny02LjYzMiAxMzcuNzAzIDEzNy43MDMgMCAwMC03LjM3Ny00LjcwOCAxNDYuODggMTQ2Ljg4IDAgMDAtNi44NzktMy44NDlsLTEuNC0uNzI1YTQgNCAwIDAwLTUuMzgyIDEuNzQyeiIgaWQ9InBpZC02NC1zdmdvLWQiPjwvcGF0aD48ZmlsdGVyIHg9Ii0xNS40JSIgeT0iLTE2LjMlIiB3aWR0aD0iMTMwLjklIiBoZWlnaHQ9IjEzMi41JSIgZmlsdGVyVW5pdHM9Im9iamVjdEJvdW5kaW5nQm94IiBpZD0icGlkLTY0LXN2Z28tYyI+PGZlT2Zmc2V0IGR5PSIyIiBpbj0iU291cmNlQWxwaGEiIHJlc3VsdD0ic2hhZG93T2Zmc2V0T3V0ZXIxIj48L2ZlT2Zmc2V0PjxmZUdhdXNzaWFuQmx1ciBzdGREZXZpYXRpb249IjEiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjEiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMSI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMyAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMSIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjEiPjwvZmVDb2xvck1hdHJpeD48ZmVPZmZzZXQgaW49IlNvdXJjZUFscGhhIiByZXN1bHQ9InNoYWRvd09mZnNldE91dGVyMiI+PC9mZU9mZnNldD48ZmVHYXVzc2lhbkJsdXIgc3RkRGV2aWF0aW9uPSIzLjUiIGluPSJzaGFkb3dPZmZzZXRPdXRlcjIiIHJlc3VsdD0ic2hhZG93Qmx1ck91dGVyMiI+PC9mZUdhdXNzaWFuQmx1cj48ZmVDb2xvck1hdHJpeCB2YWx1ZXM9IjAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAgMCAwIDAuMiAwIiBpbj0ic2hhZG93Qmx1ck91dGVyMiIgcmVzdWx0PSJzaGFkb3dNYXRyaXhPdXRlcjIiPjwvZmVDb2xvck1hdHJpeD48ZmVNZXJnZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMSI+PC9mZU1lcmdlTm9kZT48ZmVNZXJnZU5vZGUgaW49InNoYWRvd01hdHJpeE91dGVyMiI+PC9mZU1lcmdlTm9kZT48L2ZlTWVyZ2U+PC9maWx0ZXI+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iLjgiPjxtYXNrIGlkPSJwaWQtNjQtc3Znby1iIiBmaWxsPSIjZmZmIj48dXNlIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1hIj48L3VzZT48L21hc2s+PGcgbWFzaz0idXJsKCNwaWQtNjQtc3Znby1iKSI+PHVzZSBmaWxsPSIjMDAwIiBmaWx0ZXI9InVybCgjcGlkLTY0LXN2Z28tYykiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48dXNlIGZpbGw9IiNGRkYiIHhsaW5rOmhyZWY9IiNwaWQtNjQtc3Znby1kIj48L3VzZT48L2c+PC9nPjwvc3ZnPg==">',switch:t.value,onSwitch:function(F,k,B){const U=!F.switch;return t.value=U,F.tooltip=U?"\u5F00\u542F":"\u5173\u95ED",U}}],controls:[{position:"right",html:e.value?f:l,click:function(F,k){e.value=!e.value,k.target.parentNode.parentNode.innerHTML=e.value?f:l}},{name:"video-list",position:"right",html:h,selector:y(L),onSelect:function(F,k){return o(F.html,F.url),h}}]},P=n(L);P.length>0&&P.length>1&&R.controls.push({name:"video-subtitle",position:"right",html:v,selector:P,onSelect:F=>(F.html==="\u5173\u95ED\u5B57\u5E55"?a.subtitle.show=!1:(a.subtitle.show=!0,a.subtitle.url=F.url),v)}),a=new kt(R),a.on("destory",()=>{}),ve.isMobile.value===!1&&a.on("ready",()=>{let F=p(a.option.title);F.prev&&a.controls.add({name:"prev-video",position:"left",index:5,tooltip:"\u64AD\u653E\u4E0A\u4E00\u4E2A",html:r,click:()=>{g()}}),F.next&&a.controls.add({name:"next-video",position:"left",index:15,tooltip:"\u64AD\u653E\u4E0B\u4E00\u4E2A",html:d,click:()=>{s()}})}),a.on("video:ended",()=>{t.value&&s()}),P.length>0&&(a.subtitle.url=P[0].url)}),s=()=>{const L=p(a.option.title).next;L&&o(L.name,L.url)},g=()=>{const L=p(a.option.title).prev;L&&o(L.name,L.url)};return xt(()=>{o(S.currentClickRow.name,S.currentClickRow.url)}),(L,A)=>{const m=Lt,E=At;return ke(),Be("div",null,[Yt,Ce(M)&&Ce(ve).isMobile.value?(ke(),Be("div",Zt,[be(m,{disabled:!p(Ce(M).name).prev,icon:Ce(Kt),onClick:g},{default:xe(()=>[Qt]),_:1},8,["disabled","icon"]),be(m,{disabled:!p(Ce(M).name).next,icon:Ce(Ht),onClick:s},{default:xe(()=>[$t]),_:1},8,["disabled","icon"])])):_t("",!0),ye("div",{class:Ze(["zfile-video-tools",Ce(e)?"hidden-important":""])},[ye("div",{class:"zfile-video-tools-item",onClick:A[0]||(A[0]=x=>T("download"))},[be(E,{placement:"top"},{content:xe(()=>[Xt]),default:xe(()=>[Jt]),_:1})]),ye("div",{class:"zfile-video-tools-item",onClick:A[1]||(A[1]=x=>T("thunder"))},[be(E,{placement:"top"},{content:xe(()=>[qt]),default:xe(()=>[er]),_:1})]),ye("div",{class:"zfile-video-tools-item",onClick:A[2]||(A[2]=x=>T("motrix"))},[be(E,{placement:"top"},{content:xe(()=>[tr]),default:xe(()=>[rr]),_:1})]),ye("div",{class:"zfile-video-tools-item",onClick:A[3]||(A[3]=x=>T("potplayer"))},[be(E,{placement:"top"},{content:xe(()=>[ir]),default:xe(()=>[nr]),_:1})]),ye("div",{class:"zfile-video-tools-item",onClick:A[4]||(A[4]=x=>T("iina"))},[be(E,{placement:"top"},{content:xe(()=>[ar]),default:xe(()=>[sr]),_:1})]),ye("div",{class:"zfile-video-tools-item",onClick:A[5]||(A[5]=x=>T("vlc"))},[be(E,{placement:"top"},{content:xe(()=>[or]),default:xe(()=>[lr]),_:1})]),ye("div",{class:"zfile-video-tools-item",onClick:A[6]||(A[6]=x=>T("nplayer"))},[be(E,{placement:"top"},{content:xe(()=>[ur]),default:xe(()=>[fr]),_:1})]),ye("div",{class:"zfile-video-tools-item",onClick:A[7]||(A[7]=x=>T("mxplayer"))},[be(E,{placement:"top"},{content:xe(()=>[dr]),default:xe(()=>[cr]),_:1})]),ye("div",{class:"zfile-video-tools-item",onClick:A[8]||(A[8]=x=>T("mxplayer-pro"))},[be(E,{placement:"top"},{content:xe(()=>[hr]),default:xe(()=>[vr]),_:1})])],2),ye("div",{class:Ze(["zfile-video-tools-tips",Ce(e)?"hidden-important":""])}," tips: \u53EF\u70B9\u51FB\u4E0A\u65B9\u7684\u8F6F\u4EF6\u56FE\u6807\u8FDB\u884C\u4E0B\u8F7D\u64AD\u653E, \u672C\u5730\u64AD\u653E\u5668\u89E3\u7801\u6548\u679C\u66F4\u4F73. ",2)])}}};var Br=Dt(pr,[["__scopeId","data-v-223125bc"]]);export{Br as default};
