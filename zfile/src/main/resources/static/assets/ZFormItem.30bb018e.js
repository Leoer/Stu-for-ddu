import{S as E}from"./index.5cf4e3bb.js";import{_ as q}from"./plugin-vue_export-helper.21dcd24c.js";import{r as b,c as u,a as x,f as w,p as a,g as p,o as I,H as k,n as $,u as g,t as F,k as Z,a0 as j}from"./index.9f622a37.js";const A={class:"z-form"},R={class:"space-y-8 divide-y divide-gray-200"},S={class:"z-form-body"},B={class:"z-form-title text-lg leading-6 font-medium text-gray-900"},O={class:"z-form-sub-title mt-2 max-w-3xl text-sm text-gray-500"},V={class:"z-form-footer"},C={class:"pt-5"},N={class:"flex justify-end"},D={name:"ZForm"},H=Object.assign(D,{props:{model:Object,rules:Object},setup(v,{expose:o}){const d=v;let m=b({}),f=b([]),n=u(()=>{const e={};return f.value.forEach(({prop:t,required:i,label:s})=>{if(i&&(e[t]=[{required:!0,message:`${s}\u4E0D\u80FD\u4E3A\u7A7A`}]),d.rules[t]===void 0){console.debug(`prop \u4E3A ${t} \u7684 FormItem \u6821\u9A8C\u89C4\u5219\u4E0D\u5B58\u5728, \u8DF3\u8FC7.`);return}if(!Array.isArray(d.rules[t])){console.warn(`prop \u4E3A ${t} \u7684 FormItem \u6821\u9A8C\u89C4\u5219\u4E0D\u5B58\u5728\u6216\u8005\u5176\u503C\u4E0D\u662F\u6570\u7EC4`),e[t]=[{required:!0}];return}e[t]=d.rules[t]}),e}),_=u(()=>f.value.reduce((e,{prop:t})=>{let i=t.split(".");if(i.length>1){let s=d.model;for(;i.length>=1;){let c=i.shift();s[c]!==void 0&&(s=s[c])}e[t]=s}else e[t]=d.model[t];return e},{}));const y=e=>{new E(n.value).validate(_.value,i=>{let s={};i&&i.length?i.forEach(({message:c,field:z})=>{s[z]=c}):s={},m.value=s,e(Object.keys(s).length===0)})},h=e=>{e&&(f.value=[...f.value,e])},r=e=>{e&&(f.value=f.value.filter(({prop:t})=>t!==e.prop))};let l=u(()=>d.rules);return o({validate:y,formAddField:h,formRemoveField:r,rulesArray:l,formError:m}),(e,t)=>(x(),w("form",A,[a("div",R,[a("div",S,[a("div",null,[a("h3",B,[p(e.$slots,"form-title",{},void 0,!0)]),a("p",O,[p(e.$slots,"form-sub-title",{},void 0,!0)])]),p(e.$slots,"default",{},void 0,!0)]),a("div",V,[a("div",C,[a("div",N,[p(e.$slots,"footer",{},void 0,!0)])])])])]))}});var W=q(H,[["__scopeId","data-v-c597957c"]]);const M={class:"sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start sm:border-t sm:border-gray-200 sm:pt-5"},T=["for"],U={class:"mt-1 sm:mt-0 sm:col-span-2"},G={class:"empty:mt-0 mt-2 text-sm max-w-2xl text-gray-400 z-form-item-tips"},J={class:"empty:mt-0 mt-2 text-sm text-red-500"},K={__name:"ZFormItem",props:{required:Boolean,prop:String,label:String},setup(v){const o=v,{proxy:d}=j();let m=u(()=>{let r=n.value.rulesArray;return r?r[o.prop]:[]}),f=u(()=>{if(o.required)return!0;if(m.value)for(let r=0;r<m.value.length;r++){let l=m.value[r].required;if(typeof l=="boolean")return!0;if(typeof l=="function")return l()}return!1}),n=u(()=>{let r=d.$parent;for(;r.$options.name!=="ZForm";)r=r.parent;return r});u(()=>o.prop&&n.value.formError[o.prop]||"");const _=(r,l)=>{n.value[r](l)};let y=b();I(()=>{o.prop&&_("formAddField",{prop:o.prop,required:o.required,label:o.label,el:y.value})}),k(()=>{_("formRemoveField",{prop:o.prop})});const h=r=>{let l=r.target.value,e={},t={};m.value&&(e[o.prop]=m.value,t[o.prop]=l),new E(e).validate(t,s=>{s&&s.length?s.forEach(({message:c,field:z})=>{n.value.formError[o.prop]=c}):n.value.formError[o.prop]=""})};return(r,l)=>(x(),w("div",{ref_key:"zFormItem",ref:y,class:$([g(n).formError[o.prop]?"is-error":"is-success","z-form-item mt-6 sm:mt-5 space-y-6 sm:space-y-5"])},[a("div",M,[v.label?(x(),w("label",{key:0,for:o.prop,class:$([g(f)?"required":"not-required","block text-sm font-medium text-gray-700 sm:mt-px sm:pt-2"])},F(v.label),11,T)):Z("",!0),a("div",U,[a("div",{class:"input max-w-2xl flex rounded-md z-form-item-input",onInput:h},[p(r.$slots,"default",{},void 0,!0)],32),a("p",G,[p(r.$slots,"tips",{},void 0,!0)]),a("p",J,F(g(n).formError[o.prop]),1)])])],2))}};var X=q(K,[["__scopeId","data-v-22eef9f0"]]);export{X as Z,W as a};
