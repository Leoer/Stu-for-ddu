import{d as E,s as M,a as q,b as B,l as I,c as O}from"./admin-storage.bbd5bbcc.js";import{S as P}from"./sortable.esm.a99254e8.js";import{E as l}from"./index.109b76e3.js";import{E as n}from"./request.b205aa07.js";import{r as o,c as T}from"./index.9f622a37.js";let C=o(!1),S=o(),i=o(!1),t=o([]),s=o("");function $(r){const v=()=>{r.push("/admin/storage-edit")},u=e=>{r.push("/admin/storage-edit/"+e.id)},d=e=>{l.confirm("\u662F\u5426\u786E\u8BA4\u5220\u9664\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",callback:a=>{a==="confirm"&&E(e.id).then(c=>{n.success("\u5220\u9664\u6210\u529F"),w()})}})},x=e=>{l.confirm("\u662F\u5426\u786E\u8BA4\u5173\u95ED\uFF1F\u5173\u95ED\u540E\u586B\u5199\u7684\u6570\u636E\u4E0D\u4F1A\u4FDD\u7559\u3002",{type:"warning"}).then(a=>{e()}).catch(a=>{})},g=e=>{r.push("/admin/storage-filter/"+e.id)},h=e=>{r.push("/admin/storage-readme/"+e.id)},f=e=>{r.push("/admin/storage-password/"+e.id)},b=e=>{l.confirm(`\u662F\u5426\u786E\u8BA4${e.enable?"\u505C\u6B62":"\u542F\u7528"}\u5B58\u50A8\u6E90\u3002`,"\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning",callback:a=>{if(a==="confirm"){let c=e.enable?"disable":"enable";M(e.id,c).then(()=>{n.success((e.enable?"\u505C\u6B62":"\u542F\u7528")+"\u6210\u529F"),e.enable=!e.enable})}}})},k=e=>{let a=e.enableCache?"enable":"disable";q(e.id,a).then(()=>{n.success("\u4FEE\u6539\u6210\u529F")})},L=e=>{let a=e.autoRefreshCache?"start":"stop";B(e.id,a).then(()=>{n.success("\u4FEE\u6539\u6210\u529F")})},p=e=>{S.value=e.id,C.value=!0},R=e=>{switch(e.operator){case"edit":u(e.storage);break;case"enable":b(e.storage);break;case"readmeManager":h(e.storage);break;case"cacheManager":p(e.storage);break;case"filterManager":g(e.storage);break;case"pwdManager":f(e.storage);break;case"delete":d(e.storage);break}},m=()=>{const e=document.querySelector(".storage-container");P.create(e,{draggable:".storage-item",filter:".add-storage-btn",onEnd:a=>{if(a.oldIndex===a.newIndex)return;const c=t.value.splice(a.oldIndex,1)[0];t.value.splice(a.newIndex,0,c),O(t.value).then(()=>{n.success("\u8C03\u6574\u6392\u5E8F\u6210\u529F")})}})},w=()=>{i.value=!0,I().then(e=>{t.value=e.data,m(),i.value=!1})},y=T(()=>s.value===""?t.value:t.value.filter(e=>!!(e.name&&e.name.toLowerCase().indexOf(s.value.toLowerCase())!==-1||e.remark&&e.remark.toLowerCase().indexOf(s.value.toLowerCase())!==-1||e.type&&e.type.description.toLowerCase().indexOf(s.value.toLowerCase())!==-1||e.type&&e.type.key.toLowerCase().indexOf(s.value.toLowerCase())!==-1)));return{init:w,loading:i,searchKey:s,storageListSearchResult:y,handleOperator:R,addStorage:v,editStorage:u,deleteStorage:d,handleClose:x,showFilterPage:g,showReadmePage:h,showPasswordPage:f,switchEnableStatus:b,cacheManageVisible:C,currentCacheManageId:S,switchCacheEnableStatus:k,switchCacheAutoRefreshStatus:L,cacheManage:p}}export{$ as u};
